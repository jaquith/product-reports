{"versionorigin":"202102150938","settings":{"lastcustomizeid":"0","account":"services-caleb","profileid":"tui-uk-staging","datacloud_revision":"1605528129252","lastdefineid":"811","minorrevision":"202102150939","library":"NONE","creation":"202101191111","revision":"202102150939","datacloud_profile":"main","lastloadruleid":"3","lastlabelid":"0","lastmanageid":"22"},"createManifest":"false","labels":{"1":{"name":"Flights","color":"daffodil-delight"},"2":{"color":"daffodil-delight","name":"DD_bookingReference"},"3":{"color":"daffodil-delight","name":"FirstChoice"},"4":{"color":"daffodil-delight","name":"Flight_Only"},"5":{"color":"daffodil-delight","name":"Beach"},"6":{"name":"All_Pages_Excluding_Payment_Page","color":"daffodil-delight"},"7":{"color":"daffodil-delight","name":"Prod"},"8":{"name":"Data_Definition_Condition","color":"daffodil-delight"},"9":{"color":"daffodil-delight","name":"All_Dev"},"10":{"name":"All_Test_Sites","color":"daffodil-delight"},"11":{"name":"TUI_IE","color":"daffodil-delight"},"12":{"name":"TUI_UK","color":"daffodil-delight"},"13":{"name":"FC","color":"daffodil-delight"},"14":{"color":"daffodil-delight","name":"Confirmation"},"15":{"color":"daffodil-delight","name":"All_Pages_Including_Payment_Page"},"16":{"name":"Web","color":"daffodil-delight"},"17":{"color":"daffodil-delight","name":"Dev"},"18":{"color":"old-olive","name":"consent_manager"},"19":{"name":"Marketing","color":"tempting-turquoise"},"20":{"name":"Google_Analytics","color":"pumpkin-pie"},"21":{"color":"old-olive","name":"Google_Campaign_Manager"},"22":{"name":"Google_Ads","color":"old-olive"},"23":{"name":"UDO","color":"real-red"},"24":{"color":"daffodil-delight","name":"All_Brands"},"25":{"color":"daffodil-delight","name":"Global"},"26":{"name":"Facebook","color":"pacific-point"}},"define":{"138":{"_id":"138","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"cp","labels":"","name":"utag_main_tealium_test_session"},"139":{"name":"tealium_test","labels":"","type":"qp","title":"","description":"Should be 'true' or 'false'","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"139"},"140":{"name":"utagdb","labels":"","type":"cp","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"140"},"141":{"_id":"141","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","name":"page_type","labels":"","type":"js"},"222":{"_id":"222","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","name":"ut.event","type":"js","labels":""},"223":{"title":"","description":"","name":"adobeLinkTrackVars","labels":"","type":"js","_id":"223","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"224":{"title":"","description":"","name":"adobeLinkTrackEvents","labels":"","type":"js","_id":"224","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"225":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"225","type":"js","labels":"","name":"event_name","description":"","title":""},"226":{"description":"","title":"","labels":"","type":"js","name":"map_eVar230","_id":"226","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"228":{"title":"","description":"","name":"mapToAdobeLinkTrackVars","type":"js","labels":"","_id":"228","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"229":{"_id":"229","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","labels":"","name":"mapToAdobeLinkTrackEvents"},"230":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"230","name":"adobe_template_version","type":"qp","labels":"","title":"","description":""},"311":{"labels":"","name":"legacy_abtaNumber","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"311","type":"js","description":"","title":"","imported":""},"312":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_abTest","_id":"312","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"313":{"imported":"","title":"","description":"","type":"js","_id":"313","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_adobeCookieDomainPeriods","labels":""},"314":{"title":"","description":"","type":"js","imported":"","name":"legacy_adobeDownloadFileTypes","labels":"","_id":"314","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"315":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_adobeLinkInternalFilters","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"315"},"316":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"316","labels":"","name":"legacy_adobeMarketingCloudVisitorID","imported":"","type":"js","description":"","title":""},"317":{"imported":"","description":"","title":"","type":"js","_id":"317","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_adobeProductString"},"318":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"318","name":"legacy_adobeProductStringLYP","labels":"","imported":"","type":"js","title":"","description":""},"319":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"319","name":"legacy_adobeReportSuite","labels":""},"320":{"imported":"","description":"","title":"","type":"js","_id":"320","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_agentID"},"321":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"321","name":"legacy_airportExtras","labels":"","imported":"","type":"js","title":"","description":""},"322":{"_id":"322","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_alternativeFlightOptions","imported":"","description":"","title":"","type":"js"},"323":{"name":"legacy_appVisitor","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"323","type":"js","title":"","description":"","imported":""},"324":{"labels":"","name":"legacy_arrivalAirportCode","_id":"324","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"325":{"imported":"","title":"","description":"","type":"js","_id":"325","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_arrivalAirportName","labels":""},"326":{"title":"","description":"","type":"js","imported":"","name":"legacy_boardBasisCode","labels":"","_id":"326","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"327":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"327","name":"legacy_boardBasisName","labels":"","imported":"","type":"js","title":"","description":""},"328":{"labels":"","name":"legacy_bookingDate_YYYY_MM_DD","_id":"328","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"329":{"imported":"","title":"","description":"","type":"js","_id":"329","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_bookingOrMmbIncentiveCode","labels":""},"330":{"_id":"330","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_bookingReference","imported":"","description":"","title":"","type":"js"},"331":{"labels":"","name":"legacy_bookingReferenceMoney4Travel","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"331","type":"js","description":"","title":"","imported":""},"332":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_brand","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"332"},"333":{"type":"js","title":"","description":"","imported":"","name":"legacy_campaign","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"333"},"334":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"334","name":"legacy_campaignSource","labels":""},"335":{"imported":"","title":"","description":"","type":"js","_id":"335","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_cancelReason","labels":""},"336":{"name":"legacy_carrierCode","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"336","type":"js","title":"","description":"","imported":""},"337":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"337","name":"legacy_carrierInbound","labels":"","imported":"","type":"js","title":"","description":""},"338":{"labels":"","name":"legacy_carrierOutbound","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"338","type":"js","description":"","title":"","imported":""},"339":{"labels":"","name":"legacy_Channel","_id":"339","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"340":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"340","labels":"","name":"legacy_childAges","imported":"","type":"js","description":"","title":""},"341":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_commercialSortPriority","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"341"},"342":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"342","labels":"","name":"legacy_commercialValueScore"},"343":{"labels":"","name":"legacy_commercialValueScoreType","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"343","type":"js","description":"","title":"","imported":""},"344":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"344","name":"legacy_componentClicked","labels":""},"345":{"title":"","description":"","type":"js","imported":"","name":"legacy_content_id","labels":"","_id":"345","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"346":{"_id":"346","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_continentCode","imported":"","description":"","title":"","type":"js"},"347":{"name":"legacy_continentName","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"347","type":"js","title":"","description":"","imported":""},"348":{"name":"legacy_cookieLength","labels":"","_id":"348","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"349":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"349","name":"legacy_countryCode","labels":""},"350":{"name":"legacy_countryName","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"350","type":"js","title":"","description":"","imported":""},"351":{"labels":"","name":"legacy_coupon","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"351","type":"js","description":"","title":"","imported":""},"352":{"labels":"","name":"legacy_creditNoteBooking","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"352","type":"js","description":"","title":"","imported":""},"353":{"labels":"","name":"legacy_creditNoteCode","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"353","type":"js","description":"","title":"","imported":""},"354":{"imported":"","title":"","description":"","type":"js","_id":"354","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_creditNoteDiscount","labels":""},"355":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_creditNoteOriginalBookingID","_id":"355","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"356":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_creditNoteRefundValue","_id":"356","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"357":{"labels":"","name":"legacy_creditNoteTotalValue","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"357","type":"js","description":"","title":"","imported":""},"358":{"imported":"","title":"","description":"","type":"js","_id":"358","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_cruiseCabinType","labels":""},"359":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_cruiseEpicCode","_id":"359","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"360":{"type":"js","title":"","description":"","imported":"","name":"legacy_cruiseHotel","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"360"},"361":{"name":"legacy_cruiseShip","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"361","type":"js","title":"","description":"","imported":""},"362":{"_id":"362","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_cruiseStay","imported":"","description":"","title":"","type":"js"},"363":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_cruiseStayDuration","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"363"},"364":{"labels":"","name":"legacy_cruiseStayRoomType","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"364","type":"js","description":"","title":"","imported":""},"365":{"labels":"","name":"legacy_cruiseType","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"365","type":"js","description":"","title":"","imported":""},"366":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"366","labels":"","name":"legacy_Crystal_Affiliate_Order_Detail","imported":"","type":"js","description":"","title":""},"367":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_Crystal_BkngStep","_id":"367","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"368":{"_id":"368","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_Crystal_bookingDate","labels":"","imported":"","title":"","description":"","type":"js"},"369":{"type":"js","title":"","description":"","imported":"","name":"legacy_Crystal_bookingPace","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"369"},"370":{"name":"legacy_Crystal_BookingRef","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"370","type":"js","title":"","description":"","imported":""},"371":{"_id":"371","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_Crystal_boughtAdults","labels":"","imported":"","title":"","description":"","type":"js"},"372":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"372","name":"legacy_Crystal_boughtCategory4","labels":"","imported":"","type":"js","title":"","description":""},"373":{"type":"js","title":"","description":"","imported":"","name":"legacy_Crystal_boughtChildren","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"373"},"374":{"_id":"374","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_Crystal_boughtCountry","labels":"","imported":"","title":"","description":"","type":"js"},"375":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_Crystal_boughtPax","_id":"375","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"376":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_Crystal_boughtPeriod","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"376"},"377":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"377","name":"legacy_Crystal_boughtPrice","labels":"","imported":"","type":"js","title":"","description":""},"378":{"imported":"","title":"","description":"","type":"js","_id":"378","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_Crystal_boughtResort","labels":""},"379":{"labels":"","name":"legacy_Crystal_cjevent","_id":"379","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"380":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"380","name":"legacy_Crystal_currentArrivalAirport","labels":"","imported":"","type":"js","title":"","description":""},"381":{"title":"","description":"","type":"js","imported":"","name":"legacy_Crystal_currentCountry","labels":"","_id":"381","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"382":{"name":"legacy_Crystal_currentDepartureAirportArray","labels":"","_id":"382","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"383":{"title":"","description":"","type":"js","imported":"","name":"legacy_Crystal_currentDepartureDate","labels":"","_id":"383","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"384":{"labels":"","name":"legacy_Crystal_currentDuration","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"384","type":"js","description":"","title":"","imported":""},"385":{"_id":"385","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_Crystal_currentHotelId","imported":"","description":"","title":"","type":"js"},"386":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"386","name":"legacy_Crystal_currentPartyType","labels":"","imported":"","type":"js","title":"","description":""},"387":{"imported":"","title":"","description":"","type":"js","_id":"387","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_Crystal_currentPax","labels":""},"388":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"388","name":"legacy_Crystal_currentPax_inc_infants","labels":"","imported":"","type":"js","title":"","description":""},"389":{"labels":"","name":"legacy_Crystal_currentResort","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"389","type":"js","description":"","title":"","imported":""},"390":{"labels":"","name":"legacy_Crystal_currentRoute","_id":"390","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"391":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"391","labels":"","name":"legacy_Crystal_departureDate","imported":"","type":"js","description":"","title":""},"392":{"labels":"","name":"legacy_Crystal_DL_Ready","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"392","type":"js","description":"","title":"","imported":""},"393":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"393","name":"legacy_Crystal_Hit_Timestamp","labels":""},"394":{"name":"legacy_Crystal_Internal_Campaign","labels":"","_id":"394","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"395":{"name":"legacy_Crystal_NumberOfRooms","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"395","type":"js","title":"","description":"","imported":""},"396":{"_id":"396","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_Crystal_pageName","imported":"","description":"","title":"","type":"js"},"397":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"397","name":"legacy_Crystal_productBrand","labels":"","imported":"","type":"js","title":"","description":""},"398":{"labels":"","name":"legacy_Crystal_productCategory","_id":"398","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"399":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_Crystal_productCategory1","_id":"399","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"400":{"title":"","description":"","type":"js","imported":"","name":"legacy_Crystal_productCategory2","labels":"","_id":"400","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"401":{"_id":"401","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_Crystal_productCategory3_Resort","labels":"","imported":"","title":"","description":"","type":"js"},"402":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"402","name":"legacy_Crystal_productCategory4","labels":""},"403":{"labels":"","name":"legacy_Crystal_productID","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"403","type":"js","description":"","title":"","imported":""},"404":{"name":"legacy_Crystal_productID_Facebook","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"404","type":"js","title":"","description":"","imported":""},"405":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"405","labels":"","name":"legacy_Crystal_productName","imported":"","type":"js","description":"","title":""},"406":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"406","labels":"","name":"legacy_Crystal_productPax"},"407":{"labels":"","name":"legacy_Crystal_productPrice","_id":"407","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"408":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"408","labels":"","name":"legacy_Crystal_sectionName"},"409":{"type":"js","title":"","description":"","imported":"","name":"legacy_Crystal_Selected_Flight_Position","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"409"},"410":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_Crystal_Server","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"410"},"411":{"imported":"","title":"","description":"","type":"js","_id":"411","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_Crystal_transactionID","labels":""},"412":{"_id":"412","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_Crystal_TravelType","imported":"","description":"","title":"","type":"js"},"413":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"413","labels":"","name":"legacy_Crystal_Ski_Affiliate_Cookie"},"414":{"name":"legacy_Crystal_Ski_cjCookie","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"414","type":"js","title":"","description":"","imported":""},"415":{"imported":"","title":"","description":"","type":"js","_id":"415","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_Crystal_Ski_Flashtalking_Departure_Date","labels":""},"416":{"_id":"416","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_Crystal_Ski_Products_Array","imported":"","description":"","title":"","type":"js"},"417":{"_id":"417","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_Crystal_Ski_Products_Array_Search","imported":"","description":"","title":"","type":"js"},"418":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"418","labels":"","name":"legacy_Currency","imported":"","type":"js","description":"","title":""},"419":{"_id":"419","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_currencyCode","imported":"","description":"","title":"","type":"js"},"420":{"title":"","description":"","type":"js","imported":"","name":"legacy_customerAccountNumberOfBookings","labels":"","_id":"420","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"421":{"_id":"421","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_customerID","imported":"","description":"","title":"","type":"js"},"422":{"labels":"","name":"legacy_date","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"422","type":"js","description":"","title":"","imported":""},"423":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_daysToDeparture","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"423"},"424":{"name":"legacy_decibelID","labels":"","_id":"424","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"425":{"type":"js","title":"","description":"","imported":"","name":"legacy_departureAirportCode","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"425"},"426":{"imported":"","title":"","description":"","type":"js","_id":"426","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_departureDate","labels":""},"427":{"_id":"427","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_departureDate_YYYYMMDD","imported":"","description":"","title":"","type":"js"},"428":{"labels":"","name":"legacy_departureDateDifference","_id":"428","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"429":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"429","labels":"","name":"legacy_depositOptionsAvailable"},"430":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_depositOptionSelected","_id":"430","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"431":{"imported":"","description":"","title":"","type":"js","_id":"431","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_depositValueBookflow"},"432":{"name":"legacy_destinationBrowse","labels":"","_id":"432","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"433":{"name":"legacy_destinationCode","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"433","type":"js","title":"","description":"","imported":""},"434":{"imported":"","description":"","title":"","type":"js","_id":"434","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_destinationFC"},"435":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"435","name":"legacy_destinationIMG","labels":"","imported":"","type":"js","title":"","description":""},"436":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"436","name":"legacy_destinationName","labels":"","imported":"","type":"js","title":"","description":""},"437":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"437","name":"legacy_destinationPrice","labels":""},"438":{"name":"legacy_destinationPush","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"438","type":"js","title":"","description":"","imported":""},"439":{"imported":"","title":"","description":"","type":"js","_id":"439","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_device","labels":""},"440":{"_id":"440","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_directDebit","imported":"","description":"","title":"","type":"js"},"441":{"_id":"441","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_directOrIndirectFlight","imported":"","description":"","title":"","type":"js"},"442":{"labels":"","name":"legacy_dreamlinerFlight","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"442","type":"js","description":"","title":"","imported":""},"443":{"type":"js","title":"","description":"","imported":"","name":"legacy_duration","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"443"},"444":{"imported":"","description":"","title":"","type":"js","_id":"444","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_durationCode"},"445":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"445","name":"legacy_durationSearched","labels":"","imported":"","type":"js","title":"","description":""},"446":{"imported":"","title":"","description":"","type":"js","_id":"446","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_emailHash","labels":""},"447":{"title":"","description":"","type":"js","imported":"","name":"legacy_epicCode","labels":"","_id":"447","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"448":{"name":"legacy_facebookPixelFire","labels":"","_id":"448","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"449":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"449","name":"legacy_filterAccommodationType","labels":""},"450":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_filterBackTime","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"450"},"451":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"451","labels":"","name":"legacy_filterBestFor","imported":"","type":"js","description":"","title":""},"452":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"452","name":"legacy_filterBoard","labels":"","imported":"","type":"js","title":"","description":""},"453":{"title":"","description":"","type":"js","imported":"","name":"legacy_filterBudget","labels":"","_id":"453","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"454":{"_id":"454","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_filterCruiseCabin","imported":"","description":"","title":"","type":"js"},"455":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"455","labels":"","name":"legacy_filterCruiseDestination","imported":"","type":"js","description":"","title":""},"456":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"456","name":"legacy_filterCruiseShip","labels":""},"457":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"457","name":"legacy_filterCruiseStayDestination","labels":""},"458":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"458","name":"legacy_filterDepartureAirport","labels":""},"459":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"459","name":"legacy_filterDestination","labels":"","imported":"","type":"js","title":"","description":""},"460":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_filterFeatures","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"460"},"461":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"461","name":"legacy_filterFreeChildPlaces","labels":"","imported":"","type":"js","title":"","description":""},"462":{"_id":"462","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_filterHolidayType","labels":"","imported":"","title":"","description":"","type":"js"},"463":{"title":"","description":"","type":"js","imported":"","name":"legacy_filterOutTime","labels":"","_id":"463","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"464":{"imported":"","description":"","title":"","type":"js","_id":"464","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_filterSingleAccommodationEndState"},"465":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"465","name":"legacy_filterSortBy","labels":""},"466":{"imported":"","title":"","description":"","type":"js","_id":"466","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_filterTourOperator","labels":""},"467":{"labels":"","name":"legacy_filterTripAdvisorRating","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"467","type":"js","description":"","title":"","imported":""},"468":{"title":"","description":"","type":"js","imported":"","name":"legacy_filterTuiRating","labels":"","_id":"468","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"469":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"469","name":"legacy_firstPartyAncillaries","labels":""},"470":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_flexibleDates","_id":"470","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"471":{"_id":"471","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_flightExtrasBookingReference","imported":"","description":"","title":"","type":"js"},"472":{"imported":"","title":"","description":"","type":"js","_id":"472","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_flightExtrasCheckedInState","labels":""},"473":{"name":"legacy_flightExtrasInboundDays","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"473","type":"js","title":"","description":"","imported":""},"474":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"474","labels":"","name":"legacy_flightInventory"},"475":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"475","labels":"","name":"legacy_flightOnlyDeparturePeriod","imported":"","type":"js","description":"","title":""},"476":{"imported":"","title":"","description":"","type":"js","_id":"476","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_flightType","labels":""},"477":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"477","labels":"","name":"legacy_freeChildPlacePartySize","imported":"","type":"js","description":"","title":""},"478":{"name":"legacy_freeChildPlaces","labels":"","_id":"478","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"479":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"479","labels":"","name":"legacy_geoCountry","imported":"","type":"js","description":"","title":""},"480":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_geoLevel","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"480"},"481":{"name":"legacy_gmpCustomerID","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"481","type":"js","title":"","description":"","imported":""},"482":{"title":"","description":"","type":"js","imported":"","name":"legacy_Google_Analytics_New_Property_ID","labels":"","_id":"482","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"483":{"labels":"","name":"legacy_Google_Analytics_Property_ID","_id":"483","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"484":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"484","name":"legacy_googleAnalyticsClientID","labels":"","imported":"","type":"js","title":"","description":""},"485":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"485","name":"legacy_googleAnalyticsPropertyID","labels":"","imported":"","type":"js","title":"","description":""},"486":{"_id":"486","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_handLuggageOnly","labels":"","imported":"","title":"","description":"","type":"js"},"487":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"487","name":"legacy_haulTypeSearch","labels":""},"488":{"_id":"488","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_hostname","labels":"","imported":"","title":"","description":"","type":"js"},"489":{"labels":"","name":"legacy_hotelName","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"489","type":"js","description":"","title":"","imported":""},"490":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"490","labels":"","name":"legacy_irClickID","imported":"","type":"js","description":"","title":""},"491":{"labels":"","name":"legacy_isAccommodationOnly","_id":"491","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"492":{"type":"js","title":"","description":"","imported":"","name":"legacy_isChoiceSearch","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"492"},"493":{"labels":"","name":"legacy_isCreditNoteBooking","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"493","type":"js","description":"","title":"","imported":""},"494":{"_id":"494","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_isCreditNoteIncentiveEligible","labels":"","imported":"","title":"","description":"","type":"js"},"495":{"imported":"","description":"","title":"","type":"js","_id":"495","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_isCRM"},"496":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_isLowDeposit","_id":"496","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"497":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_isPush","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"497"},"498":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"498","labels":"","name":"legacy_isSearch"},"499":{"type":"js","title":"","description":"","imported":"","name":"legacy_isSEO","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"499"},"500":{"imported":"","description":"","title":"","type":"js","_id":"500","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_limitedAvailabilityBeds"},"501":{"name":"legacy_limitedAvailabilityCabins","labels":"","_id":"501","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"502":{"name":"legacy_limitedAvailabilitySeats","labels":"","_id":"502","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"503":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"503","labels":"","name":"legacy_Lock_Your_Price_Booking_Check","imported":"","type":"js","description":"","title":""},"504":{"name":"legacy_Lock_Your_Price_Available","labels":"","_id":"504","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"505":{"imported":"","title":"","description":"","type":"js","_id":"505","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_Lock_Your_Price_Confirmed_Booking","labels":""},"506":{"imported":"","description":"","title":"","type":"js","_id":"506","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_Lock_Your_Price_Revenue"},"507":{"name":"legacy_Lock_Your_Price_Unconfirmed_Booking","labels":"","_id":"507","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"508":{"name":"legacy_Lock_Your_Price_Unconfirmed_Booking_Revenue","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"508","type":"js","title":"","description":"","imported":""},"509":{"type":"js","title":"","description":"","imported":"","name":"legacy_loginDetail","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"509"},"510":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_minimumPaymentAmount","_id":"510","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"511":{"labels":"","name":"legacy_mmbAmendmentDate","_id":"511","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"512":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"512","labels":"","name":"legacy_mmbAmendmentDetail","imported":"","type":"js","description":"","title":""},"513":{"type":"js","title":"","description":"","imported":"","name":"legacy_mmbAmendmentType","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"513"},"514":{"labels":"","name":"legacy_mmbAmountOutstanding","_id":"514","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"515":{"title":"","description":"","type":"js","imported":"","name":"legacy_mmbAncillaries","labels":"","_id":"515","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"516":{"labels":"","name":"legacy_mmbBookingAmount","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"516","type":"js","description":"","title":"","imported":""},"517":{"type":"js","title":"","description":"","imported":"","name":"legacy_mmbBookingType","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"517"},"518":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"518","labels":"","name":"legacy_mmbExistingBookingDepartureDate"},"519":{"_id":"519","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_mmbPaymentType","labels":"","imported":"","title":"","description":"","type":"js"},"520":{"title":"","description":"","type":"js","imported":"","name":"legacy_mmbTransactionValue","labels":"","_id":"520","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"521":{"_id":"521","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_month","imported":"","description":"","title":"","type":"js"},"522":{"_id":"522","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_monthYear","imported":"","description":"","title":"","type":"js"},"523":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_navigationTracking","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"523"},"524":{"title":"","description":"","type":"js","imported":"","name":"legacy_newDataLayer","labels":"","_id":"524","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"525":{"title":"","description":"","type":"js","imported":"","name":"legacy_newSEOdata","labels":"","_id":"525","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"526":{"type":"js","title":"","description":"","imported":"","name":"legacy_noOfRooms","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"526"},"527":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"527","name":"legacy_numberOfAdults","labels":"","imported":"","type":"js","title":"","description":""},"528":{"name":"legacy_numberOfChildren","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"528","type":"js","title":"","description":"","imported":""},"529":{"name":"legacy_numberOfInfants","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"529","type":"js","title":"","description":"","imported":""},"530":{"imported":"","title":"","description":"","type":"js","_id":"530","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_numberOfPax","labels":""},"531":{"name":"legacy_numberOfResults","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"531","type":"js","title":"","description":"","imported":""},"532":{"imported":"","title":"","description":"","type":"js","_id":"532","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_onlineDiscount","labels":""},"533":{"name":"legacy_pageID","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"533","type":"js","title":"","description":"","imported":""},"534":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"534","labels":"","name":"legacy_pageLoadTimeCount","imported":"","type":"js","description":"","title":""},"535":{"_id":"535","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_pageLoadTimeFullyLoaded","labels":"","imported":"","title":"","description":"","type":"js"},"536":{"type":"js","title":"","description":"","imported":"","name":"legacy_pageLoadTimeInteractive","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"536"},"537":{"imported":"","title":"","description":"","type":"js","_id":"537","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_pageNameTemporary","labels":""},"538":{"title":"","description":"","type":"js","imported":"","name":"legacy_pagePath","labels":"","_id":"538","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"539":{"labels":"","name":"legacy_pageSubCategory","_id":"539","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"description":"","title":"","type":"js","imported":""},"540":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"540","labels":"","name":"legacy_pageURL"},"541":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"541","labels":"","name":"legacy_paymentType","imported":"","type":"js","description":"","title":""},"542":{"name":"legacy_ppcVariant","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"542","type":"js","title":"","description":"","imported":""},"543":{"_id":"543","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_preferredSearchAvailable","labels":"","imported":"","title":"","description":"","type":"js"},"544":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"544","name":"legacy_price","labels":""},"545":{"imported":"","title":"","description":"","type":"js","_id":"545","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_priceVariationAlert","labels":""},"546":{"labels":"","name":"legacy_Privacy_Analytics_Experience","_id":"546","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"547":{"name":"legacy_Privacy_Experience","labels":"","_id":"547","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"548":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"548","labels":"","name":"legacy_Privacy_Opted_out_Categories"},"549":{"labels":"","name":"legacy_Privacy_Opted_out_Categories_Page_Load","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"549","type":"js","description":"","title":"","imported":""},"550":{"name":"legacy_productCollectionCode","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"550","type":"js","title":"","description":"","imported":""},"551":{"imported":"","title":"","description":"","type":"js","_id":"551","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_productCollectionName","labels":""},"552":{"labels":"","name":"legacy_productID","_id":"552","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"553":{"labels":"","name":"legacy_productList","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"553","type":"js","description":"","title":"","imported":""},"554":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"554","name":"legacy_productType","labels":"","imported":"","type":"js","title":"","description":""},"555":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"555","labels":"","name":"legacy_productTypeMoney4Travel"},"556":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"556","labels":"","name":"legacy_programmeChangeFreeAmends","imported":"","type":"js","description":"","title":""},"557":{"_id":"557","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_programmeChangeIncentiveCode","imported":"","description":"","title":"","type":"js"},"558":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"558","name":"legacy_programmeChangeMemoNotes","labels":"","imported":"","type":"js","title":"","description":""},"559":{"labels":"","name":"legacy_promoCodeName","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"559","type":"js","description":"","title":"","imported":""},"560":{"name":"legacy_promoCodeValue","labels":"","_id":"560","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"561":{"_id":"561","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_protocol","imported":"","description":"","title":"","type":"js"},"562":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"562","labels":"","name":"legacy_purchaseID"},"563":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_pushData","_id":"563","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"564":{"name":"legacy_queryString","labels":"","_id":"564","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"565":{"type":"js","title":"","description":"","imported":"","name":"legacy_queryStringParamCmid","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"565"},"566":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"566","name":"legacy_queryStringParamGclid","labels":""},"567":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"567","name":"legacy_queryStringParamIkid","labels":"","imported":"","type":"js","title":"","description":""},"568":{"type":"js","title":"","description":"","imported":"","name":"legacy_queryStringParamIto","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"568"},"569":{"labels":"","name":"legacy_queryStringParamQ","_id":"569","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"570":{"name":"legacy_queryStringParamVlid","labels":"","_id":"570","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"571":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_regionCode","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"571"},"572":{"imported":"","title":"","description":"","type":"js","_id":"572","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"legacy_regionName","labels":""},"573":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"573","labels":"","name":"legacy_resortCode"},"574":{"_id":"574","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_resortName","imported":"","description":"","title":"","type":"js"},"575":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"575","labels":"","name":"legacy_retailVisitorIDValueChange"},"576":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_returnDate","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"576"},"577":{"name":"legacy_revenueMoney4Travel","labels":"","_id":"577","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"578":{"title":"","description":"","type":"js","imported":"","name":"legacy_roomAllocation","labels":"","_id":"578","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"579":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_roomComposition","_id":"579","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"580":{"name":"legacy_roomOrCabinType","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"580","type":"js","title":"","description":"","imported":""},"581":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"581","name":"legacy_screenSizeIncludingIPhones","labels":""},"582":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_searchedDepartureDate","_id":"582","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"583":{"imported":"","title":"","description":"","type":"js","_id":"583","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_searchedDestinationIDs","labels":""},"584":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"584","name":"legacy_searchedDestinationNames","labels":"","imported":"","type":"js","title":"","description":""},"585":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"585","labels":"","name":"legacy_searchResultsFinalPosition","imported":"","type":"js","description":"","title":""},"586":{"_id":"586","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_searchType","imported":"","description":"","title":"","type":"js"},"587":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"587","name":"legacy_season","labels":""},"588":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_sellingCode","_id":"588","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"589":{"type":"js","title":"","description":"","imported":"","name":"legacy_sessionID","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"589"},"590":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"590","name":"legacy_sessionState","labels":"","imported":"","type":"js","title":"","description":""},"591":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"591","name":"legacy_shortlist","labels":"","imported":"","type":"js","title":"","description":""},"592":{"imported":"","description":"","title":"","type":"js","_id":"592","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_siteSection"},"593":{"type":"js","title":"","description":"","imported":"","name":"legacy_siteSubSection","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"593"},"594":{"imported":"","title":"","description":"","type":"js","_id":"594","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_sourceBookingReference","labels":""},"595":{"name":"legacy_sourceBookingSystem","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"595","type":"js","title":"","description":"","imported":""},"596":{"labels":"","name":"legacy_STOCKTON_CD_BOARD","_id":"596","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"597":{"_id":"597","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_STOCKTON_CD_Cabin","imported":"","description":"","title":"","type":"js"},"598":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"598","labels":"","name":"legacy_STOCKTON_DD_Affiliation"},"599":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"599","labels":"","name":"legacy_STOCKTON_DD_BoardFilter","imported":"","type":"js","description":"","title":""},"600":{"title":"","description":"","type":"js","imported":"","name":"legacy_STOCKTON_DD_BrandName","labels":"","_id":"600","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"601":{"imported":"","description":"","title":"","type":"js","_id":"601","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"legacy_STOCKTON_DD_BudgetFilter"},"602":{"labels":"","name":"legacy_STOCKTON_DD_CabinFilter","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"602","type":"js","description":"","title":"","imported":""},"603":{"_id":"603","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_STOCKTON_DD_Category","labels":"","imported":"","title":"","description":"","type":"js"},"604":{"labels":"","name":"legacy_STOCKTON_DD_Confirmation_Itinerary_Name","_id":"604","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"605":{"type":"js","title":"","description":"","imported":"","name":"legacy_STOCKTON_DD_CRType","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"605"},"606":{"_id":"606","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_STOCKTON_DD_Cruise_Details_Itinerary_Name","imported":"","description":"","title":"","type":"js"},"607":{"title":"","description":"","type":"js","imported":"","name":"legacy_STOCKTON_DD_Cruise_Options_Itinerary_Name","labels":"","_id":"607","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"608":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"608","labels":"","name":"legacy_STOCKTON_DD_CruiseId","imported":"","type":"js","description":"","title":""},"609":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"609","name":"legacy_STOCKTON_DD_CRWhereTo","labels":""},"610":{"_id":"610","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_STOCKTON_DD_DaysUntilDeparture","imported":"","description":"","title":"","type":"js"},"611":{"name":"legacy_STOCKTON_DD_DepartureAirport","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"611","type":"js","title":"","description":"","imported":""},"612":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_STOCKTON_DD_DepartureAirportFilter","_id":"612","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"613":{"_id":"613","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"legacy_STOCKTON_DD_DepartureDate","labels":"","imported":"","title":"","description":"","type":"js"},"614":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_STOCKTON_DD_DestinationFilter","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"614"},"615":{"name":"legacy_STOCKTON_DD_Discount","labels":"","_id":"615","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"616":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"616","name":"legacy_STOCKTON_DD_Duration","labels":""},"617":{"_id":"617","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"legacy_STOCKTON_DD_Duration_New","imported":"","description":"","title":"","type":"js"},"618":{"name":"legacy_STOCKTON_DD_Hotel","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"618","type":"js","title":"","description":"","imported":""},"619":{"imported":"","title":"","description":"","type":"js","_id":"619","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_STOCKTON_DD_Party","labels":""},"620":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"620","name":"legacy_Stockton_DD_Passenger_Details_Itinerary_Name","labels":"","imported":"","type":"js","title":"","description":""},"621":{"imported":"","title":"","description":"","type":"js","_id":"621","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_STOCKTON_DD_PaymentType","labels":""},"622":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_STOCKTON_DD_PromoCode","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"622"},"623":{"_id":"623","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"legacy_STOCKTON_DD_ShipFilter","labels":"","imported":"","title":"","description":"","type":"js"},"624":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_STOCKTON_DD_ShipName","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"624"},"625":{"labels":"","name":"legacy_STOCKTON_DD_Sum","_id":"625","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"626":{"imported":"","description":"","title":"","type":"js","_id":"626","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_STOCKTON_DD_TransactionId"},"627":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"627","labels":"","name":"legacy_STOCKTON_DD_Variant"},"628":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"628","name":"legacy_thirdPartyAncillaries","labels":"","imported":"","type":"js","title":"","description":""},"629":{"labels":"","name":"legacy_thirdPartyBeds","_id":"629","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"630":{"labels":"","name":"legacy_thirdPartyBedsSupplier","_id":"630","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"631":{"_id":"631","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"legacy_thirdPartyFlightDetail","imported":"","description":"","title":"","type":"js"},"632":{"labels":"","name":"legacy_top5SearchResults","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"632","type":"js","description":"","title":"","imported":""},"633":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"633","name":"legacy_tradingCycle","labels":""},"634":{"name":"legacy_tripAdvisorEventID","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"634","type":"js","title":"","description":"","imported":""},"635":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"635","name":"legacy_tripAdvisorRating","labels":""},"636":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"636","name":"legacy_tripType","labels":"","imported":"","type":"js","title":"","description":""},"637":{"name":"legacy_trv_reference","labels":"","_id":"637","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"638":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"638","labels":"","name":"legacy_tuiProductRating","imported":"","type":"js","description":"","title":""},"639":{"name":"legacy_uniqodoBookingReference","labels":"","_id":"639","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"640":{"type":"js","description":"","title":"","imported":"","labels":"","name":"legacy_uniqodoPrice","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"640"},"641":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_uniqodoPromoCodeName","_id":"641","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"642":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"642","labels":"","name":"legacy_userAgent"},"643":{"labels":"","name":"auth","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"643","type":"qp","description":"","title":"","imported":""},"644":{"labels":"","name":"cmid","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"644","type":"qp","description":"","title":"","imported":""},"645":{"name":"b","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"645","type":"qp","title":"","description":"","imported":""},"646":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"646","name":"cjevent","labels":"","imported":"","type":"qp","title":"","description":""},"647":{"name":"irclickid","labels":"","_id":"647","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"qp","imported":""},"648":{"title":"","description":"For Google Analytics, migrated from Ensighten","type":"js","imported":"","name":"legacy_customerIDClean","labels":"","_id":"648","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"649":{"name":"legacy_bookingReferenceSplit","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"649","type":"js","title":"","description":"","imported":""},"650":{"imported":"","type":"qp","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"650","labels":"","name":"gaid"},"651":{"imported":"","description":"created with an extension, just a combination of the old and the new as a comma-delimited string","title":"","type":"js","_id":"651","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"legacy_Google_Analytics_All_Property_IDs"},"652":{"imported":"","type":"js","description":"Set by extension, should be mostly temporary, but IS a useful way to recycle conditions","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"652","labels":"","name":"loadRulesTriggered"},"653":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"653","name":"gaEventCategory","labels":"","imported":"","type":"js","title":"","description":""},"654":{"labels":"","name":"gaEventAction","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"654","type":"js","description":"","title":"","imported":""},"655":{"labels":"","name":"product_id","_id":"655","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"description":"Contains product ID(s) - multiple values should be comma-separated.","title":"Product ID","type":"js","imported":""},"656":{"imported":"","type":"js","description":"Contains product SKU(s) - multiple values should be comma-separated.","title":"Product SKU","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"656","labels":"","name":"product_sku"},"657":{"title":"Product Name","description":"Contains product name(s) - multiple values should be comma-separated.","type":"js","imported":"","name":"product_name","labels":"","_id":"657","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"658":{"imported":"","title":"Product Brand","description":"Contains product brand(s) - multiple values should be comma-separated.","type":"js","_id":"658","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"product_brand","labels":""},"659":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"659","name":"product_category","labels":"","imported":"","type":"js","title":"Product Category","description":"Contains product category(s) - multiple values should be comma-separated."},"660":{"imported":"","type":"js","title":"Product Subcategory","description":"Contains product subcategory(s) - multiple values should be comma-separated.","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"660","name":"product_subcategory","labels":""},"661":{"_id":"661","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"product_unit_price","imported":"","description":"Contains product unit price(s) - multiple values should be comma-separated.","title":"Product Unit Price","type":"js"},"662":{"imported":"","type":"js","title":"Product List Price","description":"Contains product list price(s) before discount - multiple values should be comma-separated.","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"662","name":"product_list_price","labels":""},"663":{"imported":"","type":"js","description":"Contains product quantity(s) - multiple values should be comma-separated.","title":"Product Quantity","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"663","labels":"","name":"product_quantity"},"664":{"imported":"","type":"js","description":"Contains product discount(s) - multiple values should be comma-separated.","title":"Product Discount","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"664","labels":"","name":"product_discount"},"665":{"name":"order_id","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"665","type":"js","title":"Order ID","description":"Contains the order or transaction ID.","imported":""},"666":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"666","name":"order_total","labels":"","imported":"","type":"js","title":"Order Total","description":"Contains the order total value."},"667":{"imported":"","description":"Contains the order subtotal (not containing taxes &amp; shipping).","title":"Order Subtotal","type":"js","_id":"667","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"order_subtotal"},"668":{"labels":"","name":"order_payment_type","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"668","type":"js","description":"Contains the order payment type.","title":"Order Payment Type","imported":""},"669":{"labels":"","name":"order_discount","_id":"669","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"Contains the order discount (if any).","title":"Order Discount","type":"js","imported":""},"670":{"imported":"","title":"Order Shipping","description":"Contains the order shipping value.","type":"js","_id":"670","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"order_shipping","labels":""},"671":{"_id":"671","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"order_tax","labels":"","imported":"","title":"Order Tax","description":"Contains the order tax amount.","type":"js"},"672":{"type":"js","title":"Order Currency","description":"Contains the currency associated with the transaction, e.g. 'USD'.","imported":"","name":"order_currency","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"672"},"673":{"_id":"673","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"order_coupon_code","labels":"","imported":"","title":"Order Coupon Code","description":"Contains the order coupon code.","type":"js"},"674":{"imported":"","type":"js","title":"Order Coupon Discount","description":"Contains the order coupon discount.","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"674","name":"order_coupon_discount","labels":""},"675":{"labels":"","name":"order_store","_id":"675","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"Contains identification information for a store.","title":"Order Store","type":"js","imported":""},"676":{"imported":"","type":"js","title":"Order Type","description":"Contains type of order/cart.","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"676","name":"order_type","labels":""},"677":{"type":"js","title":"Customer ID","description":"Contains the customer ID.","imported":"","name":"customer_id","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"677"},"678":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"678","labels":"","name":"customer_city","imported":"","type":"js","description":"Contains the customer city.","title":"Customer City"},"679":{"labels":"","name":"customer_state","_id":"679","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"Contains the customer state.","title":"Customer State","type":"js","imported":""},"680":{"description":"Contains the customer zip/postal code.","title":"Customer Zip Code","type":"js","imported":"","labels":"","name":"customer_zip","_id":"680","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"681":{"description":"Contains the customer country.","title":"Customer Country","type":"js","imported":"","labels":"","name":"customer_country","_id":"681","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"682":{"_id":"682","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"customer_email","labels":"","imported":"","title":"Customer Email","description":"Contains the customer email.","type":"js"},"683":{"imported":"","type":"js","description":"Contains the customer type.","title":"Customer Type","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"683","labels":"","name":"customer_type"},"684":{"labels":"","name":"legacy_productList.productID","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"684","type":"js","description":"parsed from the parent object in a JS extension","title":"","imported":""},"685":{"labels":"","name":"legacy_productList.productName","_id":"685","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"description":"","title":"","type":"js","imported":""},"686":{"labels":"","name":"legacy_productList.list","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"686","type":"js","description":"","title":"","imported":""},"687":{"description":"","title":"","type":"js","imported":"","labels":"","name":"legacy_productList.productCollectionName","_id":"687","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"688":{"title":"","description":"","type":"js","imported":"","name":"legacy_productList.position","labels":"","_id":"688","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"689":{"name":"gaEventLabel","labels":"","_id":"689","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"690":{"labels":"","name":"legacy_productList.brand","_id":"690","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"","title":"","type":"js","imported":""},"691":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"691","name":"legacy_productList.price","labels":""},"692":{"_id":"692","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"legacy_productList.quantity","labels":"","imported":"","title":"","description":"","type":"js"},"693":{"title":"","description":"","type":"js","imported":"","name":"legacy_productList.name","labels":"","_id":"693","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"}},"694":{"labels":"","name":"legacy_productList.productType","_id":"694","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"695":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"695","labels":"","name":"legacy_productList.id"},"696":{"name":"legacy_productList.metric1","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"696","type":"js","title":"","description":"","imported":""},"697":{"name":"siteName","labels":"","_id":"697","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"","type":"js","imported":""},"698":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"698","labels":"","name":"fbPixelID"},"699":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"699","name":"fbEvent","labels":"","imported":"","type":"js","title":"","description":""},"700":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"700","labels":"","name":"fbContentType"},"701":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"701","name":"fbEventType","labels":"","imported":"","type":"js","title":"","description":""},"702":{"labels":"","name":"fbContentName","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"702","type":"js","description":"","title":"","imported":""},"703":{"name":"fbCheckinDate","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"703","type":"js","title":"","description":"","imported":""},"704":{"name":"fbValue","labels":"","_id":"704","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"705":{"imported":"","title":"","description":"","type":"js","_id":"705","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"fbNumTravelers","labels":""},"706":{"title":"","description":"","type":"js","imported":"","name":"fbPromoCodeName","labels":"","_id":"706","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"707":{"labels":"","name":"fbPromoCodeValue","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"707","type":"js","description":"","title":"","imported":""},"708":{"name":"fbDestination","labels":"","_id":"708","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"709":{"name":"fbOrigin","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"709","type":"js","title":"","description":"","imported":""},"710":{"imported":"","description":"","title":"","type":"js","_id":"710","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"fbDeparting"},"711":{"imported":"","description":"","title":"","type":"js","_id":"711","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"fbContentIDs"},"712":{"name":"fbDepartingDepartureDate","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"712","type":"js","title":"","description":"","imported":""},"713":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"713","name":"fbOriginAirport","labels":"","imported":"","type":"js","title":"","description":""},"714":{"labels":"","name":"fbReturningDepartureDate","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"714","type":"js","description":"","title":"","imported":""},"715":{"_id":"715","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"fbDestinationAirport","imported":"","description":"","title":"","type":"js"},"716":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"716","name":"fbNumAdults","labels":""},"717":{"labels":"","name":"fbContentCategory","_id":"717","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"718":{"type":"js","title":"","description":"","imported":"","name":"fbNumItems","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"718"},"719":{"imported":"","title":"","description":"","type":"js","_id":"719","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"fbCheckoutDate","labels":""},"720":{"title":"","description":"","type":"js","imported":"","name":"fbNumChildren","labels":"","_id":"720","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"721":{"title":"","description":"","type":"js","imported":"","name":"fbDestinationIDs","labels":"","_id":"721","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"722":{"title":"","description":"","type":"js","imported":"","name":"fbHaulType","labels":"","_id":"722","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"723":{"imported":"","title":"","description":"","type":"js","_id":"723","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"currencyCode","labels":""},"724":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"724","labels":"","name":"utag_main__ss","imported":"","type":"cp","description":"(Cookie) A flag that indicates whether or not a page view is the start of a session. A value of 1 means yes and 0 means no.","title":"(UTAG) is_start_of_session"},"725":{"name":"utag_main__pn","labels":"","_id":"725","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"(UTAG) session_page_view_count","description":"(Cookie) The number of pages viewed during the current session","type":"cp","imported":""},"726":{"_id":"726","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"utag_main__sn","labels":"","imported":"","title":"(UTAG) session_count","description":"(Cookie) The number of sessions for this unique visitor","type":"cp"},"727":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"727","labels":"","name":"utag_main_v_id","imported":"","type":"cp","description":"(Cookie) A unique identifier for each visitor","title":"(UTAG) visitor_id"},"728":{"imported":"","type":"cp","title":"(UTAG) timestamp","description":"(Cookie) The Unix/Epoch time stamp in milliseconds.","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"728","name":"utag_main__st","labels":""},"729":{"labels":"","name":"utag_main_ses_id","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"729","type":"cp","description":"(Cookie) A unique identifier for the session.","title":"(UTAG) session_id","imported":""},"730":{"name":"ut.account","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"730","type":"js","title":"(UTAG) account","description":"The account associated with this utag.js file.","imported":""},"731":{"name":"ut.profile","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"731","type":"js","title":"(UTAG) profile","description":"The profile associated with this utag.js file.","imported":""},"732":{"_id":"732","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"ut.env","labels":"","imported":"","title":"(UTAG) environment","description":"The publish environment associated with this utag.js file.","type":"js"},"733":{"description":"The version number of the utag.js file. This is a combination of the utag.js template version number and the time stamp of its publish.","title":"(UTAG) version","type":"js","imported":"","labels":"","name":"ut.version","_id":"733","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"734":{"_id":"734","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"ut.domain","labels":"","imported":"","title":"(UTAG) domain","description":"The top-level domain of the currently loaded web page.","type":"js"},"735":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"735","name":"brand_and_environment","labels":"","imported":"","type":"js","title":"","description":""},"736":{"type":"js","title":"","description":"","imported":"","name":"uniqodo_script_id","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"736"},"737":{"name":"uniqodo_account_id","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"737","type":"js","title":"","description":"","imported":""},"738":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"738","name":"uniqodo_brand","labels":"","imported":"","type":"js","title":"","description":""},"739":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"739","name":"legacy_flightOnlyDepositPeriod","labels":"","imported":"","type":"js","title":"","description":"Added manually for AA"},"740":{"name":"legacy_commerceValueScore","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"740","type":"js","title":"","description":"","imported":""},"741":{"imported":"","type":"js","title":"","description":"Added manually for AA","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"741","name":"legacy_filterCruiseStayDuration","labels":""},"742":{"name":"adobeChannel","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"742","type":"js","title":"","description":"","imported":""},"743":{"labels":"","name":"adobeCampaign","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"743","type":"js","description":"","title":"","imported":""},"744":{"_id":"744","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"quantcastLabel","labels":"","imported":"","title":"","description":"","type":"js"},"745":{"name":"quantcastAccountId","labels":"","_id":"745","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"746":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"746","labels":"","name":"numberOfPax","imported":"","type":"js","description":"The new one, set by extension","title":""},"747":{"name":"cm_event_name","labels":"18","_id":"747","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"set via Consent Manager code,used for analytics","type":"js","imported":""},"748":{"name":"cm_event_category","labels":"18","_id":"748","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"title":"","description":"set via Consent Manager code,used for analytics","type":"js","imported":""},"749":{"imported":"","description":"set via Consent Manager code,used for analytics","title":"","type":"js","_id":"749","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"18","name":"cm_event_action"},"750":{"imported":"","title":"","description":"set via Consent Manager code,used for analytics","type":"js","_id":"750","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"cm_method","labels":"18"},"751":{"imported":"","type":"js","title":"","description":"set via Consent Manager code,used for analytics","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"751","name":"cm_banner_version","labels":"18"},"752":{"labels":"18","name":"cm_optout_categories","_id":"752","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"description":"set via Consent Manager code,used for analytics","title":"","type":"js","imported":""},"753":{"title":"","description":"Populated in the dataLayer object for events","type":"js","imported":"","name":"event","labels":"","_id":"753","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"754":{"labels":"","name":"productType","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"754","type":"js","description":"","title":"","imported":""},"755":{"name":"cm_banner_was_shown","labels":"","_id":"755","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"title":"","description":"'true' or 'false' (strings) depending on whether consent has previously been given or not.","type":"js","imported":""},"756":{"title":"","description":"","type":"js","imported":"","name":"tealium_event","labels":"","_id":"756","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"757":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"757","name":"legacy_queryStringParamGaid","labels":""},"758":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"758","name":"quantcastCategory","labels":"","imported":"","type":"js","title":"","description":""},"759":{"title":"","description":"","type":"cp","imported":"","name":"tuiblue","labels":"","_id":"759","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"760":{"_id":"760","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"dcAdvertiserId","labels":"","imported":"","title":"","description":"Google Campaign Manager Advertiser ID","type":"js"},"761":{"type":"js","title":"","description":"Google Campaign Manager Activity Group String","imported":"","name":"dcActivityGroup","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"761"},"762":{"description":"Google Campaign Manager Activity String","title":"","type":"js","imported":"","labels":"","name":"dcActivityString","_id":"762","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"763":{"type":"js","title":"","description":"Fire CM floodlight","imported":"","name":"dcFloodlightFire","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"763"},"764":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"764","name":"cloud_iq_id","labels":""},"765":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"765","labels":"","name":"placeholder_pageCategory"},"766":{"labels":"","name":"dcCounterType","_id":"766","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"description":"Google Campaign Manager Counting Method","title":"","type":"js","imported":""},"767":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"767","labels":"","name":"dcSettings","imported":"","type":"js","description":"Google Campaign Manager Config","title":""},"768":{"title":"","description":"","type":"js","imported":"","name":"baynote_code","labels":"","_id":"768","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"769":{"_id":"769","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"baynote_server","imported":"","description":"","title":"","type":"js"},"770":{"imported":"","description":"Google Ads Conversion ID","title":"","type":"js","_id":"770","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"googleAdsConversionId"},"771":{"_id":"771","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"googleAdsConversionLabel","labels":"","imported":"","title":"","description":"Google Ads Conversion Label","type":"js"},"772":{"_id":"772","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"labels":"","name":"braze_api_key","imported":"","description":"","title":"","type":"js"},"773":{"_id":"773","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"bingUETTag","labels":"","imported":"","title":"","description":"","type":"js"},"774":{"labels":"","name":"bingEvent","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"774","type":"js","description":"","title":"","imported":""},"775":{"labels":"","name":"turnID","_id":"775","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"776":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"776","labels":"","name":"uniqodo_booking_type","imported":"","type":"js","description":"","title":""},"777":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"777","name":"turnCID","labels":""},"778":{"type":"js","description":"","title":"","imported":"","labels":"","name":"turnbprice","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"778"},"779":{"_id":"779","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"name":"fbOrderID","labels":"","imported":"","title":"","description":"","type":"js"},"780":{"labels":"","name":"fbCreditNoteBooking","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"780","type":"js","description":"","title":"","imported":""},"781":{"_id":"781","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"fbCreditNoteDiscount","imported":"","description":"","title":"","type":"js"},"782":{"imported":"","type":"js","description":"","title":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"782","labels":"","name":"pageID"},"783":{"type":"js","description":"","title":"","imported":"","labels":"","name":"fbCurrency","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"783"},"784":{"_id":"784","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"pinterestEvent","labels":"","imported":"","title":"","description":"","type":"js"},"785":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"785","name":"adobeEvents","labels":"","imported":"","type":"js","title":"","description":""},"786":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"786","labels":"","name":"sc_events","imported":"","type":"js","description":"","title":""},"787":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"787","name":"linkTrackVars","labels":""},"788":{"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"788","labels":"","name":"linkTrackEvents","imported":"","type":"js","description":"","title":""},"789":{"labels":"","name":"impactActionId","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"789","type":"js","description":"","title":"","imported":""},"790":{"_id":"790","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"labels":"","name":"impactSku","imported":"","description":"","title":"","type":"js"},"791":{"_id":"791","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"impactResortName","labels":"","imported":"","title":"","description":"","type":"js"},"792":{"imported":"","title":"","description":"","type":"js","_id":"792","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"name":"movableInkSubDomain","labels":""},"793":{"_id":"793","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"labels":"","name":"movableInkSku","imported":"","description":"","title":"","type":"js"},"794":{"imported":"","description":"","title":"","type":"js","_id":"794","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"impactConversionTrigger"},"795":{"imported":"","type":"js","title":"","description":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"795","name":"tsmID","labels":""},"796":{"_id":"796","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"name":"tsmRID","labels":"","imported":"","title":"","description":"","type":"js"},"797":{"name":"rid","labels":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"797","type":"qp","title":"","description":"","imported":""},"798":{"imported":"","type":"cp","description":"","title":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"798","labels":"","name":"tsm_rid"},"799":{"_id":"799","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"name":"tsmBoard","labels":"","imported":"","title":"","description":"","type":"js"},"800":{"labels":"","name":"pushengageBaseUrl","_id":"800","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"description":"","title":"","type":"js","imported":""},"801":{"publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"801","labels":"","name":"pushengageEvent","imported":"","type":"js","description":"","title":""},"802":{"type":"js","description":"","title":"","imported":"","labels":"","name":"pushengageCampaignName","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"802"},"803":{"_id":"803","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"labels":"","name":"tripadvisorPixelId","imported":"","description":"","title":"","type":"js"},"804":{"name":"tripadvisorPartner","labels":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"804","type":"js","title":"","description":"","imported":""},"805":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"805","name":"taeventid","labels":"","imported":"","type":"cp","title":"","description":""},"806":{"title":"","description":"","type":"js","imported":"","name":"tripadvisorEvent","labels":"","_id":"806","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"}},"807":{"type":"js","title":"","description":"","imported":"","name":"googleHotelAdsOrderId","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"807"},"808":{"title":"","description":"","type":"js","imported":"","name":"distributeTravelId","labels":"","_id":"808","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"809":{"name":"ozoneTagId","labels":"","_id":"809","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"","description":"","type":"js","imported":""},"810":{"name":"ozoneSegmentKey","labels":"","_id":"810","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"","description":"","type":"js","imported":""},"811":{"name":"trv_reference","labels":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"811","type":"qp","title":"","description":"","imported":""},"812":{"_id":"812","name":"Account Value Strings","type":"va","description":"Should contain account numbers and their value band","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5217","origin_name":"Account Value Strings","origin_type":"property_lists","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"813":{"_id":"813","name":"Active browser type","type":"va","description":"The browser actively being used by the visitor","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"44","origin_name":"Active browser type","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"814":{"_id":"814","name":"Active browser version","type":"va","description":"The browser version actively being used by the visitor","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"48","origin_name":"Active browser version","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"815":{"_id":"815","name":"Active device","type":"va","description":"The device actively being used by the visitor","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"46","origin_name":"Active device","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"816":{"_id":"816","name":"Active operating system","type":"va","description":"The operating system actively being used by the visitor","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"45","origin_name":"Active operating system","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"817":{"_id":"817","name":"Active platform","type":"va","description":"The platform actively being used by the visitor","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"47","origin_name":"Active platform","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"818":{"_id":"818","name":"Average visit duration in minutes","type":"va","description":"Average visit duration in minutes","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"26","origin_name":"Average visit duration in minutes","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"819":{"_id":"819","name":"Average visits per week","type":"va","description":"Average visits per week","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"29","origin_name":"Average visits per week","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"820":{"_id":"820","name":"Batch Tester","type":"va","description":"Testing the batch webhook","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5189","origin_name":"Batch Tester","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"821":{"_id":"821","name":"Blue","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5067","origin_name":"Blue","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"822":{"_id":"822","name":"Brown","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5055","origin_name":"Brown","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"823":{"_id":"823","name":"Cookie Sync ID - Assigned Rule","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5075","origin_name":"Cookie Sync ID - Assigned Rule","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"824":{"_id":"824","name":"Cookie Sync ID - No Rule","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5079","origin_name":"Cookie Sync ID - No Rule","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"825":{"_id":"825","name":"Counter (Last Seen)","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5193","origin_name":"Counter (Last Seen)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"826":{"_id":"826","name":"Direct visit","type":"va","description":"The user navigated directly to the site","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"14","origin_name":"Direct visit","origin_type":"flags","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"827":{"_id":"827","name":"Entry URL","type":"va","description":"URL of the first page visited","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5","origin_name":"Entry URL","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"828":{"_id":"828","name":"Event count","type":"va","description":"Total number of events in visit","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"7","origin_name":"Event count","origin_type":"metrics","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"829":{"_id":"829","name":"Exit URL","type":"va","description":"URL of the last page visited","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"6","origin_name":"Exit URL","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"830":{"_id":"830","name":"Fan","type":"va","description":"More than two total visits and more direct visits than refers","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"30","origin_name":"Fan","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"831":{"_id":"831","name":"First 'test_value' only","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5183","origin_name":"First 'test_value' only","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"832":{"_id":"832","name":"First visit","type":"va","description":"Date of first visit","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"23","origin_name":"First visit","origin_type":"dates","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"833":{"_id":"833","name":"Frequent visitor","type":"va","description":"Two or more average visits per week","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"31","origin_name":"Frequent visitor","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"834":{"_id":"834","name":"Full entry URL (with attribution)","type":"va","description":"","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5090","origin_name":"Full entry URL (with attribution)","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"835":{"_id":"835","name":"Google GID","type":"va","description":"From the Google Cookie Match, saved here as string ","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5038","origin_name":"Google GID","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"836":{"_id":"836","name":"Green","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5063","origin_name":"Green","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"837":{"_id":"837","name":"GUID - Compromised Profile","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5179","origin_name":"GUID - Compromised Profile","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"838":{"_id":"838","name":"GUID - Compromised profile and a new visit [bln]","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5340","origin_name":"GUID - Compromised profile and a new visit [bln]","origin_type":"flags","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"839":{"_id":"839","name":"GUID - Count Has Changed This Visit","type":"va","description":"","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5332","origin_name":"GUID - Count Has Changed This Visit","origin_type":"flags","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"840":{"_id":"840","name":"GUID - Count of seen [num]","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5175","origin_name":"GUID - Count of seen [num]","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"841":{"_id":"841","name":"GUID - Healthy Profile","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5177","origin_name":"GUID - Healthy Profile","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"842":{"_id":"842","name":"GUID - Incomplete Profile","type":"va","description":"Should not use this profile, it's been used on a shared device and only contains partial information","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5334","origin_name":"GUID - Incomplete Profile","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"843":{"_id":"843","name":"GUID - Last seen [str]","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5169","origin_name":"GUID - Last seen [str]","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"844":{"_id":"844","name":"GUID - None","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5181","origin_name":"GUID - None","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"845":{"_id":"845","name":"Has Cookie Sync ID - With Rule","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5077","origin_name":"Has Cookie Sync ID - With Rule","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"846":{"_id":"846","name":"Has Cookie Sync ID - Without Rule","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5081","origin_name":"Has Cookie Sync ID - Without Rule","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"847":{"_id":"847","name":"Hyphen Lover","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5088","origin_name":"Hyphen Lover","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"848":{"_id":"848","name":"Import - Age","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5165","origin_name":"Import - Age","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"849":{"_id":"849","name":"Import - Alpha","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5161","origin_name":"Import - Alpha","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"850":{"_id":"850","name":"Import - Bool","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5167","origin_name":"Import - Bool","origin_type":"flags","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"851":{"_id":"851","name":"Import - Row Number","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5163","origin_name":"Import - Row Number","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"852":{"_id":"852","name":"Last 'test_value'","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5187","origin_name":"Last 'test_value'","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"853":{"_id":"853","name":"Last conversion partner name","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5034","origin_name":"Last conversion partner name","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"854":{"_id":"854","name":"Last event time","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5318","origin_name":"Last event time","origin_type":"dates","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"855":{"_id":"855","name":"Last event URL","type":"va","description":"Last event URL for visitor","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"17","origin_name":"Last event URL","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"856":{"_id":"856","name":"Last UDO String","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5145","origin_name":"Last UDO String","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"857":{"_id":"857","name":"Last visit","type":"va","description":"Date of last visit","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"24","origin_name":"Last visit","origin_type":"dates","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"858":{"_id":"858","name":"Last-seen tealium_event [str]","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5324","origin_name":"Last-seen tealium_event [str]","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"859":{"_id":"859","name":"Last-seen Trace Id","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5320","origin_name":"Last-seen Trace Id","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"860":{"_id":"860","name":"Lifetime browser types used (favorite)","type":"va","description":"Captures the favorite metric for Metric Set: Lifetime browser types used","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"56","origin_name":"Lifetime browser types used (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"861":{"_id":"861","name":"Lifetime browser versions used (favorite)","type":"va","description":"Captures the favorite metric for Metric Set: Lifetime browser versions used","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"62","origin_name":"Lifetime browser versions used (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"862":{"_id":"862","name":"Lifetime devices used (favorite)","type":"va","description":"Captures the favorite metric for Metric Set: Lifetime devices used","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"54","origin_name":"Lifetime devices used (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"863":{"_id":"863","name":"Lifetime event count","type":"va","description":"Total number of events triggered by user","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"22","origin_name":"Lifetime event count","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"864":{"_id":"864","name":"Lifetime operating systems used (favorite)","type":"va","description":"Captures the favorite metric for Metric Set: Lifetime operating systems used","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"58","origin_name":"Lifetime operating systems used (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"865":{"_id":"865","name":"Lifetime order total","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5028","origin_name":"Lifetime order total","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"866":{"_id":"866","name":"Lifetime order total by partner name (favorite)","type":"va","description":"Captures the favorite number for Tally: Lifetime order total by partner name","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5031","origin_name":"Lifetime order total by partner name (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"867":{"_id":"867","name":"Lifetime platforms used (favorite)","type":"va","description":"Captures the favorite metric for Metric Set: Lifetime platforms used","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"60","origin_name":"Lifetime platforms used (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"868":{"_id":"868","name":"LIfetime Test Stream Values (favorite)","type":"va","description":"Captures the favorite number for Tally: LIfetime Test Stream Values","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5132","origin_name":"LIfetime Test Stream Values (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"869":{"_id":"869","name":"Lifetime visit count","type":"va","description":"Total number of times user has visited site","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"21","origin_name":"Lifetime visit count","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"870":{"_id":"870","name":"Light Blue","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5065","origin_name":"Light Blue","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"871":{"_id":"871","name":"Most Recent GCLID","type":"va","description":"This setup ignores the edge case where a user could click two ads from this campaign within the same session - it will only send the last GCLID in those cases.","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5312","origin_name":"Most Recent GCLID","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"872":{"_id":"872","name":"Most Recent GCLID has changed this visit","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5314","origin_name":"Most Recent GCLID has changed this visit","origin_type":"flags","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"873":{"_id":"873","name":"NO BOUNCERS HERE","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5322","origin_name":"NO BOUNCERS HERE","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"874":{"_id":"874","name":"Optin (imported)","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5149","origin_name":"Optin (imported)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"875":{"_id":"875","name":"Orange","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5059","origin_name":"Orange","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"876":{"_id":"876","name":"Pink","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5069","origin_name":"Pink","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"877":{"_id":"877","name":"Product Prices Purchases - Last Order Imported (favorite)","type":"va","description":"Captures the favorite number for Tally: Product Prices Purchases - Last Order Imported","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5120","origin_name":"Product Prices Purchases - Last Order Imported (favorite)","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"878":{"_id":"878","name":"Product Purchase Count (Lifetime) (favorite)","type":"va","description":"Captures the favorite number for Tally: Product Purchase Count (Lifetime)","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5118","origin_name":"Product Purchase Count (Lifetime) (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"879":{"_id":"879","name":"Red","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5057","origin_name":"Red","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"880":{"_id":"880","name":"Referred visit","type":"va","description":"The user was referred from another site","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"13","origin_name":"Referred visit","origin_type":"flags","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"881":{"_id":"881","name":"Referrer","type":"va","description":"","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5092","origin_name":"Referrer","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"882":{"_id":"882","name":"Returning visitor","type":"va","description":"Return visitor","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"27","origin_name":"Returning visitor","origin_type":"flags","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"883":{"_id":"883","name":"Spend per Product (Lifetime) (favorite)","type":"va","description":"Captures the favorite number for Tally: Spend per Product (Lifetime)","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5122","origin_name":"Spend per Product (Lifetime) (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"884":{"_id":"884","name":"Tealium Test Visit","type":"va","description":"Set via query parameter &quot;tealium_test_visit=true&quot;","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"5125","origin_name":"Tealium Test Visit","origin_type":"flags","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"885":{"_id":"885","name":"Tealium Visitor ID (Last Seen)","type":"va","description":"3rd party wins if present","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5129","origin_name":"Tealium Visitor ID (Last Seen)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"886":{"_id":"886","name":"tealium_cf_visit_ttl","type":"va","description":"","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"82","origin_name":"tealium_cf_visit_ttl","origin_type":"properties","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"887":{"_id":"887","name":"Test Date","type":"va","description":"Expects format 2020-08-27T13:13:47.395Z ","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5195","origin_name":"Test Date","origin_type":"dates","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"888":{"_id":"888","name":"Test Tally (favorite)","type":"va","description":"Captures the favorite number for Tally: Test Tally","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5093","origin_name":"Test Tally (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"889":{"_id":"889","name":"test_tiq_string values (favorite)","type":"va","description":"Captures the favorite number for Tally: test_tiq_string values","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5136","origin_name":"test_tiq_string values (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"890":{"_id":"890","name":"test_udo_string values (favorite)","type":"va","description":"Captures the favorite number for Tally: test_udo_string values","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5138","origin_name":"test_udo_string values (favorite)","origin_type":"properties","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"891":{"_id":"891","name":"Tester","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5141","origin_name":"Tester","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"892":{"_id":"892","name":"Total direct visits","type":"va","description":"Total direct visits","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"15","origin_name":"Total direct visits","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"893":{"_id":"893","name":"Total referred visits","type":"va","description":"Total referred visits","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"16","origin_name":"Total referred visits","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"894":{"_id":"894","name":"Total time spent on site in minutes","type":"va","description":"Sum duration of all user visits","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"25","origin_name":"Total time spent on site in minutes","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"895":{"_id":"895","name":"Unbadged","type":"va","description":"The visitor has not been assigned any badges","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"32","origin_name":"Unbadged","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"896":{"_id":"896","name":"Visit duration","type":"va","description":"Visit duration in minutes","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"12","origin_name":"Visit duration","origin_type":"metrics","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"897":{"_id":"897","name":"Visit end","type":"va","description":"Visit end date","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"11","origin_name":"Visit end","origin_type":"dates","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"898":{"_id":"898","name":"Visit start","type":"va","description":"Visit start date","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"10","origin_name":"Visit start","origin_type":"dates","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"899":{"_id":"899","name":"Weeks since first visit","type":"va","description":"Weeks elapsed since first visit","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"28","origin_name":"Weeks since first visit","origin_type":"metrics","origin_context":"visitor","account":"services-caleb","profileid":"main"}},"900":{"_id":"900","name":"Weeks since first visit temp","type":"va","description":"Temporary store for computer value","context":"current_visit","imported":"AudienceStream","settings":{"origin_id":"80","origin_name":"Weeks since first visit temp","origin_type":"metrics","origin_context":"current_visit","account":"services-caleb","profileid":"main"}},"901":{"_id":"901","name":"Yellow","type":"va","description":"","context":"visitor","imported":"AudienceStream","settings":{"origin_id":"5061","origin_name":"Yellow","origin_type":"badges","origin_context":"visitor","account":"services-caleb","profileid":"main"}}},"manage":{"1":{"advconfig_send":"yes","advconfig_src":"","config_account_id":"","lastTemplateUpdate":"1609789336170","_id":"1","tag_id":"21012","publish_revisions":{"svr_save_timestamps":{"dev":"202101131210","prod":"202101151252","qa":"202101151252"},"last_modified":"202101131210"},"notes":"","sort":"1","new_flag":"true","selectedTargets":{"qa":"false","dev":"false","prod":"false"},"advconfig_bundle":"no","advconfig_wait":"yes","advconfig_loadtype":"","loadrule":"all","tag_name":"Uniqodo","title":"Uniqodo","id":"1","status":"inactive","scope":"all","loadrule_join_operator":"all","advconfig_optout":"yes","labels":""},"2":{"config_cloudid":"41E27DA552A6473A0A490D4D@AdobeOrg","tag_id":"19063","lastTemplateUpdate":"1611061750942","config_runclearvars":"yes","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"new_flag":"true","config_viewthroughinterval":"100","config_detectserial":"yes","notes":"daf","publishedTargets":"dev","config_internalfilters":"javascript:,firstchoice.co.uk,thomson.co.uk,falconholidays.ie,tui.co.uk,tuiholidays.ie,i.4see.mobi,survey.foreseeresults.com,tuiretailagents.thomson.co.uk,falconretailagents.falconholidays.ie,tuiretailhish-live.thomsonuk.dnsroot.biz,falconretailhish-live.thomsonuk.dnsroot.biz,money4travel.com,inbro.net,tuitickets.com,amazonaws.com,tuiprjuat.co.uk,firstchoiceprjuat.co.uk,tuiholidaysprjuat.ie,thomsonuk.dnsroot.biz","config_tagversion":"am2140","loadrule_join_operator":"all","scope":"2","status":"active","config_server":"tuiuk.d1.sc.omtrdc.net","config_reportsuite":"tuiukdev","config_serversecure":"tuiuk.d1.sc.omtrdc.net","advconfig_optout":"yes","tag_name":"Adobe Analytics AppMeasurement for JS","loadrule":"2","advconfig_loadtype":"","advconfig_wait":"yes","title":"Adobe Analytics AppMeasurement for JS - Marketplace","config_tagdevicetype":"standard","publish_revisions":{"svr_save_timestamps":{"qa":"202102030846","prod":"202101191702","dev":"202101201107"},"last_modified":"202101201107"},"config_viewthroughmaxtries":"3","_id":"2","sort":"2","map":{"1":{"variable":"pageName, channel, prop48, eVar48","type":"static.text","key":"tui"},"2":{"dsID":"225","key":"event_name","type":"js","variable":"linkName"},"3":{"key":"map_eVar230","dsID":"226","type":"js","variable":"eVar230"},"4":{"variable":"combineLinkVar","type":"static.js","key":"true"},"5":{"key":"adobeLinkTrackEvents","dsID":"224","type":"js","variable":"linkTrackEvents"},"6":{"key":"adobeLinkTrackVars","dsID":"223","variable":"linkTrackVars","type":"js"}},"advconfig_send":"yes","config_runviewthrough":"no","advconfig_src":"","config_tracklinks":"true","config_namespace":"tuiuk","labels":"","config_sobject":"s","advconfig_bundle":"no","id":"2"},"3":{"status":"active","scope":"all","loadrule_join_operator":"all","config_marketingCloudServer":"","advconfig_optout":"yes","labels":"","advconfig_bundle":"yes","advconfig_wait":"no","advconfig_loadtype":"","loadrule":"all","tag_name":"Adobe Experience Cloud ID Service","config_trackingServer":"","config_trackingServerSecure":"","title":"Adobe Experience Cloud ID Service","id":"3","lastTemplateUpdate":"1610630558252","tag_id":"1191","_id":"3","publish_revisions":{"svr_save_timestamps":{"qa":"202101151252","dev":"202101141323","prod":"202101151252"},"last_modified":"202101141323"},"notes":"","new_flag":"true","sort":"0","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"config_adobe_org_id":"41E27DA552A6473A0A490D4D@AdobeOrg","config_marketingCloudServerSecure":"","advconfig_send":"yes","publishedTargets":"dev","advconfig_src":"","config_tagversion":"aid511"},"5":{"tag_id":"19063","lastTemplateUpdate":"1611073944871","config_cloudid":"41E27DA552A6473A0A490D4D@AdobeOrg","notes":"daf","config_detectserial":"yes","config_viewthroughinterval":"100","new_flag":"true","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"config_runclearvars":"no","config_internalfilters":"javascript:,firstchoice.co.uk,thomson.co.uk,falconholidays.ie,tui.co.uk,tuiholidays.ie,i.4see.mobi,survey.foreseeresults.com,tuiretailagents.thomson.co.uk,falconretailagents.falconholidays.ie,tuiretailhish-live.thomsonuk.dnsroot.biz,falconretailhish-live.thomsonuk.dnsroot.biz,money4travel.com,inbro.net,tuitickets.com,amazonaws.com,tuiprjuat.co.uk,firstchoiceprjuat.co.uk,tuiholidaysprjuat.ie,thomsonuk.dnsroot.biz","publishedTargets":"dev","config_tagversion":"am2140","status":"active","scope":"3","loadrule_join_operator":"all","advconfig_optout":"yes","config_serversecure":"tuiuk.d1.sc.omtrdc.net","config_server":"tuiuk.d1.sc.omtrdc.net","config_reportsuite":"tuiukdev","advconfig_wait":"yes","advconfig_loadtype":"","tag_name":"Adobe Analytics AppMeasurement for JS","loadrule":"3","config_tagdevicetype":"standard","title":"Adobe Analytics AppMeasurement for JS - Fixed","_id":"5","publish_revisions":{"svr_save_timestamps":{"qa":"202102030846","prod":"202101191702","dev":"202101201149"},"last_modified":"202101201149"},"config_viewthroughmaxtries":"3","map":{"1":{"key":"tui","type":"static.text","variable":"pageName, channel, prop48, eVar48"},"2":{"type":"js","variable":"linkName","key":"event_name","dsID":"225"},"3":{"variable":"eVar230","type":"js","key":"map_eVar230","dsID":"226"},"4":{"variable":"combineLinkVar","type":"static.js","key":"true"},"5":{"dsID":"224","key":"adobeLinkTrackEvents","variable":"linkTrackEvents","type":"js"},"6":{"type":"js","variable":"linkTrackVars","dsID":"223","key":"adobeLinkTrackVars"}},"sort":"3","advconfig_send":"yes","advconfig_src":"","copiedFromTag":"2","config_runviewthrough":"no","config_namespace":"tuiuk","config_tracklinks":"true","labels":"","advconfig_bundle":"no","config_sobject":"s","id":"5"},"7":{"config_internalfilters":"javascript:,firstchoice.co.uk,thomson.co.uk,falconholidays.ie,tui.co.uk,tuiholidays.ie,i.4see.mobi,survey.foreseeresults.com,tuiretailagents.thomson.co.uk,falconretailagents.falconholidays.ie,tuiretailhish-live.thomsonuk.dnsroot.biz,falconretailhish-live.thomsonuk.dnsroot.biz,money4travel.com,inbro.net,tuitickets.com,amazonaws.com,tuiprjuat.co.uk,firstchoiceprjuat.co.uk,tuiholidaysprjuat.ie,thomsonuk.dnsroot.biz","publishedTargets":"dev","config_tagversion":"am2220","tag_id":"19063","lastTemplateUpdate":"1611061750942","config_cloudid":"41E27DA552A6473A0A490D4D@AdobeOrg","notes":"daf","config_viewthroughinterval":"100","config_detectserial":"yes","new_flag":"true","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"config_runclearvars":"yes","advconfig_wait":"yes","advconfig_loadtype":"","tag_name":"Adobe Analytics AppMeasurement for JS","loadrule":"4","config_tagdevicetype":"standard","title":"Adobe Analytics AppMeasurement for JS - Latest Marketplace","status":"active","scope":"4","loadrule_join_operator":"all","config_serversecure":"tuiuk.d1.sc.omtrdc.net","advconfig_optout":"yes","config_server":"tuiuk.d1.sc.omtrdc.net","config_reportsuite":"tuiukdev","advconfig_send":"yes","advconfig_src":"","copiedFromTag":"2","config_runviewthrough":"no","_id":"7","config_viewthroughmaxtries":"3","publish_revisions":{"last_modified":"202101201107","svr_save_timestamps":{"qa":"202102030846","dev":"202101201107","prod":"202101191702"}},"map":{"1":{"key":"tui","variable":"pageName, channel, prop48, eVar48","type":"static.text"},"2":{"variable":"linkName","type":"js","key":"event_name","dsID":"225"},"3":{"variable":"eVar230","type":"js","dsID":"226","key":"map_eVar230"},"4":{"type":"static.js","variable":"combineLinkVar","key":"true"},"5":{"type":"js","variable":"linkTrackEvents","key":"adobeLinkTrackEvents","dsID":"224"},"6":{"dsID":"223","key":"adobeLinkTrackVars","type":"js","variable":"linkTrackVars"}},"sort":"4","advconfig_bundle":"no","config_sobject":"s","id":"7","config_namespace":"tuiuk","config_tracklinks":"true","labels":""},"8":{"loadrule_join_operator":"all","scope":"5","status":"active","config_server":"tuiuk.d1.sc.omtrdc.net","config_reportsuite":"tuiukdev","advconfig_optout":"yes","config_serversecure":"tuiuk.d1.sc.omtrdc.net","tag_name":"Adobe Analytics AppMeasurement for JS","loadrule":"5","advconfig_loadtype":"","advconfig_wait":"yes","title":"Adobe Analytics AppMeasurement for JS - Latest FIxed","config_tagdevicetype":"standard","config_cloudid":"41E27DA552A6473A0A490D4D@AdobeOrg","lastTemplateUpdate":"1611075016779","tag_id":"19063","config_runclearvars":"yes","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"new_flag":"true","config_viewthroughinterval":"100","notes":"daf","config_detectserial":"yes","publishedTargets":"dev","config_internalfilters":"javascript:,firstchoice.co.uk,thomson.co.uk,falconholidays.ie,tui.co.uk,tuiholidays.ie,i.4see.mobi,survey.foreseeresults.com,tuiretailagents.thomson.co.uk,falconretailagents.falconholidays.ie,tuiretailhish-live.thomsonuk.dnsroot.biz,falconretailhish-live.thomsonuk.dnsroot.biz,money4travel.com,inbro.net,tuitickets.com,amazonaws.com,tuiprjuat.co.uk,firstchoiceprjuat.co.uk,tuiholidaysprjuat.ie,thomsonuk.dnsroot.biz","config_tagversion":"am2220","config_tracklinks":"true","config_namespace":"tuiuk","labels":"","config_sobject":"s","advconfig_bundle":"no","id":"8","config_viewthroughmaxtries":"3","publish_revisions":{"svr_save_timestamps":{"prod":"202101191702","dev":"202101201107","qa":"202102030846"},"last_modified":"202101201107"},"_id":"8","sort":"5","map":{"1":{"key":"tui","type":"static.text","variable":"pageName, channel, prop48, eVar48"},"2":{"type":"js","variable":"linkName","dsID":"225","key":"event_name"},"3":{"key":"map_eVar230","dsID":"226","type":"js","variable":"eVar230"},"4":{"type":"static.js","variable":"combineLinkVar","key":"true"},"5":{"key":"adobeLinkTrackEvents","dsID":"224","type":"js","variable":"linkTrackEvents"},"6":{"variable":"linkTrackVars","type":"js","key":"adobeLinkTrackVars","dsID":"223"}},"advconfig_send":"yes","copiedFromTag":"7","config_runviewthrough":"no","advconfig_src":""},"10":{"advconfig_bundle":"no","config_use_amp_client_id":"false","id":"10","_multipleLoadRules":"6","multipleLoadRules":"6","labels":"","config_allow_display_features":"true","advconfig_send":"yes","advconfig_src":"","config_cross_track_domains":"","_id":"10","config_cross_track":"false","publish_revisions":{"svr_save_timestamps":{"dev":"202101221307","qa":"202102030846"},"last_modified":"202101221307"},"map":{"1":{"dsID":"1493","key":"legacy_Google_Analytics_All_Property_IDs","variable":"tracking_id","type":"js"},"2":{"variable":"cdm.dimension1--page_view","type":"js","dsID":"1118","key":"legacy_pageURL"},"3":{"key":"legacy_pageNameTemporary","dsID":"1115","variable":"cdm.dimension2--page_view","type":"js"},"4":{"variable":"cdm.dimension3--page_view, cdm.dimension10--prod","type":"js","key":"legacy_siteSection","dsID":"1170"},"5":{"dsID":"1171","key":"legacy_siteSubSection","type":"js","variable":"cdm.dimension4--page_view"},"6":{"variable":"cdm.dimension5--page_view","type":"js","key":"legacy_pageID","dsID":"1111"},"7":{"dsID":"910","key":"legacy_brand","type":"js","variable":"cdm.dimension6--page_view"},"8":{"key":"legacy_customerIDClean","dsID":"1227","type":"js","variable":"cdm.dimension7--page_view"},"9":{"key":"legacy_adobeMarketingCloudVisitorID","dsID":"894","variable":"cdm.dimension8--page_view, cdm.dimension8--ecom","type":"js"},"10":{"key":"legacy_abTest","dsID":"890","type":"js","variable":"cdm.dimension9--page_view, cdm.dimension9--ecom"},"11":{"dsID":"1130","key":"legacy_productID","type":"js","variable":"cdm.dimension37--page_view"},"12":{"variable":"detail:view_item, search:view_item_list, checkout_room_options:checkout_progress, checkout_flight_options:checkout_progress, checkout_lock_your_price_unconfirmed:checkout_progress, checkout_summary_to_payment:checkout_progress, checkout_customise_holiday:checkout_progress, purchase:purchase, cm_event:cm_event, page_timing:cst_timing","type":"js","dsID":"1910","key":"tealium_event"},"13":{"type":"js","variable":"cdm.dimension50--page_view, cdm.dimension19--prod","dsID":"1005","key":"legacy_departureDate_YYYYMMDD"},"14":{"variable":"cdm.dimension53--page_view, cdm.dimension53--cm_event","type":"js","key":"cm_banner_version","dsID":"1904"},"15":{"variable":"cdm.dimension56--page_view, cdm.dimension56--ecom","type":"js","dsID":"931","key":"legacy_creditNoteCode"},"16":{"variable":"cdm.dimension48--page_view","type":"js","dsID":"1059","key":"legacy_gmpCustomerID"},"17":{"type":"js","variable":"cdm.dimension49--page_view","dsID":"1491","key":"legacy_bookingReferenceSplit"},"18":{"variable":"cdm.dimension67--page_view","type":"qp","key":"gaid","dsID":"1492"},"19":{"variable":"event.event_category","type":"js","dsID":"1762","key":"gaEventCategory"},"20":{"variable":"event.event_action","type":"js","dsID":"1763","key":"gaEventAction"},"21":{"variable":"event.event_label","type":"js","dsID":"1828","key":"gaEventLabel"},"22":{"dsID":"1054","key":"legacy_flightType","type":"js","variable":"cdm.dimension11--prod"},"23":{"variable":"cdm.dimension14--prod","type":"js","dsID":"1213","key":"legacy_tripAdvisorRating"},"24":{"variable":"cdm.dimension15--prod","type":"js","dsID":"1001","key":"legacy_daysToDeparture"},"25":{"key":"legacy_tradingCycle","dsID":"1211","type":"js","variable":"cdm.dimension16--prod"},"26":{"dsID":"1003","key":"legacy_departureAirportCode","type":"js","variable":"cdm.dimension17--prod"},"27":{"key":"legacy_arrivalAirportCode","dsID":"902","variable":"cdm.dimension18--prod","type":"js"},"28":{"dsID":"1021","key":"legacy_duration","variable":"cdm.dimension20--prod","type":"js"},"29":{"dsID":"1108","key":"legacy_numberOfPax","type":"js","variable":"cdm.metric1--prod"},"30":{"type":"js","variable":"cdm.metric3--cst_timing","key":"legacy_pageLoadTimeCount","dsID":"1112"},"31":{"type":"js","variable":"cdm.metric4--cst_timing","dsID":"1114","key":"legacy_pageLoadTimeInteractive"},"32":{"dsID":"1113","key":"legacy_pageLoadTimeFullyLoaded","variable":"cdm.metric5--cst_timing","type":"js"},"33":{"key":"legacy_productList.productID","dsID":"1823","variable":"impression_id","type":"js"},"34":{"key":"legacy_productList.productName","dsID":"1824","variable":"impression_name","type":"js"},"35":{"variable":"impression_list_name","type":"js","dsID":"1825","key":"legacy_productList.list"},"36":{"variable":"impression_brand","type":"js","dsID":"1826","key":"legacy_productList.productCollectionName"},"37":{"key":"legacy_productList.position","dsID":"1827","variable":"impression_list_position","type":"js"},"38":{"variable":"cdm.dimension52--checkout","type":"js","dsID":"1082","key":"legacy_Lock_Your_Price_Available"},"39":{"type":"dom","variable":"config.page_title","key":"title"},"40":{"dsID":"1833","key":"legacy_productList.productType","variable":"cdm.dimension13--prod","type":"js"},"41":{"type":"js","variable":"cdm.metric7--purchase","key":"legacy_Lock_Your_Price_Confirmed_Booking","dsID":"1083"},"42":{"type":"js","variable":"cdm.metric8--purchase","key":"legacy_Lock_Your_Price_Revenue","dsID":"1084"},"43":{"dsID":"932","key":"legacy_creditNoteDiscount","type":"js","variable":"cdm.metric12--purchase"},"44":{"dsID":"1835","key":"legacy_productList.metric1","type":"js","variable":"cdm.metric1--prod"},"45":{"key":"100","type":"static.text","variable":"config.site_speed_sample_rate"},"46":{"dsID":"1905","key":"cm_optout_categories","type":"js","variable":"cdm.dimension54--page_view, cdm.dimension54--cm_event"},"47":{"variable":"cdm.dimension55--cm_event","type":"js","dsID":"1903","key":"cm_method"},"48":{"key":" &quot;page_timing&quot; === b.tealium_event ? 1 : ''","type":"static.js","variable":"event.non_interaction"},"49":{"variable":"cdm.metric15--page_view","type":"static.js","key":"b.cm_banner_was_shown === 'true' ? 1 : ''"},"50":{"key":"&quot;tiq.cm_save_preferences&quot; === b.event ? 1 : ''","variable":"cdm.metric11--cm_event","type":"static.js"},"51":{"key":"'tiq.cm_manage_preferences' === b.event ? 1  : ''","variable":"cdm.metric10--cm_event","type":"static.js"}},"config_data_layer_name":"","sort":"6","advconfig_wait":"yes","config_enhanced_link_attribution":"false","advconfig_loadtype":"","loadrule":"6","tag_name":"Google Analytics (gtag.js)","title":"GUA - TUI UK","status":"active","scope":"6","loadrule_join_operator":"all","advconfig_optout":"yes","config_transport_type":"default","config_clear_global_vars":"true","publishedTargets":"dev","config_screen_view":"false","lastTemplateUpdate":"1611250536417","tag_id":"7133","config_anonymize_ip":"true","config_tracking_id":"","notes":"   Caleb wrote this comment while Tom was adding a new tag as a concurrent user check.","new_flag":"true","config_allow_anchor":"false","selectedTargets":{"prod":"false","dev":"true","qa":"true"},"config_gaobject":"","config_optimize_id":""},"11":{"_id":"11","config_cross_track_domains":"","publish_revisions":{"last_modified":"202101221302","svr_save_timestamps":{"qa":"202101190830","dev":"202101221302"}},"map":{"1":{"dsID":"1165","key":"legacy_season","type":"js","variable":"custom.u1"},"2":{"variable":"custom.u2","type":"js","key":"legacy_countryName","dsID":"928"},"3":{"dsID":"1128","key":"legacy_productCollectionCode","type":"js","variable":"custom.u3"},"4":{"type":"js","variable":"custom.u4","dsID":"1108","key":"legacy_numberOfPax"},"5":{"dsID":"914","key":"legacy_carrierCode","variable":"custom.u5","type":"js"},"6":{"type":"js","variable":"custom.u7","key":"legacy_epicCode","dsID":"1025"},"7":{"dsID":"937","key":"legacy_cruiseEpicCode","variable":"custom.u8","type":"js"},"8":{"type":"js","variable":"custom.u9","key":"legacy_cruiseShip","dsID":"939"},"9":{"variable":"custom.u10","type":"js","dsID":"943","key":"legacy_cruiseType"},"10":{"variable":"custom.u11","type":"js","dsID":"1004","key":"legacy_departureDate"},"11":{"dsID":"1003","key":"legacy_departureAirportCode","variable":"custom.u12","type":"js"},"12":{"dsID":"902","key":"legacy_arrivalAirportCode","type":"js","variable":"custom.u13"},"13":{"key":"legacy_duration","dsID":"1021","variable":"custom.u14","type":"js"},"14":{"dsID":"1129","key":"legacy_productCollectionName","type":"js","variable":"custom.u15"},"15":{"type":"js","variable":"custom.u16","key":"legacy_boardBasisCode","dsID":"904"},"16":{"variable":"custom.u17","type":"js","key":"legacy_price","dsID":"1122"},"17":{"key":"legacy_promoCodeName","dsID":"1137","type":"js","variable":"custom.u18"},"18":{"type":"js","variable":"custom.u19","key":"legacy_bookingReference","dsID":"908"},"19":{"dsID":"1212","key":"legacy_tripAdvisorEventID","variable":"custom.u20","type":"js"},"20":{"key":"legacy_isAccommodationOnly","dsID":"1069","type":"js","variable":"custom.u21"},"21":{"key":"legacy_isCreditNoteBooking","dsID":"1071","type":"js","variable":"custom.u22"},"22":{"key":"legacy_creditNoteTotalValue","dsID":"935","variable":"custom.u23","type":"js"},"23":{"key":"legacy_creditNoteRefundValue","dsID":"934","type":"js","variable":"custom.u24"},"24":{"key":"legacy_creditNoteOriginalBookingID","dsID":"933","variable":"custom.u25","type":"js"},"25":{"type":"js","variable":"custom.u26","dsID":"925","key":"legacy_continentName"},"26":{"variable":"custom.u27","type":"js","dsID":"924","key":"legacy_continentCode"},"27":{"type":"js","variable":"custom.u28","key":"legacy_countryCode","dsID":"927"},"28":{"variable":"custom.u29","type":"js","key":"legacy_destinationName","dsID":"1014"},"29":{"key":"legacy_destinationCode","dsID":"1011","type":"js","variable":"custom.u30"},"30":{"variable":"custom.u31","type":"js","key":"legacy_regionName","dsID":"1150"},"31":{"dsID":"1149","key":"legacy_regionCode","type":"js","variable":"custom.u32"},"32":{"dsID":"1152","key":"legacy_resortName","variable":"custom.u33","type":"js"},"33":{"dsID":"1151","key":"legacy_resortCode","type":"js","variable":"custom.u34"},"34":{"variable":"custom.u35","type":"static.js","key":"'adult:' + b['legacy_numberOfAdults'] + '|child:' + b['legacy_numberOfChildren'] + '|infant:' + b['legacy_numberOfInfants']"},"35":{"variable":"custom.u36","type":"js","dsID":"1074","key":"legacy_isLowDeposit"},"36":{"variable":"custom.u37","type":"js","dsID":"1056","key":"legacy_freeChildPlaces"},"37":{"variable":"custom.u38","type":"js","key":"legacy_searchType","dsID":"1164"},"38":{"variable":"custom.u39","type":"js","dsID":"1001","key":"legacy_daysToDeparture"},"39":{"type":"js","variable":"custom.u40","key":"legacy_hotelName","dsID":"1067"},"40":{"key":"dcAdvertiserId","dsID":"1916","variable":"advertiser_id","type":"js"},"41":{"type":"js","variable":"activity_group","dsID":"1917","key":"dcActivityGroup"},"42":{"key":"dcActivityString","dsID":"1918","variable":"activity","type":"js"},"43":{"dsID":"1922","key":"dcCounterType","variable":"counting_method","type":"js"},"44":{"type":"js","variable":"1:conversion, 2:purchase","key":"dcFloodlightFire","dsID":"1919"}},"sort":"7","config_data_layer_name":"","advconfig_send":"yes","config_custom_scripts":"true","advconfig_src":"","_multipleLoadRules":"all","multipleLoadRules":"all","labels":"19,21","advconfig_bundle":"no","config_advertiser_id":"","config_activity":"","id":"11","tag_id":"4049","lastTemplateUpdate":"1607969327304","notes":"","new_flag":"true","selectedTargets":{"prod":"false","dev":"true","qa":"false"},"publishedTargets":"dev","config_gtag_rename":"","status":"active","scope":"all","loadrule_join_operator":"all","advconfig_optout":"yes","config_counting_method":"","config_activity_group":"","advconfig_wait":"yes","advconfig_loadtype":"","tag_name":"Floodlight (gtag.js)","loadrule":"all","title":"Google Campaign Manager (gtag.js)","config_fire_purchase":"false"},"12":{"loadrule_join_operator":"any","scope":"11,14,13,12","status":"active","advconfig_optout":"yes","tag_name":"Floodlight (gtag.js)","loadrule":"11,14,13,12","advconfig_loadtype":"","config_activity_group":"","advconfig_wait":"yes","config_counting_method":"","config_fire_purchase":"false","title":"Google Campaign Manager Unique Lands Floodlight (gtag.js)","lastTemplateUpdate":"1608558340549","tag_id":"4049","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"new_flag":"true","notes":"","publishedTargets":"dev","config_gtag_rename":"","multipleLoadRules":"11,14,13,12","_multipleLoadRules":"11,14,13,12","labels":"19,21","config_advertiser_id":"","advconfig_bundle":"no","config_activity":"","id":"12","publish_revisions":{"svr_save_timestamps":{"dev":"202101221302","qa":"202102030846"},"last_modified":"202101221302"},"config_cross_track_domains":"","_id":"12","config_data_layer_name":"","sort":"8","map":{"1":{"dsID":"1916","key":"dcAdvertiserId","variable":"advertiser_id","type":"js"},"2":{"key":"dcActivityGroup","dsID":"1917","type":"js","variable":"activity_group"},"3":{"key":"dcActivityString","dsID":"1918","type":"js","variable":"activity"},"4":{"key":"dcCounterType","dsID":"1922","variable":"counting_method","type":"js"},"5":{"dsID":"1919","key":"dcFloodlightFire","variable":"1:conversion, 2:conversion","type":"js"}},"config_custom_scripts":"true","advconfig_send":"yes","advconfig_src":""},"13":{"loadrule_join_operator":"all","status":"active","scope":"all","advconfig_optout":"yes","advconfig_loadtype":"","loadrule":"all","tag_name":"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)","advconfig_wait":"yes","title":"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)","lastTemplateUpdate":"1608574623814","tag_id":"7132","selectedTargets":{"qa":"false","dev":"true","prod":"false"},"notes":"","new_flag":"true","publishedTargets":"dev","config_pagetype":"home","config_gtag_rename":"","config_conversion_value":"","multipleLoadRules":"all","_multipleLoadRules":"all","labels":"19,22","config_conversion_id":"","advconfig_bundle":"no","id":"13","_multipleLoadRulesTitle":"","publish_revisions":{"svr_save_timestamps":{"dev":"202101221302","qa":"202012291436"},"last_modified":"202101221302"},"config_conversion_label":"","config_remarketing":"false","_id":"13","config_cross_track_domains":"","map":{"1":{"dsID":"1928","key":"googleAdsConversionId","variable":"conversion_id","type":"js"},"2":{"dsID":"1929","key":"googleAdsConversionLabel","variable":"conversion_label","type":"js"}},"sort":"9","config_data_layer_name":"","advconfig_send":"yes","advconfig_src":""},"14":{"title":"Google Ads Conversion Tracking &amp; Remarketing (gtag.js) - TUI IE Display","advconfig_wait":"yes","advconfig_loadtype":"","tag_name":"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)","loadrule":"8,7,10,9","advconfig_optout":"yes","status":"active","scope":"8,7,10,9","loadrule_join_operator":"any","config_gtag_rename":"","config_conversion_value":"","config_pagetype":"conversion","publishedTargets":"dev","notes":"","new_flag":"true","selectedTargets":{"qa":"false","prod":"false","dev":"true"},"tag_id":"7132","lastTemplateUpdate":"1610032374375","id":"14","advconfig_bundle":"no","config_conversion_id":"AW-985827756","labels":"22,19","_multipleLoadRules":"8,7,10,9","multipleLoadRules":"8,7,10,9","advconfig_src":"","advconfig_send":"yes","config_data_layer_name":"","sort":"10","config_cross_track_domains":"","config_conversion_label":"_sJkCLzS-AQQrJOK1gM","config_remarketing":"false","_id":"14","publish_revisions":{"svr_save_timestamps":{"dev":"202101221302","qa":"202101072009"},"last_modified":"202101221302"}},"15":{"title":"Google Hotel Ads Conversion Tracking (gtag.js)","advconfig_loadtype":"","loadrule":"13,12","tag_name":"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)","advconfig_wait":"yes","advconfig_optout":"yes","loadrule_join_operator":"any","status":"active","scope":"13,12","config_gtag_rename":"","config_conversion_value":"","publishedTargets":"dev","config_pagetype":"conversion","selectedTargets":{"prod":"false","dev":"true","qa":"true"},"notes":"","new_flag":"true","tag_id":"7132","lastTemplateUpdate":"1610720427387","id":"15","advconfig_bundle":"no","labels":"22,19","config_conversion_id":"AW-657399759","multipleLoadRules":"13,12","_multipleLoadRules":"13,12","advconfig_src":"","advconfig_send":"yes","map":{"1":{"key":"_cprice","type":"customization30","variable":"custom.value"},"2":{"variable":"custom.currency","type":"customization30","key":"_ccurrency"},"3":{"dsID":"1975","key":"googleHotelAdsOrderId","variable":"order_id, custom.transaction_id","type":"js"},"4":{"type":"js","variable":"custom.id","dsID":"1166","key":"legacy_sellingCode"},"5":{"type":"js","variable":"custom.start_date","dsID":"1005","key":"legacy_departureDate_YYYYMMDD"},"6":{"dsID":"1154","key":"legacy_returnDate","type":"js","variable":"custom.end_date"}},"config_data_layer_name":"","sort":"11","publish_revisions":{"last_modified":"202101221302","svr_save_timestamps":{"dev":"202101221302","qa":"202102030846"}},"config_cross_track_domains":"","config_conversion_label":"3eh9CKen5coBEM-_vLkC","config_remarketing":"false","_id":"15"},"16":{"status":"inactive","_multipleLoadRules":"all","scope":"all","multipleLoadRules":"all","loadrule_join_operator":"all","advconfig_optout":"yes","labels":"","advconfig_wait":"yes","advconfig_bundle":"no","advconfig_loadtype":"","tag_name":"Tealium Custom Container","loadrule":"all","title":"GA4 - Custom","id":"16","tag_id":"20010","_id":"16","lastTemplateUpdate":"1611246548687","publish_revisions":{"svr_save_timestamps":{"dev":"202101221355"},"last_modified":"202101221354"},"notes":"A custom container for GA4 until an official Tealium tag is released.","map":{"1":{"key":"G-R1P4W35ZRQ","type":"static.text","variable":"property_id"}},"new_flag":"true","sort":"12","selectedTargets":{"qa":"false","prod":"false","dev":"true"},"advconfig_send":"yes","advconfig_src":""},"17":{"config_clear_global_vars":"false","publishedTargets":"dev","config_screen_view":"false","config_anonymize_ip":"false","tag_id":"7133","lastTemplateUpdate":"1611320347509","config_tracking_id":"G-R1P4W35ZRQ","new_flag":"true","config_allow_anchor":"false","notes":"","config_optimize_id":"","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"config_gaobject":"","config_enhanced_link_attribution":"false","advconfig_wait":"yes","tag_name":"Google Analytics (gtag.js)","loadrule":"all","advconfig_loadtype":"","title":"GA4 - Google Analytics (gtag.js)","scope":"all","status":"active","loadrule_join_operator":"all","advconfig_optout":"yes","config_transport_type":"default","config_allow_display_features":"false","advconfig_send":"yes","advconfig_src":"","config_cross_track_domains":"","_id":"17","config_cross_track":"false","publish_revisions":{"last_modified":"202101221354","svr_save_timestamps":{"qa":"202102030846","dev":"202101221355"}},"config_data_layer_name":"","sort":"13","map":{"1":{"key":"G-R1P4W35ZRQ","variable":"measurement_id","type":"static.text"}},"advconfig_bundle":"no","config_use_amp_client_id":"false","id":"17","labels":""},"20":{"labels":"19,26","advconfig_optout":"yes","multipleLoadRules":"16,15","config_advanced_matching":"false","loadrule_join_operator":"all","_multipleLoadRules":"16,15","status":"active","scope":"16","id":"20","title":"Facebook Pixel","advconfig_loadtype":"","tag_name":"Facebook Pixel","loadrule":"16","advconfig_bundle":"no","advconfig_wait":"yes","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"notes":"","map":{"1":{"key":"false","type":"static.js","variable":"autoConfig"},"2":{"variable":"content_type","type":"js","key":"fbContentType","dsID":"1839"},"3":{"type":"js","variable":"AddToCart:AddToCart, InitiateCheckout:InitiateCheckout, Purchase:Purchase, Search:Search, ViewContent:ViewContent, PurchaseM4T:PurchaseM4T, AddToWishlist:AddToWishlist","dsID":"1840","key":"fbEventType"},"4":{"variable":"content_name","type":"js","dsID":"1841","key":"fbContentName"},"5":{"dsID":"1843","key":"fbValue","type":"js","variable":"value"},"6":{"key":"fbCheckinDate","dsID":"1842","variable":"checkin_date","type":"js"},"7":{"dsID":"1844","key":"fbNumTravelers","variable":"num_travelers","type":"js"},"8":{"key":"fbDestination","dsID":"1847","variable":"destination","type":"js"},"9":{"key":"fbOrigin","dsID":"1848","type":"js","variable":"origin"},"10":{"variable":"departing","type":"js","key":"fbDeparting","dsID":"1849"},"11":{"variable":"promo_code_name","type":"js","key":"fbPromoCodeName","dsID":"1845"},"12":{"dsID":"1846","key":"fbPromoCodeValue","type":"js","variable":"promo_code_value"},"13":{"dsID":"1851","key":"fbDepartingDepartureDate","variable":"departing_departure_date","type":"js"},"14":{"dsID":"1852","key":"fbOriginAirport","variable":"origin_airport","type":"js"},"15":{"type":"js","variable":"returning_departure_date","key":"fbReturningDepartureDate","dsID":"1853"},"16":{"key":"fbDestinationAirport","dsID":"1854","type":"js","variable":"destination_airport"},"17":{"key":"fbNumAdults","dsID":"1855","variable":"num_adults","type":"js"},"18":{"key":"fbContentCategory","dsID":"1856","type":"js","variable":"content_category"},"19":{"type":"js","variable":"content_ids","key":"fbContentIDs","dsID":"1850"},"20":{"key":"fbNumItems","dsID":"1857","variable":"num_items","type":"js"},"21":{"variable":"num_children, Search.num_children","type":"js","key":"fbNumChildren","dsID":"1859"},"22":{"dsID":"1860","key":"fbDestinationIDs","variable":"destination_ids","type":"js"},"23":{"dsID":"1861","key":"fbHaulType","type":"js","variable":"haulType"},"24":{"key":"fbCheckoutDate","dsID":"1858","type":"js","variable":"checkout_date"},"25":{"variable":"credit_note_booking","type":"js","key":"fbCreditNoteBooking","dsID":"1940"},"26":{"dsID":"1941","key":"fbCreditNoteDiscount","variable":"credit_note_discount","type":"js"},"27":{"key":"fbCurrency","dsID":"1943","type":"js","variable":"order_currency"},"28":{"type":"js","variable":"order_id","dsID":"1938","key":"fbOrderID"},"29":{"key":"1430667403867728","type":"static.text","variable":"pixel_id"}},"sort":"14","new_flag":"true","publish_revisions":{"last_modified":"202102101306","svr_save_timestamps":{"prod":"202102101104","dev":"202102101306","qa":"202102101257"}},"_id":"20","lastTemplateUpdate":"1610722607280","tag_id":"6037","config_generate_event_id":"false","advconfig_src":"","advconfig_send":"yes","publishedTargets":"dev","config_pixel_id":""},"22":{"config_campaignid":"","id":"22","title":"Adform","tag_name":"Adform","loadrule":"all","advconfig_loadtype":"","advconfig_wait":"yes","advconfig_bundle":"no","config_page_name":"","advconfig_optout":"yes","loadrule_join_operator":"all","scope":"all","status":"active","advconfig_src":"","advconfig_send":"yes","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"sort":"15","new_flag":"true","notes":"","publish_revisions":{"last_modified":"202102150938"},"lastTemplateUpdate":"1613381930570","tag_id":"1203"}},"privacy_management":{"useTemplate":"true"},"title":"Version 2021.02.15.0938","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","email":"caleb.jaquith@tealium.com","loadrules":{"2":{"0":{"operator_1":"equals_ignore_case","operator_0":"populated","input_0":"qp.adobe_template_version","filter_0":"","filter_1":"marketplace","input_1":"qp.adobe_template_version"},"id":"2","startDate":"------------","containerId":"loadrules_content_161338163774600019","title":"Adobe Marketplace Tag","initialize":"","labels":"","editable":"true","sort":"1","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"endDate":"------------","constructor":"","_id":"2","status":"active"},"3":{"0":{"filter_1":"fixed","filter_0":"","input_1":"qp.adobe_template_version","operator_0":"populated","input_0":"qp.adobe_template_version","operator_1":"equals_ignore_case"},"editable":"true","sort":"2","initialize":"","labels":"","_id":"3","status":"active","constructor":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"endDate":"------------","title":"Adobe Fixed Tag","containerId":"loadrules_content_161338163774700020","id":"3","startDate":"------------"},"4":{"0":{"operator_0":"populated","input_0":"qp.adobe_template_version","operator_1":"equals_ignore_case","input_1":"qp.adobe_template_version","filter_0":"","filter_1":"marketplace_latest"},"title":"Adobe Marketplace Latest Tag","containerId":"loadrules_content_161338163774800021","startDate":"------------","id":"4","editable":"true","sort":"3","labels":"","initialize":"","status":"active","_id":"4","constructor":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"endDate":"------------"},"5":{"0":{"operator_1":"equals_ignore_case","operator_0":"populated","input_0":"qp.adobe_template_version","filter_0":"","filter_1":"fixed_latest","input_1":"qp.adobe_template_version"},"endDate":"------------","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"5","status":"active","constructor":"","initialize":"","labels":"","sort":"4","editable":"true","startDate":"------------","id":"5","title":"Adobe Fixed Latest Tag","containerId":"loadrules_content_161338163774900022"},"6":{"0":{"filter_1":"/^(.*?)$/i","filter_0":"/^(?!(?:^(prdsupport.(tui|thomson|tuiholidays)prjuat\\.(co\\.uk|ie)|tuiretail.*|falconretail.*|inspire\\.content.*|tui\\.thomson|.*retailagents.*|.*tui.se.*|.*tui.no.*|.*tui.fi.*|.*tui.dk.*)$)$).*$/i","input_1":"dom.pathname","operator_1":"regular_expression","input_0":"dom.domain","operator_0":"regular_expression"},"startDate":"------------","id":"6","title":"All Brands - Web - Global - All Pages (Excluding PrdSupport, Retail, Inspire &amp; Nordics) [4885406]","containerId":"loadrules_content_161338163775100023","labels":"","initialize":"","sort":"5","editable":"true","endDate":"------------","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"constructor":"","status":"active","_id":"6"},"7":{"0":{"operator_1":"regular_expression","input_0":"dom.domain","operator_0":"regular_expression","input_2":"js.legacy_bookingReference","filter_1":"/^(\\/flight\\/book\\/confirmation\\/?)$/","filter_0":"/^(.*\\.(tui|falcon)holidaysprjuat\\.ie)$/","filter_2":"","operator_2":"populated","input_1":"dom.pathname"},"endDate":"------------","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"7","status":"active","constructor":"[object Object]","initialize":"","labels":"1,17,11,16,14,8,4,10,2","editable":"true","sort":"9","id":"7","startDate":"------------","containerId":"loadrules_content_161338163775600027","title":"TUI IE - Web - Dev - All Test Sites - Flights - Confirmation (With Data Definition) [4868458]"},"8":{"0":{"input_1":"dom.pathname","filter_2":"","operator_2":"populated","input_0":"dom.domain","operator_0":"regular_expression","operator_1":"regular_expression","input_2":"js.legacy_bookingReference","filter_1":"/^(\\/f\\/book\\/confirmation\\/?)$/","filter_0":"/^(.*\\.(tui|falcon)holidaysprjuat\\.ie)$/"},"id":"8","startDate":"------------","title":"TUI IE - Web - Dev - All Test Sites - Beach - Confirmation (With Data Definition) [4868457]","containerId":"loadrules_content_161338163775500026","labels":"17,11,16,14,8,5,10,2","initialize":"","sort":"8","editable":"true","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"endDate":"------------","constructor":"[object Object]","_id":"8","status":"active"},"9":{"0":{"input_1":"dom.pathname","operator_2":"populated","filter_2":"","filter_0":"/^(www\\.tuiholidays\\.ie)$/i","filter_1":"/^(\\/flight\\/book\\/(mobile\\/)?confirmation\\/?)$/i","input_2":"js.legacy_bookingReference","input_0":"dom.domain","operator_0":"regular_expression","operator_1":"regular_expression"},"title":"TUI IE - Web - Prod - Flights - Confirmation (With Data Definition) [4868452]","containerId":"loadrules_content_161338163775900029","startDate":"------------","id":"9","_id":"9","status":"active","constructor":"[object Object]","endDate":"------------","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"editable":"true","sort":"11","initialize":"","labels":"1,7,11,16,14,8,4,2"},"10":{"0":{"operator_1":"regular_expression","input_0":"dom.domain","operator_0":"regular_expression","input_2":"js.legacy_bookingReference","filter_0":"/^(www\\.(tui|falcon)holidays\\.ie)$/i","filter_1":"/^(\\/f\\/book\\/(mobile\\/)?confirmation\\/?)$/i","operator_2":"populated","filter_2":"","input_1":"dom.pathname"},"publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"endDate":"------------","constructor":"[object Object]","status":"active","_id":"10","labels":"7,11,16,14,8,5,2","initialize":"","editable":"true","sort":"10","startDate":"------------","id":"10","containerId":"loadrules_content_161338163775700028","title":"TUI IE - Web - Prod - Beach - Confirmation (With Data Definition) [4868451]"},"11":{"0":{"operator_0":"regular_expression","input_0":"dom.domain","operator_1":"regular_expression","input_1":"dom.pathname","filter_1":"/^(.*)$/i","filter_0":"/^(.*\\.firstchoiceprjuat\\.co\\.uk)$/i"},"containerId":"loadrules_content_161338163775200024","title":"FC - Web - Dev - All Test Sites - All Pages (Including Payment) [962796]","id":"11","editable":"true","sort":"6","labels":"13,9,17,16,15","_id":"11","status":"active","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"12":{"0":{"operator_0":"regular_expression","input_0":"dom.domain","filter_0":"/^(www\\.tui\\.co\\.uk)$/i"},"id":"12","title":"TUI UK - Web - Prod - All Pages (Excluding Payment Page) [686176]","containerId":"loadrules_content_161338163776300031","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"status":"active","_id":"12","labels":"7,12,16,6","editable":"true","sort":"13"},"13":{"0":{"filter_0":"/^(.*\\.tuiprjuat\\.co\\.uk)$/","filter_1":"/^(\\/?)/i","input_1":"dom.pathname","input_0":"dom.domain","operator_0":"regular_expression","operator_1":"regular_expression"},"containerId":"loadrules_content_161338163776000030","title":"TUI UK - Web - Dev - All Test Sites - All Pages (Including Payment) [664598]","id":"13","_id":"13","status":"active","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"editable":"true","sort":"12","labels":"12,17,16,15,10"},"14":{"0":{"input_1":"dom.pathname","filter_1":"/^(.*)/i","filter_0":"/^(www\\.firstchoice\\.co\\.uk)$/i","input_0":"dom.domain","operator_0":"regular_expression","operator_1":"regular_expression"},"title":"FC - Web - Prod - All Pages (Excluding Payment) [650480]","containerId":"loadrules_content_161338163775300025","id":"14","_id":"14","status":"active","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"editable":"true","sort":"7","labels":"3,7,16,6"},"15":{"0":{"operator_0":"populated","input_0":"js.fbPixelID","filter_0":""},"startDate":"------------","id":"15","title":"fbPixelID is populated","containerId":"loadrules_content_161338163776400032","labels":"","initialize":"","editable":"true","sort":"14","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"},"last_modified":"202102150938"},"endDate":"------------","constructor":"","_id":"15","status":"active"},"16":{"0":{"filter_0":"/^((www|st.*|hybd.*|prdsupport)\\.(tui|firstchoice|tuiholidays)(prjuat)?\\.(co\\.uk|ie))$/i","filter_1":"/^(.*)$/i","input_1":"dom.pathname","operator_1":"regular_expression","operator_0":"regular_expression","input_0":"dom.domain"},"editable":"true","sort":"15","initialize":"","labels":"25,16,24,6","status":"active","_id":"16","constructor":"","endDate":"------------","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"}},"title":"All Brands - Web - Global - All Pages (Excluding Payment)","containerId":"loadrules_content_161338163776500033","id":"16","startDate":"------------"}},"customizations":{"10":{"notes":"_","sort":"0","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"_id":"10","extType":"Javascript Code","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"type":"new","blockPubTargetsLogic":"true","publishedTargets":"dev","initialize":"","labels":"","codeDevData":{"queueSeq":"3","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"name":"Draft 1","code":"// Preloader\n\n// disable the automatic view, we want to fire it from the listener instead\nwindow.utag_cfg_ovrd = window.utag_cfg_ovrd || {};\nwindow.utag_cfg_ovrd.noview = true;","updatedBy":"venera.kozueva@tealium.com","updateDate":"202010160948","creationDate":"202010160948"}},"draftSeq":"1","promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"name":"dev","code":"// Preloader\n\n// disable the automatic view, we want to fire it from the listener instead\nwindow.utag_cfg_ovrd = window.utag_cfg_ovrd || {};\nwindow.utag_cfg_ovrd.noview = true;","promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202101151252","promotedDraftName":"Draft 1"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"code":"// Preloader\n\n// disable the automatic view, we want to fire it from the listener instead\nwindow.utag_cfg_ovrd = window.utag_cfg_ovrd || {};\nwindow.utag_cfg_ovrd.noview = true;","name":"qa","promotedDraftName":"Draft 1","promotedTimestamp":"202101151252","promotedBy":"caleb.jaquith@tealium.com"},"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"name":"prod","code":"// Preloader\n\n// disable the automatic view, we want to fire it from the listener instead\nwindow.utag_cfg_ovrd = window.utag_cfg_ovrd || {};\nwindow.utag_cfg_ovrd.noview = true;","promotedBy":"caleb.jaquith@tealium.com","promotedDraftName":"Draft 1","promotedTimestamp":"202101151252"}}},"status":"active","scope":"preload","constructor":"","advExecOption":"alr","title":"GTM Listener (1/5) - Disable automatic utag.view call","id":"100040"},"11":{"id":"100040","title":"GTM Listener (2/5) - Data Layer Helper Library (provided by Google)","advExecOption":"alr","scope":"domready","constructor":"","status":"active","labels":"","codeDevData":{"draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"updatedBy":"caleb.jaquith@tealium.com","creationDate":"202010160948","updateDate":"202101061308","name":"Draft 1","code":"/**\n * Scope       : DOM Ready\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Data Layer Helper Library (provided by Google), makes it easy to queue \n *               events. We use it here to process existing GTM Events for Collect\n * \n * Documentation: https://github.com/google/data-layer-helper\n * Source: https://raw.githubusercontent.com/google/data-layer-helper/master/dist/data-layer-helper.js\n *\n*/\n\n(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\n'use strict';function f(b,a){switch(a){case 1:console.log(b);break;case 2:console.warn(b);break;case 3:console.error(b)}};/*\n jQuery v1.9.1 (c) 2005, 2012\n jQuery Foundation, Inc. jquery.org/license.\n*/\nvar g=/\\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\\]/;function l(b){return null==b?String(b):(b=g.exec(Object.prototype.toString.call(Object(b))))?b[1].toLowerCase():&quot;object&quot;}function n(b,a){return Object.prototype.hasOwnProperty.call(Object(b),a)}function p(b){if(!b||&quot;object&quot;!=l(b)||b.nodeType||b==b.window)return!1;try{if(b.constructor&amp;&amp;!n(b,&quot;constructor&quot;)&amp;&amp;!n(b.constructor.prototype,&quot;isPrototypeOf&quot;))return!1}catch(c){return!1}for(var a in b);return void 0===a||n(b,a)};function q(b,a){var c={},d=c;b=b.split(&quot;.&quot;);for(var e=0;e&lt;b.length-1;e++)d=d[b[e]]={};d[b[b.length-1]]=a;return c}function r(b,a){var c=!b._clear,d;for(d in b)if(n(b,d)){var e=b[d];&quot;array&quot;===l(e)&amp;&amp;c?(&quot;array&quot;===l(a[d])||(a[d]=[]),r(e,a[d])):p(e)&amp;&amp;c?(p(a[d])||(a[d]={}),r(e,a[d])):a[d]=e}delete a._clear};/*\n Copyright 2012 Google Inc. All rights reserved. */\nfunction t(b,a,c){a=void 0===a?{}:a;c=void 0===c?!1:c;&quot;function&quot;===typeof a?(f(&quot;Legacy constructor was used. See README for latest usage.&quot;,2),a={listener:a,listenToPast:c,processNow:!0,commandProcessors:{}}):a={listener:a.listener||function(){},listenToPast:a.listenToPast||!1,processNow:void 0===a.processNow?!0:a.processNow,commandProcessors:a.commandProcessors||{}};this.a=b;this.l=a.listener;this.j=a.listenToPast;this.g=this.h=!1;this.c={};this.f=[];this.b=a.commandProcessors;this.i=w(this);var d=\nthis.a.push,e=this;this.a.push=function(){var h=[].slice.call(arguments,0),m=d.apply(e.a,h);x(e,h);return m};a.processNow&amp;&amp;this.process()}\nt.prototype.process=function(){this.h&amp;&amp;f(&quot;Process has already been run. This method should only run a single time to prepare the helper.&quot;,3);this.registerProcessor(&quot;set&quot;,function(){var c={};1===arguments.length&amp;&amp;&quot;object&quot;===l(arguments[0])?c=arguments[0]:2===arguments.length&amp;&amp;&quot;string&quot;===l(arguments[0])&amp;&amp;(c=q(arguments[0],arguments[1]));return c});this.h=!0;for(var b=this.a.length,a=0;a&lt;b;a++)x(this,[this.a[a]],!this.j)};\nt.prototype.get=function(b){var a=this.c;b=b.split(&quot;.&quot;);for(var c=0;c&lt;b.length;c++){if(void 0===a[b[c]])return;a=a[b[c]]}return a};t.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};r(this.c,this.a[0])};t.prototype.registerProcessor=function(b,a){b in this.b||(this.b[b]=[]);this.b[b].push(a)};\nfunction x(b,a,c){c=void 0===c?!1:c;if(b.h&amp;&amp;(b.f.push.apply(b.f,a),!b.g))for(;0&lt;b.f.length;){a=b.f.shift();if(&quot;array&quot;===l(a))a:{var d=b.c;&quot;string&quot;===l(a[0])||f(&quot;Error processing command, no command was run. The first argument must be of type string, but was of type &quot;+(typeof a[0]+&quot;.\\nThe command run was &quot;+a),2);for(var e=a[0].split(&quot;.&quot;),h=e.pop(),m=a.slice(1),k=0;k&lt;e.length;k++){if(void 0===d[e[k]]){f(&quot;Error processing command, no command was run as the object at &quot;+(e+&quot; was undefined.\\nThe command run was &quot;+\na),2);break a}d=d[e[k]]}try{d[h].apply(d,m)}catch(u){f(&quot;An exception was thrown by the method &quot;+(h+&quot;, so no command was run.\\nThe method was called on the data layer object at the location &quot;)+(e+&quot;.&quot;),3)}}else if(&quot;arguments&quot;===l(a)){e=b;h=[];m=a[0];if(e.b[m])for(d=e.b[m].length,k=0;k&lt;d;k++)h.push(e.b[m][k].apply(e.i,[].slice.call(a,1)));b.f.push.apply(b.f,h)}else if(&quot;function&quot;==typeof a)try{a.call(b.i)}catch(u){f(&quot;An exception was thrown when running the method &quot;+(a+&quot;, execution was skipped.&quot;),3),\nf(u,3)}else if(p(a))for(var v in a)r(q(v,a[v]),b.c);else continue;c||(b.g=!0,b.l(b.c,a),b.g=!1)}}t.prototype.registerProcessor=t.prototype.registerProcessor;t.prototype.flatten=t.prototype.flatten;t.prototype.get=t.prototype.get;t.prototype.process=t.prototype.process;window.DataLayerHelper=t;function w(b){return{set:function(a,c){r(q(a,c),b.c)},get:function(a){return b.get(a)}}};})();"}},"queueSeq":"5","promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"name":"dev","code":"/**\n * Scope       : DOM Ready\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Data Layer Helper Library (provided by Google), makes it easy to queue \n *               events. We use it here to process existing GTM Events for Collect\n * \n * Documentation: https://github.com/google/data-layer-helper\n * Source: https://raw.githubusercontent.com/google/data-layer-helper/master/dist/data-layer-helper.js\n *\n*/\n\n(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\n'use strict';function f(b,a){switch(a){case 1:console.log(b);break;case 2:console.warn(b);break;case 3:console.error(b)}};/*\n jQuery v1.9.1 (c) 2005, 2012\n jQuery Foundation, Inc. jquery.org/license.\n*/\nvar g=/\\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\\]/;function l(b){return null==b?String(b):(b=g.exec(Object.prototype.toString.call(Object(b))))?b[1].toLowerCase():&quot;object&quot;}function n(b,a){return Object.prototype.hasOwnProperty.call(Object(b),a)}function p(b){if(!b||&quot;object&quot;!=l(b)||b.nodeType||b==b.window)return!1;try{if(b.constructor&amp;&amp;!n(b,&quot;constructor&quot;)&amp;&amp;!n(b.constructor.prototype,&quot;isPrototypeOf&quot;))return!1}catch(c){return!1}for(var a in b);return void 0===a||n(b,a)};function q(b,a){var c={},d=c;b=b.split(&quot;.&quot;);for(var e=0;e&lt;b.length-1;e++)d=d[b[e]]={};d[b[b.length-1]]=a;return c}function r(b,a){var c=!b._clear,d;for(d in b)if(n(b,d)){var e=b[d];&quot;array&quot;===l(e)&amp;&amp;c?(&quot;array&quot;===l(a[d])||(a[d]=[]),r(e,a[d])):p(e)&amp;&amp;c?(p(a[d])||(a[d]={}),r(e,a[d])):a[d]=e}delete a._clear};/*\n Copyright 2012 Google Inc. All rights reserved. */\nfunction t(b,a,c){a=void 0===a?{}:a;c=void 0===c?!1:c;&quot;function&quot;===typeof a?(f(&quot;Legacy constructor was used. See README for latest usage.&quot;,2),a={listener:a,listenToPast:c,processNow:!0,commandProcessors:{}}):a={listener:a.listener||function(){},listenToPast:a.listenToPast||!1,processNow:void 0===a.processNow?!0:a.processNow,commandProcessors:a.commandProcessors||{}};this.a=b;this.l=a.listener;this.j=a.listenToPast;this.g=this.h=!1;this.c={};this.f=[];this.b=a.commandProcessors;this.i=w(this);var d=\nthis.a.push,e=this;this.a.push=function(){var h=[].slice.call(arguments,0),m=d.apply(e.a,h);x(e,h);return m};a.processNow&amp;&amp;this.process()}\nt.prototype.process=function(){this.h&amp;&amp;f(&quot;Process has already been run. This method should only run a single time to prepare the helper.&quot;,3);this.registerProcessor(&quot;set&quot;,function(){var c={};1===arguments.length&amp;&amp;&quot;object&quot;===l(arguments[0])?c=arguments[0]:2===arguments.length&amp;&amp;&quot;string&quot;===l(arguments[0])&amp;&amp;(c=q(arguments[0],arguments[1]));return c});this.h=!0;for(var b=this.a.length,a=0;a&lt;b;a++)x(this,[this.a[a]],!this.j)};\nt.prototype.get=function(b){var a=this.c;b=b.split(&quot;.&quot;);for(var c=0;c&lt;b.length;c++){if(void 0===a[b[c]])return;a=a[b[c]]}return a};t.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};r(this.c,this.a[0])};t.prototype.registerProcessor=function(b,a){b in this.b||(this.b[b]=[]);this.b[b].push(a)};\nfunction x(b,a,c){c=void 0===c?!1:c;if(b.h&amp;&amp;(b.f.push.apply(b.f,a),!b.g))for(;0&lt;b.f.length;){a=b.f.shift();if(&quot;array&quot;===l(a))a:{var d=b.c;&quot;string&quot;===l(a[0])||f(&quot;Error processing command, no command was run. The first argument must be of type string, but was of type &quot;+(typeof a[0]+&quot;.\\nThe command run was &quot;+a),2);for(var e=a[0].split(&quot;.&quot;),h=e.pop(),m=a.slice(1),k=0;k&lt;e.length;k++){if(void 0===d[e[k]]){f(&quot;Error processing command, no command was run as the object at &quot;+(e+&quot; was undefined.\\nThe command run was &quot;+\na),2);break a}d=d[e[k]]}try{d[h].apply(d,m)}catch(u){f(&quot;An exception was thrown by the method &quot;+(h+&quot;, so no command was run.\\nThe method was called on the data layer object at the location &quot;)+(e+&quot;.&quot;),3)}}else if(&quot;arguments&quot;===l(a)){e=b;h=[];m=a[0];if(e.b[m])for(d=e.b[m].length,k=0;k&lt;d;k++)h.push(e.b[m][k].apply(e.i,[].slice.call(a,1)));b.f.push.apply(b.f,h)}else if(&quot;function&quot;==typeof a)try{a.call(b.i)}catch(u){f(&quot;An exception was thrown when running the method &quot;+(a+&quot;, execution was skipped.&quot;),3),\nf(u,3)}else if(p(a))for(var v in a)r(q(v,a[v]),b.c);else continue;c||(b.g=!0,b.l(b.c,a),b.g=!1)}}t.prototype.registerProcessor=t.prototype.registerProcessor;t.prototype.flatten=t.prototype.flatten;t.prototype.get=t.prototype.get;t.prototype.process=t.prototype.process;window.DataLayerHelper=t;function w(b){return{set:function(a,c){r(q(a,c),b.c)},get:function(a){return b.get(a)}}};})();","promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202101151252","promotedDraftName":"Draft 1"},"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"name":"prod","code":"/**\n * Scope       : DOM Ready\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Data Layer Helper Library (provided by Google), makes it easy to queue \n *               events. We use it here to process existing GTM Events for Collect\n * \n * Documentation: https://github.com/google/data-layer-helper\n * Source: https://raw.githubusercontent.com/google/data-layer-helper/master/dist/data-layer-helper.js\n *\n*/\n\n(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\n'use strict';function f(b,a){switch(a){case 1:console.log(b);break;case 2:console.warn(b);break;case 3:console.error(b)}};/*\n jQuery v1.9.1 (c) 2005, 2012\n jQuery Foundation, Inc. jquery.org/license.\n*/\nvar g=/\\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\\]/;function l(b){return null==b?String(b):(b=g.exec(Object.prototype.toString.call(Object(b))))?b[1].toLowerCase():&quot;object&quot;}function n(b,a){return Object.prototype.hasOwnProperty.call(Object(b),a)}function p(b){if(!b||&quot;object&quot;!=l(b)||b.nodeType||b==b.window)return!1;try{if(b.constructor&amp;&amp;!n(b,&quot;constructor&quot;)&amp;&amp;!n(b.constructor.prototype,&quot;isPrototypeOf&quot;))return!1}catch(c){return!1}for(var a in b);return void 0===a||n(b,a)};function q(b,a){var c={},d=c;b=b.split(&quot;.&quot;);for(var e=0;e&lt;b.length-1;e++)d=d[b[e]]={};d[b[b.length-1]]=a;return c}function r(b,a){var c=!b._clear,d;for(d in b)if(n(b,d)){var e=b[d];&quot;array&quot;===l(e)&amp;&amp;c?(&quot;array&quot;===l(a[d])||(a[d]=[]),r(e,a[d])):p(e)&amp;&amp;c?(p(a[d])||(a[d]={}),r(e,a[d])):a[d]=e}delete a._clear};/*\n Copyright 2012 Google Inc. All rights reserved. */\nfunction t(b,a,c){a=void 0===a?{}:a;c=void 0===c?!1:c;&quot;function&quot;===typeof a?(f(&quot;Legacy constructor was used. See README for latest usage.&quot;,2),a={listener:a,listenToPast:c,processNow:!0,commandProcessors:{}}):a={listener:a.listener||function(){},listenToPast:a.listenToPast||!1,processNow:void 0===a.processNow?!0:a.processNow,commandProcessors:a.commandProcessors||{}};this.a=b;this.l=a.listener;this.j=a.listenToPast;this.g=this.h=!1;this.c={};this.f=[];this.b=a.commandProcessors;this.i=w(this);var d=\nthis.a.push,e=this;this.a.push=function(){var h=[].slice.call(arguments,0),m=d.apply(e.a,h);x(e,h);return m};a.processNow&amp;&amp;this.process()}\nt.prototype.process=function(){this.h&amp;&amp;f(&quot;Process has already been run. This method should only run a single time to prepare the helper.&quot;,3);this.registerProcessor(&quot;set&quot;,function(){var c={};1===arguments.length&amp;&amp;&quot;object&quot;===l(arguments[0])?c=arguments[0]:2===arguments.length&amp;&amp;&quot;string&quot;===l(arguments[0])&amp;&amp;(c=q(arguments[0],arguments[1]));return c});this.h=!0;for(var b=this.a.length,a=0;a&lt;b;a++)x(this,[this.a[a]],!this.j)};\nt.prototype.get=function(b){var a=this.c;b=b.split(&quot;.&quot;);for(var c=0;c&lt;b.length;c++){if(void 0===a[b[c]])return;a=a[b[c]]}return a};t.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};r(this.c,this.a[0])};t.prototype.registerProcessor=function(b,a){b in this.b||(this.b[b]=[]);this.b[b].push(a)};\nfunction x(b,a,c){c=void 0===c?!1:c;if(b.h&amp;&amp;(b.f.push.apply(b.f,a),!b.g))for(;0&lt;b.f.length;){a=b.f.shift();if(&quot;array&quot;===l(a))a:{var d=b.c;&quot;string&quot;===l(a[0])||f(&quot;Error processing command, no command was run. The first argument must be of type string, but was of type &quot;+(typeof a[0]+&quot;.\\nThe command run was &quot;+a),2);for(var e=a[0].split(&quot;.&quot;),h=e.pop(),m=a.slice(1),k=0;k&lt;e.length;k++){if(void 0===d[e[k]]){f(&quot;Error processing command, no command was run as the object at &quot;+(e+&quot; was undefined.\\nThe command run was &quot;+\na),2);break a}d=d[e[k]]}try{d[h].apply(d,m)}catch(u){f(&quot;An exception was thrown by the method &quot;+(h+&quot;, so no command was run.\\nThe method was called on the data layer object at the location &quot;)+(e+&quot;.&quot;),3)}}else if(&quot;arguments&quot;===l(a)){e=b;h=[];m=a[0];if(e.b[m])for(d=e.b[m].length,k=0;k&lt;d;k++)h.push(e.b[m][k].apply(e.i,[].slice.call(a,1)));b.f.push.apply(b.f,h)}else if(&quot;function&quot;==typeof a)try{a.call(b.i)}catch(u){f(&quot;An exception was thrown when running the method &quot;+(a+&quot;, execution was skipped.&quot;),3),\nf(u,3)}else if(p(a))for(var v in a)r(q(v,a[v]),b.c);else continue;c||(b.g=!0,b.l(b.c,a),b.g=!1)}}t.prototype.registerProcessor=t.prototype.registerProcessor;t.prototype.flatten=t.prototype.flatten;t.prototype.get=t.prototype.get;t.prototype.process=t.prototype.process;window.DataLayerHelper=t;function w(b){return{set:function(a,c){r(q(a,c),b.c)},get:function(a){return b.get(a)}}};})();","promotedBy":"caleb.jaquith@tealium.com","promotedDraftName":"Draft 1","promotedTimestamp":"202101151252"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"promotedDraftName":"Draft 1","promotedTimestamp":"202101151252","promotedBy":"caleb.jaquith@tealium.com","code":"/**\n * Scope       : DOM Ready\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Data Layer Helper Library (provided by Google), makes it easy to queue \n *               events. We use it here to process existing GTM Events for Collect\n * \n * Documentation: https://github.com/google/data-layer-helper\n * Source: https://raw.githubusercontent.com/google/data-layer-helper/master/dist/data-layer-helper.js\n *\n*/\n\n(function(){/*\n\n Copyright The Closure Library Authors.\n SPDX-License-Identifier: Apache-2.0\n*/\n'use strict';function f(b,a){switch(a){case 1:console.log(b);break;case 2:console.warn(b);break;case 3:console.error(b)}};/*\n jQuery v1.9.1 (c) 2005, 2012\n jQuery Foundation, Inc. jquery.org/license.\n*/\nvar g=/\\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\\]/;function l(b){return null==b?String(b):(b=g.exec(Object.prototype.toString.call(Object(b))))?b[1].toLowerCase():&quot;object&quot;}function n(b,a){return Object.prototype.hasOwnProperty.call(Object(b),a)}function p(b){if(!b||&quot;object&quot;!=l(b)||b.nodeType||b==b.window)return!1;try{if(b.constructor&amp;&amp;!n(b,&quot;constructor&quot;)&amp;&amp;!n(b.constructor.prototype,&quot;isPrototypeOf&quot;))return!1}catch(c){return!1}for(var a in b);return void 0===a||n(b,a)};function q(b,a){var c={},d=c;b=b.split(&quot;.&quot;);for(var e=0;e&lt;b.length-1;e++)d=d[b[e]]={};d[b[b.length-1]]=a;return c}function r(b,a){var c=!b._clear,d;for(d in b)if(n(b,d)){var e=b[d];&quot;array&quot;===l(e)&amp;&amp;c?(&quot;array&quot;===l(a[d])||(a[d]=[]),r(e,a[d])):p(e)&amp;&amp;c?(p(a[d])||(a[d]={}),r(e,a[d])):a[d]=e}delete a._clear};/*\n Copyright 2012 Google Inc. All rights reserved. */\nfunction t(b,a,c){a=void 0===a?{}:a;c=void 0===c?!1:c;&quot;function&quot;===typeof a?(f(&quot;Legacy constructor was used. See README for latest usage.&quot;,2),a={listener:a,listenToPast:c,processNow:!0,commandProcessors:{}}):a={listener:a.listener||function(){},listenToPast:a.listenToPast||!1,processNow:void 0===a.processNow?!0:a.processNow,commandProcessors:a.commandProcessors||{}};this.a=b;this.l=a.listener;this.j=a.listenToPast;this.g=this.h=!1;this.c={};this.f=[];this.b=a.commandProcessors;this.i=w(this);var d=\nthis.a.push,e=this;this.a.push=function(){var h=[].slice.call(arguments,0),m=d.apply(e.a,h);x(e,h);return m};a.processNow&amp;&amp;this.process()}\nt.prototype.process=function(){this.h&amp;&amp;f(&quot;Process has already been run. This method should only run a single time to prepare the helper.&quot;,3);this.registerProcessor(&quot;set&quot;,function(){var c={};1===arguments.length&amp;&amp;&quot;object&quot;===l(arguments[0])?c=arguments[0]:2===arguments.length&amp;&amp;&quot;string&quot;===l(arguments[0])&amp;&amp;(c=q(arguments[0],arguments[1]));return c});this.h=!0;for(var b=this.a.length,a=0;a&lt;b;a++)x(this,[this.a[a]],!this.j)};\nt.prototype.get=function(b){var a=this.c;b=b.split(&quot;.&quot;);for(var c=0;c&lt;b.length;c++){if(void 0===a[b[c]])return;a=a[b[c]]}return a};t.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};r(this.c,this.a[0])};t.prototype.registerProcessor=function(b,a){b in this.b||(this.b[b]=[]);this.b[b].push(a)};\nfunction x(b,a,c){c=void 0===c?!1:c;if(b.h&amp;&amp;(b.f.push.apply(b.f,a),!b.g))for(;0&lt;b.f.length;){a=b.f.shift();if(&quot;array&quot;===l(a))a:{var d=b.c;&quot;string&quot;===l(a[0])||f(&quot;Error processing command, no command was run. The first argument must be of type string, but was of type &quot;+(typeof a[0]+&quot;.\\nThe command run was &quot;+a),2);for(var e=a[0].split(&quot;.&quot;),h=e.pop(),m=a.slice(1),k=0;k&lt;e.length;k++){if(void 0===d[e[k]]){f(&quot;Error processing command, no command was run as the object at &quot;+(e+&quot; was undefined.\\nThe command run was &quot;+\na),2);break a}d=d[e[k]]}try{d[h].apply(d,m)}catch(u){f(&quot;An exception was thrown by the method &quot;+(h+&quot;, so no command was run.\\nThe method was called on the data layer object at the location &quot;)+(e+&quot;.&quot;),3)}}else if(&quot;arguments&quot;===l(a)){e=b;h=[];m=a[0];if(e.b[m])for(d=e.b[m].length,k=0;k&lt;d;k++)h.push(e.b[m][k].apply(e.i,[].slice.call(a,1)));b.f.push.apply(b.f,h)}else if(&quot;function&quot;==typeof a)try{a.call(b.i)}catch(u){f(&quot;An exception was thrown when running the method &quot;+(a+&quot;, execution was skipped.&quot;),3),\nf(u,3)}else if(p(a))for(var v in a)r(q(v,a[v]),b.c);else continue;c||(b.g=!0,b.l(b.c,a),b.g=!1)}}t.prototype.registerProcessor=t.prototype.registerProcessor;t.prototype.flatten=t.prototype.flatten;t.prototype.get=t.prototype.get;t.prototype.process=t.prototype.process;window.DataLayerHelper=t;function w(b){return{set:function(a,c){r(q(a,c),b.c)},get:function(a){return b.get(a)}}};})();","name":"qa"}},"draftSeq":"0"},"initialize":"","publishedTargets":"dev","blockPubTargetsLogic":"true","type":"new","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"extType":"Javascript Code","_id":"11","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"sort":"25","notes":""},"12":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"12","extType":"Javascript Code","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"notes":"Changes  made to the following functions to handle array type data:\n1) teal.processDataArray \n2) teal.processDataObject \nEXAMPLE dataLayer[0].basket.items.subItems ","sort":"26","publishedTargets":"dev","blockPubTargetsLogic":"true","type":"new","advExecOption":"alr","status":"active","scope":"domready","constructor":"","labels":"","codeDevData":{"draftSeq":"2","promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"code":"// Flattener, pulled from https://tags.tiqcdn.com/utag/tealium-solutions/main/prod/utag.9.js as instructed by\n// https://community.tealiumiq.com/t5/iQ-Tag-Management/Data-Layer-Converter/ta-p/17581#toc-hId-1329378795\n\n//Define the teal global namespace\nwindow.teal = window.teal || {};\nteal.ignore_keys = {};\nteal.replace_keys = {};\nteal.prefix = &quot;&quot;;\n\n//In cases of a nested object, what should join the parent key and child key\nteal.nested_delimiter = &quot;.&quot;;\n\n//Ignore keys in the data layer that start with the following text.\n//Expecting an object of strings\n/*\nteal.ignore_keys = {\n  &quot;user&quot; : 1,\n  &quot;util&quot; : 1\n};\n*/\n\n//Specify a prefix for data layer elements being sent to the utag_data object.\n//Instead of utag_data.productID, it could be utag_data.dl_productID\n// teal.prefix = &quot;dl.&quot;;\n\n//Keys to be removed from the new flattened key name\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pi.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;pi&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.pageName\n/* teal.replace_keys = {\n    &quot;page&quot;:&quot;&quot;,\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n/*****************DO NOT MODIFY BELOW***********************/\n\nteal.flattener_version = 1.4;\n\n// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n// Add the Object.keys method for older versions of IE\nObject.keys||(Object.keys=function(){&quot;use strict&quot;;var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable(&quot;toString&quot;),c=[&quot;toString&quot;,&quot;toLocaleString&quot;,&quot;valueOf&quot;,&quot;hasOwnProperty&quot;,&quot;isPrototypeOf&quot;,&quot;propertyIsEnumerable&quot;,&quot;constructor&quot;],d=c.length;return function(e){if(&quot;object&quot;!=typeof e&amp;&amp;(&quot;function&quot;!=typeof e||null===e))throw new TypeError(&quot;Object.keys called on non-object&quot;);var g,h,f=[];for(g in e)a.call(e,g)&amp;&amp;f.push(g);if(b)for(h=0;h&lt;d;h++)a.call(e,c[h])&amp;&amp;f.push(c[h]);return f}}());\n\nteal.ignoreKey = function(key,re){\n  var should_ignore_key = 0;\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.ignore_keys_list === 'undefined'){\n    teal.ignore_keys_list = Object.keys(teal.ignore_keys);\n    teal.ignore_keys_list.forEach(function(name){\n      //Store a copy of the regex in the object\n      teal.ignore_keys[name] = new RegExp(&quot;^&quot;+name);\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }else{\n    //Loop through the ignore_keys object to see if we should ignore this key\n    teal.ignore_keys_list.forEach(function(name){\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }\n  return should_ignore_key;\n}\n\nteal.getKeyName = function(key,re){\n  //Create a new object to store regexs or use existing one\n  teal.replace_keys_regex = teal.replace_keys_regex || {};\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.replace_keys_list === 'undefined'){\n    teal.replace_keys_list = Object.keys(teal.replace_keys);\n    //Make a start of string and end of string regex\n    teal.replace_keys_regex.startOfString = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n    teal.replace_keys_regex.endOfString = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n    teal.replace_keys_list.forEach(function(name){\n      //Store a copy of the regex in the teal.replace_keys_regex object so that the regexs are only built once\n      teal.replace_keys_regex[name] = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]?&quot; + name + &quot;[&quot; + teal.nested_delimiter + &quot;]?&quot;, &quot;g&quot;);\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }else{\n    //Loop through the replace_keys object to see what we should be replacing\n    teal.replace_keys_list.forEach(function(name){\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }\n  return key;\n}\n\nteal.keyReplace = function(key,name,re){\n  //Check to see if we are replacing the key name with a new value or if we are removing the key altogether\n  if(teal.replace_keys[name] === ''){\n    //The key needs to be removed completely\n    key = key.replace(re,teal.nested_delimiter);\n    //Check to see if the key starts with the nested delimiter and if so, remove it\n    if(key.indexOf(teal.nested_delimiter) === 0){\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }else{\n    //Make a copy of the original key to see how we need to update the key name\n    var origKey = key;\n    //Replace the key name\n    key = key.replace(re,teal.nested_delimiter + teal.replace_keys[name] + teal.nested_delimiter);\n    //Check for the start of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.startOfString)){\n      //Remove the nested delimiter from the start of the string\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n    //Check for the end of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.endOfString)){\n      //Add the nested delimiter to the end of the string\n      var cleanRegEx = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }\n  return key;\n}\n\nteal.processDataObject = function(obj,new_obj,parent_key,create_array){\n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else{\n    //Add the nested_delimiter to the parent key if the delimiter isn't already at the end\n    teal.nested_delimiter_regex = teal.nested_delimiter_regex || new RegExp(&quot;[&quot;+teal.nested_delimiter+&quot;]$&quot;);\n    if(!parent_key.match(teal.nested_delimiter_regex)){\n      parent_key += &quot;&quot;+teal.nested_delimiter;\n    }\n  }\n  Object.keys(obj).forEach(function(key){\n    var nested_key_name = parent_key+key;\n    //Format the new key name and take out any whitespace\n    var new_key_name = teal.getKeyName((teal.prefix+parent_key+key).replace(/\\s/g, ''));\n    //Set the key_type to limit the number of typeof checks\n    var key_type = teal.typeOf(obj[key]);\n    if(key_type !== 'undefined' &amp;&amp; key_type != null){\n      if(key_type.match(/boolean|string|number|date/) &amp;&amp; !teal.ignoreKey(key)){\n        //If obj[key] is a date, convert to ISOString\n        if(teal.typeOf(obj[key]) === 'date'){\n          obj[key] = obj[key].toISOString();\n        }\n        //Check to see if we need to create an array for this data point\n        if(create_array){\n          //First check to see if this key exists\n          if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n            //Make the key an array                       \n            new_obj[new_key_name] = [];\n          }\n          new_obj[new_key_name].push(&quot;&quot;+obj[key]); //Force value to be a string\n        }else{\n          //If the value of the key is a boolean or a string or a number and \n          //the key shouldn't be ignored add to the data layer\n          new_obj[new_key_name] = &quot;&quot;+obj[key]; //Force value to be a string\n        }\n      }else if(key_type === 'object' &amp;&amp; !teal.ignoreKey(key)){\n        //Process this piece of the data layer and merge it\n        teal.processDataObject(obj[key],new_obj,nested_key_name,create_array);\n      }else if(key_type === 'array'){\n        teal.processDataArray(obj[key],new_obj,nested_key_name);\n      }\n    }\n  });\n}\n\nteal.processDataArray = function(obj,new_obj,parent_key){\n  var objLength = obj.length; \n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else if(objLength &gt; 0 &amp;&amp; teal.typeOf(obj[0]).match(/boolean|string|number|date/)){\n    //This is a normal array that doesn't need a nested delimiter\n  }else{\n    //Add the nested_delimiter to the parent key\n    parent_key += &quot;&quot;+teal.nested_delimiter;\n  }\n  //Format the new key name and take out any whitespace\n  var new_key_name = teal.getKeyName((teal.prefix+parent_key).replace(/\\s/g, ''));\n  for(var n = 0; n &lt; objLength; n++){\n    var key_type = teal.typeOf(obj[n]);\n    if(key_type.match(/boolean|string|number|date/)){\n      //If obj[n] is a date, convert to ISOString\n      if(key_type === 'date'){\n        obj[n] = obj[n].toISOString();\n      }\n      //First check to see if this key exists\n      if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n        //Make the key an array                       \n        new_obj[new_key_name] = [];\n      }\n      //If the value of the key is a boolean or a string or a number and \n      //the key shouldn't be ignored add to the data layer                        \n      new_obj[new_key_name].push(&quot;&quot;+obj[n]);\n    }else if(key_type === 'object'){\n      teal.processDataObject(obj[n],new_obj,new_key_name,1);\n    }\n  }\n}\n\nteal.typeOf = function(e){return ({}).toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();}\n\nteal.flattenObject = function(obj,new_obj){\n  //Make sure object exists\n  if(typeof obj === 'undefined'){\n    return false;\n  }\n  //Check to see if we want to flatten the same object and keep the reference\n  var mergeObject = false;\n  if(obj === new_obj){\n    mergeObject = true;\n    //Start off a clean copy of the object\n    new_obj = {};\n  }\n  //Make sure new object exists\n  if(typeof new_obj === 'undefined'){\n    new_obj = {};\n  }\n  //Check to see if this object is an array\n  if(teal.typeOf(obj) === 'array'){\n    //Store a safe copy of this object in case we are processing the b object\n    var temp_array = JSON.parse(JSON.stringify(obj));\n    var temp_array_length = temp_array.length;\n    //Clean up the object\n    obj = {};\n    //Let's see if the obj and new_obj are the same.  If so, going to assume we are using the b object\n    if(obj == new_obj){\n      //Let's ensure that we have the a object\n      if(typeof a === 'undefined'){\n        var a = 'view';\n      }\n      //Add the automatic utag data points\n      utag.loader.RD(new_obj,a);\n    }\n    for(var i = 0; i &lt; temp_array_length; i++){\n        teal.processDataObject(temp_array[i],new_obj);\n    }\n  }else{\n    teal.processDataObject(obj,new_obj);\n  }\n  if(mergeObject){\n    //Need to delete everything out of obj and replace with new_obj\n    Object.keys(obj).forEach(function(key){\n      delete obj[key];\n    });\n    //Now that we have a clean original object, add everything from new_obj which allows the reference to be kept\n    Object.keys(new_obj).forEach(function(key){\n      obj[key] = new_obj[key];\n    });\n  }\n\n  return new_obj;\n}","name":"dev","promotedTimestamp":"202101151252","promotedDraftName":"default","promotedBy":"caleb.jaquith@tealium.com"},"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202101151252","promotedDraftName":"default","name":"prod","code":"// Flattener, pulled from https://tags.tiqcdn.com/utag/tealium-solutions/main/prod/utag.9.js as instructed by\n// https://community.tealiumiq.com/t5/iQ-Tag-Management/Data-Layer-Converter/ta-p/17581#toc-hId-1329378795\n\n//Define the teal global namespace\nwindow.teal = window.teal || {};\nteal.ignore_keys = {};\nteal.replace_keys = {};\nteal.prefix = &quot;&quot;;\n\n//In cases of a nested object, what should join the parent key and child key\nteal.nested_delimiter = &quot;.&quot;;\n\n//Ignore keys in the data layer that start with the following text.\n//Expecting an object of strings\n/*\nteal.ignore_keys = {\n  &quot;user&quot; : 1,\n  &quot;util&quot; : 1\n};\n*/\n\n//Specify a prefix for data layer elements being sent to the utag_data object.\n//Instead of utag_data.productID, it could be utag_data.dl_productID\n// teal.prefix = &quot;dl.&quot;;\n\n//Keys to be removed from the new flattened key name\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pi.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;pi&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.pageName\n/* teal.replace_keys = {\n    &quot;page&quot;:&quot;&quot;,\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n/*****************DO NOT MODIFY BELOW***********************/\n\nteal.flattener_version = 1.4;\n\n// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n// Add the Object.keys method for older versions of IE\nObject.keys||(Object.keys=function(){&quot;use strict&quot;;var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable(&quot;toString&quot;),c=[&quot;toString&quot;,&quot;toLocaleString&quot;,&quot;valueOf&quot;,&quot;hasOwnProperty&quot;,&quot;isPrototypeOf&quot;,&quot;propertyIsEnumerable&quot;,&quot;constructor&quot;],d=c.length;return function(e){if(&quot;object&quot;!=typeof e&amp;&amp;(&quot;function&quot;!=typeof e||null===e))throw new TypeError(&quot;Object.keys called on non-object&quot;);var g,h,f=[];for(g in e)a.call(e,g)&amp;&amp;f.push(g);if(b)for(h=0;h&lt;d;h++)a.call(e,c[h])&amp;&amp;f.push(c[h]);return f}}());\n\nteal.ignoreKey = function(key,re){\n  var should_ignore_key = 0;\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.ignore_keys_list === 'undefined'){\n    teal.ignore_keys_list = Object.keys(teal.ignore_keys);\n    teal.ignore_keys_list.forEach(function(name){\n      //Store a copy of the regex in the object\n      teal.ignore_keys[name] = new RegExp(&quot;^&quot;+name);\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }else{\n    //Loop through the ignore_keys object to see if we should ignore this key\n    teal.ignore_keys_list.forEach(function(name){\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }\n  return should_ignore_key;\n}\n\nteal.getKeyName = function(key,re){\n  //Create a new object to store regexs or use existing one\n  teal.replace_keys_regex = teal.replace_keys_regex || {};\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.replace_keys_list === 'undefined'){\n    teal.replace_keys_list = Object.keys(teal.replace_keys);\n    //Make a start of string and end of string regex\n    teal.replace_keys_regex.startOfString = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n    teal.replace_keys_regex.endOfString = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n    teal.replace_keys_list.forEach(function(name){\n      //Store a copy of the regex in the teal.replace_keys_regex object so that the regexs are only built once\n      teal.replace_keys_regex[name] = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]?&quot; + name + &quot;[&quot; + teal.nested_delimiter + &quot;]?&quot;, &quot;g&quot;);\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }else{\n    //Loop through the replace_keys object to see what we should be replacing\n    teal.replace_keys_list.forEach(function(name){\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }\n  return key;\n}\n\nteal.keyReplace = function(key,name,re){\n  //Check to see if we are replacing the key name with a new value or if we are removing the key altogether\n  if(teal.replace_keys[name] === ''){\n    //The key needs to be removed completely\n    key = key.replace(re,teal.nested_delimiter);\n    //Check to see if the key starts with the nested delimiter and if so, remove it\n    if(key.indexOf(teal.nested_delimiter) === 0){\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }else{\n    //Make a copy of the original key to see how we need to update the key name\n    var origKey = key;\n    //Replace the key name\n    key = key.replace(re,teal.nested_delimiter + teal.replace_keys[name] + teal.nested_delimiter);\n    //Check for the start of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.startOfString)){\n      //Remove the nested delimiter from the start of the string\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n    //Check for the end of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.endOfString)){\n      //Add the nested delimiter to the end of the string\n      var cleanRegEx = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }\n  return key;\n}\n\nteal.processDataObject = function(obj,new_obj,parent_key,create_array){\n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else{\n    //Add the nested_delimiter to the parent key if the delimiter isn't already at the end\n    teal.nested_delimiter_regex = teal.nested_delimiter_regex || new RegExp(&quot;[&quot;+teal.nested_delimiter+&quot;]$&quot;);\n    if(!parent_key.match(teal.nested_delimiter_regex)){\n      parent_key += &quot;&quot;+teal.nested_delimiter;\n    }\n  }\n  Object.keys(obj).forEach(function(key){\n    var nested_key_name = parent_key+key;\n    //Format the new key name and take out any whitespace\n    var new_key_name = teal.getKeyName((teal.prefix+parent_key+key).replace(/\\s/g, ''));\n    //Set the key_type to limit the number of typeof checks\n    var key_type = teal.typeOf(obj[key]);\n    if(key_type !== 'undefined' &amp;&amp; key_type != null){\n      if(key_type.match(/boolean|string|number|date/) &amp;&amp; !teal.ignoreKey(key)){\n        //If obj[key] is a date, convert to ISOString\n        if(teal.typeOf(obj[key]) === 'date'){\n          obj[key] = obj[key].toISOString();\n        }\n        //Check to see if we need to create an array for this data point\n        if(create_array){\n          //First check to see if this key exists\n          if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n            //Make the key an array                       \n            new_obj[new_key_name] = [];\n          }\n          new_obj[new_key_name].push(&quot;&quot;+obj[key]); //Force value to be a string\n        }else{\n          //If the value of the key is a boolean or a string or a number and \n          //the key shouldn't be ignored add to the data layer\n          new_obj[new_key_name] = &quot;&quot;+obj[key]; //Force value to be a string\n        }\n      }else if(key_type === 'object' &amp;&amp; !teal.ignoreKey(key)){\n        //Process this piece of the data layer and merge it\n        teal.processDataObject(obj[key],new_obj,nested_key_name,create_array);\n      }else if(key_type === 'array'){\n        teal.processDataArray(obj[key],new_obj,nested_key_name);\n      }\n    }\n  });\n}\n\nteal.processDataArray = function(obj,new_obj,parent_key){\n  var objLength = obj.length; \n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else if(objLength &gt; 0 &amp;&amp; teal.typeOf(obj[0]).match(/boolean|string|number|date/)){\n    //This is a normal array that doesn't need a nested delimiter\n  }else{\n    //Add the nested_delimiter to the parent key\n    parent_key += &quot;&quot;+teal.nested_delimiter;\n  }\n  //Format the new key name and take out any whitespace\n  var new_key_name = teal.getKeyName((teal.prefix+parent_key).replace(/\\s/g, ''));\n  for(var n = 0; n &lt; objLength; n++){\n    var key_type = teal.typeOf(obj[n]);\n    if(key_type.match(/boolean|string|number|date/)){\n      //If obj[n] is a date, convert to ISOString\n      if(key_type === 'date'){\n        obj[n] = obj[n].toISOString();\n      }\n      //First check to see if this key exists\n      if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n        //Make the key an array                       \n        new_obj[new_key_name] = [];\n      }\n      //If the value of the key is a boolean or a string or a number and \n      //the key shouldn't be ignored add to the data layer                        \n      new_obj[new_key_name].push(&quot;&quot;+obj[n]);\n    }else if(key_type === 'object'){\n      teal.processDataObject(obj[n],new_obj,new_key_name,1);\n    }\n  }\n}\n\nteal.typeOf = function(e){return ({}).toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();}\n\nteal.flattenObject = function(obj,new_obj){\n  //Make sure object exists\n  if(typeof obj === 'undefined'){\n    return false;\n  }\n  //Check to see if we want to flatten the same object and keep the reference\n  var mergeObject = false;\n  if(obj === new_obj){\n    mergeObject = true;\n    //Start off a clean copy of the object\n    new_obj = {};\n  }\n  //Make sure new object exists\n  if(typeof new_obj === 'undefined'){\n    new_obj = {};\n  }\n  //Check to see if this object is an array\n  if(teal.typeOf(obj) === 'array'){\n    //Store a safe copy of this object in case we are processing the b object\n    var temp_array = JSON.parse(JSON.stringify(obj));\n    var temp_array_length = temp_array.length;\n    //Clean up the object\n    obj = {};\n    //Let's see if the obj and new_obj are the same.  If so, going to assume we are using the b object\n    if(obj == new_obj){\n      //Let's ensure that we have the a object\n      if(typeof a === 'undefined'){\n        var a = 'view';\n      }\n      //Add the automatic utag data points\n      utag.loader.RD(new_obj,a);\n    }\n    for(var i = 0; i &lt; temp_array_length; i++){\n        teal.processDataObject(temp_array[i],new_obj);\n    }\n  }else{\n    teal.processDataObject(obj,new_obj);\n  }\n  if(mergeObject){\n    //Need to delete everything out of obj and replace with new_obj\n    Object.keys(obj).forEach(function(key){\n      delete obj[key];\n    });\n    //Now that we have a clean original object, add everything from new_obj which allows the reference to be kept\n    Object.keys(new_obj).forEach(function(key){\n      obj[key] = new_obj[key];\n    });\n  }\n\n  return new_obj;\n}"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"code":"// Flattener, pulled from https://tags.tiqcdn.com/utag/tealium-solutions/main/prod/utag.9.js as instructed by\n// https://community.tealiumiq.com/t5/iQ-Tag-Management/Data-Layer-Converter/ta-p/17581#toc-hId-1329378795\n\n//Define the teal global namespace\nwindow.teal = window.teal || {};\nteal.ignore_keys = {};\nteal.replace_keys = {};\nteal.prefix = &quot;&quot;;\n\n//In cases of a nested object, what should join the parent key and child key\nteal.nested_delimiter = &quot;.&quot;;\n\n//Ignore keys in the data layer that start with the following text.\n//Expecting an object of strings\n/*\nteal.ignore_keys = {\n  &quot;user&quot; : 1,\n  &quot;util&quot; : 1\n};\n*/\n\n//Specify a prefix for data layer elements being sent to the utag_data object.\n//Instead of utag_data.productID, it could be utag_data.dl_productID\n// teal.prefix = &quot;dl.&quot;;\n\n//Keys to be removed from the new flattened key name\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pi.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;pi&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.pageName\n/* teal.replace_keys = {\n    &quot;page&quot;:&quot;&quot;,\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n/*****************DO NOT MODIFY BELOW***********************/\n\nteal.flattener_version = 1.4;\n\n// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n// Add the Object.keys method for older versions of IE\nObject.keys||(Object.keys=function(){&quot;use strict&quot;;var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable(&quot;toString&quot;),c=[&quot;toString&quot;,&quot;toLocaleString&quot;,&quot;valueOf&quot;,&quot;hasOwnProperty&quot;,&quot;isPrototypeOf&quot;,&quot;propertyIsEnumerable&quot;,&quot;constructor&quot;],d=c.length;return function(e){if(&quot;object&quot;!=typeof e&amp;&amp;(&quot;function&quot;!=typeof e||null===e))throw new TypeError(&quot;Object.keys called on non-object&quot;);var g,h,f=[];for(g in e)a.call(e,g)&amp;&amp;f.push(g);if(b)for(h=0;h&lt;d;h++)a.call(e,c[h])&amp;&amp;f.push(c[h]);return f}}());\n\nteal.ignoreKey = function(key,re){\n  var should_ignore_key = 0;\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.ignore_keys_list === 'undefined'){\n    teal.ignore_keys_list = Object.keys(teal.ignore_keys);\n    teal.ignore_keys_list.forEach(function(name){\n      //Store a copy of the regex in the object\n      teal.ignore_keys[name] = new RegExp(&quot;^&quot;+name);\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }else{\n    //Loop through the ignore_keys object to see if we should ignore this key\n    teal.ignore_keys_list.forEach(function(name){\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }\n  return should_ignore_key;\n}\n\nteal.getKeyName = function(key,re){\n  //Create a new object to store regexs or use existing one\n  teal.replace_keys_regex = teal.replace_keys_regex || {};\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.replace_keys_list === 'undefined'){\n    teal.replace_keys_list = Object.keys(teal.replace_keys);\n    //Make a start of string and end of string regex\n    teal.replace_keys_regex.startOfString = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n    teal.replace_keys_regex.endOfString = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n    teal.replace_keys_list.forEach(function(name){\n      //Store a copy of the regex in the teal.replace_keys_regex object so that the regexs are only built once\n      teal.replace_keys_regex[name] = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]?&quot; + name + &quot;[&quot; + teal.nested_delimiter + &quot;]?&quot;, &quot;g&quot;);\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }else{\n    //Loop through the replace_keys object to see what we should be replacing\n    teal.replace_keys_list.forEach(function(name){\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }\n  return key;\n}\n\nteal.keyReplace = function(key,name,re){\n  //Check to see if we are replacing the key name with a new value or if we are removing the key altogether\n  if(teal.replace_keys[name] === ''){\n    //The key needs to be removed completely\n    key = key.replace(re,teal.nested_delimiter);\n    //Check to see if the key starts with the nested delimiter and if so, remove it\n    if(key.indexOf(teal.nested_delimiter) === 0){\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }else{\n    //Make a copy of the original key to see how we need to update the key name\n    var origKey = key;\n    //Replace the key name\n    key = key.replace(re,teal.nested_delimiter + teal.replace_keys[name] + teal.nested_delimiter);\n    //Check for the start of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.startOfString)){\n      //Remove the nested delimiter from the start of the string\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n    //Check for the end of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.endOfString)){\n      //Add the nested delimiter to the end of the string\n      var cleanRegEx = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }\n  return key;\n}\n\nteal.processDataObject = function(obj,new_obj,parent_key,create_array){\n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else{\n    //Add the nested_delimiter to the parent key if the delimiter isn't already at the end\n    teal.nested_delimiter_regex = teal.nested_delimiter_regex || new RegExp(&quot;[&quot;+teal.nested_delimiter+&quot;]$&quot;);\n    if(!parent_key.match(teal.nested_delimiter_regex)){\n      parent_key += &quot;&quot;+teal.nested_delimiter;\n    }\n  }\n  Object.keys(obj).forEach(function(key){\n    var nested_key_name = parent_key+key;\n    //Format the new key name and take out any whitespace\n    var new_key_name = teal.getKeyName((teal.prefix+parent_key+key).replace(/\\s/g, ''));\n    //Set the key_type to limit the number of typeof checks\n    var key_type = teal.typeOf(obj[key]);\n    if(key_type !== 'undefined' &amp;&amp; key_type != null){\n      if(key_type.match(/boolean|string|number|date/) &amp;&amp; !teal.ignoreKey(key)){\n        //If obj[key] is a date, convert to ISOString\n        if(teal.typeOf(obj[key]) === 'date'){\n          obj[key] = obj[key].toISOString();\n        }\n        //Check to see if we need to create an array for this data point\n        if(create_array){\n          //First check to see if this key exists\n          if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n            //Make the key an array                       \n            new_obj[new_key_name] = [];\n          }\n          new_obj[new_key_name].push(&quot;&quot;+obj[key]); //Force value to be a string\n        }else{\n          //If the value of the key is a boolean or a string or a number and \n          //the key shouldn't be ignored add to the data layer\n          new_obj[new_key_name] = &quot;&quot;+obj[key]; //Force value to be a string\n        }\n      }else if(key_type === 'object' &amp;&amp; !teal.ignoreKey(key)){\n        //Process this piece of the data layer and merge it\n        teal.processDataObject(obj[key],new_obj,nested_key_name,create_array);\n      }else if(key_type === 'array'){\n        teal.processDataArray(obj[key],new_obj,nested_key_name);\n      }\n    }\n  });\n}\n\nteal.processDataArray = function(obj,new_obj,parent_key){\n  var objLength = obj.length; \n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else if(objLength &gt; 0 &amp;&amp; teal.typeOf(obj[0]).match(/boolean|string|number|date/)){\n    //This is a normal array that doesn't need a nested delimiter\n  }else{\n    //Add the nested_delimiter to the parent key\n    parent_key += &quot;&quot;+teal.nested_delimiter;\n  }\n  //Format the new key name and take out any whitespace\n  var new_key_name = teal.getKeyName((teal.prefix+parent_key).replace(/\\s/g, ''));\n  for(var n = 0; n &lt; objLength; n++){\n    var key_type = teal.typeOf(obj[n]);\n    if(key_type.match(/boolean|string|number|date/)){\n      //If obj[n] is a date, convert to ISOString\n      if(key_type === 'date'){\n        obj[n] = obj[n].toISOString();\n      }\n      //First check to see if this key exists\n      if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n        //Make the key an array                       \n        new_obj[new_key_name] = [];\n      }\n      //If the value of the key is a boolean or a string or a number and \n      //the key shouldn't be ignored add to the data layer                        \n      new_obj[new_key_name].push(&quot;&quot;+obj[n]);\n    }else if(key_type === 'object'){\n      teal.processDataObject(obj[n],new_obj,new_key_name,1);\n    }\n  }\n}\n\nteal.typeOf = function(e){return ({}).toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();}\n\nteal.flattenObject = function(obj,new_obj){\n  //Make sure object exists\n  if(typeof obj === 'undefined'){\n    return false;\n  }\n  //Check to see if we want to flatten the same object and keep the reference\n  var mergeObject = false;\n  if(obj === new_obj){\n    mergeObject = true;\n    //Start off a clean copy of the object\n    new_obj = {};\n  }\n  //Make sure new object exists\n  if(typeof new_obj === 'undefined'){\n    new_obj = {};\n  }\n  //Check to see if this object is an array\n  if(teal.typeOf(obj) === 'array'){\n    //Store a safe copy of this object in case we are processing the b object\n    var temp_array = JSON.parse(JSON.stringify(obj));\n    var temp_array_length = temp_array.length;\n    //Clean up the object\n    obj = {};\n    //Let's see if the obj and new_obj are the same.  If so, going to assume we are using the b object\n    if(obj == new_obj){\n      //Let's ensure that we have the a object\n      if(typeof a === 'undefined'){\n        var a = 'view';\n      }\n      //Add the automatic utag data points\n      utag.loader.RD(new_obj,a);\n    }\n    for(var i = 0; i &lt; temp_array_length; i++){\n        teal.processDataObject(temp_array[i],new_obj);\n    }\n  }else{\n    teal.processDataObject(obj,new_obj);\n  }\n  if(mergeObject){\n    //Need to delete everything out of obj and replace with new_obj\n    Object.keys(obj).forEach(function(key){\n      delete obj[key];\n    });\n    //Now that we have a clean original object, add everything from new_obj which allows the reference to be kept\n    Object.keys(new_obj).forEach(function(key){\n      obj[key] = new_obj[key];\n    });\n  }\n\n  return new_obj;\n}","name":"qa","promotedTimestamp":"202101151252","promotedDraftName":"default","promotedBy":"caleb.jaquith@tealium.com"}},"queueSeq":"12","draftSnippets":{"37a8eec1ce19687d132fe29051dca629d164e2c4958ba141d5f4133a33f0688f":{"code":"// Flattener, pulled from https://tags.tiqcdn.com/utag/tealium-solutions/main/prod/utag.9.js as instructed by\n// https://community.tealiumiq.com/t5/iQ-Tag-Management/Data-Layer-Converter/ta-p/17581#toc-hId-1329378795\n\n//Define the teal global namespace\nwindow.teal = window.teal || {};\nteal.ignore_keys = {};\nteal.replace_keys = {};\nteal.prefix = &quot;&quot;;\n\n//In cases of a nested object, what should join the parent key and child key\nteal.nested_delimiter = &quot;.&quot;;\n\n//Ignore keys in the data layer that start with the following text.\n//Expecting an object of strings\n/*\nteal.ignore_keys = {\n  &quot;user&quot; : 1,\n  &quot;util&quot; : 1\n};\n*/\n\n//Specify a prefix for data layer elements being sent to the utag_data object.\n//Instead of utag_data.productID, it could be utag_data.dl_productID\n// teal.prefix = &quot;dl.&quot;;\n\n//Keys to be removed from the new flattened key name\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pi.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;pi&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.page.pageName\n/* teal.replace_keys = {\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n//For a flattened key, you have digitalData.page.pageInfo.pageName and you want digitalData.pageName\n/* teal.replace_keys = {\n    &quot;page&quot;:&quot;&quot;,\n    &quot;pageInfo&quot;:&quot;&quot;\n  };\n*/\n\n/*****************DO NOT MODIFY BELOW***********************/\n\nteal.flattener_version = 1.4;\n\n// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n// Add the Object.keys method for older versions of IE\nObject.keys||(Object.keys=function(){&quot;use strict&quot;;var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable(&quot;toString&quot;),c=[&quot;toString&quot;,&quot;toLocaleString&quot;,&quot;valueOf&quot;,&quot;hasOwnProperty&quot;,&quot;isPrototypeOf&quot;,&quot;propertyIsEnumerable&quot;,&quot;constructor&quot;],d=c.length;return function(e){if(&quot;object&quot;!=typeof e&amp;&amp;(&quot;function&quot;!=typeof e||null===e))throw new TypeError(&quot;Object.keys called on non-object&quot;);var g,h,f=[];for(g in e)a.call(e,g)&amp;&amp;f.push(g);if(b)for(h=0;h&lt;d;h++)a.call(e,c[h])&amp;&amp;f.push(c[h]);return f}}());\n\nteal.ignoreKey = function(key,re){\n  var should_ignore_key = 0;\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.ignore_keys_list === 'undefined'){\n    teal.ignore_keys_list = Object.keys(teal.ignore_keys);\n    teal.ignore_keys_list.forEach(function(name){\n      //Store a copy of the regex in the object\n      teal.ignore_keys[name] = new RegExp(&quot;^&quot;+name);\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }else{\n    //Loop through the ignore_keys object to see if we should ignore this key\n    teal.ignore_keys_list.forEach(function(name){\n      if(key.match(teal.ignore_keys[name])){\n        should_ignore_key = 1;\n      }\n    });\n  }\n  return should_ignore_key;\n}\n\nteal.getKeyName = function(key,re){\n  //Create a new object to store regexs or use existing one\n  teal.replace_keys_regex = teal.replace_keys_regex || {};\n  //Build a new array to avoid running through Object.keys multiple times\n  if(typeof teal.replace_keys_list === 'undefined'){\n    teal.replace_keys_list = Object.keys(teal.replace_keys);\n    //Make a start of string and end of string regex\n    teal.replace_keys_regex.startOfString = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n    teal.replace_keys_regex.endOfString = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n    teal.replace_keys_list.forEach(function(name){\n      //Store a copy of the regex in the teal.replace_keys_regex object so that the regexs are only built once\n      teal.replace_keys_regex[name] = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]?&quot; + name + &quot;[&quot; + teal.nested_delimiter + &quot;]?&quot;, &quot;g&quot;);\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }else{\n    //Loop through the replace_keys object to see what we should be replacing\n    teal.replace_keys_list.forEach(function(name){\n      key = teal.keyReplace(key,name,teal.replace_keys_regex[name]);\n    });\n  }\n  return key;\n}\n\nteal.keyReplace = function(key,name,re){\n  //Check to see if we are replacing the key name with a new value or if we are removing the key altogether\n  if(teal.replace_keys[name] === ''){\n    //The key needs to be removed completely\n    key = key.replace(re,teal.nested_delimiter);\n    //Check to see if the key starts with the nested delimiter and if so, remove it\n    if(key.indexOf(teal.nested_delimiter) === 0){\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }else{\n    //Make a copy of the original key to see how we need to update the key name\n    var origKey = key;\n    //Replace the key name\n    key = key.replace(re,teal.nested_delimiter + teal.replace_keys[name] + teal.nested_delimiter);\n    //Check for the start of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.startOfString)){\n      //Remove the nested delimiter from the start of the string\n      var cleanRegEx = new RegExp(&quot;^[&quot; + teal.nested_delimiter + &quot;]&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n    //Check for the end of the origKey to see of the nested delimiter is there\n    if(!origKey.match(teal.replace_keys_regex.endOfString)){\n      //Add the nested delimiter to the end of the string\n      var cleanRegEx = new RegExp(&quot;[&quot; + teal.nested_delimiter + &quot;]$&quot;);\n      key = key.replace(cleanRegEx,'');\n    }\n  }\n  return key;\n}\n\nteal.processDataObject = function(obj,new_obj,parent_key,create_array){\n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else{\n    //Add the nested_delimiter to the parent key if the delimiter isn't already at the end\n    teal.nested_delimiter_regex = teal.nested_delimiter_regex || new RegExp(&quot;[&quot;+teal.nested_delimiter+&quot;]$&quot;);\n    if(!parent_key.match(teal.nested_delimiter_regex)){\n      parent_key += &quot;&quot;+teal.nested_delimiter;\n    }\n  }\n  Object.keys(obj).forEach(function(key){\n    var nested_key_name = parent_key+key;\n    //Format the new key name and take out any whitespace\n    var new_key_name = teal.getKeyName((teal.prefix+parent_key+key).replace(/\\s/g, ''));\n    //Set the key_type to limit the number of typeof checks\n    var key_type = teal.typeOf(obj[key]);\n    if(key_type !== 'undefined' &amp;&amp; key_type != null){\n      if(key_type.match(/boolean|string|number|date/) &amp;&amp; !teal.ignoreKey(key)){\n        //If obj[key] is a date, convert to ISOString\n        if(teal.typeOf(obj[key]) === 'date'){\n          obj[key] = obj[key].toISOString();\n        }\n        //Check to see if we need to create an array for this data point\n        if(create_array){\n          //First check to see if this key exists\n          if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n            //Make the key an array                       \n            new_obj[new_key_name] = [];\n          }\n          new_obj[new_key_name].push(&quot;&quot;+obj[key]); //Force value to be a string\n        }else{\n          //If the value of the key is a boolean or a string or a number and \n          //the key shouldn't be ignored add to the data layer\n          new_obj[new_key_name] = &quot;&quot;+obj[key]; //Force value to be a string\n        }\n      }else if(key_type === 'object' &amp;&amp; !teal.ignoreKey(key)){\n        //Process this piece of the data layer and merge it\n        teal.processDataObject(obj[key],new_obj,nested_key_name,create_array);\n      }else if(key_type === 'array'){\n        teal.processDataArray(obj[key],new_obj,nested_key_name);\n      }\n    }\n  });\n}\n\nteal.processDataArray = function(obj,new_obj,parent_key){\n  var objLength = obj.length; \n  if(typeof parent_key === &quot;undefined&quot;){\n    //This object isn't nested in another object\n    parent_key = &quot;&quot;;\n  }else if(objLength &gt; 0 &amp;&amp; teal.typeOf(obj[0]).match(/boolean|string|number|date/)){\n    //This is a normal array that doesn't need a nested delimiter\n  }else{\n    //Add the nested_delimiter to the parent key\n    parent_key += &quot;&quot;+teal.nested_delimiter;\n  }\n  //Format the new key name and take out any whitespace\n  var new_key_name = teal.getKeyName((teal.prefix+parent_key).replace(/\\s/g, ''));\n  for(var n = 0; n &lt; objLength; n++){\n    var key_type = teal.typeOf(obj[n]);\n    if(key_type.match(/boolean|string|number|date/)){\n      //If obj[n] is a date, convert to ISOString\n      if(key_type === 'date'){\n        obj[n] = obj[n].toISOString();\n      }\n      //First check to see if this key exists\n      if(teal.typeOf(new_obj[new_key_name]) !== &quot;array&quot;){\n        //Make the key an array                       \n        new_obj[new_key_name] = [];\n      }\n      //If the value of the key is a boolean or a string or a number and \n      //the key shouldn't be ignored add to the data layer                        \n      new_obj[new_key_name].push(&quot;&quot;+obj[n]);\n    }else if(key_type === 'object'){\n      teal.processDataObject(obj[n],new_obj,new_key_name,1);\n    }\n  }\n}\n\nteal.typeOf = function(e){return ({}).toString.call(e).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();}\n\nteal.flattenObject = function(obj,new_obj){\n  //Make sure object exists\n  if(typeof obj === 'undefined'){\n    return false;\n  }\n  //Check to see if we want to flatten the same object and keep the reference\n  var mergeObject = false;\n  if(obj === new_obj){\n    mergeObject = true;\n    //Start off a clean copy of the object\n    new_obj = {};\n  }\n  //Make sure new object exists\n  if(typeof new_obj === 'undefined'){\n    new_obj = {};\n  }\n  //Check to see if this object is an array\n  if(teal.typeOf(obj) === 'array'){\n    //Store a safe copy of this object in case we are processing the b object\n    var temp_array = JSON.parse(JSON.stringify(obj));\n    var temp_array_length = temp_array.length;\n    //Clean up the object\n    obj = {};\n    //Let's see if the obj and new_obj are the same.  If so, going to assume we are using the b object\n    if(obj == new_obj){\n      //Let's ensure that we have the a object\n      if(typeof a === 'undefined'){\n        var a = 'view';\n      }\n      //Add the automatic utag data points\n      utag.loader.RD(new_obj,a);\n    }\n    for(var i = 0; i &lt; temp_array_length; i++){\n        teal.processDataObject(temp_array[i],new_obj);\n    }\n  }else{\n    teal.processDataObject(obj,new_obj);\n  }\n  if(mergeObject){\n    //Need to delete everything out of obj and replace with new_obj\n    Object.keys(obj).forEach(function(key){\n      delete obj[key];\n    });\n    //Now that we have a clean original object, add everything from new_obj which allows the reference to be kept\n    Object.keys(new_obj).forEach(function(key){\n      obj[key] = new_obj[key];\n    });\n  }\n\n  return new_obj;\n}","name":"default","creationDate":"202010260907","updateDate":"202012041340","updatedBy":"caleb.jaquith@tealium.com"}}},"initialize":"","id":"100040","title":"GTM Listener (3/5) - Tealium Flattener Definitions"},"13":{"publishedTargets":"dev","blockPubTargetsLogic":"true","type":"new","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"extType":"Javascript Code","_id":"13","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"sort":"27","notes":"Force","id":"100040","title":"GTM Listener (4/5) - Data Layer Listener Function","advExecOption":"alr","scope":"domready","constructor":"","status":"active","initialize":"","codeDevData":{"draftSeq":"2","promotedSnippets":{"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"code":"/**\n * Scope       : DOM Ready (run once)\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Attach listener function using the DataLayer Helper\n */\n\n// define listener function, will be called for each element in the dataLayer array\nvar processEvent = function(model, message) {\n    // exit if the flattener function isn't present on the page\n    if (!teal || typeof teal.flattenObject !== &quot;function&quot;) {\n        return;\n    }\n    \n    var udo\n    // utag.view on dom ready (will be queued if too early)\n    // processes the 'model', built by the helper based on all past events on the page\n    if (message.event === &quot;tiq.load&quot;) {\n        //console.log(teal.flattenObject(message, message));\n        udo = flattenAndAugmentDataLayer(model)\n        utag.DB(&quot;View / &quot; + message.event, udo);\n        utag.view(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.page_timing&quot;) {\n        udo = flattenAndAugmentDataLayer(model);\n        utag.DB(&quot;Custom / timing&quot;, udo);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.track('timing', udo);\n    }\n    \n    // consent events\n    if (message.event === &quot;tiq.cm_manage_preferences&quot; || message.event === &quot;tiq.cm_save_preferences&quot; || message.event === &quot;tiq.cm_manage_preferences_relaunched&quot;) {\n        udo = flattenAndAugmentDataLayer(message)\n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.demo&quot;) {\n        udo = flattenDataLayer(message) // don't add tui.analytics, but do flatten\n        \n        udo = addFromModelIfDefined(udo, 'page.country')  // will be populated often\n        udo = addFromModelIfDefined(udo, 'page.countryX') // will not be populated\n        \n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n};\n\n// make sure the object is actually defined\nwindow.dataLayer = window.dataLayer || [];\n\n// attach the listener (and process any historical events on attachment)\nif (typeof processEvent === &quot;function&quot;) {\n    window.tuiDataLayer = new DataLayerHelper(window.dataLayer, {\n      listener: processEvent,\n      listenToPast: true,\n    });\n}\n\n// Helper functions\n\nfunction addPrefixToKeys (obj, prefix) {\n    if (typeof prefix !== 'string' || prefix === '') {\n        return obj\n    }\n    // add a prefix to the old keys to make the difference between the old and new dataLayer is clear\n    var keys = Object.keys(obj)\n    for (var i = 0, key; i &lt; keys.length; i++) {\n        key = keys[i]\n        obj[prefix + key] = obj[key]\n        delete obj[key]\n    }\n    return obj\n}\n\nfunction addFromModelIfDefined(udo, variableName) {\n    // use the helper to check\n    let fetched = window.tuiDataLayer.get(variableName)\n    if (typeof fetched !== 'undefined') {\n        udo[variableName] = fetched\n    }\n    return udo\n}\n\nfunction flattenAndAugmentDataLayer (nestedObject, prefix, disableTuiAnalytics) {\n    \n    if (typeof nestedObject !==  'object') {\n        nestedObject = {}\n    }\n    \n    prefix = prefix || ''\n    \n    var flat = teal.flattenObject(nestedObject);\n    flat = addPrefixToKeys(flat, prefix)\n    \n    if (!disableTuiAnalytics) {\n        var tuiAnalytics = (window.tui &amp;&amp; window.tui.analytics &amp;&amp; window.tui.analytics) || {}\n        tuiAnalytics = teal.flattenObject( [ tuiAnalytics ] )\n        tuiAnalytics = addPrefixToKeys(tuiAnalytics, 'tui.analytics.')\n        utag.ut.merge(flat, tuiAnalytics, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    }\n\n    /* // disable this for now, it's realllllyyyyy long and barely used\n    var jsonData = window.jsonData || {}\n    jsonData = teal.flattenObject( [ jsonData ] )\n    jsonData = addPrefixToKeys(jsonData, 'jsonData.')\n    utag.ut.merge(flat, jsonData, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    */\n    \n    return flat\n}\n\nfunction flattenDataLayer (nestedObject, prefix) {\n    return flattenAndAugmentDataLayer(nestedObject, prefix, true)\n}","name":"prod","promotedTimestamp":"202101151252","promotedDraftName":"CURRENT","promotedBy":"caleb.jaquith@tealium.com"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"code":"/**\n * Scope       : DOM Ready (run once)\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Attach listener function using the DataLayer Helper\n */\n\n// define listener function, will be called for each element in the dataLayer array\nvar processEvent = function(model, message) {\n    // exit if the flattener function isn't present on the page\n    if (!teal || typeof teal.flattenObject !== &quot;function&quot;) {\n        return;\n    }\n    \n    var udo\n    // utag.view on dom ready (will be queued if too early)\n    // processes the 'model', built by the helper based on all past events on the page\n    if (message.event === &quot;tiq.load&quot;) {\n        //console.log(teal.flattenObject(message, message));\n        udo = flattenAndAugmentDataLayer(model)\n        utag.DB(&quot;View / &quot; + message.event, udo);\n        utag.view(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.page_timing&quot;) {\n        udo = flattenAndAugmentDataLayer(model);\n        utag.DB(&quot;Custom / timing&quot;, udo);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.track('timing', udo);\n    }\n    \n    // consent events\n    if (message.event === &quot;tiq.cm_manage_preferences&quot; || message.event === &quot;tiq.cm_save_preferences&quot; || message.event === &quot;tiq.cm_manage_preferences_relaunched&quot;) {\n        udo = flattenAndAugmentDataLayer(message)\n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.demo&quot;) {\n        udo = flattenDataLayer(message) // don't add tui.analytics, but do flatten\n        \n        udo = addFromModelIfDefined(udo, 'page.country')  // will be populated often\n        udo = addFromModelIfDefined(udo, 'page.countryX') // will not be populated\n        \n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n};\n\n// make sure the object is actually defined\nwindow.dataLayer = window.dataLayer || [];\n\n// attach the listener (and process any historical events on attachment)\nif (typeof processEvent === &quot;function&quot;) {\n    window.tuiDataLayer = new DataLayerHelper(window.dataLayer, {\n      listener: processEvent,\n      listenToPast: true,\n    });\n}\n\n// Helper functions\n\nfunction addPrefixToKeys (obj, prefix) {\n    if (typeof prefix !== 'string' || prefix === '') {\n        return obj\n    }\n    // add a prefix to the old keys to make the difference between the old and new dataLayer is clear\n    var keys = Object.keys(obj)\n    for (var i = 0, key; i &lt; keys.length; i++) {\n        key = keys[i]\n        obj[prefix + key] = obj[key]\n        delete obj[key]\n    }\n    return obj\n}\n\nfunction addFromModelIfDefined(udo, variableName) {\n    // use the helper to check\n    let fetched = window.tuiDataLayer.get(variableName)\n    if (typeof fetched !== 'undefined') {\n        udo[variableName] = fetched\n    }\n    return udo\n}\n\nfunction flattenAndAugmentDataLayer (nestedObject, prefix, disableTuiAnalytics) {\n    \n    if (typeof nestedObject !==  'object') {\n        nestedObject = {}\n    }\n    \n    prefix = prefix || ''\n    \n    var flat = teal.flattenObject(nestedObject);\n    flat = addPrefixToKeys(flat, prefix)\n    \n    if (!disableTuiAnalytics) {\n        var tuiAnalytics = (window.tui &amp;&amp; window.tui.analytics &amp;&amp; window.tui.analytics) || {}\n        tuiAnalytics = teal.flattenObject( [ tuiAnalytics ] )\n        tuiAnalytics = addPrefixToKeys(tuiAnalytics, 'tui.analytics.')\n        utag.ut.merge(flat, tuiAnalytics, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    }\n\n    /* // disable this for now, it's realllllyyyyy long and barely used\n    var jsonData = window.jsonData || {}\n    jsonData = teal.flattenObject( [ jsonData ] )\n    jsonData = addPrefixToKeys(jsonData, 'jsonData.')\n    utag.ut.merge(flat, jsonData, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    */\n    \n    return flat\n}\n\nfunction flattenDataLayer (nestedObject, prefix) {\n    return flattenAndAugmentDataLayer(nestedObject, prefix, true)\n}","name":"qa","promotedTimestamp":"202101151252","promotedDraftName":"CURRENT","promotedBy":"caleb.jaquith@tealium.com"},"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"promotedBy":"caleb.jaquith@tealium.com","promotedDraftName":"CURRENT","promotedTimestamp":"202101151252","name":"dev","code":"/**\n * Scope       : DOM Ready (run once)\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Attach listener function using the DataLayer Helper\n */\n\n// define listener function, will be called for each element in the dataLayer array\nvar processEvent = function(model, message) {\n    // exit if the flattener function isn't present on the page\n    if (!teal || typeof teal.flattenObject !== &quot;function&quot;) {\n        return;\n    }\n    \n    var udo\n    // utag.view on dom ready (will be queued if too early)\n    // processes the 'model', built by the helper based on all past events on the page\n    if (message.event === &quot;tiq.load&quot;) {\n        //console.log(teal.flattenObject(message, message));\n        udo = flattenAndAugmentDataLayer(model)\n        utag.DB(&quot;View / &quot; + message.event, udo);\n        utag.view(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.page_timing&quot;) {\n        udo = flattenAndAugmentDataLayer(model);\n        utag.DB(&quot;Custom / timing&quot;, udo);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.track('timing', udo);\n    }\n    \n    // consent events\n    if (message.event === &quot;tiq.cm_manage_preferences&quot; || message.event === &quot;tiq.cm_save_preferences&quot; || message.event === &quot;tiq.cm_manage_preferences_relaunched&quot;) {\n        udo = flattenAndAugmentDataLayer(message)\n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.demo&quot;) {\n        udo = flattenDataLayer(message) // don't add tui.analytics, but do flatten\n        \n        udo = addFromModelIfDefined(udo, 'page.country')  // will be populated often\n        udo = addFromModelIfDefined(udo, 'page.countryX') // will not be populated\n        \n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n};\n\n// make sure the object is actually defined\nwindow.dataLayer = window.dataLayer || [];\n\n// attach the listener (and process any historical events on attachment)\nif (typeof processEvent === &quot;function&quot;) {\n    window.tuiDataLayer = new DataLayerHelper(window.dataLayer, {\n      listener: processEvent,\n      listenToPast: true,\n    });\n}\n\n// Helper functions\n\nfunction addPrefixToKeys (obj, prefix) {\n    if (typeof prefix !== 'string' || prefix === '') {\n        return obj\n    }\n    // add a prefix to the old keys to make the difference between the old and new dataLayer is clear\n    var keys = Object.keys(obj)\n    for (var i = 0, key; i &lt; keys.length; i++) {\n        key = keys[i]\n        obj[prefix + key] = obj[key]\n        delete obj[key]\n    }\n    return obj\n}\n\nfunction addFromModelIfDefined(udo, variableName) {\n    // use the helper to check\n    let fetched = window.tuiDataLayer.get(variableName)\n    if (typeof fetched !== 'undefined') {\n        udo[variableName] = fetched\n    }\n    return udo\n}\n\nfunction flattenAndAugmentDataLayer (nestedObject, prefix, disableTuiAnalytics) {\n    \n    if (typeof nestedObject !==  'object') {\n        nestedObject = {}\n    }\n    \n    prefix = prefix || ''\n    \n    var flat = teal.flattenObject(nestedObject);\n    flat = addPrefixToKeys(flat, prefix)\n    \n    if (!disableTuiAnalytics) {\n        var tuiAnalytics = (window.tui &amp;&amp; window.tui.analytics &amp;&amp; window.tui.analytics) || {}\n        tuiAnalytics = teal.flattenObject( [ tuiAnalytics ] )\n        tuiAnalytics = addPrefixToKeys(tuiAnalytics, 'tui.analytics.')\n        utag.ut.merge(flat, tuiAnalytics, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    }\n\n    /* // disable this for now, it's realllllyyyyy long and barely used\n    var jsonData = window.jsonData || {}\n    jsonData = teal.flattenObject( [ jsonData ] )\n    jsonData = addPrefixToKeys(jsonData, 'jsonData.')\n    utag.ut.merge(flat, jsonData, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    */\n    \n    return flat\n}\n\nfunction flattenDataLayer (nestedObject, prefix) {\n    return flattenAndAugmentDataLayer(nestedObject, prefix, true)\n}"}},"queueSeq":"45","draftSnippets":{"e3cc57e193d6512e6debf0e925febe757e87e85d66150a2f212aa8641940b027":{"updatedBy":"caleb.jaquith@tealium.com","updateDate":"202101131209","creationDate":"202011021107","name":"CURRENT","code":"/**\n * Scope       : DOM Ready (run once)\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Attach listener function using the DataLayer Helper\n */\n\n// define listener function, will be called for each element in the dataLayer array\nvar processEvent = function(model, message) {\n    // exit if the flattener function isn't present on the page\n    if (!teal || typeof teal.flattenObject !== &quot;function&quot;) {\n        return;\n    }\n    \n    var udo\n    // utag.view on dom ready (will be queued if too early)\n    // processes the 'model', built by the helper based on all past events on the page\n    if (message.event === &quot;tiq.load&quot;) {\n        //console.log(teal.flattenObject(message, message));\n        udo = flattenAndAugmentDataLayer(model)\n        utag.DB(&quot;View / &quot; + message.event, udo);\n        utag.view(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.page_timing&quot;) {\n        udo = flattenAndAugmentDataLayer(model);\n        utag.DB(&quot;Custom / timing&quot;, udo);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.track('timing', udo);\n    }\n    \n    // consent events\n    if (message.event === &quot;tiq.cm_manage_preferences&quot; || message.event === &quot;tiq.cm_save_preferences&quot; || message.event === &quot;tiq.cm_manage_preferences_relaunched&quot;) {\n        udo = flattenAndAugmentDataLayer(message)\n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n    // listen for page timing events as well (important for GA)\n    if (message.event === &quot;tiq.demo&quot;) {\n        udo = flattenDataLayer(message) // don't add tui.analytics, but do flatten\n        \n        udo = addFromModelIfDefined(udo, 'page.country')  // will be populated often\n        udo = addFromModelIfDefined(udo, 'page.countryX') // will not be populated\n        \n        utag.DB(&quot;Consent link event: &quot; + message.event);\n        // this is a custom event type - tag templates need to be edited (u.ev object updated to include 'timing') if the tag should fire. Tealium Collect will pick this up (u.ev.all === true)\n        utag.link(udo);\n    }\n    \n};\n\n// make sure the object is actually defined\nwindow.dataLayer = window.dataLayer || [];\n\n// attach the listener (and process any historical events on attachment)\nif (typeof processEvent === &quot;function&quot;) {\n    window.tuiDataLayer = new DataLayerHelper(window.dataLayer, {\n      listener: processEvent,\n      listenToPast: true,\n    });\n}\n\n// Helper functions\n\nfunction addPrefixToKeys (obj, prefix) {\n    if (typeof prefix !== 'string' || prefix === '') {\n        return obj\n    }\n    // add a prefix to the old keys to make the difference between the old and new dataLayer is clear\n    var keys = Object.keys(obj)\n    for (var i = 0, key; i &lt; keys.length; i++) {\n        key = keys[i]\n        obj[prefix + key] = obj[key]\n        delete obj[key]\n    }\n    return obj\n}\n\nfunction addFromModelIfDefined(udo, variableName) {\n    // use the helper to check\n    let fetched = window.tuiDataLayer.get(variableName)\n    if (typeof fetched !== 'undefined') {\n        udo[variableName] = fetched\n    }\n    return udo\n}\n\nfunction flattenAndAugmentDataLayer (nestedObject, prefix, disableTuiAnalytics) {\n    \n    if (typeof nestedObject !==  'object') {\n        nestedObject = {}\n    }\n    \n    prefix = prefix || ''\n    \n    var flat = teal.flattenObject(nestedObject);\n    flat = addPrefixToKeys(flat, prefix)\n    \n    if (!disableTuiAnalytics) {\n        var tuiAnalytics = (window.tui &amp;&amp; window.tui.analytics &amp;&amp; window.tui.analytics) || {}\n        tuiAnalytics = teal.flattenObject( [ tuiAnalytics ] )\n        tuiAnalytics = addPrefixToKeys(tuiAnalytics, 'tui.analytics.')\n        utag.ut.merge(flat, tuiAnalytics, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    }\n\n    /* // disable this for now, it's realllllyyyyy long and barely used\n    var jsonData = window.jsonData || {}\n    jsonData = teal.flattenObject( [ jsonData ] )\n    jsonData = addPrefixToKeys(jsonData, 'jsonData.')\n    utag.ut.merge(flat, jsonData, 0); // 0 means don't overwrite values in the first with those from the second (but they won't collide anyway of the prefixing)\n    */\n    \n    return flat\n}\n\nfunction flattenDataLayer (nestedObject, prefix) {\n    return flattenAndAugmentDataLayer(nestedObject, prefix, true)\n}"},"75cc13d02a66aa6f80881105a69e0f5cdfd4c51ac9370674b1a4d99f5fd70737":{"code":"/**\n * Scope       : DOM Ready\n * Execution   : n/a\n * Condition   : n/a\n * Description : GTM Listener - Add listener function using the DataLayer Helper\n * Notes       : Both new and legacy objects need to be converted for the current migration. NEW: window.dataLayer, Legacy: window.tui.analytics\n */\n\nvar flatNew = {},\n    flatLegacy = {},\n    flatMerged = {};\n\n// flattening legacy object before the model process, to be merged with new DL\n// using prefix as test for now to differentiate and avoid overrides when merging data for same keys with differing values\nif (window.tui.analytics) {\n    teal.prefix = 'legacy_';\n    flatLegacy = teal.flattenObject(window.tui.analytics);\n}\n\n// optional tbd\nvar triggerLegacyOrBackup = function() {\n    return Object.keys(flatLegacy).length &gt; 0 ? utag.view(flatLegacy) : console.log('***** Tealium view did not trigger, no page data available!', utag.data);\n};\n\n// start processing the model event\nvar processEvent = function(model, message) {\n    // exit if the flattener function isn't present on the page\n    if (!teal || typeof teal.flattenObject !== 'function') {\n        return;\n    }\n\n    teal.prefix = 'new_';\n    // utag.view on gtm.load to help see dataLayer for now\n    if (message.event === 'gtm.load') {\n        flatNew = teal.flattenObject(model, model);\n        flatMerged = Object.assign(flatNew, flatLegacy);\n        \n        console.log('***** initializing VIEW from GTM listener!');\n        utag.view(flatMerged);\n        utag.data = flatMerged;\n\n    } else {\n        // decide if view should trigger when no event data\n        // triggerLegacyOrBackup();\n    }\n    \n    // some click events as examples\n    if (message.event === 'buttonClick' || message.event === 'GAevent') {\n        flatNew = teal.flattenObject(model, model);\n        flatMerged = Object.assign(flatNew, flatLegacy);\n        \n        console.log('***** initializing LINK from GTM listener!');\n        utag.link(flatMerged);\n        utag.data = flatMerged;\n    }\n};\n\n\nwindow.dataLayer = window.dataLayer|| [];\n// using helper for new data only\nif (typeof processEvent === 'function') {\n    var helper = new DataLayerHelper(window.dataLayer, processEvent, true);\n}","name":"_Draft 1","creationDate":"202011021108","updateDate":"202011021108","updatedBy":"caleb.jaquith@tealium.com"}}},"labels":""},"14":{"code":"// domReady(); // not needed for now\npageDefinitelyLoaded()\n\n// wait until DOM is completely loaded, including images and scripts\n// in case the document is already rendered\nif (document.readyState==='complete') hasLoaded();\n// modern browsers\nelse if (window.addEventListener) window.addEventListener('load', hasLoaded);\n// IE &lt;= 8\nelse document.attachEvent('onreadystatechange', function(){\n    if (document.readyState==='complete') hasLoaded();\n});\n\n/*\n// not needed for now\nfunction domReady() {\n   window.dataLayer = window.dataLayer || [];\n   var event = {}\n   event.event = 'tiq.dom'\n   window.dataLayer.push(event)\n}\n*/\n\nvar counter = 0\nvar maxAttempts = 10\nvar delayBetween = 800\nfunction pageDefinitelyLoaded() {\n    counter++\n    function checkForPerformanceTimingInfo () {\n      if (counter &gt; maxAttempts) return true\n        if (window.performance &amp;&amp; performance.timing &amp;&amp; performance.timing.loadEventEnd &amp;&amp; performance.timing.navigationStart) {\n          return true\n          // return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n      return false;\n    }\n    \n    function fireEvent (payload) {\n        window.dataLayer = window.dataLayer || [];\n        payload = payload || {}\n        payload.event = 'tiq.page_timing';\n        window.dataLayer.push(payload);\n    }\n    \n    if (checkForPerformanceTimingInfo() === true) {\n        fireEvent({'timing_check' : window.performance &amp;&amp; performance.timing &amp;&amp; performance.timing.loadEventEnd &amp;&amp; performance.timing.navigationStart })\n    } else {\n        window.setTimeout(pageDefinitelyLoaded, delayBetween)\n    }\n}\n\n\nfunction hasLoaded() {\n   window.dataLayer = window.dataLayer || [];\n   var event = {};\n   event.event = 'tiq.load';\n   window.dataLayer.push(event);\n}\n","initialize":"","labels":"","constructor":"","scope":"domready","status":"active","advExecOption":"alr","title":"GTM Listener (5/5) - Add 'tiq.load' and 'tiq.dom' pushes to dataLayer ","id":"100036","_ignoreError":"false","sort":"28","notes":"We need to do it like this instead of listening for the pageData event because the pageData event is sometimes missing (on older pages), but we still want to fire a pageview.\n\nWe also want to be able to push events into this array for debugging purposes, since we need the listener anyway it seems best to use it all the time.","scopevars":"","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"extType":"Javascript Code","_id":"14","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"type":"new","publishedTargets":"dev"},"16":{"scope":"preload","constructor":"","status":"inactive","advExecOption":"alr","code":"      window.dataLayer = window.dataLayer || [];\n      dataLayer.push = function() {\n        var b = this\n          , a = arguments\n          , f = Array.prototype.push;\n        f.apply(b, a)\n      }","labels":"","initialize":"","_ignoreError":"false","title":"ENSIGHTEN PORT - check for issue reproducibility","id":"100036","extType":"Javascript Code","_id":"16","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"sort":"1","scopevars":"","notes":"","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"type":"new"},"17":{"advExecOption":"alr","constructor":"","scope":"5,8,7,2","status":"active","initialize":"","codeDevData":{"promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"code":"/*\n  Scope:       Adobe Analytics (Tag Scope)\n\n  Description: Fire u.addEvent for each event listed in b.linkTrackEvents to avoid needing to do that manually in\n               a second extension each time.\n*/\nvar linkTrackEvents = u.data.linkTrackEvents || b.linkTrackEvents\nif (typeof linkTrackEvents === 'string') {\n    var events = linkTrackEvents.split(',')\n    for (var i = 0, match; i &lt; events.length; i++) {\n        if (typeof events[i] === 'string' &amp;&amp; events[i].trim() !== '' &amp;&amp; events[i].trim() !== 'None') {\n          u.addEvent(events[i].trim());\n        }\n    }\n}\n","name":"dev","promotedDraftName":"Draft 1","promotedTimestamp":"202101191259","promotedBy":"caleb.jaquith@tealium.com"},"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"code":"/*\n  Scope:       Adobe Analytics (Tag Scope)\n\n  Description: Fire u.addEvent for each event listed in b.linkTrackEvents to avoid needing to do that manually in\n               a second extension each time.\n*/\nvar linkTrackEvents = u.data.linkTrackEvents || b.linkTrackEvents\nif (typeof linkTrackEvents === 'string') {\n    var events = linkTrackEvents.split(',')\n    for (var i = 0, match; i &lt; events.length; i++) {\n        if (typeof events[i] === 'string' &amp;&amp; events[i].trim() !== '' &amp;&amp; events[i].trim() !== 'None') {\n          u.addEvent(events[i].trim());\n        }\n    }\n}\n","name":"prod","promotedDraftName":"Draft 1","promotedTimestamp":"202101191702","promotedBy":"caleb.jaquith@tealium.com"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202101191259","promotedDraftName":"Draft 1","name":"qa","code":"/*\n  Scope:       Adobe Analytics (Tag Scope)\n\n  Description: Fire u.addEvent for each event listed in b.linkTrackEvents to avoid needing to do that manually in\n               a second extension each time.\n*/\nvar linkTrackEvents = u.data.linkTrackEvents || b.linkTrackEvents\nif (typeof linkTrackEvents === 'string') {\n    var events = linkTrackEvents.split(',')\n    for (var i = 0, match; i &lt; events.length; i++) {\n        if (typeof events[i] === 'string' &amp;&amp; events[i].trim() !== '' &amp;&amp; events[i].trim() !== 'None') {\n          u.addEvent(events[i].trim());\n        }\n    }\n}\n"}},"draftSeq":"1","queueSeq":"6","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"creationDate":"202101131216","updateDate":"202101151155","updatedBy":"caleb.jaquith@tealium.com","code":"/*\n  Scope:       Adobe Analytics (Tag Scope)\n\n  Description: Fire u.addEvent for each event listed in b.linkTrackEvents to avoid needing to do that manually in\n               a second extension each time.\n*/\nvar linkTrackEvents = u.data.linkTrackEvents || b.linkTrackEvents\nif (typeof linkTrackEvents === 'string') {\n    var events = linkTrackEvents.split(',')\n    for (var i = 0, match; i &lt; events.length; i++) {\n        if (typeof events[i] === 'string' &amp;&amp; events[i].trim() !== '' &amp;&amp; events[i].trim() !== 'None') {\n          u.addEvent(events[i].trim());\n        }\n    }\n}\n","name":"Draft 1"}}},"labels":"","id":"100040","title":"Fire u.addEvent as needed for specific events","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"extType":"Javascript Code","_id":"17","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"sort":"33","notes":"","publishedTargets":"dev","blockPubTargetsLogic":"true","type":"new"},"18":{"labels":"","codeDevData":{"draftSeq":"1","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"updatedBy":"caleb.jaquith@tealium.com","creationDate":"202101131221","updateDate":"202101131221","name":"Draft 1","code":"u.addEvent('event500')\nu.addEvent('event501')\nu.addEvent('event502')"}},"queueSeq":"3"},"initialize":"","advExecOption":"alr","constructor":"","scope":"global","status":"inactive","id":"100040","title":"Add some test events","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"sort":"16","notes":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"extType":"Javascript Code","_id":"18","type":"new","blockPubTargetsLogic":"true"},"21":{"161071507961500139_setoption":"var","id":"100003","title":"Intermediate mappings to test ","161071267953800040_settotext":"","161071267953800040_set":"js.adobeLinkTrackEvents","161071507961500139_set":"js.adobeLinkTrackVars","161071507961500139_settovar":"js.mapToAdobeLinkTrackVars","labels":"","initialize":"","advExecOption":"alr","scope":"2,5","constructor":"","status":"inactive","type":"new","161071267953800040_settovar":"js.mapToAdobeLinkTrackEvents","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"sort":"32","161071507961500139_settotext":"","notes":"","161071267953800040_setoption":"var","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"extType":"Set Data Values","_id":"21"},"23":{"advExecOption":"alr","status":"active","constructor":"","scope":"5,8,7,2","labels":"","codeDevData":{"queueSeq":"5","draftSnippets":{"21b000058e9ea05aad32d918ac1b576ab5abdebde3902c953c87cfd9f950cccf":{"code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"s.events logic moved out of plugins","creationDate":"202101200914","updateDate":"202101200915","updatedBy":"caleb.jaquith@tealium.com"},"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n\ts.events = (function ensightenAdobeEventLogic(existingEventString) {\n        s.events = existingEventString || ''\n        \n        var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n        \n        totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n        \n        creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n        \n        creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n        \n        onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n        \n        bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n        \n        incentivePromoValue = incentivePromoDiscount();\n        \n        function incentivePromoDiscount() {\n        \n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          var result = 0;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              result = promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n          return result;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n          return parseFloat(tui.analytics.page.IncentivePromoValue);\n        } else {\n          return 0;\n        }\n        }\n        \n        //Normal Bookflow &amp; LYP with same confirmation url\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n          s.events = &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n            +\n            &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;;\n        } else {\n          s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n            +\n            &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n            +\n            &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n            +\n            &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n            +\n            &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice); // multiple promocode - maintaining redemption code reporting\n        }\n        }\n        \n        //LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\n        else if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n        s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n          +\n          &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;; //added 158&amp;159 for PC Incentive\n        }\n        \n        //MMB Unpaid\n        else if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n            s.events = &quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Paid\n        else if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n            s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Cancel\n        else if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n            s.events = &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n          }\n        }\n        }\n        \n        //Price Variation Alert\n        else if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n        var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n        var price = document.querySelectorAll('.alertprice');\n        if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, '');\n        } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, '');\n        }\n        }\n        \n        // Credit Note Booking\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n        var creditNoteBooking = b.legacy_isCreditNoteBooking || ''\n        if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          s.events = s.apl(s.events, 'event70', ',', 1);\n        }\n        }\n        \n        \n        // Performance Timing Replacement\n        /*\n        var pt = (Bootstrapper.PTE &amp;&amp; Bootstrapper.PTE.performanceTimings &amp;&amp; Bootstrapper.PTE.performanceTimings.get ? Bootstrapper.PTE.performanceTimings.get() : '');\n        \n        if (pt) {\n            pt = pt.split('|');\n            s.events = s.apl(s.events,'event980=' + pt[0],',',1);\n            s.events = s.apl(s.events,'event981=' + pt[1],',',1);\n            s.events = s.apl(s.events,'event982=' + pt[2],',',1);\n            s.events = s.apl(s.events,'event983=' + pt[3],',',1);\n            s.events = s.apl(s.events,'event984=' + pt[4],',',1);\n            s.events = s.apl(s.events,'event985=' + pt[5],',',1);\n            s.events = s.apl(s.events,'event986=' + pt[6],',',1);\n            s.events = s.apl(s.events,'event987=' + pt[7],',',1);\n            s.events = s.apl(s.events,'event988=' + pt[8],',',1);\n            \n            if (pt[9] &gt; 0) {\n                s.events = s.apl(s.events,'event989=' + pt[9],',',1);\n            }\n            if (pt[10] &gt; 0) {\n            s.events = s.apl(s.events,'event990=' + pt[10],',',1);\n            }\n            s.events = s.apl(s.events,'event1000',',',1);\n        }\n        */\n        \n        // Bookflow Events\n        // Search\n        if (document.URL.indexOf('/destinations/packages') != -1 || document.URL.indexOf('/flight/search') != -1 || document.URL.indexOf('/cruise/packages') != -1 || document.URL.indexOf('/holiday/packages') != -1 || document.URL.indexOf('/f/packages') != -1 || document.URL.indexOf('/river-cruises/packages') != -1 || document.URL.indexOf('/retail/packages') != -1) {\n        s.events = s.apl(s.events, &quot;event1&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Product View &amp; Custom Product View\n        if (document.URL.indexOf('/bookaccommodation') != -1 || document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1 || document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event11,prodView&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Beach Bookflow Events\n        if (document.URL.indexOf('bookaccommodation') != -1) {\n        s.events = s.apl(s.events, &quot;event15&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/book/mobile/hubsummary') != -1) {\n        s.events = s.apl(s.events, &quot;event16&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/flightoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/flightoptions') != -1 || document.URL.indexOf('/destinations/book/flow/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flightoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/flightoptions') != -1 || document.URL.indexOf('/f/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/mobile/flightoptions') != -1 || document.URL.indexOf('/retail/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event17,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/roomoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/roomoptions') != -1 || document.URL.indexOf('/destinations/book/flow/roomoptions') != -1 || document.URL.indexOf('/holiday/book/roomoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/roomoptions') != -1 || document.URL.indexOf('/holiday/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/roomoptions') != -1 || document.URL.indexOf('/f/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/mobile/roomoptions') != -1 || document.URL.indexOf('/retail/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event18&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/extraoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/extraoptions') != -1 || document.URL.indexOf('/destinations/book/flow/extraoptions') != -1 || document.URL.indexOf('/holiday/book/extraoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/extraoptions') != -1 || document.URL.indexOf('/holiday/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/extraoptions') != -1 || document.URL.indexOf('/f/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/mobile/extraoptions') != -1 || document.URL.indexOf('/retail/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event19&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/passengerdetails') != -1 || document.URL.indexOf('/destinations/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/f/book/passengerdetails') != -1 || document.URL.indexOf('/f/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/retail/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event20,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('25000') != -1 || s.Util.getQueryParam('b').indexOf('32000') != -1 || s.Util.getQueryParam('b').indexOf('50000') != -1 || s.Util.getQueryParam('b').indexOf('19000') != -1 || s.Util.getQueryParam('b').indexOf('41000') != -1 || s.Util.getQueryParam('b').indexOf('31000') != -1 || s.Util.getQueryParam('b').indexOf('10000') != -1 || s.Util.getQueryParam('b').indexOf('20000') != -1 || s.Util.getQueryParam('b').indexOf('42000') != -1 || s.Util.getQueryParam('b').indexOf('51000') != -1 || s.Util.getQueryParam('b').indexOf('52000') != -1 || s.Util.getQueryParam('b').indexOf('53000') != -1 || s.Util.getQueryParam('b').indexOf('38000') != -1)) {\n        s.events = s.apl(s.events, &quot;event21&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/confirmation') != -1 || document.URL.indexOf('/destinations/book/mobile/confirmation') != -1 || document.URL.indexOf('/holiday/book/confirmation') != -1 || document.URL.indexOf('/holiday/book/mobile/confirmation') != -1 || document.URL.indexOf('/f/book/confirmation') != -1 || document.URL.indexOf('/f/book/mobile/confirmation') != -1 || document.URL.indexOf('/managemybooking/paymentconfirmation') != -1 || document.URL.indexOf('/retail/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/book/bookingConfirmation') != -1) {\n        if (window.tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' || dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          s.events = s.apl(s.events, &quot;event22&quot;, &quot;,&quot;, 1);\n        }\n        }\n        \n        // Cruise Bookflow Events\t\n        /*else if (document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event23&quot;, &quot;,&quot;, 1);\n        }*/ else if (document.URL.indexOf('/cruise/packages/hotels') != -1) {\n        s.events = s.apl(s.events, &quot;event24&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/bookHotelDetails') != -1) {\n        s.events = s.apl(s.events, &quot;event25&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/cruiseoptions') != -1 || document.URL.indexOf('/cruise/book/flow/cruiseoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event26,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/flightoptions') != -1 || document.URL.indexOf('/cruise/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event27&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/roomoptions') != -1 || document.URL.indexOf('/cruise/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event28&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/extraoptions') != -1 || document.URL.indexOf('/cruise/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event29&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event30,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('37000') != -1 || s.Util.getQueryParam('b').indexOf('54000') != -1 || s.Util.getQueryParam('b').indexOf('49000') != -1)) {\n        s.events = s.apl(s.events, &quot;event31&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/confirmation') != -1 || document.URL.indexOf('/retail/cruise/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/cruise/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event32&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // Flight Only Bookflow Events\t\t\n        else if (document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event33,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/extraoptions') != -1 || document.URL.indexOf('/flight/book/mobile/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event34&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/passengerdetails') != -1 || document.URL.indexOf('/flight/book/mobile/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event35,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('39000') != -1 || s.Util.getQueryParam('b').indexOf('47000') != -1 || s.Util.getQueryParam('b').indexOf('40000') != -1 || s.Util.getQueryParam('b').indexOf('48000') != -1 || s.Util.getQueryParam('b').indexOf('59000') != -1 || s.Util.getQueryParam('b').indexOf('60000') != -1)) {\n        s.events = s.apl(s.events, &quot;event36&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/confirmation') != -1 || document.URL.indexOf('/flight/book/mobile/confirmation') != -1 || document.URL.indexOf('/retail/flight/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/flight/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event37&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // This is for event 8 (Pax) (legacy_numberOfPax)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + tui.analytics.page.Pax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].transactions.total.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].basket.price.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].product.noOfPax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].page.search.noOfPax, &quot;,&quot;, 1);\n        }\n        */\n        \n        // This is for event 10 (Discount) (legacy_onlineDiscount)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + tui.analytics.page.Disc, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].transactions.total.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].basket.price.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].product.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(jsonData.packageViewData.onlineDiscount).toString(), &quot;,&quot;, 1);\n        }\n        */\n        \n        \n        // This is for event 38 (Revenue) \n        \n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n        if (window.tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0)) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount)), &quot;,&quot;, 1);\n        } else {\n          s.events = s.events = s.apl(s.events, &quot;event38=&quot; + tui.analytics.page.Sum, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n        if (window.dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].transactions.total.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n        if (window.dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].basket.price.totalPrice + dataLayer[0].basket.price.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].basket.price.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n        s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].product.currentPrice, &quot;,&quot;, 1);\n        }\n        \n        // For Privacy\n        /* // moved, since this logic isn't relevant post-migration\n        try {\n        var privacyExperience = Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience');\n        if (privacyExperience !== 'C') {\n          if (window.gateway &amp;&amp; window.gateway.isInitialized &amp;&amp; String(Bootstrapper.gateway.getCookie('BANNER_VIEWED')) !== '1') {\n            s.events = s.apl(s.events, 'event107', ',', 1);\n          }\n        }\n        } catch (err) {\n        console.log('Ensighten:event107 not set');\n        }\n        */\n        \n        return s.events;\n        })(s.events)\n\t\n\t// Custom pageview event\n\ts.events = s.apl(s.events,&quot;event3&quot;,&quot;,&quot;,1);\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"Draft 1","creationDate":"202101191100","updateDate":"202101191101","updatedBy":"caleb.jaquith@tealium.com"},"1d89fc0653e0b74c9c56320a37ae726c9fe4dd01762e252b04fec8fb25064a6c":{"name":"Updated with s.event removed","code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","updatedBy":"caleb.jaquith@tealium.com","creationDate":"202101201049","updateDate":"202101201049"},"acb5c8055cdf24b84ee61016044ae07b3035c345888b3004ccd8d2dd1c1735cb":{"updateDate":"202101201048","creationDate":"202101201047","updatedBy":"caleb.jaquith@tealium.com","code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n\ts.events = (function ensightenAdobeEventLogic(existingEventString) {\n        s.events = existingEventString || ''\n        \n        var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n        \n        totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n        \n        creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n        \n        creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n        \n        onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n        \n        bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n        \n        incentivePromoValue = incentivePromoDiscount();\n        \n        function incentivePromoDiscount() {\n        \n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          var result = 0;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              result = promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n          return result;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n          return parseFloat(tui.analytics.page.IncentivePromoValue);\n        } else {\n          return 0;\n        }\n        }\n        \n        //Normal Bookflow &amp; LYP with same confirmation url\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n          s.events = s.apl(s.events, &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n            +\n            &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;, ',', 1);\n        } else {\n          s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n            +\n            &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n            +\n            &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n            +\n            &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n            +\n            &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice), ',', 1); // multiple promocode - maintaining redemption code reporting\n        }\n        }\n        \n        //LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\n        else if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n        s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n          +\n          &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;, ',', 1); //added 158&amp;159 for PC Incentive\n        }\n        \n        //MMB Unpaid\n        else if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n            s.events = s.apl(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Paid\n        else if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n            s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Cancel\n        else if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n            s.events = s.apl(s.events, &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n          }\n        }\n        }\n        \n        //Price Variation Alert\n        else if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n        var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n        var price = document.querySelectorAll('.alertprice');\n        if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n          s.events = s.apl(s.events, &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n        } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n          s.events = s.apl(s.events, &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n        }\n        }\n        \n        // Credit Note Booking\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n        var creditNoteBooking = b.legacy_isCreditNoteBooking || '';\n        if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          s.events = s.apl(s.events, 'event70', ',', 1);\n        }\n        }\n        \n        \n        // Performance Timing Replacement\n        /*\n        var pt = (Bootstrapper.PTE &amp;&amp; Bootstrapper.PTE.performanceTimings &amp;&amp; Bootstrapper.PTE.performanceTimings.get ? Bootstrapper.PTE.performanceTimings.get() : '');\n        \n        if (pt) {\n            pt = pt.split('|');\n            s.events = s.apl(s.events,'event980=' + pt[0],',',1);\n            s.events = s.apl(s.events,'event981=' + pt[1],',',1);\n            s.events = s.apl(s.events,'event982=' + pt[2],',',1);\n            s.events = s.apl(s.events,'event983=' + pt[3],',',1);\n            s.events = s.apl(s.events,'event984=' + pt[4],',',1);\n            s.events = s.apl(s.events,'event985=' + pt[5],',',1);\n            s.events = s.apl(s.events,'event986=' + pt[6],',',1);\n            s.events = s.apl(s.events,'event987=' + pt[7],',',1);\n            s.events = s.apl(s.events,'event988=' + pt[8],',',1);\n            \n            if (pt[9] &gt; 0) {\n                s.events = s.apl(s.events,'event989=' + pt[9],',',1);\n            }\n            if (pt[10] &gt; 0) {\n            s.events = s.apl(s.events,'event990=' + pt[10],',',1);\n            }\n            s.events = s.apl(s.events,'event1000',',',1);\n        }\n        */\n        /*\n        // Bookflow Events\n        // Search\n        if (document.URL.indexOf('/destinations/packages') != -1 || document.URL.indexOf('/flight/search') != -1 || document.URL.indexOf('/cruise/packages') != -1 || document.URL.indexOf('/holiday/packages') != -1 || document.URL.indexOf('/f/packages') != -1 || document.URL.indexOf('/river-cruises/packages') != -1 || document.URL.indexOf('/retail/packages') != -1) {\n        s.events = s.apl(s.events, &quot;event1&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Product View &amp; Custom Product View\n        if (document.URL.indexOf('/bookaccommodation') != -1 || document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1 || document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event11,prodView&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Beach Bookflow Events\n        if (document.URL.indexOf('bookaccommodation') != -1) {\n        s.events = s.apl(s.events, &quot;event15&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/book/mobile/hubsummary') != -1) {\n        s.events = s.apl(s.events, &quot;event16&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/flightoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/flightoptions') != -1 || document.URL.indexOf('/destinations/book/flow/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flightoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/flightoptions') != -1 || document.URL.indexOf('/f/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/mobile/flightoptions') != -1 || document.URL.indexOf('/retail/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event17,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/roomoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/roomoptions') != -1 || document.URL.indexOf('/destinations/book/flow/roomoptions') != -1 || document.URL.indexOf('/holiday/book/roomoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/roomoptions') != -1 || document.URL.indexOf('/holiday/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/roomoptions') != -1 || document.URL.indexOf('/f/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/mobile/roomoptions') != -1 || document.URL.indexOf('/retail/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event18&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/extraoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/extraoptions') != -1 || document.URL.indexOf('/destinations/book/flow/extraoptions') != -1 || document.URL.indexOf('/holiday/book/extraoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/extraoptions') != -1 || document.URL.indexOf('/holiday/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/extraoptions') != -1 || document.URL.indexOf('/f/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/mobile/extraoptions') != -1 || document.URL.indexOf('/retail/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event19&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/passengerdetails') != -1 || document.URL.indexOf('/destinations/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/f/book/passengerdetails') != -1 || document.URL.indexOf('/f/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/retail/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event20,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('25000') != -1 || s.Util.getQueryParam('b').indexOf('32000') != -1 || s.Util.getQueryParam('b').indexOf('50000') != -1 || s.Util.getQueryParam('b').indexOf('19000') != -1 || s.Util.getQueryParam('b').indexOf('41000') != -1 || s.Util.getQueryParam('b').indexOf('31000') != -1 || s.Util.getQueryParam('b').indexOf('10000') != -1 || s.Util.getQueryParam('b').indexOf('20000') != -1 || s.Util.getQueryParam('b').indexOf('42000') != -1 || s.Util.getQueryParam('b').indexOf('51000') != -1 || s.Util.getQueryParam('b').indexOf('52000') != -1 || s.Util.getQueryParam('b').indexOf('53000') != -1 || s.Util.getQueryParam('b').indexOf('38000') != -1)) {\n        s.events = s.apl(s.events, &quot;event21&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/confirmation') != -1 || document.URL.indexOf('/destinations/book/mobile/confirmation') != -1 || document.URL.indexOf('/holiday/book/confirmation') != -1 || document.URL.indexOf('/holiday/book/mobile/confirmation') != -1 || document.URL.indexOf('/f/book/confirmation') != -1 || document.URL.indexOf('/f/book/mobile/confirmation') != -1 || document.URL.indexOf('/managemybooking/paymentconfirmation') != -1 || document.URL.indexOf('/retail/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/book/bookingConfirmation') != -1) {\n        if (window.tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' || dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          s.events = s.apl(s.events, &quot;event22&quot;, &quot;,&quot;, 1);\n        }\n        }\n        \n        // Cruise Bookflow Events\t\n        else if (document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event23&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/packages/hotels') != -1) {\n        s.events = s.apl(s.events, &quot;event24&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/bookHotelDetails') != -1) {\n        s.events = s.apl(s.events, &quot;event25&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/cruiseoptions') != -1 || document.URL.indexOf('/cruise/book/flow/cruiseoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event26,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/flightoptions') != -1 || document.URL.indexOf('/cruise/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event27&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/roomoptions') != -1 || document.URL.indexOf('/cruise/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event28&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/extraoptions') != -1 || document.URL.indexOf('/cruise/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event29&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event30,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('37000') != -1 || s.Util.getQueryParam('b').indexOf('54000') != -1 || s.Util.getQueryParam('b').indexOf('49000') != -1)) {\n        s.events = s.apl(s.events, &quot;event31&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/confirmation') != -1 || document.URL.indexOf('/retail/cruise/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/cruise/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event32&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // Flight Only Bookflow Events\t\t\n        else if (document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event33,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/extraoptions') != -1 || document.URL.indexOf('/flight/book/mobile/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event34&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/passengerdetails') != -1 || document.URL.indexOf('/flight/book/mobile/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event35,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('39000') != -1 || s.Util.getQueryParam('b').indexOf('47000') != -1 || s.Util.getQueryParam('b').indexOf('40000') != -1 || s.Util.getQueryParam('b').indexOf('48000') != -1 || s.Util.getQueryParam('b').indexOf('59000') != -1 || s.Util.getQueryParam('b').indexOf('60000') != -1)) {\n        s.events = s.apl(s.events, &quot;event36&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/confirmation') != -1 || document.URL.indexOf('/flight/book/mobile/confirmation') != -1 || document.URL.indexOf('/retail/flight/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/flight/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event37&quot;, &quot;,&quot;, 1);\n        }\n        */\n        \n        // This is for event 8 (Pax) (legacy_numberOfPax)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + tui.analytics.page.Pax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].transactions.total.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].basket.price.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].product.noOfPax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].page.search.noOfPax, &quot;,&quot;, 1);\n        }\n        */\n        \n        // This is for event 10 (Discount) (legacy_onlineDiscount)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + tui.analytics.page.Disc, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].transactions.total.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].basket.price.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].product.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(jsonData.packageViewData.onlineDiscount).toString(), &quot;,&quot;, 1);\n        }\n        */\n        \n        \n        // This is for event 38 (Revenue) \n        \n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n        if (window.tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0)) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount)), &quot;,&quot;, 1);\n        } else {\n          s.events = s.events = s.apl(s.events, &quot;event38=&quot; + tui.analytics.page.Sum, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n        if (window.dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].transactions.total.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n        if (window.dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].basket.price.totalPrice + dataLayer[0].basket.price.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].basket.price.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n        s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].product.currentPrice, &quot;,&quot;, 1);\n        }\n        \n        // For Privacy\n        /* // moved, since this logic isn't relevant post-migration\n        try {\n        var privacyExperience = Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience');\n        if (privacyExperience !== 'C') {\n          if (window.gateway &amp;&amp; window.gateway.isInitialized &amp;&amp; String(Bootstrapper.gateway.getCookie('BANNER_VIEWED')) !== '1') {\n            s.events = s.apl(s.events, 'event107', ',', 1);\n          }\n        }\n        } catch (err) {\n        console.log('Ensighten:event107 not set');\n        }\n        */\n        \n        return s.events;\n        })(s.events)\n\t\n\t// Custom pageview event\n\ts.events = s.apl(s.events,&quot;event3&quot;,&quot;,&quot;,1);\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"Updated 20 Jan 2020 from uk profile"}},"promotedSnippets":{"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"promotedTimestamp":"202101191702","promotedDraftName":"Draft 1","promotedBy":"caleb.jaquith@tealium.com","code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n\ts.events = (function ensightenAdobeEventLogic(existingEventString) {\n        s.events = existingEventString || ''\n        \n        var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n        \n        totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n        \n        creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n        \n        creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n        \n        onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n        \n        bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n        \n        incentivePromoValue = incentivePromoDiscount();\n        \n        function incentivePromoDiscount() {\n        \n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          var result = 0;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              result = promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n          return result;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n          return parseFloat(tui.analytics.page.IncentivePromoValue);\n        } else {\n          return 0;\n        }\n        }\n        \n        //Normal Bookflow &amp; LYP with same confirmation url\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n          s.events = &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n            +\n            &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;;\n        } else {\n          s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n            +\n            &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n            +\n            &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n            +\n            &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n            +\n            &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice); // multiple promocode - maintaining redemption code reporting\n        }\n        }\n        \n        //LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\n        else if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n        s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n          +\n          &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;; //added 158&amp;159 for PC Incentive\n        }\n        \n        //MMB Unpaid\n        else if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n            s.events = &quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Paid\n        else if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n            s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Cancel\n        else if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n            s.events = &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n          }\n        }\n        }\n        \n        //Price Variation Alert\n        else if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n        var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n        var price = document.querySelectorAll('.alertprice');\n        if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, '');\n        } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, '');\n        }\n        }\n        \n        // Credit Note Booking\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n        var creditNoteBooking = b.legacy_isCreditNoteBooking || ''\n        if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          s.events = s.apl(s.events, 'event70', ',', 1);\n        }\n        }\n        \n        \n        // Performance Timing Replacement\n        /*\n        var pt = (Bootstrapper.PTE &amp;&amp; Bootstrapper.PTE.performanceTimings &amp;&amp; Bootstrapper.PTE.performanceTimings.get ? Bootstrapper.PTE.performanceTimings.get() : '');\n        \n        if (pt) {\n            pt = pt.split('|');\n            s.events = s.apl(s.events,'event980=' + pt[0],',',1);\n            s.events = s.apl(s.events,'event981=' + pt[1],',',1);\n            s.events = s.apl(s.events,'event982=' + pt[2],',',1);\n            s.events = s.apl(s.events,'event983=' + pt[3],',',1);\n            s.events = s.apl(s.events,'event984=' + pt[4],',',1);\n            s.events = s.apl(s.events,'event985=' + pt[5],',',1);\n            s.events = s.apl(s.events,'event986=' + pt[6],',',1);\n            s.events = s.apl(s.events,'event987=' + pt[7],',',1);\n            s.events = s.apl(s.events,'event988=' + pt[8],',',1);\n            \n            if (pt[9] &gt; 0) {\n                s.events = s.apl(s.events,'event989=' + pt[9],',',1);\n            }\n            if (pt[10] &gt; 0) {\n            s.events = s.apl(s.events,'event990=' + pt[10],',',1);\n            }\n            s.events = s.apl(s.events,'event1000',',',1);\n        }\n        */\n        \n        // Bookflow Events\n        // Search\n        if (document.URL.indexOf('/destinations/packages') != -1 || document.URL.indexOf('/flight/search') != -1 || document.URL.indexOf('/cruise/packages') != -1 || document.URL.indexOf('/holiday/packages') != -1 || document.URL.indexOf('/f/packages') != -1 || document.URL.indexOf('/river-cruises/packages') != -1 || document.URL.indexOf('/retail/packages') != -1) {\n        s.events = s.apl(s.events, &quot;event1&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Product View &amp; Custom Product View\n        if (document.URL.indexOf('/bookaccommodation') != -1 || document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1 || document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event11,prodView&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Beach Bookflow Events\n        if (document.URL.indexOf('bookaccommodation') != -1) {\n        s.events = s.apl(s.events, &quot;event15&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/book/mobile/hubsummary') != -1) {\n        s.events = s.apl(s.events, &quot;event16&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/flightoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/flightoptions') != -1 || document.URL.indexOf('/destinations/book/flow/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flightoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/flightoptions') != -1 || document.URL.indexOf('/f/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/mobile/flightoptions') != -1 || document.URL.indexOf('/retail/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event17,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/roomoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/roomoptions') != -1 || document.URL.indexOf('/destinations/book/flow/roomoptions') != -1 || document.URL.indexOf('/holiday/book/roomoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/roomoptions') != -1 || document.URL.indexOf('/holiday/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/roomoptions') != -1 || document.URL.indexOf('/f/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/mobile/roomoptions') != -1 || document.URL.indexOf('/retail/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event18&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/extraoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/extraoptions') != -1 || document.URL.indexOf('/destinations/book/flow/extraoptions') != -1 || document.URL.indexOf('/holiday/book/extraoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/extraoptions') != -1 || document.URL.indexOf('/holiday/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/extraoptions') != -1 || document.URL.indexOf('/f/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/mobile/extraoptions') != -1 || document.URL.indexOf('/retail/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event19&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/passengerdetails') != -1 || document.URL.indexOf('/destinations/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/f/book/passengerdetails') != -1 || document.URL.indexOf('/f/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/retail/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event20,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('25000') != -1 || s.Util.getQueryParam('b').indexOf('32000') != -1 || s.Util.getQueryParam('b').indexOf('50000') != -1 || s.Util.getQueryParam('b').indexOf('19000') != -1 || s.Util.getQueryParam('b').indexOf('41000') != -1 || s.Util.getQueryParam('b').indexOf('31000') != -1 || s.Util.getQueryParam('b').indexOf('10000') != -1 || s.Util.getQueryParam('b').indexOf('20000') != -1 || s.Util.getQueryParam('b').indexOf('42000') != -1 || s.Util.getQueryParam('b').indexOf('51000') != -1 || s.Util.getQueryParam('b').indexOf('52000') != -1 || s.Util.getQueryParam('b').indexOf('53000') != -1 || s.Util.getQueryParam('b').indexOf('38000') != -1)) {\n        s.events = s.apl(s.events, &quot;event21&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/confirmation') != -1 || document.URL.indexOf('/destinations/book/mobile/confirmation') != -1 || document.URL.indexOf('/holiday/book/confirmation') != -1 || document.URL.indexOf('/holiday/book/mobile/confirmation') != -1 || document.URL.indexOf('/f/book/confirmation') != -1 || document.URL.indexOf('/f/book/mobile/confirmation') != -1 || document.URL.indexOf('/managemybooking/paymentconfirmation') != -1 || document.URL.indexOf('/retail/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/book/bookingConfirmation') != -1) {\n        if (window.tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' || dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          s.events = s.apl(s.events, &quot;event22&quot;, &quot;,&quot;, 1);\n        }\n        }\n        \n        // Cruise Bookflow Events\t\n        /*else if (document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event23&quot;, &quot;,&quot;, 1);\n        }*/ else if (document.URL.indexOf('/cruise/packages/hotels') != -1) {\n        s.events = s.apl(s.events, &quot;event24&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/bookHotelDetails') != -1) {\n        s.events = s.apl(s.events, &quot;event25&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/cruiseoptions') != -1 || document.URL.indexOf('/cruise/book/flow/cruiseoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event26,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/flightoptions') != -1 || document.URL.indexOf('/cruise/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event27&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/roomoptions') != -1 || document.URL.indexOf('/cruise/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event28&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/extraoptions') != -1 || document.URL.indexOf('/cruise/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event29&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event30,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('37000') != -1 || s.Util.getQueryParam('b').indexOf('54000') != -1 || s.Util.getQueryParam('b').indexOf('49000') != -1)) {\n        s.events = s.apl(s.events, &quot;event31&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/confirmation') != -1 || document.URL.indexOf('/retail/cruise/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/cruise/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event32&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // Flight Only Bookflow Events\t\t\n        else if (document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event33,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/extraoptions') != -1 || document.URL.indexOf('/flight/book/mobile/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event34&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/passengerdetails') != -1 || document.URL.indexOf('/flight/book/mobile/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event35,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('39000') != -1 || s.Util.getQueryParam('b').indexOf('47000') != -1 || s.Util.getQueryParam('b').indexOf('40000') != -1 || s.Util.getQueryParam('b').indexOf('48000') != -1 || s.Util.getQueryParam('b').indexOf('59000') != -1 || s.Util.getQueryParam('b').indexOf('60000') != -1)) {\n        s.events = s.apl(s.events, &quot;event36&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/confirmation') != -1 || document.URL.indexOf('/flight/book/mobile/confirmation') != -1 || document.URL.indexOf('/retail/flight/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/flight/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event37&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // This is for event 8 (Pax) (legacy_numberOfPax)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + tui.analytics.page.Pax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].transactions.total.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].basket.price.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].product.noOfPax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].page.search.noOfPax, &quot;,&quot;, 1);\n        }\n        */\n        \n        // This is for event 10 (Discount) (legacy_onlineDiscount)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + tui.analytics.page.Disc, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].transactions.total.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].basket.price.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].product.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(jsonData.packageViewData.onlineDiscount).toString(), &quot;,&quot;, 1);\n        }\n        */\n        \n        \n        // This is for event 38 (Revenue) \n        \n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n        if (window.tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0)) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount)), &quot;,&quot;, 1);\n        } else {\n          s.events = s.events = s.apl(s.events, &quot;event38=&quot; + tui.analytics.page.Sum, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n        if (window.dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].transactions.total.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n        if (window.dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].basket.price.totalPrice + dataLayer[0].basket.price.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].basket.price.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n        s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].product.currentPrice, &quot;,&quot;, 1);\n        }\n        \n        // For Privacy\n        /* // moved, since this logic isn't relevant post-migration\n        try {\n        var privacyExperience = Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience');\n        if (privacyExperience !== 'C') {\n          if (window.gateway &amp;&amp; window.gateway.isInitialized &amp;&amp; String(Bootstrapper.gateway.getCookie('BANNER_VIEWED')) !== '1') {\n            s.events = s.apl(s.events, 'event107', ',', 1);\n          }\n        }\n        } catch (err) {\n        console.log('Ensighten:event107 not set');\n        }\n        */\n        \n        return s.events;\n        })(s.events)\n\t\n\t// Custom pageview event\n\ts.events = s.apl(s.events,&quot;event3&quot;,&quot;,&quot;,1);\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"qa"},"6754af9632a2745e85c293e5aac0863370d9bd3330b9938c00cadfd215227d77":{"code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n\ts.events = (function ensightenAdobeEventLogic(existingEventString) {\n        s.events = existingEventString || ''\n        \n        var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n        \n        totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n        \n        creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n        \n        creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n        \n        onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n        \n        bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n        \n        incentivePromoValue = incentivePromoDiscount();\n        \n        function incentivePromoDiscount() {\n        \n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          var result = 0;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              result = promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n          return result;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n          return parseFloat(tui.analytics.page.IncentivePromoValue);\n        } else {\n          return 0;\n        }\n        }\n        \n        //Normal Bookflow &amp; LYP with same confirmation url\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n          s.events = &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n            +\n            &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;;\n        } else {\n          s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n            +\n            &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n            +\n            &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n            +\n            &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n            +\n            &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice); // multiple promocode - maintaining redemption code reporting\n        }\n        }\n        \n        //LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\n        else if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n        s.events = &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n          +\n          &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;; //added 158&amp;159 for PC Incentive\n        }\n        \n        //MMB Unpaid\n        else if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n            s.events = &quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Paid\n        else if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n            s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n            /*\n            if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n               if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n                s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n               }\n            }*/\n        \n            // Start\n            var dl = window.dataLayer\n            if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n              // If old object is shown - can be removed at a later date\n              if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                // Check for PC &amp; MMB/Booking Incentive\n                if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                  // Programme Change Incentive\n                  if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                  // MMB/Booking Incentive\n                  if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                    s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                  }\n                } else {\n                  s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n                }\n                // Added to handle new promo code array\n              } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n                for (i = 0; i &lt; promoCodeArray.length; i++) {\n        \n                  if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                    // Programme Change Incentive\n                    if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                    // MMB/Booking Incentive\n                    if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                      s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                    }\n                  } else {\n                    s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                  }\n                }\n              }\n              // For legacy data layer (only single promo code &amp; value)\t\n            } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                } else {\n                  s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n                }\n              }\n            } //End\n          }\n        }\n        }\n        \n        //MMB Cancel\n        else if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n        for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n          if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n            s.events = &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n          }\n        }\n        }\n        \n        //Price Variation Alert\n        else if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n        var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n        var price = document.querySelectorAll('.alertprice');\n        if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, '');\n        } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n          s.events = &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, '');\n        }\n        }\n        \n        // Credit Note Booking\n        if ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n        // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n        var creditNoteBooking = b.legacy_isCreditNoteBooking || ''\n        if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          s.events = s.apl(s.events, 'event70', ',', 1);\n        }\n        }\n        \n        \n        // Performance Timing Replacement\n        /*\n        var pt = (Bootstrapper.PTE &amp;&amp; Bootstrapper.PTE.performanceTimings &amp;&amp; Bootstrapper.PTE.performanceTimings.get ? Bootstrapper.PTE.performanceTimings.get() : '');\n        \n        if (pt) {\n            pt = pt.split('|');\n            s.events = s.apl(s.events,'event980=' + pt[0],',',1);\n            s.events = s.apl(s.events,'event981=' + pt[1],',',1);\n            s.events = s.apl(s.events,'event982=' + pt[2],',',1);\n            s.events = s.apl(s.events,'event983=' + pt[3],',',1);\n            s.events = s.apl(s.events,'event984=' + pt[4],',',1);\n            s.events = s.apl(s.events,'event985=' + pt[5],',',1);\n            s.events = s.apl(s.events,'event986=' + pt[6],',',1);\n            s.events = s.apl(s.events,'event987=' + pt[7],',',1);\n            s.events = s.apl(s.events,'event988=' + pt[8],',',1);\n            \n            if (pt[9] &gt; 0) {\n                s.events = s.apl(s.events,'event989=' + pt[9],',',1);\n            }\n            if (pt[10] &gt; 0) {\n            s.events = s.apl(s.events,'event990=' + pt[10],',',1);\n            }\n            s.events = s.apl(s.events,'event1000',',',1);\n        }\n        */\n        \n        // Bookflow Events\n        // Search\n        if (document.URL.indexOf('/destinations/packages') != -1 || document.URL.indexOf('/flight/search') != -1 || document.URL.indexOf('/cruise/packages') != -1 || document.URL.indexOf('/holiday/packages') != -1 || document.URL.indexOf('/f/packages') != -1 || document.URL.indexOf('/river-cruises/packages') != -1 || document.URL.indexOf('/retail/packages') != -1) {\n        s.events = s.apl(s.events, &quot;event1&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Product View &amp; Custom Product View\n        if (document.URL.indexOf('/bookaccommodation') != -1 || document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1 || document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event11,prodView&quot;, &quot;,&quot;, 1);\n        }\n        \n        // Beach Bookflow Events\n        if (document.URL.indexOf('bookaccommodation') != -1) {\n        s.events = s.apl(s.events, &quot;event15&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/book/mobile/hubsummary') != -1) {\n        s.events = s.apl(s.events, &quot;event16&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/flightoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/flightoptions') != -1 || document.URL.indexOf('/destinations/book/flow/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flightoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/flightoptions') != -1 || document.URL.indexOf('/holiday/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/flightoptions') != -1 || document.URL.indexOf('/f/book/flow/flightoptions') != -1 || document.URL.indexOf('/f/book/mobile/flightoptions') != -1 || document.URL.indexOf('/retail/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event17,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/roomoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/roomoptions') != -1 || document.URL.indexOf('/destinations/book/flow/roomoptions') != -1 || document.URL.indexOf('/holiday/book/roomoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/roomoptions') != -1 || document.URL.indexOf('/holiday/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/roomoptions') != -1 || document.URL.indexOf('/f/book/flow/roomoptions') != -1 || document.URL.indexOf('/f/book/mobile/roomoptions') != -1 || document.URL.indexOf('/retail/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event18&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/extraoptions') != -1 || document.URL.indexOf('/destinations/book/mobile/extraoptions') != -1 || document.URL.indexOf('/destinations/book/flow/extraoptions') != -1 || document.URL.indexOf('/holiday/book/extraoptions') != -1 || document.URL.indexOf('/holiday/book/mobile/extraoptions') != -1 || document.URL.indexOf('/holiday/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/extraoptions') != -1 || document.URL.indexOf('/f/book/flow/extraoptions') != -1 || document.URL.indexOf('/f/book/mobile/extraoptions') != -1 || document.URL.indexOf('/retail/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event19&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/passengerdetails') != -1 || document.URL.indexOf('/destinations/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/passengerdetails') != -1 || document.URL.indexOf('/holiday/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/f/book/passengerdetails') != -1 || document.URL.indexOf('/f/book/mobile/passengerdetails') != -1 || document.URL.indexOf('/retail/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event20,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('25000') != -1 || s.Util.getQueryParam('b').indexOf('32000') != -1 || s.Util.getQueryParam('b').indexOf('50000') != -1 || s.Util.getQueryParam('b').indexOf('19000') != -1 || s.Util.getQueryParam('b').indexOf('41000') != -1 || s.Util.getQueryParam('b').indexOf('31000') != -1 || s.Util.getQueryParam('b').indexOf('10000') != -1 || s.Util.getQueryParam('b').indexOf('20000') != -1 || s.Util.getQueryParam('b').indexOf('42000') != -1 || s.Util.getQueryParam('b').indexOf('51000') != -1 || s.Util.getQueryParam('b').indexOf('52000') != -1 || s.Util.getQueryParam('b').indexOf('53000') != -1 || s.Util.getQueryParam('b').indexOf('38000') != -1)) {\n        s.events = s.apl(s.events, &quot;event21&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/destinations/book/confirmation') != -1 || document.URL.indexOf('/destinations/book/mobile/confirmation') != -1 || document.URL.indexOf('/holiday/book/confirmation') != -1 || document.URL.indexOf('/holiday/book/mobile/confirmation') != -1 || document.URL.indexOf('/f/book/confirmation') != -1 || document.URL.indexOf('/f/book/mobile/confirmation') != -1 || document.URL.indexOf('/managemybooking/paymentconfirmation') != -1 || document.URL.indexOf('/retail/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/book/bookingConfirmation') != -1) {\n        if (window.tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' || dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          s.events = s.apl(s.events, &quot;event22&quot;, &quot;,&quot;, 1);\n        }\n        }\n        \n        // Cruise Bookflow Events\t\n        /*else if (document.URL.indexOf('/cruise/bookitineraries') != -1) {\n        s.events = s.apl(s.events, &quot;event23&quot;, &quot;,&quot;, 1);\n        }*/ else if (document.URL.indexOf('/cruise/packages/hotels') != -1) {\n        s.events = s.apl(s.events, &quot;event24&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/bookHotelDetails') != -1) {\n        s.events = s.apl(s.events, &quot;event25&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/cruiseoptions') != -1 || document.URL.indexOf('/cruise/book/flow/cruiseoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event26,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/flightoptions') != -1 || document.URL.indexOf('/cruise/book/flow/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event27&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/roomoptions') != -1 || document.URL.indexOf('/cruise/book/flow/roomoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event28&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/extraoptions') != -1 || document.URL.indexOf('/cruise/book/flow/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event29&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event30,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('37000') != -1 || s.Util.getQueryParam('b').indexOf('54000') != -1 || s.Util.getQueryParam('b').indexOf('49000') != -1)) {\n        s.events = s.apl(s.events, &quot;event31&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cruise/book/confirmation') != -1 || document.URL.indexOf('/retail/cruise/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/cruise/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event32&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // Flight Only Bookflow Events\t\t\n        else if (document.URL.indexOf('/flight/book/flightoptions') != -1 || document.URL.indexOf('/flight/book/mobile/flightoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event33,scView,scOpen,scAdd&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/extraoptions') != -1 || document.URL.indexOf('/flight/book/mobile/extraoptions') != -1) {\n        s.events = s.apl(s.events, &quot;event34&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/passengerdetails') != -1 || document.URL.indexOf('/flight/book/mobile/passengerdetails') != -1) {\n        s.events = s.apl(s.events, &quot;event35,scCheckout&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/cps/pageRender') != -1 &amp;&amp; (s.Util.getQueryParam('b').indexOf('39000') != -1 || s.Util.getQueryParam('b').indexOf('47000') != -1 || s.Util.getQueryParam('b').indexOf('40000') != -1 || s.Util.getQueryParam('b').indexOf('48000') != -1 || s.Util.getQueryParam('b').indexOf('59000') != -1 || s.Util.getQueryParam('b').indexOf('60000') != -1)) {\n        s.events = s.apl(s.events, &quot;event36&quot;, &quot;,&quot;, 1);\n        } else if (document.URL.indexOf('/flight/book/confirmation') != -1 || document.URL.indexOf('/flight/book/mobile/confirmation') != -1 || document.URL.indexOf('/retail/flight/book/bookingConfirmation') != -1 || document.URL.indexOf('/retail/f/flight/book/bookingConfirmation') != -1) {\n        s.events = s.apl(s.events, &quot;event37&quot;, &quot;,&quot;, 1);\n        }\n        \n        \n        // This is for event 8 (Pax) (legacy_numberOfPax)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + tui.analytics.page.Pax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].transactions.total.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].basket.price.paxDetails.total, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].product.noOfPax, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n        s.events = s.apl(s.events, &quot;event8=&quot; + dataLayer[0].page.search.noOfPax, &quot;,&quot;, 1);\n        }\n        */\n        \n        // This is for event 10 (Discount) (legacy_onlineDiscount)\n        // MOVED to mapping\n        /*\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + tui.analytics.page.Disc, &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].transactions.total.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].basket.price.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(dataLayer[0].product.discount).toString(), &quot;,&quot;, 1);\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n        s.events = s.apl(s.events, &quot;event10=&quot; + Math.round(jsonData.packageViewData.onlineDiscount).toString(), &quot;,&quot;, 1);\n        }\n        */\n        \n        \n        // This is for event 38 (Revenue) \n        \n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n        if (window.tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0)) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount)), &quot;,&quot;, 1);\n        } else {\n          s.events = s.events = s.apl(s.events, &quot;event38=&quot; + tui.analytics.page.Sum, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n        if (window.dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].transactions.total.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n        if (window.dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n          s.events = s.apl(s.events, &quot;event38=&quot; + (dataLayer[0].basket.price.totalPrice + dataLayer[0].basket.price.bookingLevelCreditNoteDiscount), &quot;,&quot;, 1);\n        } else {\n          s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].basket.price.totalPrice, &quot;,&quot;, 1);\n        }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n        s.events = s.apl(s.events, &quot;event38=&quot; + dataLayer[0].product.currentPrice, &quot;,&quot;, 1);\n        }\n        \n        // For Privacy\n        /* // moved, since this logic isn't relevant post-migration\n        try {\n        var privacyExperience = Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience');\n        if (privacyExperience !== 'C') {\n          if (window.gateway &amp;&amp; window.gateway.isInitialized &amp;&amp; String(Bootstrapper.gateway.getCookie('BANNER_VIEWED')) !== '1') {\n            s.events = s.apl(s.events, 'event107', ',', 1);\n          }\n        }\n        } catch (err) {\n        console.log('Ensighten:event107 not set');\n        }\n        */\n        \n        return s.events;\n        })(s.events)\n\t\n\t// Custom pageview event\n\ts.events = s.apl(s.events,&quot;event3&quot;,&quot;,&quot;,1);\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"prod","promotedTimestamp":"202101191702","promotedDraftName":"Draft 1","promotedBy":"caleb.jaquith@tealium.com"},"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"code":"// Performance Timing Events\ns.pte = 'event980,event981,event982,event983,event984,event985,event986,event987,event988,event989,event990,event1000';\n//[--------------------------- 1 to 8 ---------------------------][-- 9 --][- 10 -]\ns.ptc = false;\n\ns.usePlugins=true;\nfunction s_doPlugins(s) {\n\n    // Sets server\n\ts.server = document.location.host;\n\t\n    // Time parting used for eVar 31 and 32\n\ttpA = s.getTimeParting('n','0');\n\ttpAh = tpA[1].split(':')[0];\n\tif(tpA[1].indexOf('PM')!=-1)\n\t{\n\t\tif(eval(tpAh) != 12)\n\t\ttpAh = eval(tpAh) + 12;\n\t}\n\tif (tpA[1].indexOf(&quot;AM&quot;) != -1) \n\tif (eval(tpAh) == 12) tpAh = &quot;0&quot;;\n\ttmAm = tpA[0].split(':')[1];\n\ttmAm = tmAm.replace(/\\D/g, '');\n\t\n\n\t/* Performance Timing Called */\n\ts.performanceTiming();\n    /*    \n    if (s.linkType === 'e') {\n        var pt = (window.Bootstrapper.PTE &amp;&amp; window.Bootstrapper.PTE.performanceTimings &amp;&amp; window.Bootstrapper.PTE.performanceTimings.get ? window.Bootstrapper.PTE.performanceTimings.get(true) : ''),\n            timingEvents = ['980', '981', '982', '983', '984', '985', '986', '987', '988', '989', '990'];\n\n        if (pt) {\n            pt = pt.split('|');\n            s.linkTrackVars = s.apl(s.linkTrackVars, 'events', ',', 1);\n\n            for (var i = 0; i &lt; pt.length; i++) {\n                if ((i &lt; 9) || pt[i] &gt; 0) {\n                    s.events = s.apl(s.events, 'event' + timingEvents[i] + '=' + pt[i], ',', 1);\n                    s.linkTrackEvents = s.apl(s.linkTrackEvents, 'event' + timingEvents[i], ',', 1);\n                }\n            }\n            s.events = s.apl(s.events, 'event1000', ',', 1);\n        }\n        else {\n            for (var i = 0; i &lt; timingEvents.length; i++) {\n                var regex = new RegExp('event' + timingEvents[i] + ',?', 'g');\n                s.linkTrackEvents = s.linkTrackEvents.replace(regex, '');\n            }\n        }\n    }\n\t*/\n    /* If GSA Internal search term exists then fire search event*/\n\tif(s.eVar8!==&quot;&quot;){\n        s.events = s.apl(s.events,&quot;event1&quot;,&quot;,&quot;,1);\n\t}\n\n\ts.eVar31 = tpAh;\n\ts.eVar32 = tpA[2];\n\t\n    //Note: IE browsers can be in only visitor's local time\n    s.eVar7 = getTimeParting2(&quot;Europe/London&quot;);\t\n\n    // Prod View event initiates time to complete calculation\n\tif(s.events.indexOf('prodView')&gt;-1)\n        s.eVar34='start';\n\n    // Purchase event finishes time to complete calculation \n\tif(s.events.indexOf('purchase')&gt;-1)\n        s.eVar34='stop';\n\n    // Time To Complete Checkout\n\ts.eVar34 = s.getTimeToComplete(s.eVar34,'ttc',0);\n\n    // New or Repeat\n\ts.eVar35 = s.getNewRepeat();\n\n    // Days Since Last Visit\n\ts.eVar36 = s.getDaysSinceLastVisit('s_lv');\n\n    // Page URL\n\t//.prop38 = s.eVar38 = document.location.host + document.location.pathname;\n\t\n\t// Previous Page URL eVar\n\ts.eVar159 = s.getPreviousValue(s.eVar38,'gpv_pn');\n\t\n\t// Previous Page ID eVar\n\ts.eVar160 = s.getPreviousValue(s.eVar45,'gpv_pn2');\n    \n    // Query String eVar\n\tvar url_split = document.URL.split('?')[1];\n\tif(typeof url_split != 'undefined')\n\ts.eVar39 =  url_split;\n\n    // Minute of hour eVar\n\ts.eVar40 = tmAm;\n\n    // User Agent eVar\n\t//s.eVar41 =&quot;D=User-Agent&quot;;\n\n    // Marketing Cloud Visitor ID eVar\n\tif(typeof visitor != 'undefined')\n\ts.eVar44 = visitor.getMarketingCloudVisitorID();\n\n    // Brand\n\t//s.eVar48 = s.prop48 = brand; \n    \n    \n    // Page Depth Tracking - Action Depth Test was previously defined in base code\n    s.ActionDepthTest = true;\n    if (s.ActionDepthTest) {\n      s.eVar75 = s.getActionDepthVisitor(&quot;s_depth&quot;);\n      s.eVar76 = s.getActionDepth('s_depth_visit');\n      s.ActionDepthTest = false;\n    }\n\t\n\t//Time Stamp \n\n\ts.eVar77 = startTime();\n\n}\n\ns.doPlugins=s_doPlugins;\n\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepth = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n\n  /*\n   * Plugin: getActionDepth v1.0 - Returns the current\n   * page number of the visit\n   */\n  s.getActionDepthVisitor = new Function(&quot;c&quot;, &quot;&quot; + &quot;var s=this,v,t=new Date;t.setFullYear(t.getFullYear()+2);&quot; + &quot;if(!s.c_r(c)){v=1}if(s.c_r(c)){v=s.c_r(c);v++}&quot; + &quot;if(!s.c_w(c,v,t)){s.c_w(c,v,0)}return v;&quot;);\n \n \n// Used for Timestamp eVar\nfunction checkTime(i) {\n    if (i &lt; 10) {\n        i = &quot;0&quot; + i;\n    }\nreturn i;\n}\n\nfunction startTime() {\n    var today = new Date();\n    var h = today.getHours();\n    var m = today.getMinutes();\n    var s = today.getSeconds();\n    // add a zero in front of numbers&lt;10\n    m = checkTime(m);\n    s = checkTime(s);\n    h = checkTime(h);\n\treturn h + &quot;:&quot; + m + &quot;:&quot; + s;\n}\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/* Plugin: Performance Timing Tracking - 0.1 BETA */\ns.performanceTiming = function(v){\n    var s=this;\n    if(v) s.ptv=v;\n    if(typeof performance!='undefined'){\n        if(performance.timing.loadEventEnd==0){\n            s.pi=setInterval(function(){s.performanceWrite()},250);\n        }\n        if(!s.ptc||s.linkType=='e'){\n            s.performanceRead();\n        }\n        else{s.rfe();\n        s[s.ptv]='';\n        }\n     }\n};\n\ns.performanceWrite = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    try{\n        if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){\n            try{\n                var pt=performance.timing;\n                var pta='';\n                pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);\n                pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);\n                pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);\n                pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd); \n                pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);\n                pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0); // Added for First Paint Metric\n\t\t\t\tpta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0); // Added for First Contentful Paint Metric\n                s.c_w('s_ptc',pta);\n                    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n                        var pe=performance.getEntries();\n                        var tempPe='';\n                        for(var i=0;i&lt;pe.length;i++){\n                            tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;\n                            tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}\n                            sessionStorage.setItem('s_pec',tempPe);\n                    }\n            }\n            catch(err){\n                return;\n            }\n        }\n    }\n    catch(err){\n        return;\n    }\n};\ns.performanceCheck = function(a,b){\n    if(a&gt;=0&amp;&amp;b&gt;=0){\n        if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){\n            return((a-b)/1000).toFixed(2);\n        }\n        else{\n            return 600;\n        }\n    }\n};\ns.performanceRead = function(){\n    var s=this;\n    if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);\n    var cv=s.c_r('s_ptc');\n    if(s.pte){\n        var ela=s.pte.split(',');\n    }\n    if(cv!=''){\n        var cva=s.split(cv,'^^');\n        if(cva[1]!=''){\n            for(var x=0;x&lt;(ela.length-1);x++){\n                s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);\n            }\n        }\n        s.events=s.apl(s.events,ela[ela.length-1],',',2);\n    }\n    s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);\n    s.c_w('s_ptc','',0);\n    if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){\n        s[s.ptv]=sessionStorage.getItem('s_pec');\n        sessionStorage.setItem('s_pec','',0);\n    }\n    else{\n        s[s.ptv]='sessionStorage Unavailable';\n    }\n    s.ptc=true;\n}\n\ns.rfe = function(){\n    var s=this;\n    var ea=s.split(s.events,',');\n    var pta=s.split(s.pte,',');\n    try{\n        for(x in pta){\n            s.events=s.rfl(s.events,pta[x]);\n            s.contextData['events']=s.events;\n        }\n    }\n    catch(e){\n        return;\n    }\n}\n\ns.rfl = function(l,v,d1,d2,ku){\n\tvar s=this,\n\t\tR=new Array(),\n\t\tC='',\n\t\td1=!d1?',':d1,\n\t\td2=!d2?',':d2,\n\t\tku=!ku?0:1;\n\tif(!l)return'';\n\tL=l.split(d1);\n\tfor(i=0;i&lt;L.length;i++){\n\t\tif(L[i].indexOf(':')&gt;-1){ // remove serialisation to get just the event number\n\t\t\tC=L[i].split(':');\n\t\t\tC[1]=C[0]+':'+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i].indexOf('=')&gt;-1){ // remove numeric event to get just the event number\n\t\t\tC=L[i].split('=');\n\t\t\tC[1]=C[0]+'='+C[1];\n\t\t\tL[i]=C[0];\n\t\t}\n\t\tif(L[i]!=v&amp;&amp;C){ // if it wasn't a duplicate and the variable had extras\n\t\t\tR.push(C[1])\n\t\t}\n\t\telse if(L[i]!=v){ // if it was a duplicate\n\t\t\tR.push(L[i])\n\t\t}\n\t\telse if(L[i]==v&amp;&amp;ku){\n\t\t\tku=0;\n\t\t\tif(C){\n\t\t\t\tR.push(C[1])\n\t\t\t}\n\t\t\telse {\n\t\t\t\tR.push(L[i])\n\t\t\t}\n\t\t}\n\t\tC=''; // clear it back out\n\t}\n\treturn s.join(R,{delim:d2})\n}\n\n\n /* Plugin: Performance Timing Tracking - 0.11 BETA */\n /*\ns.performanceTiming=new Function(&quot;v&quot;,&quot;var s=this;if(v)s.ptv=v;if(typeof performance!='undefined'){if(performance.timing.loadEventEnd==0){s.pi=setInterval(function(){s.performanceWrite()},250);}if(!s.ptc||s.linkType=='e'){s.performanceRead();}else{s.rfe();s[s.ptv]='';}}&quot;);\ns.performanceWrite=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);try{if(s.c_r('s_ptc')==''&amp;&amp;performance.timing.loadEventEnd&gt;0){try{var pt=performance.timing;var pta='';pta=s.performanceCheck(pt.fetchStart,pt.navigationStart);pta+='^^'+s.performanceCheck(pt.domainLookupStart,pt.fetchStart);pta+='^^'+s.performanceCheck(pt.domainLookupEnd,pt.domainLookupStart);pta+='^^'+s.performanceCheck(pt.connectEnd,pt.connectStart);pta+='^^'+s.performanceCheck(pt.responseStart,pt.connectEnd);pta+='^^'+s.performanceCheck(pt.responseEnd,pt.responseStart);pta+='^^'+s.performanceCheck(pt.loadEventStart,pt.domLoading);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.loadEventStart);pta+='^^'+s.performanceCheck(pt.loadEventEnd,pt.navigationStart);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[0].startTime,0);pta+='^^'+s.performanceCheck(performance.getEntriesByType('paint')[1].startTime,0);s.c_w('s_ptc',pta);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){var pe=performance.getEntries();var tempPe='';for(var i=0;i&lt;pe.length;i++){tempPe+='!';tempPe+=pe[i].name.indexOf('?')&gt;-1?pe[i].name.split('?')[0]:pe[i].name;tempPe+='|'+(Math.round(pe[i].startTime)/1000).toFixed(1)+'|'+(Math.round(pe[i].duration)/1000).toFixed(1)+'|'+pe[i].initiatorType;}sessionStorage.setItem('s_pec',tempPe);}}catch(err){return;}}}catch(err){return;}&quot;);\ns.performanceCheck=new Function(&quot;a&quot;,&quot;b&quot;,&quot;if(a&gt;=0&amp;&amp;b&gt;=0){if((a-b)&lt;60000&amp;&amp;((a-b)&gt;=0)){return((a-b)/1000).toFixed(2);}else{return 600;}}&quot;);\ns.performanceRead=new Function(&quot;&quot;,&quot;var s=this;if(performance.timing.loadEventEnd&gt;0)clearInterval(s.pi);var cv=s.c_r('s_ptc');if(s.pte){var ela=s.pte.split(',');}if(cv!=''){var cva=s.split(cv,'^^');if(cva[1]!=''){for(var x=0;x&lt;(ela.length-1);x++){s.events=s.apl(s.events,ela[x]+'='+cva[x],',',2);}}s.events=s.apl(s.events,ela[ela.length-1],',',2);}s.linkTrackEvents=s.apl(s.linkTrackEvents,s.pte,',',2);s.c_w('s_ptc','',0);if(sessionStorage&amp;&amp;navigator.cookieEnabled&amp;&amp;s.ptv!='undefined'){s[s.ptv]=sessionStorage.getItem('s_pec');sessionStorage.setItem('s_pec','',0);}else{s[s.ptv]='sessionStorage Unavailable';}s.ptc=true;&quot;),s.rfe=new Function(&quot;&quot;,&quot;var s=this;var ea=s.split(s.events,',');var pta=s.split(s.pte,',');try{for(x in pta){s.events=s.rfl(s.events,pta[x]);s.contextData['events']=s.events;}}catch(e){return;}&quot;),s.rfl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d1&quot;,&quot;d2&quot;,&quot;ku&quot;,&quot;var s=this,R=new Array(),C='',d1=!d1?',':d1,d2=!d2?',':d2,ku=!ku?0:1;if(!l)return'';L=l.split(d1);for(i=0;i&lt;L.length;i++){if(L[i].indexOf(':')&gt;-1){C=L[i].split(':');C[1]=C[0]+':'+C[1];L[i]=C[0];}if(L[i].indexOf('=')&gt;-1){C=L[i].split('=');C[1]=C[0]+'='+C[1];L[i]=C[0];}if(L[i]!=v&amp;&amp;C)R.push(C[1]);else if(L[i]!=v)R.push(L[i]);else if(L[i]==v&amp;&amp;ku){ku=0;if(C)R.push(C[1]);else R.push(L[i]);}C='';}return s.join(R,{delim:d2})&quot;);\n*/\n /* s.join: 1.0 - Joins an array into a string\n */\ns.join=new Function(&quot;v&quot;,&quot;p&quot;,&quot;&quot;\n+&quot;var s=this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'&quot;\n+&quot;';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x&quot;\n+&quot;&lt;v.length;x++){if(typeof(v[x])=='object')str+=s.join(v[x],p);else s&quot;\n+&quot;tr+=w+v[x]+w;if(x&lt;v.length-1)str+=d;}return f+str+b;&quot;);\n \n/********************************************************************\n *\n * Supporting functions that may be shared between plug-ins\n *\n *******************************************************************/\n\n//Europe\ns._tpDST = { \n\t2012:'3/25,10/28', \n\t2013:'3/31,10/27', \n\t2014:'3/30,10/26', \n\t2015:'3/29,10/25', \n\t2016:'3/27,10/30', \n\t2017:'3/26,10/29', \n\t2018:'3/25,10/28', \n\t2019:'3/31,10/27',\n\t2020:'3/29,10/25',\n\t2021:'3/28,10/31'\n};\n\n\n/*\n * Plugin: getPreviousValue_v1.0 - return previous value of designated\n *   variable (requires split utility)\n */\ns.getPreviousValue=new Function(&quot;v&quot;,&quot;c&quot;,&quot;el&quot;,&quot;&quot;\n+&quot;var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el&quot;\n+&quot;){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i&quot;\n+&quot;){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t)&quot;\n+&quot;:s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?&quot;\n+&quot;s.c_w(c,v,t):s.c_w(c,'no value',t);return r}&quot;);\n\n\n/*\n * Plugin: getTimeParting 3.3\n */\ns.getTimeParting=new Function(&quot;h&quot;,&quot;z&quot;,&quot;&quot;\n+&quot;var s=this,od;od=new Date('1/1/2000');if(od.getDay()!=6||od.getMont&quot;\n+&quot;h()!=0){return'Data Not Available';}else{var H,M,D,W,U,ds,de,tm,tt,&quot;\n+&quot;da=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Sa&quot;\n+&quot;turday'],d=new Date(),a=[];z=z?z:0;z=parseFloat(z);if(s._tpDST){var&quot;\n+&quot; dso=s._tpDST[d.getFullYear()].split(/,/);ds=new Date(dso[0]+'/'+d.&quot;\n+&quot;getFullYear());de=new Date(dso[1]+'/'+d.getFullYear());if(h=='n'&amp;&amp;d&quot;\n+&quot;&gt;ds&amp;&amp;d&lt;de){z=z+1;}else if(h=='s'&amp;&amp;(d&gt;de||d&lt;ds)){z=z+1;}}d=d.getTime&quot;\n+&quot;()+(d.getTimezoneOffset()*60000);d=new Date(d+(3600000*z));H=d.getH&quot;\n+&quot;ours();M=d.getMinutes();M=(M&lt;10)?'0'+M:M;D=d.getDay();U='AM';W='Wee&quot;\n+&quot;kday';if(H&gt;=12){U='PM';H=H-12;}if(H==0){H=12;}if(D==6||D==0){W='Wee&quot;\n+&quot;kend';}D=da[D];tm=H+':'+M+U;tt=H+':'+((M&gt;30)?'30':'00')+U;a=[tm,tt,&quot;\n+&quot;D,W];return a;}&quot;);\n\n/* Adobe Consulting Plugin: getTimeParting v6.2 (No Prerequisites Needed) */\n/* Changed name from getTimeParting to getTimeParting2 for parallel testing of v6.2 with v3.3 */\nvar getTimeParting2 = function(a) {\n  a = document.documentMode ? void 0 : a || &quot;Etc/GMT&quot;;\n  a = (new Date).toLocaleDateString(&quot;en-US&quot;, {\n    timeZone: a,\n    minute: &quot;numeric&quot;,\n    hour: &quot;numeric&quot;,\n    weekday: &quot;long&quot;,\n    day: &quot;numeric&quot;,\n    year: &quot;numeric&quot;,\n    month: &quot;long&quot;\n  });\n  a = /([a-zA-Z]+).*?([a-zA-Z]+).*?([0-9]+).*?([0-9]+)(.*?)([0-9])(.*)/.exec(a);\n  return &quot;year=&quot; + a[4] + &quot; | month=&quot; + a[2] + &quot; | date=&quot; + a[3] + &quot; | day=&quot; + a[1] + &quot; | time=&quot; + (a[6] + a[7])\n};\n\n/*\n * Plugin: getNewRepeat 1.2 - Returns whether user is new or repeat\n */\ns.getNewRepeat=new Function(&quot;d&quot;,&quot;cn&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:&quot;\n+&quot;'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length=&quot;\n+&quot;=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct&quot;\n+&quot;-sval[0]&lt;30*60*1000&amp;&amp;sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N&quot;\n+&quot;ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}&quot;);\n\n/*\n * Utility Function: split v1.5 (JS 1.0 compatible)\n */\ns.split=new Function(&quot;l&quot;,&quot;d&quot;,&quot;&quot;\n+&quot;var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i&gt;-1?i:l.length;a[x&quot;\n+&quot;++]=l.substring(0,i);l=l.substring(i+d.length);}return a&quot;);\n\n/*\n * Plugin: getValOnce_v1.11\n */\ns.getValOnce=new Function(&quot;v&quot;,&quot;c&quot;,&quot;e&quot;,&quot;t&quot;,&quot;&quot;\n+&quot;var s=this,a=new Date,v=v?v:'',c=c?c:'s_gvo',e=e?e:0,i=t=='m'?6000&quot;\n+&quot;0:86400000,k=s.c_r(c);if(v){a.setTime(a.getTime()+e*i);s.c_w(c,v,e&quot;\n+&quot;==0?0:a);}return v==k?'':v&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n \n/*\n * Plugin: Days since last Visit 1.1.H - capture time from last visit\n */\ns.getDaysSinceLastVisit=new Function(&quot;c&quot;,&quot;&quot;\n+&quot;var s=this,e=new Date(),es=new Date(),cval,cval_s,cval_ss,ct=e.getT&quot;\n+&quot;ime(),day=24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s&quot;\n+&quot;etTime(ct+30*60*1000);f0='Cookies Not Supported';f1='First Visit';f&quot;\n+&quot;2='More than 30 days';f3='More than 7 days';f4='Less than 7 days';f&quot;\n+&quot;5='Less than 1 day';cval=s.c_r(c);if(cval.length==0){s.c_w(c,ct,e);&quot;\n+&quot;s.c_w(c+'_s',f1,es);}else{var d=ct-cval;if(d&gt;30*60*1000){if(d&gt;30*da&quot;\n+&quot;y){s.c_w(c,ct,e);s.c_w(c+'_s',f2,es);}else if(d&lt;30*day+1 &amp;&amp; d&gt;7*day&quot;\n+&quot;){s.c_w(c,ct,e);s.c_w(c+'_s',f3,es);}else if(d&lt;7*day+1 &amp;&amp; d&gt;day){s.&quot;\n+&quot;c_w(c,ct,e);s.c_w(c+'_s',f4,es);}else if(d&lt;day+1){s.c_w(c,ct,e);s.c&quot;\n+&quot;_w(c+'_s',f5,es);}}else{s.c_w(c,ct,e);cval_ss=s.c_r(c+'_s');s.c_w(c&quot;\n+&quot;+'_s',cval_ss,es);}}cval_s=s.c_r(c+'_s');if(cval_s.length==0) retur&quot;\n+&quot;n f0;else if(cval_s!=f1&amp;&amp;cval_s!=f2&amp;&amp;cval_s!=f3&amp;&amp;cval_s!=f4&amp;&amp;cval_s&quot;\n+&quot;!=f5) return '';else return cval_s;&quot;);\n\n/********************************************************************\n *\n * Main Plug-in code (should be in Plug-ins section)\n *\n *******************************************************************/\n/*\n * Plugin: getTimeToComplete 0.4 - return the time from start to stop\n */\ns.getTimeToComplete=new Function(&quot;v&quot;,&quot;cn&quot;,&quot;e&quot;,&quot;&quot;\n+&quot;var s=this,d=new Date,x=d,k;if(!s.ttcr){e=e?e:0;if(v=='start'||v=='&quot;\n+&quot;stop')s.ttcr=1;x.setTime(x.getTime()+e*86400000);if(v=='start'){s.c&quot;\n+&quot;_w(cn,d.getTime(),e?x:0);return '';}if(v=='stop'){k=s.c_r(cn);if(!s&quot;\n+&quot;.c_w(cn,'',d)||!k)return '';v=(d.getTime()-k)/1000;var td=86400,th=&quot;\n+&quot;3600,tm=60,r=5,u,un;if(v&gt;td){u=td;un='days';}else if(v&gt;th){u=th;un=&quot;\n+&quot;'hours';}else if(v&gt;tm){r=2;u=tm;un='minutes';}else{r=.2;u=1;un='sec&quot;\n+&quot;onds';}v=v*r/u;return (Math.round(v)/r)+' '+un;}}return '';&quot;);\n\n\n/*\n * Plugin Utility: apl v1.1\n */\ns.apl=new Function(&quot;l&quot;,&quot;v&quot;,&quot;d&quot;,&quot;u&quot;,&quot;&quot;\n+&quot;var s=this,m=0;if(!l)l='';if(u){var i,n,a=s.split(l,d);for(i=0;i&lt;a.&quot;\n+&quot;length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas&quot;\n+&quot;e()));}}if(!m)l=l?l+d+v:v;return l&quot;);\n\n\n/************************** CONFIG SECTION END**************************/\n\n\n/*\n==========START MEDIA MODULE==========\nThe Media Module is required to implement Adobe Analytics Video Milestone Tracking\n*/\n\nfunction AppMeasurement_Module_Media(q){var b=this;b.s=q;q=window;q.s_c_in||(q.s_c_il=[],q.s_c_in=0);b._il=q.s_c_il;b._in=q.s_c_in;b._il[b._in]=b;q.s_c_in++;b._c=&quot;s_m&quot;;b.list=[];b.open=function(d,c,e,k){var f={},a=new Date,l=&quot;&quot;,g;c||(c=-1);if(d&amp;&amp;e){b.list||(b.list={});b.list[d]&amp;&amp;b.close(d);k&amp;&amp;k.id&amp;&amp;(l=k.id);if(l)for(g in b.list)!Object.prototype[g]&amp;&amp;b.list[g]&amp;&amp;b.list[g].R==l&amp;&amp;b.close(b.list[g].name);f.name=d;f.length=c;f.offset=0;f.e=0;f.playerName=b.playerName?b.playerName:e;f.R=l;f.C=0;f.a=0;f.timestamp=\nMath.floor(a.getTime()/1E3);f.k=0;f.u=f.timestamp;f.c=-1;f.n=&quot;&quot;;f.g=-1;f.D=0;f.I={};f.G=0;f.m=0;f.f=&quot;&quot;;f.B=0;f.L=0;f.A=0;f.F=0;f.l=!1;f.v=&quot;&quot;;f.J=&quot;&quot;;f.K=0;f.r=!1;f.H=&quot;&quot;;f.complete=0;f.Q=0;f.p=0;f.q=0;b.list[d]=f}};b.openAd=function(d,c,e,k,f,a,l,g){var h={};b.open(d,c,e,g);if(h=b.list[d])h.l=!0,h.v=k,h.J=f,h.K=a,h.H=l};b.M=function(d){var c=b.list[d];b.list[d]=0;c&amp;&amp;c.monitor&amp;&amp;clearTimeout(c.monitor.interval)};b.close=function(d){b.i(d,0,-1)};b.play=function(d,c,e,k){var f=b.i(d,1,c,e,k);f&amp;&amp;!f.monitor&amp;&amp;\n(f.monitor={},f.monitor.update=function(){1==f.k&amp;&amp;b.i(f.name,3,-1);f.monitor.interval=setTimeout(f.monitor.update,1E3)},f.monitor.update())};b.click=function(d,c){b.i(d,7,c)};b.complete=function(d,c){b.i(d,5,c)};b.stop=function(d,c){b.i(d,2,c)};b.track=function(d){b.i(d,4,-1)};b.P=function(d,c){var e=&quot;a.media.&quot;,k=d.linkTrackVars,f=d.linkTrackEvents,a=&quot;m_i&quot;,l,g=d.contextData,h;c.l&amp;&amp;(e+=&quot;ad.&quot;,c.v&amp;&amp;(g[&quot;a.media.name&quot;]=c.v,g[e+&quot;pod&quot;]=c.J,g[e+&quot;podPosition&quot;]=c.K),c.G||(g[e+&quot;CPM&quot;]=c.H));c.r&amp;&amp;(g[e+&quot;clicked&quot;]=\n!0,c.r=!1);g[&quot;a.contentType&quot;]=&quot;video&quot;+(c.l?&quot;Ad&quot;:&quot;&quot;);g[&quot;a.media.channel&quot;]=b.channel;g[e+&quot;name&quot;]=c.name;g[e+&quot;playerName&quot;]=c.playerName;0&lt;c.length&amp;&amp;(g[e+&quot;length&quot;]=c.length);g[e+&quot;timePlayed&quot;]=Math.floor(c.a);0&lt;Math.floor(c.a)&amp;&amp;(g[e+&quot;timePlayed&quot;]=Math.floor(c.a));c.G||(g[e+&quot;view&quot;]=!0,a=&quot;m_s&quot;,b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;(a=c.l?b.__primetime?&quot;mspa_s&quot;:&quot;msa_s&quot;:b.__primetime?&quot;msp_s&quot;:&quot;ms_s&quot;),c.G=1);c.f&amp;&amp;(g[e+&quot;segmentNum&quot;]=c.m,g[e+&quot;segment&quot;]=c.f,0&lt;c.B&amp;&amp;(g[e+&quot;segmentLength&quot;]=c.B),c.A&amp;&amp;0&lt;c.a&amp;&amp;(g[e+&quot;segmentView&quot;]=\n!0));!c.Q&amp;&amp;c.complete&amp;&amp;(g[e+&quot;complete&quot;]=!0,c.S=1);0&lt;c.p&amp;&amp;(g[e+&quot;milestone&quot;]=c.p);0&lt;c.q&amp;&amp;(g[e+&quot;offsetMilestone&quot;]=c.q);if(k)for(h in g)Object.prototype[h]||(k+=&quot;,contextData.&quot;+h);l=g[&quot;a.contentType&quot;];d.pe=a;d.pev3=l;var q,s;if(b.contextDataMapping)for(h in d.events2||(d.events2=&quot;&quot;),k&amp;&amp;(k+=&quot;,events&quot;),b.contextDataMapping)if(!Object.prototype[h]){a=h.length&gt;e.length&amp;&amp;h.substring(0,e.length)==e?h.substring(e.length):&quot;&quot;;l=b.contextDataMapping[h];if(&quot;string&quot;==typeof l)for(q=l.split(&quot;,&quot;),s=0;s&lt;q.length;s++)l=\nq[s],&quot;a.contentType&quot;==h?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]):&quot;view&quot;==a||&quot;segmentView&quot;==a||&quot;clicked&quot;==a||&quot;complete&quot;==a||&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?(f&amp;&amp;(f+=&quot;,&quot;+l),&quot;timePlayed&quot;==a||&quot;CPM&quot;==a?g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l+&quot;=&quot;+g[h]):g[h]&amp;&amp;(d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+l)):&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]?(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h+&quot;Num&quot;]+&quot;:&quot;+g[h]):(k&amp;&amp;(k+=&quot;,&quot;+l),d[l]=g[h]);else if(&quot;milestones&quot;==a||&quot;offsetMilestones&quot;==a)h=h.substring(0,h.length-1),g[h]&amp;&amp;b.contextDataMapping[h+&quot;s&quot;][g[h]]&amp;&amp;(f&amp;&amp;(f+=&quot;,&quot;+b.contextDataMapping[h+\n&quot;s&quot;][g[h]]),d.events2+=(d.events2?&quot;,&quot;:&quot;&quot;)+b.contextDataMapping[h+&quot;s&quot;][g[h]]);g[h]&amp;&amp;(g[h]=0);&quot;segment&quot;==a&amp;&amp;g[h+&quot;Num&quot;]&amp;&amp;(g[h+&quot;Num&quot;]=0)}d.linkTrackVars=k;d.linkTrackEvents=f};b.i=function(d,c,e,k,f){var a={},l=(new Date).getTime()/1E3,g,h,q=b.trackVars,s=b.trackEvents,t=b.trackSeconds,u=b.trackMilestones,v=b.trackOffsetMilestones,w=b.segmentByMilestones,x=b.segmentByOffsetMilestones,p,n,r=1,m={},y;b.channel||(b.channel=b.s.w.location.hostname);if(a=d&amp;&amp;b.list&amp;&amp;b.list[d]?b.list[d]:0)if(a.l&amp;&amp;(t=b.adTrackSeconds,\nu=b.adTrackMilestones,v=b.adTrackOffsetMilestones,w=b.adSegmentByMilestones,x=b.adSegmentByOffsetMilestones),0&gt;e&amp;&amp;(e=1==a.k&amp;&amp;0&lt;a.u?l-a.u+a.c:a.c),0&lt;a.length&amp;&amp;(e=e&lt;a.length?e:a.length),0&gt;e&amp;&amp;(e=0),a.offset=e,0&lt;a.length&amp;&amp;(a.e=a.offset/a.length*100,a.e=100&lt;a.e?100:a.e),0&gt;a.c&amp;&amp;(a.c=e),y=a.D,m.name=d,m.ad=a.l,m.length=a.length,m.openTime=new Date,m.openTime.setTime(1E3*a.timestamp),m.offset=a.offset,m.percent=a.e,m.playerName=a.playerName,m.mediaEvent=0&gt;a.g?&quot;OPEN&quot;:1==c?&quot;PLAY&quot;:2==c?&quot;STOP&quot;:3==c?&quot;MONITOR&quot;:\n4==c?&quot;TRACK&quot;:5==c?&quot;COMPLETE&quot;:7==c?&quot;CLICK&quot;:&quot;CLOSE&quot;,2&lt;c||c!=a.k&amp;&amp;(2!=c||1==a.k)){f||(k=a.m,f=a.f);if(c){1==c&amp;&amp;(a.c=e);if((3&gt;=c||5&lt;=c)&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1,q=s=&quot;None&quot;,a.g!=e)){h=a.g;h&gt;e&amp;&amp;(h=a.c,h&gt;e&amp;&amp;(h=e));p=u?u.split(&quot;,&quot;):0;if(0&lt;a.length&amp;&amp;p&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h/a.length*100&lt;g&amp;&amp;a.e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=&quot;MILESTONE&quot;,a.p=m.milestone=g);if((p=v?v.split(&quot;,&quot;):0)&amp;&amp;e&gt;=h)for(n=0;n&lt;p.length;n++)(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)&amp;&amp;h&lt;g&amp;&amp;e&gt;=g&amp;&amp;(r=!0,n=p.length,m.mediaEvent=\n&quot;OFFSET_MILESTONE&quot;,a.q=m.offsetMilestone=g)}if(a.L||!f){if(w&amp;&amp;u&amp;&amp;0&lt;a.length){if(p=u.split(&quot;,&quot;))for(p.push(&quot;100&quot;),n=h=0;n&lt;p.length;n++)if(g=p[n]?parseFloat(&quot;&quot;+p[n]):0)a.e&lt;g&amp;&amp;(k=n+1,f=&quot;M:&quot;+h+&quot;-&quot;+g,n=p.length),h=g}else if(x&amp;&amp;v&amp;&amp;(p=v.split(&quot;,&quot;)))for(p.push(&quot;&quot;+(0&lt;a.length?a.length:&quot;E&quot;)),n=h=0;n&lt;p.length;n++)if((g=p[n]?parseFloat(&quot;&quot;+p[n]):0)||&quot;E&quot;==p[n]){if(e&lt;g||&quot;E&quot;==p[n])k=n+1,f=&quot;O:&quot;+h+&quot;-&quot;+g,n=p.length;h=g}f&amp;&amp;(a.L=!0)}(f||a.f)&amp;&amp;f!=a.f&amp;&amp;(a.F=!0,a.f||(a.m=k,a.f=f),0&lt;=a.g&amp;&amp;(r=!0));(2&lt;=c||100&lt;=a.e)&amp;&amp;a.c&lt;e&amp;&amp;\n(a.C+=e-a.c,a.a+=e-a.c);if(2&gt;=c||3==c&amp;&amp;!a.k)a.n+=(1==c||3==c?&quot;S&quot;:&quot;E&quot;)+Math.floor(e),a.k=3==c?1:c;!r&amp;&amp;0&lt;=a.g&amp;&amp;3&gt;=c&amp;&amp;(t=t?t:0)&amp;&amp;a.a&gt;=t&amp;&amp;(r=!0,m.mediaEvent=&quot;SECONDS&quot;);a.u=l;a.c=e}if(!c||3&gt;=c&amp;&amp;100&lt;=a.e)2!=a.k&amp;&amp;(a.n+=&quot;E&quot;+Math.floor(e)),c=0,q=s=&quot;None&quot;,m.mediaEvent=&quot;CLOSE&quot;;7==c&amp;&amp;(r=m.clicked=a.r=!0);if(5==c||b.completeByCloseOffset&amp;&amp;(!c||100&lt;=a.e)&amp;&amp;0&lt;a.length&amp;&amp;e&gt;=a.length-b.completeCloseOffsetThreshold)r=m.complete=a.complete=!0;l=m.mediaEvent;&quot;MILESTONE&quot;==l?l+=&quot;_&quot;+m.milestone:&quot;OFFSET_MILESTONE&quot;==l&amp;&amp;(l+=\n&quot;_&quot;+m.offsetMilestone);a.I[l]?m.eventFirstTime=!1:(m.eventFirstTime=!0,a.I[l]=1);m.event=m.mediaEvent;m.timePlayed=a.C;m.segmentNum=a.m;m.segment=a.f;m.segmentLength=a.B;b.monitor&amp;&amp;4!=c&amp;&amp;b.monitor(b.s,m);b.Heartbeat&amp;&amp;b.Heartbeat.enabled&amp;&amp;0&lt;=a.g&amp;&amp;(r=!1);0==c&amp;&amp;b.M(d);r&amp;&amp;a.D==y&amp;&amp;(d={contextData:{}},d.linkTrackVars=q,d.linkTrackEvents=s,d.linkTrackVars||(d.linkTrackVars=&quot;&quot;),d.linkTrackEvents||(d.linkTrackEvents=&quot;&quot;),b.P(d,a),d.linkTrackVars||(d[&quot;!linkTrackVars&quot;]=1),d.linkTrackEvents||(d[&quot;!linkTrackEvents&quot;]=\n1),b.s.track(d),a.F?(a.m=k,a.f=f,a.A=!0,a.F=!1):0&lt;a.a&amp;&amp;(a.A=!1),a.n=&quot;&quot;,a.p=a.q=0,a.a-=Math.floor(a.a),a.g=e,a.D++)}return a};b.O=function(d,c,e,k,f){var a=0;if(d&amp;&amp;(!b.autoTrackMediaLengthRequired||c&amp;&amp;0&lt;c)){if(b.list&amp;&amp;b.list[d])a=1;else if(1==e||3==e)b.open(d,c,&quot;HTML5 Video&quot;,f),a=1;a&amp;&amp;b.i(d,e,k,-1,0)}};b.attach=function(d){var c,e,k;d&amp;&amp;d.tagName&amp;&amp;&quot;VIDEO&quot;==d.tagName.toUpperCase()&amp;&amp;(b.o||(b.o=function(c,a,d){var e,h;b.autoTrack&amp;&amp;(e=c.currentSrc,(h=c.duration)||(h=-1),0&gt;d&amp;&amp;(d=c.currentTime),b.O(e,h,a,\nd,c))}),c=function(){b.o(d,1,-1)},e=function(){b.o(d,1,-1)},b.j(d,&quot;play&quot;,c),b.j(d,&quot;pause&quot;,e),b.j(d,&quot;seeking&quot;,e),b.j(d,&quot;seeked&quot;,c),b.j(d,&quot;ended&quot;,function(){b.o(d,0,-1)}),b.j(d,&quot;timeupdate&quot;,c),k=function(){d.paused||d.ended||d.seeking||b.o(d,3,-1);setTimeout(k,1E3)},k())};b.j=function(b,c,e){b.attachEvent?b.attachEvent(&quot;on&quot;+c,e):b.addEventListener&amp;&amp;b.addEventListener(c,e,!1)};void 0==b.completeByCloseOffset&amp;&amp;(b.completeByCloseOffset=1);void 0==b.completeCloseOffsetThreshold&amp;&amp;(b.completeCloseOffsetThreshold=\n1);b.Heartbeat={};b.N=function(){var d,c;if(b.autoTrack&amp;&amp;(d=b.s.d.getElementsByTagName(&quot;VIDEO&quot;)))for(c=0;c&lt;d.length;c++)b.attach(d[c])};b.j(q,&quot;load&quot;,b.N)}\n\n/*\n==========END MEDIA MODULE==========\n*/\n\n\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING START*****/\n\ns.loadModule(&quot;Media&quot;)\ns.Media.onLoad = function(s,m) {\n\ts.Media.autoTrack= false;\n\t/*Track Milestone 10%, 25%, 50%, 75%, 95%\n\t* Delete unwanted milestone if necessary\n\t*/\n\ts.Media.trackMilestones=&quot;10,25,50,75,95&quot;;\n\ts.Media.playerName= &quot;TUI Brightcove HTML5 Player&quot;;\n\ts.Media.segmentByMilestones = true;\n\ts.Media.trackUsingContextData = true;\n\t/* Add reserved context data variables as needed to populate default metrics\n\t*   a.media.progress10, a.media.progress25, a.media.progress50 ,a.media.progress75, a.media.progress95\n\t*\ta.media.friendlyname --&gt; to populate Video Name report\n\t*/\n\ts.Media.trackVars=&quot;contextData.a.media.progress10,contextData.a.media.progress25,contextData.a.media.progress50,contextData.a.media.progress75,contextData.a.media.progress95,contextData.a.media.friendlyname&quot;;\n};\n\n/*\n* USE MEDIA MONITOR TO SEND THE ADDITIONAL a.media.progressXX variables: needed as no processing rules are created by default to handle media.milestone\n*/\n\ns.Media.monitor = function (s,media){\n\t\n\t\t\n\t//Reset Variables\n\ts.contextData['a.media.progress10'] = s.contextData['a.media.progress25'] = s.contextData['a.media.progress50'] = s.contextData['a.media.progress75'] = s.contextData['a.media.progress95'] = s.contextData['a.media.friendlyname'] =  '';\n\t\n\ts.contextData['a.media.friendlyname'] = '' //assign custom friendly name if needed\n\t//if no custom friendly name\n\tif(!s.contextData['a.media.friendlyname']){\n\t\t//default to media.name\n\t\ts.contextData['a.media.friendlyname'] = media.name;\n\t}\n\t\n\t//If MILESTONE EVENT\n\tif(media.event==&quot;MILESTONE&quot;) {\n\t\t//Check which milestone has been reached: media.milestone\n\t\tswitch (media.milestone) {\n\t\t\t//When the 10% milestone is reached add a.media.progress10 to the Adobe Analytics request\n\t\t\tcase 10:\n\t\t\t\ts.contextData['a.media.progress10'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 25% milestone is reached add a.media.progress25 to the Adobe Analytics request\n\t\t\tcase 25:\n\t\t\t\ts.contextData['a.media.progress25'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 50% milestone is reached add a.media.progress50 to the Adobe Analytics request\n\t\t\tcase 50:\n\t\t\t\ts.contextData['a.media.progress50'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 75% milestone is reached add a.media.progress75 to the Adobe Analytics request\n\t\t\tcase 75:\n\t\t\t\ts.contextData['a.media.progress75'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When the 95% milestone is reached add a.media.progress95 to the Adobe Analytics request\n\t\t\tcase 95:\n\t\t\t\ts.contextData['a.media.progress95'] = true;\n\t\t\t\ts.Media.track(media.name);\n\t\t\t\tbreak;\n\t\t\t//When any other % milestone is reached do nothing\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n/***** MEDIA MODULE CONFIGURATION FOR MILESTONE TRACKING END*****/\n","name":"dev","promotedDraftName":"Updated with s.event removed","promotedTimestamp":"202101201107","promotedBy":"caleb.jaquith@tealium.com"}},"draftSeq":"4"},"initialize":"","id":"100040","title":"TUI UK Plugin staging","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"23","extType":"Javascript Code","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"notes":"","sort":"31","publishedTargets":"dev","blockPubTargetsLogic":"true","type":"new"},"25":{"title":"Adobe Analytics - s.events JS logic","id":"100040","scope":"5","constructor":"","status":"active","advExecOption":"alr","labels":"","codeDevData":{"promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202101201149","promotedDraftName":"Reworked","name":"dev","code":"var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n\n  totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n\n  creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n\n  creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n\n  onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n\n  bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n\n  incentivePromoValue = incentivePromoDiscount();\n\nfunction incentivePromoDiscount() {\n  if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n    var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n    var result = 0;\n    for (i = 0; i &lt; promoCodeArray.length; i++) {\n      if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n        result = promoCodeArray[i].bookingLevelPromoDiscount;\n      }\n    }\n    return result;\n  } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n    return parseFloat(tui.analytics.page.IncentivePromoValue);\n  } else {\n    return 0;\n  }\n}\n\n//Normal Bookflow &amp; LYP with same confirmation url\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n    /*s.events = s.apl(s.events, &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n      +\n      &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;, ',', 1); */\n    u.addEvent([\n        &quot;event78:&quot; + bookingReference + &quot;LYP&quot;, // event serialisation with event78 (LYP Unconfirmed Booking)\n        &quot;event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot;,\n        &quot;event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;\n    ])\n  } else {\n    /*\n    s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n      +\n      &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n      +\n      &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n      +\n      &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n      +\n      &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice), ',', 1); // multiple promocode - maintaining redemption code reporting\n    */\n    u.addEvent([\n        &quot;purchase&quot;,\n        &quot;event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice),\n        &quot;event5=&quot; + onlineDiscount,\n        &quot;event9=&quot; + bookingPax,\n        &quot;event150&quot;,&quot;event151&quot;,&quot;event152&quot;,&quot;event153&quot;,&quot;event154&quot;,\n        &quot;event158&quot;,&quot;event159&quot;, //added 158&amp;159 for PC Incentive \n        &quot;event155=&quot; + creditNoteDiscountValue,  // Added for credit note launch\n        &quot;event156=&quot; + creditNoteRefundValue, // Added for credit note launch\n        &quot;event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0),\n        &quot;event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice)\n    ])\n  }\n}\n\n//LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\nelse if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n  /*s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n    +\n    &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;, ',', 1); //added 158&amp;159 for PC Incentive\n    */\n  u.addEvent([\n    &quot;purchase&quot;, \n    &quot;event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice),\n    &quot;event5=&quot; + onlineDiscount, \n    &quot;event9=&quot; + bookingPax,\n    &quot;event79&quot;,\n    &quot;event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1), \n    &quot;event150&quot;,&quot;event151&quot;,&quot;event152&quot;,&quot;event153&quot;,&quot;event154&quot;,\n    &quot;event158&quot;,&quot;event159&quot; //added 158&amp;159 for PC Incentive\n  ])\n}\n\n//MMB Unpaid\nelse if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n        \n      //s.events = s.apl(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n      u.addEvent(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n              \n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n          } else {\n            //s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            u.addEvent('event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n            } else {\n              //s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event158' + parseFloat(tui.analytics.page.PromoValue))\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            //s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event159' + parseFloat(tui.analytics.page.PromoValue))\n          } else {\n            // s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event154' + parseFloat(tui.analytics.page.PromoValue))\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Paid\nelse if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n      // s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n      u.addEvent(&quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n      /*\n      if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n         if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n          s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n         }\n      }*/\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              //s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n          } else {\n            //s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            u.addEvent('event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                // s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n            } else {\n              //s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event158' + parseFloat(tui.analytics.page.PromoValue))\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event159' + parseFloat(tui.analytics.page.PromoValue))\n          } else {\n            // s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event154' + parseFloat(tui.analytics.page.PromoValue))\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Cancel\nelse if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n      //s.events = s.apl(s.events, &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n      u.addEvent(&quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n    }\n  }\n}\n\n//Price Variation Alert\nelse if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n  var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n  var price = document.querySelectorAll('.alertprice');\n  if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n    s.events = s.apl(s.events, &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n    u.addEvent([\n        &quot;event47&quot;,\n        &quot;event48=&quot; + price[0].innerText.replace(/[£€]/g, '')\n    ])\n  } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n    //s.events = s.apl(s.events, &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n    u.addEvent([\n        &quot;event47&quot;,\n        &quot;event48=&quot; + -price[0].innerText.replace(/[£€]/g, '')\n    ])\n  }\n}\n\n// Credit Note Booking\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n  var creditNoteBooking = b.legacy_isCreditNoteBooking || '';\n  if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n    // s.events = s.apl(s.events, 'event70', ',', 1);\n    u.addEvent('event70')\n  }\n}\n\n\n// Custom pageview event\n// s.events = s.apl(s.events, &quot;event3&quot;, &quot;,&quot;, 1);\nu.addEvent('event3')\n\n/*\n// tests to sanity check\nu.addEvent(['event500=500', 'event501=test2'])\nu.addEvent(&quot;event78:&quot; + &quot;testBookingReference&quot; + &quot;LYP&quot;)\n*/"}},"draftSeq":"2","queueSeq":"7","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"name":"Draft 1","code":"var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n\n  totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n\n  creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n\n  creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n\n  onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n\n  bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n\n  incentivePromoValue = incentivePromoDiscount();\n\nfunction incentivePromoDiscount() {\n  if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n    var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n    var result = 0;\n    for (i = 0; i &lt; promoCodeArray.length; i++) {\n      if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n        result = promoCodeArray[i].bookingLevelPromoDiscount;\n      }\n    }\n    return result;\n  } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n    return parseFloat(tui.analytics.page.IncentivePromoValue);\n  } else {\n    return 0;\n  }\n}\n\n//Normal Bookflow &amp; LYP with same confirmation url\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n    s.events = s.apl(s.events, &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n      +\n      &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;, ',', 1);\n  } else {\n    s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n      +\n      &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n      +\n      &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n      +\n      &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n      +\n      &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice), ',', 1); // multiple promocode - maintaining redemption code reporting\n  }\n}\n\n//LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\nelse if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n  s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n    +\n    &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;, ',', 1); //added 158&amp;159 for PC Incentive\n}\n\n//MMB Unpaid\nelse if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n      s.events = s.apl(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            }\n          } else {\n            s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              }\n            } else {\n              s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          } else {\n            s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Paid\nelse if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n      s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n      /*\n      if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n         if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n          s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n         }\n      }*/\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            }\n          } else {\n            s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              }\n            } else {\n              s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          } else {\n            s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Cancel\nelse if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n      s.events = s.apl(s.events, &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n    }\n  }\n}\n\n//Price Variation Alert\nelse if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n  var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n  var price = document.querySelectorAll('.alertprice');\n  if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n    s.events = s.apl(s.events, &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n  } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n    s.events = s.apl(s.events, &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n  }\n}\n\n// Credit Note Booking\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n  var creditNoteBooking = b.legacy_isCreditNoteBooking || '';\n  if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n    s.events = s.apl(s.events, 'event70', ',', 1);\n  }\n}\n\n\n\n// Custom pageview event\ns.events = s.apl(s.events, &quot;event3&quot;, &quot;,&quot;, 1);","updatedBy":"caleb.jaquith@tealium.com","creationDate":"202101200915","updateDate":"202101201117"},"ee925314c82edcf852a16569fbb8824b80d8946a7796358fcfa420a9b25f323a":{"name":"Reworked","code":"var bookingReference = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref ? tui.analytics.page.Tracsref : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId ? dataLayer[0].transactions.total.transactionId : &quot;&quot;),\n\n  totalPrice = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum ? parseFloat(tui.analytics.page.Sum) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice ? parseFloat(dataLayer[0].transactions.total.totalPrice) : 0),\n\n  creditNoteDiscountValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount ? parseFloat(dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) : 0),\n\n  creditNoteRefundValue = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null' ? parseFloat(tui.analytics.page.creditNoteRefundValue) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue ? parseFloat(dataLayer[0].transactions.total.creditNoteRefundValue) : 0),\n\n  onlineDiscount = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc &amp;&amp; tui.analytics.page.Disc != 'null' ? parseFloat(tui.analytics.page.Disc) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount ? parseFloat(dataLayer[0].transactions.total.discount) : 0),\n\n  bookingPax = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax &amp;&amp; tui.analytics.page.Pax != 'null' ? parseInt(tui.analytics.page.Pax) : window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.quantity &amp;&amp; dataLayer[0].transactions.items.quantity.pax ? parseInt(dataLayer[0].transactions.items.quantity.pax) : 0),\n\n  incentivePromoValue = incentivePromoDiscount();\n\nfunction incentivePromoDiscount() {\n  if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n    var rgx = new RegExp('/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i', 'i');\n    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n    var result = 0;\n    for (i = 0; i &lt; promoCodeArray.length; i++) {\n      if (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n        result = promoCodeArray[i].bookingLevelPromoDiscount;\n      }\n    }\n    return result;\n  } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IncentivePromoValue &amp;&amp; tui.analytics.page.IncentivePromoValue != 'null') {\n    return parseFloat(tui.analytics.page.IncentivePromoValue);\n  } else {\n    return 0;\n  }\n}\n\n//Normal Bookflow &amp; LYP with same confirmation url\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  if ((window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) || (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;)) {\n    /*s.events = s.apl(s.events, &quot;event78:&quot; + bookingReference + &quot;LYP&quot; // event serialisation with event78 (LYP Unconfirmed Booking)\n      +\n      &quot;,event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot; + &quot;,event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;, ',', 1); */\n    u.addEvent([\n        &quot;event78:&quot; + bookingReference + &quot;LYP&quot;, // event serialisation with event78 (LYP Unconfirmed Booking)\n        &quot;event80=&quot; + window.dataLayer[0].transactions.total.lockYourPriceValue + &quot;:&quot; + bookingReference + &quot;LYP&quot;,\n        &quot;event81=&quot; + totalPrice + &quot;:&quot; + bookingReference + &quot;LYP&quot;\n    ])\n  } else {\n    /*\n    s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event150,event151,event152,event153,event154,event158,event159&quot; //added 158&amp;159 for PC Incentive \n      +\n      &quot;,event155=&quot; + creditNoteDiscountValue // Added for credit note launch\n      +\n      &quot;,event156=&quot; + creditNoteRefundValue // Added for credit note launch\n      +\n      &quot;,event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0) // Addded for credit note launch\n      +\n      &quot;,event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice), ',', 1); // multiple promocode - maintaining redemption code reporting\n    */\n    u.addEvent([\n        &quot;purchase&quot;,\n        &quot;event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice),\n        &quot;event5=&quot; + onlineDiscount,\n        &quot;event9=&quot; + bookingPax,\n        &quot;event150&quot;,&quot;event151&quot;,&quot;event152&quot;,&quot;event153&quot;,&quot;event154&quot;,\n        &quot;event158&quot;,&quot;event159&quot;, //added 158&amp;159 for PC Incentive \n        &quot;event155=&quot; + creditNoteDiscountValue,  // Added for credit note launch\n        &quot;event156=&quot; + creditNoteRefundValue, // Added for credit note launch\n        &quot;event157=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice : 0),\n        &quot;event160=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue + incentivePromoValue : totalPrice)\n    ])\n  }\n}\n\n//LYP mmb Bookflow (managemybooking/paymentconfirmation is the MMB confirmation page)\nelse if ((document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) &amp;&amp; window.dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5 &amp;&amp; dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot;) {\n  /*s.events = s.apl(s.events, &quot;purchase&quot; + &quot;,event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice) + &quot;,event5=&quot; + onlineDiscount + &quot;,event9=&quot; + bookingPax + &quot;,event79&quot; // Lock Your Price confirmed booking\n    +\n    &quot;,event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1) + &quot;,event150,event151,event152,event153,event154,event158,event159&quot;, ',', 1); //added 158&amp;159 for PC Incentive\n    */\n  u.addEvent([\n    &quot;purchase&quot;, \n    &quot;event4=&quot; + (creditNoteDiscountValue &gt; 0 ? totalPrice + creditNoteDiscountValue : totalPrice),\n    &quot;event5=&quot; + onlineDiscount, \n    &quot;event9=&quot; + bookingPax,\n    &quot;event79&quot;,\n    &quot;event80=&quot; + (window.dataLayer[0].transactions.total.lockYourPriceValue * -1), \n    &quot;event150&quot;,&quot;event151&quot;,&quot;event152&quot;,&quot;event153&quot;,&quot;event154&quot;,\n    &quot;event158&quot;,&quot;event159&quot; //added 158&amp;159 for PC Incentive\n  ])\n}\n\n//MMB Unpaid\nelse if (document.URL.indexOf('your-account/managemybooking/amendmentsuccess') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Unpaid') {\n        \n      //s.events = s.apl(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n      u.addEvent(&quot;event301:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n              \n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n          } else {\n            //s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            u.addEvent('event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n            } else {\n              //s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event158' + parseFloat(tui.analytics.page.PromoValue))\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            //s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event159' + parseFloat(tui.analytics.page.PromoValue))\n          } else {\n            // s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event154' + parseFloat(tui.analytics.page.PromoValue))\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Paid\nelse if (document.URL.indexOf('your-account/managemybooking/managepaymentconfirmation') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Paid') {\n      // s.events = &quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber;\n      u.addEvent(&quot;event302:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n      /*\n      if(window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode &amp;&amp; tui.analytics.page.bookingLevelPromoDiscount){\n         if(tui.analytics.page.bookingLevelPromoCode == 'CVRM'|| tui.analytics.page.bookingLevelPromoCode == 'CVRHC'){\n          s.events = s.apl(s.events,'event154=' + tui.analytics.page.bookingLevelPromoDiscount ,',',1);\n         }\n      }*/\n\n      // Start\n      var dl = window.dataLayer\n      if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n        // If old object is shown - can be removed at a later date\n        if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n          // Check for PC &amp; MMB/Booking Incentive\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n            // Programme Change Incentive\n            if (/CVRHC|CVRW20|CVRS21/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              // s.events = s.apl(s.events, 'event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n            // MMB/Booking Incentive\n            if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n              //s.events = s.apl(s.events, 'event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n            }\n          } else {\n            //s.events = s.apl(s.events, 'event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount), ',', 1);\n            u.addEvent('event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount))\n          }\n          // Added to handle new promo code array\n        } else if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              // Programme Change Incentive\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                // s.events = s.apl(s.events, 'event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event158=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n              // MMB/Booking Incentive\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                //s.events = s.apl(s.events, 'event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n                u.addEvent('event159=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n              }\n            } else {\n              //s.events = s.apl(s.events, 'event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount), ',', 1);\n              u.addEvent('event154=' + Math.abs(promoCodeArray[i].bookingLevelPromoDiscount))\n            }\n          }\n        }\n        // For legacy data layer (only single promo code &amp; value)\t\n      } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n        if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n          if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event158' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event158' + parseFloat(tui.analytics.page.PromoValue))\n          } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            // s.events = s.apl(s.events, 'event159' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event159' + parseFloat(tui.analytics.page.PromoValue))\n          } else {\n            // s.events = s.apl(s.events, 'event154' + parseFloat(tui.analytics.page.PromoValue), ',', 1);\n            u.addEvent('event154' + parseFloat(tui.analytics.page.PromoValue))\n          }\n        }\n      } //End\n    }\n  }\n}\n\n//MMB Cancel\nelse if (document.URL.indexOf('your-account/managemybooking/cancelbooking') !== -1 &amp;&amp; typeof window.tui.analytics.events != 'undefined' &amp;&amp; window.tui.analytics.events !== null) {\n  for (var i = 0; i &lt; window.tui.analytics.events.length; i++) {\n    if (window.tui.analytics.events[i].eventAction == 'MMB Cancel') {\n      //s.events = s.apl(s.events, &quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber, ',', 1);\n      u.addEvent(&quot;event303:&quot; + window.tui.analytics.events[i].eventSerialisationNumber)\n    }\n  }\n}\n\n//Price Variation Alert\nelse if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n  var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n  var price = document.querySelectorAll('.alertprice');\n  if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n    s.events = s.apl(s.events, &quot;event47,event48=&quot; + price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n    u.addEvent([\n        &quot;event47&quot;,\n        &quot;event48=&quot; + price[0].innerText.replace(/[£€]/g, '')\n    ])\n  } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n    //s.events = s.apl(s.events, &quot;event47,event48=&quot; + -price[0].innerText.replace(/[£€]/g, ''), ',', 1);\n    u.addEvent([\n        &quot;event47&quot;,\n        &quot;event48=&quot; + -price[0].innerText.replace(/[£€]/g, '')\n    ])\n  }\n}\n\n// Credit Note Booking\nif ((document.URL.indexOf('/book/confirmation') !== -1 || document.URL.indexOf('/book/mobile/confirmation') !== -1 || document.URL.indexOf('/book/bookingConfirmation') !== -1) &amp;&amp; bookingReference &amp;&amp; typeof bookingReference === &quot;string&quot; &amp;&amp; bookingReference.length &gt; 5) {\n  // var creditNoteBooking = Bootstrapper._SC.dataHandler(arguments, &quot;62528&quot;);\n  var creditNoteBooking = b.legacy_isCreditNoteBooking || '';\n  if (creditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n    // s.events = s.apl(s.events, 'event70', ',', 1);\n    u.addEvent('event70')\n  }\n}\n\n\n// Custom pageview event\n// s.events = s.apl(s.events, &quot;event3&quot;, &quot;,&quot;, 1);\nu.addEvent('event3')\n\n/*\n// tests to sanity check\nu.addEvent(['event500=500', 'event501=test2'])\nu.addEvent(&quot;event78:&quot; + &quot;testBookingReference&quot; + &quot;LYP&quot;)\n*/","updatedBy":"caleb.jaquith@tealium.com","updateDate":"202101201149","creationDate":"202101201108"}}},"initialize":"","blockPubTargetsLogic":"true","publishedTargets":"dev","type":"new","extType":"Javascript Code","_id":"25","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"sort":"30","notes":"","selectedTargets":{"prod":"true","dev":"true","qa":"true"}},"26":{"_ignoreError":"false","title":"UDO Cleanup - Remove null/empty/undefined values","id":"100036","status":"active","constructor":"","scope":"global","advExecOption":"blr","code":"// remove null, empty, undefined\nvar keys = Object.keys(b);\nfor (var i = 0, key; i &lt; keys.length; i++) {\n  key = keys[i];\n  if (b[key] === null || typeof b[key] === &quot;undefined&quot; || b[key] === &quot;&quot;) {\n    delete b[key];\n  }\n}","initialize":"","labels":"23","publishedTargets":"dev","type":"new","_id":"26","extType":"Javascript Code","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"notes":"Extension removes null, undefined and empty values from the b object. In analytics we currently collect null values so uncommenting.","scopevars":"","sort":"9","selectedTargets":{"dev":"true","prod":"true","qa":"true"}},"27":{"selectedTargets":{"qa":"true","dev":"true","prod":"true"},"notes":"","sort":"2","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"_id":"27","extType":"Javascript Code","type":"new","publishedTargets":"dev","blockPubTargetsLogic":"true","initialize":"","codeDevData":{"promotedSnippets":{"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"promotedTimestamp":"202101061753","promotedDraftName":"legacy prefixes","promotedBy":"tom.mccarthy@tui.co.uk","code":"// enables console testing (but still works in Tealium iQ)\nvar b = b || (utag &amp;&amp; utag.data) || {}\n\nvar legacyPrefix = 'legacy_'\n\n// spoof some Ensighten functionality\nvar Bootstrapper = {}\nBootstrapper.ensightenOptions = {}\nBootstrapper.ensightenOptions.publishPath = b.tealium_environment === 'prod' ? 'hybrisprod' : 'hybrisdev';\n\nBootstrapper.getQueryParam = function (qp_name) {\n  var b = b || {}\n  return b['qp.' + qp_name] || &quot;&quot;\n}\n\n/*\n// there were only three instances of this being called and the timing was tricky, so I modified the below code a touch\nBootstrapper.data = {}\nBootstrapper.data.resolve = function (name) {\n  name = getCleanLegacyNameForLookup(name)\n  console.log('RESOLVING ' + name + ' to ' + b[name] )\n  return b[name]\n}\n*/\n\nfunction getCleanLegacyNameForLookup (longEnsightenName) {\n  var arr = longEnsightenName.split('.')\n  var lastString = arr[arr.length - 1]\n  var cleanWithLegacyPrefix = legacyPrefix + getSanitizedVariableName(lastString)\n  return cleanWithLegacyPrefix\n}\n\nBootstrapper.Cookies = {}\nBootstrapper.Cookies.get = function (cookieName) {\n  var b = b || {}\n  return b['cp.' + cookieName]\n}\n\n// make sure this object is defined to avoid errors\nwindow.tui = window.tui || {}\nwindow.tui.page = window.tui.page || {}\nwindow.tui.page.analytics = window.tui.page.analytics || {}\n\n// add the legacy ensighten variables\nb = addEnsightenVariables(b)\n\nfunction getSanitizedVariableName (oldName) {\n  // sanitation regex, only allow letters, numbers, underscores, dollar signs,\n  // array brackets, periods (same as TiQ Data Layer interface), remove others\n  var blacklist = /[^0-9A-Z_$\\[\\]\\.]/gi;\n  var spacesAndHyphens = /[\\s-]+/g;\n  // replace groups of spaces and hyphens with underscores\n  newName = oldName.replace(spacesAndHyphens, '_');\n  // sanitize name\n  newName = newName.replace(blacklist, '');\n  return newName\n}\n\nfunction sanitizeAllVariableNames (b) {\n  // Sanitize attribute names to remove any characters that \n  // Tealium doesn't allow (full list in comments):\n  //    - first replace any groups of spaces/hyphens with a single underscore\n  //    - then remove disallowed characters (no replacement character)\n\n\n  // fallback in case scope is changed and to allow console-based testing\n  b = b || {}\n\n  // get the list of attributes\n  var attributes = Object.keys(b);\n\n  // initialize loop vars\n  var i, len, oldName, newName;\n\n  // get the value for each of the keys and add it to b if non-empty\n  for (i = 0, len = attributes.length; i &lt; len; i++) {\n    oldName = attributes[i];\n    newName = getSanitizedVariableName(oldName)\n    if (oldName !== newName) {\n      // copy value\n      b[newName] = b[oldName];\n      // remove old key\n      delete b[oldName];\n    }\n  }\n  return b\n}\n\nfunction logError (e) {\n  console.log(&quot;UDO population function error: &quot; + e)\n}\n\nfunction addEnsightenVariables (b) {\n  b = b || {}\n  b = addUnconditionalEnsightenVariables(b)\n  b = addConditionalEnsightenVariables(b)\n  b = sanitizeAllVariableNames(b)\n  return b\n}\n\nfunction addConditionalEnsightenVariables (originalB) {\n  // a little confusing, but this is the 'new' b and the standard one is called originalB in this function\n  var b = {}\n  // a map of relevant Ensightten condition IDs to Load Rule UIDs\n  var conditionMap = {\n    &quot;205270&quot;: &quot;893&quot;,\n    &quot;205366&quot;: &quot;892&quot;,\n    &quot;205384&quot;: &quot;891&quot;,\n    &quot;205444&quot;: &quot;890&quot;,\n    &quot;231659&quot;: &quot;889&quot;,\n    &quot;275650&quot;: &quot;888&quot;,\n    &quot;292050&quot;: &quot;887&quot;,\n    &quot;306764&quot;: &quot;886&quot;,\n    &quot;317190&quot;: &quot;885&quot;,\n    &quot;318035&quot;: &quot;884&quot;,\n    &quot;319261&quot;: &quot;883&quot;,\n    &quot;321929&quot;: &quot;882&quot;,\n    &quot;321966&quot;: &quot;881&quot;,\n    &quot;322010&quot;: &quot;880&quot;,\n    &quot;323412&quot;: &quot;879&quot;,\n    &quot;326082&quot;: &quot;878&quot;,\n    &quot;330432&quot;: &quot;877&quot;,\n    &quot;334450&quot;: &quot;876&quot;,\n    &quot;338073&quot;: &quot;875&quot;,\n    &quot;338075&quot;: &quot;874&quot;,\n    &quot;342693&quot;: &quot;873&quot;,\n    &quot;356822&quot;: &quot;872&quot;,\n    &quot;381988&quot;: &quot;871&quot;,\n    &quot;381989&quot;: &quot;870&quot;,\n    &quot;381990&quot;: &quot;869&quot;,\n    &quot;381991&quot;: &quot;868&quot;,\n    &quot;386001&quot;: &quot;867&quot;,\n    &quot;386052&quot;: &quot;866&quot;,\n    &quot;386059&quot;: &quot;865&quot;,\n    &quot;386105&quot;: &quot;864&quot;,\n    &quot;386268&quot;: &quot;863&quot;,\n    &quot;386269&quot;: &quot;862&quot;,\n    &quot;386721&quot;: &quot;861&quot;,\n    &quot;392738&quot;: &quot;860&quot;,\n    &quot;392739&quot;: &quot;859&quot;,\n    &quot;392856&quot;: &quot;858&quot;,\n    &quot;393317&quot;: &quot;857&quot;,\n    &quot;398051&quot;: &quot;856&quot;,\n    &quot;413257&quot;: &quot;855&quot;,\n    &quot;413766&quot;: &quot;854&quot;,\n    &quot;415650&quot;: &quot;853&quot;,\n    &quot;416216&quot;: &quot;852&quot;,\n    &quot;420785&quot;: &quot;851&quot;,\n    &quot;420787&quot;: &quot;850&quot;,\n    &quot;421343&quot;: &quot;849&quot;,\n    &quot;423206&quot;: &quot;848&quot;,\n    &quot;441328&quot;: &quot;847&quot;,\n    &quot;455789&quot;: &quot;846&quot;,\n    &quot;461304&quot;: &quot;845&quot;,\n    &quot;461309&quot;: &quot;844&quot;,\n    &quot;463175&quot;: &quot;843&quot;,\n    &quot;470245&quot;: &quot;842&quot;,\n    &quot;470253&quot;: &quot;841&quot;,\n    &quot;470312&quot;: &quot;840&quot;,\n    &quot;470318&quot;: &quot;839&quot;,\n    &quot;473997&quot;: &quot;838&quot;,\n    &quot;476525&quot;: &quot;837&quot;,\n    &quot;476526&quot;: &quot;836&quot;,\n    &quot;476527&quot;: &quot;835&quot;,\n    &quot;476528&quot;: &quot;834&quot;,\n    &quot;480498&quot;: &quot;833&quot;,\n    &quot;480964&quot;: &quot;832&quot;,\n    &quot;481202&quot;: &quot;831&quot;,\n    &quot;483445&quot;: &quot;830&quot;,\n    &quot;491253&quot;: &quot;829&quot;,\n    &quot;493179&quot;: &quot;828&quot;,\n    &quot;493721&quot;: &quot;827&quot;,\n    &quot;496357&quot;: &quot;826&quot;,\n    &quot;501484&quot;: &quot;825&quot;,\n    &quot;501601&quot;: &quot;824&quot;,\n    &quot;510366&quot;: &quot;823&quot;,\n    &quot;513827&quot;: &quot;822&quot;,\n    &quot;635858&quot;: &quot;821&quot;,\n    &quot;635859&quot;: &quot;820&quot;,\n    &quot;635860&quot;: &quot;819&quot;,\n    &quot;635861&quot;: &quot;818&quot;,\n    &quot;635862&quot;: &quot;817&quot;,\n    &quot;635863&quot;: &quot;816&quot;,\n    &quot;636023&quot;: &quot;815&quot;,\n    &quot;636029&quot;: &quot;814&quot;,\n    &quot;636046&quot;: &quot;813&quot;,\n    &quot;648421&quot;: &quot;812&quot;,\n    &quot;649595&quot;: &quot;811&quot;,\n    &quot;649596&quot;: &quot;810&quot;,\n    &quot;649969&quot;: &quot;809&quot;,\n    &quot;650179&quot;: &quot;808&quot;,\n    &quot;650416&quot;: &quot;807&quot;,\n    &quot;650480&quot;: &quot;806&quot;,\n    &quot;650484&quot;: &quot;805&quot;,\n    &quot;650680&quot;: &quot;804&quot;,\n    &quot;650692&quot;: &quot;803&quot;,\n    &quot;650702&quot;: &quot;802&quot;,\n    &quot;650703&quot;: &quot;801&quot;,\n    &quot;650766&quot;: &quot;800&quot;,\n    &quot;650778&quot;: &quot;799&quot;,\n    &quot;650782&quot;: &quot;798&quot;,\n    &quot;650787&quot;: &quot;797&quot;,\n    &quot;650789&quot;: &quot;796&quot;,\n    &quot;650792&quot;: &quot;795&quot;,\n    &quot;651200&quot;: &quot;794&quot;,\n    &quot;653983&quot;: &quot;793&quot;,\n    &quot;664297&quot;: &quot;792&quot;,\n    &quot;664415&quot;: &quot;791&quot;,\n    &quot;664554&quot;: &quot;790&quot;,\n    &quot;664567&quot;: &quot;789&quot;,\n    &quot;664568&quot;: &quot;788&quot;,\n    &quot;664569&quot;: &quot;787&quot;,\n    &quot;664582&quot;: &quot;786&quot;,\n    &quot;664583&quot;: &quot;785&quot;,\n    &quot;664585&quot;: &quot;784&quot;,\n    &quot;664594&quot;: &quot;783&quot;,\n    &quot;664595&quot;: &quot;782&quot;,\n    &quot;664597&quot;: &quot;781&quot;,\n    &quot;664598&quot;: &quot;780&quot;,\n    &quot;664604&quot;: &quot;779&quot;,\n    &quot;664609&quot;: &quot;778&quot;,\n    &quot;664610&quot;: &quot;777&quot;,\n    &quot;664611&quot;: &quot;776&quot;,\n    &quot;664619&quot;: &quot;775&quot;,\n    &quot;664620&quot;: &quot;774&quot;,\n    &quot;664621&quot;: &quot;773&quot;,\n    &quot;664623&quot;: &quot;772&quot;,\n    &quot;664624&quot;: &quot;771&quot;,\n    &quot;664631&quot;: &quot;770&quot;,\n    &quot;671183&quot;: &quot;769&quot;,\n    &quot;671185&quot;: &quot;768&quot;,\n    &quot;671190&quot;: &quot;767&quot;,\n    &quot;671227&quot;: &quot;766&quot;,\n    &quot;671238&quot;: &quot;765&quot;,\n    &quot;671240&quot;: &quot;764&quot;,\n    &quot;671252&quot;: &quot;763&quot;,\n    &quot;671355&quot;: &quot;762&quot;,\n    &quot;682688&quot;: &quot;761&quot;,\n    &quot;686121&quot;: &quot;760&quot;,\n    &quot;686122&quot;: &quot;759&quot;,\n    &quot;686123&quot;: &quot;758&quot;,\n    &quot;686171&quot;: &quot;757&quot;,\n    &quot;686172&quot;: &quot;756&quot;,\n    &quot;686176&quot;: &quot;755&quot;,\n    &quot;686177&quot;: &quot;754&quot;,\n    &quot;686178&quot;: &quot;753&quot;,\n    &quot;686222&quot;: &quot;752&quot;,\n    &quot;686224&quot;: &quot;751&quot;,\n    &quot;686225&quot;: &quot;750&quot;,\n    &quot;686278&quot;: &quot;749&quot;,\n    &quot;696836&quot;: &quot;748&quot;,\n    &quot;696873&quot;: &quot;747&quot;,\n    &quot;696915&quot;: &quot;746&quot;,\n    &quot;698739&quot;: &quot;745&quot;,\n    &quot;698824&quot;: &quot;744&quot;,\n    &quot;701720&quot;: &quot;743&quot;,\n    &quot;701770&quot;: &quot;742&quot;,\n    &quot;701995&quot;: &quot;741&quot;,\n    &quot;702164&quot;: &quot;740&quot;,\n    &quot;717653&quot;: &quot;739&quot;,\n    &quot;717654&quot;: &quot;738&quot;,\n    &quot;717953&quot;: &quot;737&quot;,\n    &quot;717954&quot;: &quot;736&quot;,\n    &quot;718305&quot;: &quot;735&quot;,\n    &quot;718376&quot;: &quot;734&quot;,\n    &quot;758676&quot;: &quot;733&quot;,\n    &quot;763283&quot;: &quot;732&quot;,\n    &quot;767006&quot;: &quot;731&quot;,\n    &quot;794187&quot;: &quot;730&quot;,\n    &quot;821088&quot;: &quot;729&quot;,\n    &quot;835611&quot;: &quot;728&quot;,\n    &quot;836311&quot;: &quot;727&quot;,\n    &quot;840126&quot;: &quot;726&quot;,\n    &quot;840127&quot;: &quot;725&quot;,\n    &quot;840747&quot;: &quot;724&quot;,\n    &quot;840748&quot;: &quot;723&quot;,\n    &quot;840749&quot;: &quot;722&quot;,\n    &quot;853791&quot;: &quot;721&quot;,\n    &quot;853792&quot;: &quot;720&quot;,\n    &quot;882958&quot;: &quot;719&quot;,\n    &quot;887343&quot;: &quot;718&quot;,\n    &quot;899054&quot;: &quot;717&quot;,\n    &quot;899844&quot;: &quot;716&quot;,\n    &quot;901069&quot;: &quot;715&quot;,\n    &quot;901080&quot;: &quot;714&quot;,\n    &quot;901330&quot;: &quot;713&quot;,\n    &quot;901338&quot;: &quot;712&quot;,\n    &quot;901352&quot;: &quot;711&quot;,\n    &quot;962796&quot;: &quot;710&quot;,\n    &quot;1042978&quot;: &quot;709&quot;,\n    &quot;1043130&quot;: &quot;708&quot;,\n    &quot;1081657&quot;: &quot;707&quot;,\n    &quot;1081697&quot;: &quot;706&quot;,\n    &quot;1187972&quot;: &quot;705&quot;,\n    &quot;1187977&quot;: &quot;704&quot;,\n    &quot;1187985&quot;: &quot;703&quot;,\n    &quot;1187989&quot;: &quot;702&quot;,\n    &quot;1187995&quot;: &quot;701&quot;,\n    &quot;1188366&quot;: &quot;700&quot;,\n    &quot;1207206&quot;: &quot;699&quot;,\n    &quot;1207254&quot;: &quot;698&quot;,\n    &quot;1210674&quot;: &quot;697&quot;,\n    &quot;1211596&quot;: &quot;696&quot;,\n    &quot;1211720&quot;: &quot;695&quot;,\n    &quot;1211741&quot;: &quot;694&quot;,\n    &quot;1211742&quot;: &quot;693&quot;,\n    &quot;1211743&quot;: &quot;692&quot;,\n    &quot;1216621&quot;: &quot;691&quot;,\n    &quot;1217836&quot;: &quot;690&quot;,\n    &quot;1217852&quot;: &quot;689&quot;,\n    &quot;1218080&quot;: &quot;688&quot;,\n    &quot;1218101&quot;: &quot;687&quot;,\n    &quot;1219690&quot;: &quot;686&quot;,\n    &quot;1249258&quot;: &quot;685&quot;,\n    &quot;1417083&quot;: &quot;684&quot;,\n    &quot;1417130&quot;: &quot;683&quot;,\n    &quot;1495684&quot;: &quot;682&quot;,\n    &quot;1512996&quot;: &quot;681&quot;,\n    &quot;1512997&quot;: &quot;680&quot;,\n    &quot;1513092&quot;: &quot;679&quot;,\n    &quot;1513465&quot;: &quot;678&quot;,\n    &quot;1513466&quot;: &quot;677&quot;,\n    &quot;1514697&quot;: &quot;676&quot;,\n    &quot;1514864&quot;: &quot;675&quot;,\n    &quot;1514958&quot;: &quot;674&quot;,\n    &quot;1515424&quot;: &quot;673&quot;,\n    &quot;1531045&quot;: &quot;672&quot;,\n    &quot;1531096&quot;: &quot;671&quot;,\n    &quot;1531141&quot;: &quot;670&quot;,\n    &quot;1531422&quot;: &quot;669&quot;,\n    &quot;1532177&quot;: &quot;668&quot;,\n    &quot;1668141&quot;: &quot;667&quot;,\n    &quot;1769738&quot;: &quot;666&quot;,\n    &quot;1778256&quot;: &quot;665&quot;,\n    &quot;2081444&quot;: &quot;664&quot;,\n    &quot;2081446&quot;: &quot;663&quot;,\n    &quot;2082484&quot;: &quot;662&quot;,\n    &quot;2279242&quot;: &quot;661&quot;,\n    &quot;2279323&quot;: &quot;660&quot;,\n    &quot;2503734&quot;: &quot;659&quot;,\n    &quot;2503735&quot;: &quot;658&quot;,\n    &quot;2503818&quot;: &quot;657&quot;,\n    &quot;2518567&quot;: &quot;656&quot;,\n    &quot;2518982&quot;: &quot;655&quot;,\n    &quot;2662663&quot;: &quot;654&quot;,\n    &quot;2662758&quot;: &quot;653&quot;,\n    &quot;2664033&quot;: &quot;652&quot;,\n    &quot;2664082&quot;: &quot;651&quot;,\n    &quot;2665581&quot;: &quot;650&quot;,\n    &quot;2665582&quot;: &quot;649&quot;,\n    &quot;2708240&quot;: &quot;648&quot;,\n    &quot;2712769&quot;: &quot;647&quot;,\n    &quot;2712827&quot;: &quot;646&quot;,\n    &quot;2733381&quot;: &quot;645&quot;,\n    &quot;2733382&quot;: &quot;644&quot;,\n    &quot;2910769&quot;: &quot;643&quot;,\n    &quot;2917920&quot;: &quot;642&quot;,\n    &quot;3565541&quot;: &quot;641&quot;,\n    &quot;3584019&quot;: &quot;640&quot;,\n    &quot;3600994&quot;: &quot;639&quot;,\n    &quot;3834892&quot;: &quot;638&quot;,\n    &quot;4143702&quot;: &quot;637&quot;,\n    &quot;4151405&quot;: &quot;636&quot;,\n    &quot;4151407&quot;: &quot;635&quot;,\n    &quot;4151409&quot;: &quot;634&quot;,\n    &quot;4190389&quot;: &quot;633&quot;,\n    &quot;4821493&quot;: &quot;632&quot;,\n    &quot;4821495&quot;: &quot;631&quot;,\n    &quot;4821610&quot;: &quot;630&quot;,\n    &quot;4821659&quot;: &quot;629&quot;,\n    &quot;4821660&quot;: &quot;628&quot;,\n    &quot;4821661&quot;: &quot;627&quot;,\n    &quot;4821662&quot;: &quot;626&quot;,\n    &quot;4823353&quot;: &quot;625&quot;,\n    &quot;4823354&quot;: &quot;624&quot;,\n    &quot;4823597&quot;: &quot;623&quot;,\n    &quot;4823969&quot;: &quot;622&quot;,\n    &quot;4823970&quot;: &quot;621&quot;,\n    &quot;4824954&quot;: &quot;620&quot;,\n    &quot;4824955&quot;: &quot;619&quot;,\n    &quot;4825150&quot;: &quot;618&quot;,\n    &quot;4825427&quot;: &quot;617&quot;,\n    &quot;4825428&quot;: &quot;616&quot;,\n    &quot;4825462&quot;: &quot;615&quot;,\n    &quot;4825463&quot;: &quot;614&quot;,\n    &quot;4825556&quot;: &quot;613&quot;,\n    &quot;4825566&quot;: &quot;612&quot;,\n    &quot;4825579&quot;: &quot;611&quot;,\n    &quot;4825887&quot;: &quot;610&quot;,\n    &quot;4828711&quot;: &quot;609&quot;,\n    &quot;4828847&quot;: &quot;608&quot;,\n    &quot;4829563&quot;: &quot;607&quot;,\n    &quot;4834079&quot;: &quot;606&quot;,\n    &quot;4834101&quot;: &quot;605&quot;,\n    &quot;4834967&quot;: &quot;604&quot;,\n    &quot;4834971&quot;: &quot;603&quot;,\n    &quot;4835548&quot;: &quot;602&quot;,\n    &quot;4835555&quot;: &quot;601&quot;,\n    &quot;4836637&quot;: &quot;600&quot;,\n    &quot;4836638&quot;: &quot;599&quot;,\n    &quot;4836899&quot;: &quot;598&quot;,\n    &quot;4836986&quot;: &quot;597&quot;,\n    &quot;4836987&quot;: &quot;596&quot;,\n    &quot;4836995&quot;: &quot;595&quot;,\n    &quot;4837297&quot;: &quot;594&quot;,\n    &quot;4837976&quot;: &quot;593&quot;,\n    &quot;4837985&quot;: &quot;592&quot;,\n    &quot;4837986&quot;: &quot;591&quot;,\n    &quot;4837987&quot;: &quot;590&quot;,\n    &quot;4837989&quot;: &quot;589&quot;,\n    &quot;4838170&quot;: &quot;588&quot;,\n    &quot;4838540&quot;: &quot;587&quot;,\n    &quot;4838547&quot;: &quot;586&quot;,\n    &quot;4838593&quot;: &quot;585&quot;,\n    &quot;4840815&quot;: &quot;584&quot;,\n    &quot;4841313&quot;: &quot;583&quot;,\n    &quot;4841758&quot;: &quot;582&quot;,\n    &quot;4842201&quot;: &quot;581&quot;,\n    &quot;4843069&quot;: &quot;580&quot;,\n    &quot;4843070&quot;: &quot;579&quot;,\n    &quot;4843071&quot;: &quot;578&quot;,\n    &quot;4844445&quot;: &quot;577&quot;,\n    &quot;4844447&quot;: &quot;576&quot;,\n    &quot;4844577&quot;: &quot;575&quot;,\n    &quot;4844916&quot;: &quot;574&quot;,\n    &quot;4845253&quot;: &quot;573&quot;,\n    &quot;4845255&quot;: &quot;572&quot;,\n    &quot;4845258&quot;: &quot;571&quot;,\n    &quot;4845356&quot;: &quot;570&quot;,\n    &quot;4845366&quot;: &quot;569&quot;,\n    &quot;4845617&quot;: &quot;568&quot;,\n    &quot;4847129&quot;: &quot;567&quot;,\n    &quot;4847477&quot;: &quot;566&quot;,\n    &quot;4847478&quot;: &quot;565&quot;,\n    &quot;4848441&quot;: &quot;564&quot;,\n    &quot;4848815&quot;: &quot;563&quot;,\n    &quot;4851962&quot;: &quot;562&quot;,\n    &quot;4851964&quot;: &quot;561&quot;,\n    &quot;4852083&quot;: &quot;560&quot;,\n    &quot;4852084&quot;: &quot;559&quot;,\n    &quot;4852282&quot;: &quot;558&quot;,\n    &quot;4852283&quot;: &quot;557&quot;,\n    &quot;4852362&quot;: &quot;556&quot;,\n    &quot;4852363&quot;: &quot;555&quot;,\n    &quot;4852658&quot;: &quot;554&quot;,\n    &quot;4852659&quot;: &quot;553&quot;,\n    &quot;4852660&quot;: &quot;552&quot;,\n    &quot;4853590&quot;: &quot;551&quot;,\n    &quot;4854987&quot;: &quot;550&quot;,\n    &quot;4857995&quot;: &quot;549&quot;,\n    &quot;4858047&quot;: &quot;548&quot;,\n    &quot;4858048&quot;: &quot;547&quot;,\n    &quot;4858051&quot;: &quot;546&quot;,\n    &quot;4858052&quot;: &quot;545&quot;,\n    &quot;4859198&quot;: &quot;544&quot;,\n    &quot;4859386&quot;: &quot;543&quot;,\n    &quot;4860037&quot;: &quot;542&quot;,\n    &quot;4860043&quot;: &quot;541&quot;,\n    &quot;4860384&quot;: &quot;540&quot;,\n    &quot;4860389&quot;: &quot;539&quot;,\n    &quot;4860392&quot;: &quot;538&quot;,\n    &quot;4860393&quot;: &quot;537&quot;,\n    &quot;4860396&quot;: &quot;536&quot;,\n    &quot;4860489&quot;: &quot;535&quot;,\n    &quot;4860666&quot;: &quot;534&quot;,\n    &quot;4861558&quot;: &quot;533&quot;,\n    &quot;4861560&quot;: &quot;532&quot;,\n    &quot;4861724&quot;: &quot;531&quot;,\n    &quot;4861979&quot;: &quot;530&quot;,\n    &quot;4862577&quot;: &quot;529&quot;,\n    &quot;4862583&quot;: &quot;528&quot;,\n    &quot;4862586&quot;: &quot;527&quot;,\n    &quot;4862928&quot;: &quot;526&quot;,\n    &quot;4863228&quot;: &quot;525&quot;,\n    &quot;4863575&quot;: &quot;524&quot;,\n    &quot;4863765&quot;: &quot;523&quot;,\n    &quot;4863775&quot;: &quot;522&quot;,\n    &quot;4863805&quot;: &quot;521&quot;,\n    &quot;4863806&quot;: &quot;520&quot;,\n    &quot;4863807&quot;: &quot;519&quot;,\n    &quot;4863888&quot;: &quot;518&quot;,\n    &quot;4863889&quot;: &quot;517&quot;,\n    &quot;4864153&quot;: &quot;516&quot;,\n    &quot;4864565&quot;: &quot;515&quot;,\n    &quot;4865543&quot;: &quot;514&quot;,\n    &quot;4868062&quot;: &quot;513&quot;,\n    &quot;4868261&quot;: &quot;512&quot;,\n    &quot;4868262&quot;: &quot;511&quot;,\n    &quot;4868283&quot;: &quot;510&quot;,\n    &quot;4868358&quot;: &quot;509&quot;,\n    &quot;4868359&quot;: &quot;508&quot;,\n    &quot;4868360&quot;: &quot;507&quot;,\n    &quot;4868361&quot;: &quot;506&quot;,\n    &quot;4868362&quot;: &quot;505&quot;,\n    &quot;4868392&quot;: &quot;504&quot;,\n    &quot;4868449&quot;: &quot;503&quot;,\n    &quot;4868450&quot;: &quot;502&quot;,\n    &quot;4868451&quot;: &quot;501&quot;,\n    &quot;4868452&quot;: &quot;500&quot;,\n    &quot;4868453&quot;: &quot;499&quot;,\n    &quot;4868454&quot;: &quot;498&quot;,\n    &quot;4868455&quot;: &quot;497&quot;,\n    &quot;4868457&quot;: &quot;496&quot;,\n    &quot;4868458&quot;: &quot;495&quot;,\n    &quot;4869584&quot;: &quot;494&quot;,\n    &quot;4869945&quot;: &quot;493&quot;,\n    &quot;4869951&quot;: &quot;492&quot;,\n    &quot;4869954&quot;: &quot;491&quot;,\n    &quot;4870035&quot;: &quot;490&quot;,\n    &quot;4870036&quot;: &quot;489&quot;,\n    &quot;4870216&quot;: &quot;488&quot;,\n    &quot;4870973&quot;: &quot;487&quot;,\n    &quot;4871232&quot;: &quot;486&quot;,\n    &quot;4871233&quot;: &quot;485&quot;,\n    &quot;4871234&quot;: &quot;484&quot;,\n    &quot;4871236&quot;: &quot;483&quot;,\n    &quot;4871237&quot;: &quot;482&quot;,\n    &quot;4871243&quot;: &quot;481&quot;,\n    &quot;4871370&quot;: &quot;480&quot;,\n    &quot;4871371&quot;: &quot;479&quot;,\n    &quot;4871372&quot;: &quot;478&quot;,\n    &quot;4872478&quot;: &quot;477&quot;,\n    &quot;4872479&quot;: &quot;476&quot;,\n    &quot;4873112&quot;: &quot;475&quot;,\n    &quot;4873113&quot;: &quot;474&quot;,\n    &quot;4873115&quot;: &quot;473&quot;,\n    &quot;4873116&quot;: &quot;472&quot;,\n    &quot;4873541&quot;: &quot;471&quot;,\n    &quot;4873810&quot;: &quot;470&quot;,\n    &quot;4874021&quot;: &quot;469&quot;,\n    &quot;4874022&quot;: &quot;468&quot;,\n    &quot;4874023&quot;: &quot;467&quot;,\n    &quot;4874054&quot;: &quot;466&quot;,\n    &quot;4874525&quot;: &quot;465&quot;,\n    &quot;4874978&quot;: &quot;464&quot;,\n    &quot;4878074&quot;: &quot;463&quot;,\n    &quot;4878311&quot;: &quot;462&quot;,\n    &quot;4878451&quot;: &quot;461&quot;,\n    &quot;4878452&quot;: &quot;460&quot;,\n    &quot;4878453&quot;: &quot;459&quot;,\n    &quot;4878454&quot;: &quot;458&quot;,\n    &quot;4878457&quot;: &quot;457&quot;,\n    &quot;4878459&quot;: &quot;456&quot;,\n    &quot;4878460&quot;: &quot;455&quot;,\n    &quot;4878461&quot;: &quot;454&quot;,\n    &quot;4878462&quot;: &quot;453&quot;,\n    &quot;4878475&quot;: &quot;452&quot;,\n    &quot;4878884&quot;: &quot;451&quot;,\n    &quot;4879254&quot;: &quot;450&quot;,\n    &quot;4879515&quot;: &quot;449&quot;,\n    &quot;4879516&quot;: &quot;448&quot;,\n    &quot;4879518&quot;: &quot;447&quot;,\n    &quot;4879521&quot;: &quot;446&quot;,\n    &quot;4879526&quot;: &quot;445&quot;,\n    &quot;4879546&quot;: &quot;444&quot;,\n    &quot;4879565&quot;: &quot;443&quot;,\n    &quot;4879595&quot;: &quot;442&quot;,\n    &quot;4879598&quot;: &quot;441&quot;,\n    &quot;4879602&quot;: &quot;440&quot;,\n    &quot;4879676&quot;: &quot;439&quot;,\n    &quot;4879678&quot;: &quot;438&quot;,\n    &quot;4879679&quot;: &quot;437&quot;,\n    &quot;4879685&quot;: &quot;436&quot;,\n    &quot;4879704&quot;: &quot;435&quot;,\n    &quot;4879714&quot;: &quot;434&quot;,\n    &quot;4879716&quot;: &quot;433&quot;,\n    &quot;4879808&quot;: &quot;432&quot;,\n    &quot;4879809&quot;: &quot;431&quot;,\n    &quot;4879813&quot;: &quot;430&quot;,\n    &quot;4879814&quot;: &quot;429&quot;,\n    &quot;4879815&quot;: &quot;428&quot;,\n    &quot;4880004&quot;: &quot;427&quot;,\n    &quot;4880008&quot;: &quot;426&quot;,\n    &quot;4880055&quot;: &quot;425&quot;,\n    &quot;4880056&quot;: &quot;424&quot;,\n    &quot;4880058&quot;: &quot;423&quot;,\n    &quot;4880059&quot;: &quot;422&quot;,\n    &quot;4880060&quot;: &quot;421&quot;,\n    &quot;4880061&quot;: &quot;420&quot;,\n    &quot;4880062&quot;: &quot;419&quot;,\n    &quot;4880063&quot;: &quot;418&quot;,\n    &quot;4880064&quot;: &quot;417&quot;,\n    &quot;4880065&quot;: &quot;416&quot;,\n    &quot;4880066&quot;: &quot;415&quot;,\n    &quot;4880598&quot;: &quot;414&quot;,\n    &quot;4880599&quot;: &quot;413&quot;,\n    &quot;4880600&quot;: &quot;412&quot;,\n    &quot;4880601&quot;: &quot;411&quot;,\n    &quot;4880840&quot;: &quot;410&quot;,\n    &quot;4881012&quot;: &quot;409&quot;,\n    &quot;4882458&quot;: &quot;408&quot;,\n    &quot;4885030&quot;: &quot;407&quot;,\n    &quot;4885031&quot;: &quot;406&quot;,\n    &quot;4885035&quot;: &quot;405&quot;,\n    &quot;4885036&quot;: &quot;404&quot;,\n    &quot;4885040&quot;: &quot;403&quot;,\n    &quot;4885041&quot;: &quot;402&quot;,\n    &quot;4885054&quot;: &quot;401&quot;,\n    &quot;4885055&quot;: &quot;400&quot;,\n    &quot;4885056&quot;: &quot;399&quot;,\n    &quot;4885057&quot;: &quot;398&quot;,\n    &quot;4885058&quot;: &quot;397&quot;,\n    &quot;4885059&quot;: &quot;396&quot;,\n    &quot;4885060&quot;: &quot;395&quot;,\n    &quot;4885061&quot;: &quot;394&quot;,\n    &quot;4885406&quot;: &quot;393&quot;,\n    &quot;4885411&quot;: &quot;392&quot;,\n    &quot;4885412&quot;: &quot;391&quot;,\n    &quot;4885470&quot;: &quot;390&quot;,\n    &quot;4886176&quot;: &quot;389&quot;,\n    &quot;4890965&quot;: &quot;388&quot;,\n    &quot;4890966&quot;: &quot;387&quot;,\n    &quot;4890967&quot;: &quot;386&quot;\n  }\n  // expects a space-delimited string of Ensighten condition IDs, returns a boolean that says if ANY were true\n  function checkConditions (condString) {\n    try {\n      condString = condString || &quot;&quot;\n      var condList = condString.trim().split(/\\s+/)\n      var conditions = {}\n      var translatedId\n      condList.forEach((ensightenCondId) =&gt; {\n        // populate the object with 'false' to start\n        translatedId = conditionMap[ensightenCondId]\n        if (typeof translatedId === 'string') {\n          conditions[translatedId] = false\n        }\n      })\n      window.utag.loader.loadrules(originalB, conditions)\n      // console.log(conditions)\n      var conditionMet = false\n      var finalConditions = Object.keys(conditions)\n      finalConditions.forEach((id) =&gt; {\n        if (conditions[id]) {\n          conditionMet = true\n        }\n      })\n      return conditionMet\n    } catch (e) {\n      console.log('checkConditions error', e)\n      return false\n    }\n  }\n\n  if (checkConditions(&quot; 4874978 &quot;)) {\n    try {\n      b[&quot;content_id&quot;] = (function() {\n        return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n          .split(&quot;&amp;units[]=&quot;).pop()\n          .split(&quot;&amp;&quot;).shift();\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4825462  2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - Affiliate Order Detail&quot;] = (function() {\n        var boughtCat = dataLayer[0].ecommerce.purchase.products[0].category;\n        var partDetail = boughtCat.split('/');\n        var ref = dataLayer[0].ecommerce.purchase.actionField.id;\n        return ref + &quot;_&quot; + partDetail[1] + &quot;_&quot; + partDetail[2] + &quot;_&quot; + partDetail[3] + &quot;_&quot; + dataLayer[0].departureAirport + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].name + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].quantity + &quot;_&quot; + dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - BookingRef&quot;] = (function() {\n        if (dataLayer[0].eCommerce !== undefined) {\n          return dataLayer[0].eCommerce.purchase ? dataLayer[0].eCommerce.purchase.actionField.id : &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtAdults&quot;] = (function boughtAdults() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtChildren&quot;] = (function boughtChildren() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836899  4836987  4151406  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCountry&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : dataLayer[0].ecommerce.checkout.products[0].quantity;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPeriod&quot;] = (function anon() {\n        var boughtFrom = dataLayer[0].departureDate;\n        var boughtTo = dataLayer[0].returnDate;\n\n        if (boughtFrom !== undefined) {\n          return (boughtFrom + &quot; - &quot; + boughtTo);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.actionField.revenue;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtResort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - departureDate&quot;] = (function() {\n        return dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4844447  4844445 &quot;)) {\n    try {\n      b[&quot;Crystal - productBrand&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].brand : dataLayer[0].ecommerce.detail.products[0].brand;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory1&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : (dataLayer[0].ecommerce.checkout.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory2&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  4834971  2503818  4834967  4844577  4825428 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory3 - Resort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151409  2503818 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151407 &quot;)) {\n    try {\n      b[&quot;Crystal - productID&quot;] = (function anon() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productID - Facebook&quot;] = (function anon() {\n        var accomID = dataLayer[0].ecommerce &amp;&amp; dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        return accomID.substring(2);\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4151406 &quot;)) {\n    try {\n      b[&quot;Crystal - productPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].quantity : (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : &quot;&quot;);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].price : dataLayer[0].ecommerce.detail.products[0].price;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - Selected Flight Position&quot;] = (function() {\n        if (dataLayer[0].flightposition !== undefined) {\n          return parseInt(dataLayer[0].flightPosition) + 1;\n        } else return &quot;&quot;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836987  2518567 &quot;)) {\n    try {\n      b[&quot;Crystal - TravelType&quot;] = (function() {\n        if (dataLayer[0].departureAirport === &quot;ASH&quot; || dataLayer[0].departureAirport === &quot;STP&quot;) {\n          return &quot;Train&quot;;\n        }\n        return &quot;Flight&quot;;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - Affiliate Cookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; AffiliateCJcookie=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - cjCookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; cjevent=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 386105 &quot;)) {\n    try {\n      b[&quot;geoCountry&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n            return dataLayer[0].transactions.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n            return dataLayer[0].basket.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n            return dataLayer[0].product.geo.countryName;\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n\n  // not sure why this is defined once conditional and once unconditional\n  try {\n    b[&quot;productType&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('flight/book') &gt; -1) {\n          return &quot;Flight&quot;;\n        } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n          return &quot;River Cruise&quot;;\n        } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n          return &quot;Cruise&quot;;\n        } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n          return &quot;Multi-Centre&quot;;\n        } else {\n          if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n            return &quot;Hotel Only&quot;;\n          } else {\n            return &quot;Package&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  /*\n  if (checkConditions(&quot; 696873  4845366  470318  4845258  4845255  4845356  4845253  4878884  4873541 &quot;)) {\n    try {\n      b[&quot;productType&quot;] = (function() {\n        try {\n          if (document.location.href.indexOf('flight/book') &gt; -1) {\n            return &quot;&quot;;\n          } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n            return &quot;River Cruise&quot;;\n          } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n            return &quot;Cruise&quot;;\n          } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n            return &quot;Multi-Centre&quot;;\n          } else {\n            if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n              return &quot;Hotel Only&quot;;\n            } else {\n              return &quot;Package&quot;;\n            }\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  */\n\n  \n  // depends on &quot;legacy_productType&quot;\n  if (checkConditions(&quot; 4845255  4845356  4845253  4878884  696873  4845366  4873541  4859386  4845258 &quot;)) {\n    try {\n      b[&quot;productList&quot;] = (function() {\n\n        var productObj = {},\n          product = '',\n          dl = '',\n          returnVal = [];\n\n        function mapProductObj(id, name, brand, price, quantity, productType, numPax) {\n          var tempObj = {};\n          tempObj.id = id;\n          tempObj.name = name;\n          tempObj.brand = brand || '';\n          tempObj.price = price ? (String(parseFloat(price) / parseInt(quantity, 10))) : price;\n          tempObj.quantity = String(quantity);\n          tempObj.productType = productType || masterProductType;\n          tempObj.metric1 = String(numPax);\n          return tempObj;\n        };\n\n        try {\n          // var masterProductType = Bootstrapper.data.resolve('Manage.TUI UK - Google Analytics.productType');\n          var masterProductType = b.productType\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n            dl = dataLayer[0];\n            if (dl.product &amp;&amp; dl.product.productID) {\n              // Individual Product Impression\n              product = dl.product;\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, product.currentPrice, 1, '', product.noOfPax);\n              returnVal.push(productObj);\n            } else if (dl.page.search) {\n              // Search Term\n              product = dl.page.search;\n              var noOfPax = dl.page.search.noOfPax.toString();\n              if (product.destinationId || product.destinationName) {\n                // Splits the searched destinations up\n                var delimiter = '|',\n                  destinationIds = product.destinationId ? product.destinationId.split(delimiter) : [],\n                  destinationNames = product.destinationName ? product.destinationName.split(delimiter) : [],\n                  maxLength = destinationIds.length &gt;= destinationNames.length ? destinationIds.length : destinationNames.length;\n\n                for (var i = 0; i &lt; maxLength; i++) {\n                  var searchedObj = {\n                    'list': 'Search Term',\n                    'metric1': noOfPax\n                  };\n\n                  if (destinationIds[i]) {\n                    searchedObj.productID = destinationIds[i];\n                  }\n                  if (destinationNames[i]) {\n                    searchedObj.productName = destinationNames[i];\n                  }\n                  returnVal.push(searchedObj);\n                }\n              }\n\n              // Search Results\n              if (product &amp;&amp; product.resultsList) {\n                for (var j = 0; j &lt; product.resultsList.length; j++) {\n                  var currentResult = product.resultsList[j];\n                  currentResult.position = currentResult.position || (j + 1);\n                  currentResult.list = dl.page.pageSubCategory;\n                  currentResult.metric1 = noOfPax;\n                  returnVal.push(currentResult);\n                }\n              }\n            } else if (dl.basket || dl.transactions) {\n              // main item\n              product = dl.basket ? dl.basket.items : (dl.transactions ? dl.transactions.items : {});\n\n              var numPax = dl.basket ? dl.basket.price.paxDetails.total : dl.transactions.total.paxDetails.total,\n                promoDiscount = (function() {\n                  try {\n                    //Added for new array\n                    if (dl.transactions.total &amp;&amp; dl.transactions.total.bookingLevelPromoCodes &amp;&amp; dl.transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl.transactions.total.bookingLevelPromoCodes;\n                      var promoTotalValue = 0;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                      }\n                      return promoTotalValue;\n                    } else if (typeof dl.transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      return Math.abs(dl.transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                    } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                    }\n                    return 0;\n                  } catch (err) {\n                    return 0;\n                  }\n                })(),\n                price = product.price.currentPrice - promoDiscount;\n\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, price, product.quantity.quantity, '', numPax.toString());\n              returnVal.push(productObj);\n\n              // ancillaries\n              var subItems = product.subItems || [];\n              for (var s = 0; s &lt; subItems.length; s++) {\n                var currentSubItem = subItems[s];\n                if (currentSubItem.productSubType.toLowerCase() == &quot;room upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;room downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Downgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Downgrade', currentSubItem.quantity.pax.toString());\n                } else {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Ancillary', currentSubItem.quantity.pax.toString());\n                }\n\n                returnVal.push(subItemObj);\n              }\n            }\n          }\n          // For old data layer\n          else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n            product = tui.analytics.page;\n\n            var productSum = product.Sum || 0,\n              promoDiscount = (function() {\n                try {\n                  if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  return 0\n                } catch (err) {\n                  return 0;\n                }\n              })(),\n              price = product.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(product.bookingLevelCreditNoteDiscount) &gt; 0) ? (parseFloat(product.bookingLevelCreditNoteDiscount) + parseFloat(productSum)) : productSum,\n              id = product.CRWhereTo || product.WhereTo;\n\n            price = price ? price : '';\n            productObj = mapProductObj(id, id, '', price, 1, masterProductType, product.Pax.toString()); // Credit note change - add credit note value if present\n            returnVal.push(productObj);\n          }\n          return returnVal;\n        } catch (err) {\n          return returnVal;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n \n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - CD - Cabin&quot;] = (function() {\n        return tui.analytics.page.CRCabin;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BoardFilter&quot;] = (function() {\n        return tui.analytics.page.BoardF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BudgetFilter&quot;] = (function() {\n        return tui.analytics.page.BudgetF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - CabinFilter&quot;] = (function() {\n        return tui.analytics.page.CabinF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Confirmation - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('title tui-bold')[0].innerHTML;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211741  1207206 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Details - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('inline-title')[0].innerText.replace(/(\\r\\n|\\n|\\r)/gm, &quot; &quot;);\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1210674  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Options - Itinerary Name&quot;] = (function() {\n        var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211742  1211743  1211741  1207254  1207206  1210674  1211596  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DaysUntilDeparture&quot;] = (function() {\n        //Build raw date\n        var rawDate = tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n        //Change to american formatting\n        var depDate = new Date(rawDate.split(&quot;/&quot;)[1] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[0] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[2]);\n        var today = new Date();\n        return parseInt((depDate - today) / (1000 * 60 * 60 * 24)) + 1;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211741  1211720  1211742  1211743 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirport&quot;] = (function() {\n        return tui.analytics.page.DepAir;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirportFilter&quot;] = (function() {\n        return tui.analytics.page.DepAirF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DestinationFilter&quot;] = (function() {\n        return tui.analytics.page.CRGeoF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211743  1207254  1210674  1211596  1211720  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Hotel&quot;] = (function() {\n        return tui.analytics.page.CRHotel;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211742  1211743  1211720  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Party&quot;] = (function() {\n        return tui.analytics.page.Party;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211596  1211743 &quot;)) {\n    try {\n      b[&quot;Stockton - DD - Passenger Details - Itinerary Name&quot;] = (function() {\n        try {\n          var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n          if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n            itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n          }\n\n          if (itineraryName == null || itineraryName == '') {\n            itineraryName = tui.analytics.page.CRWhereTo;\n          }\n\n          return itineraryName;\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PaymentType&quot;] = (function() {\n        return tui.analytics.page.PayType;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PromoCode&quot;] = (function() {\n        return tui.analytics.page.PromoCode;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - ShipFilter&quot;] = (function() {\n        return tui.analytics.page.CRShip;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - TransactionId&quot;] = (function() {\n        return tui.analytics.page.Tracsref;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4879518  4880063  4880064  4880065  4880066 &quot;)) {\n    try {\n      b[&quot;uniqodoBookingReference&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n            return dataLayer[0].transactions.total.transactionId.toString().split('-')[0];\n          } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n            return tui.analytics.page.Tracsref.toString().split('-')[0];\n          }\n        } catch (err) {\n          return '';\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}\n\nfunction addUnconditionalEnsightenVariables (originalB) {\n  var b = {}\n  try {\n    b[&quot;abtaNumber&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ShopID) {\n          return tui.analytics.page.ShopID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;abTest&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.abtestV2) {\n          return tui.analytics.page.abtestV2;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.abTestV2) {\n          return dataLayer[0].page.abTestV2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeCookieDomainPeriods&quot;] = (function() {\n      try {\n        if (document.location.host.indexOf(&quot;.co.uk&quot;) &gt; 0) {\n          return 3;\n        } else if (document.location.hostname.match(/(\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          return 3;\n        } else {\n          return 2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeDownloadFileTypes&quot;] = (function() {\n      try {\n        return &quot;exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeLinkInternalFilters&quot;] = (function() {\n      try {\n        return &quot;javascript:,&quot; +\n          &quot;firstchoice.co.uk,&quot; +\n          &quot;firstchoiceprjuat.co.uk,&quot; +\n          &quot;thomson.co.uk,&quot; +\n          &quot;thomsonprjuat.co.uk,&quot; +\n          &quot;falconholidays.ie,&quot; +\n          &quot;falconholidaysprjuat.ie,&quot; +\n          &quot;tui.co.uk,&quot; +\n          &quot;tuiprjuat.co.uk,&quot; +\n          &quot;tuiholidays.ie,&quot; +\n          &quot;tuiholidaysprjuat.ie,&quot; +\n          &quot;i.4see.mobi,&quot; +\n          &quot;survey.foreseeresults.com,&quot; +\n          &quot;tuiretailagents.thomson.co.uk,&quot; +\n          &quot;retailagents.tui.co.uk,&quot; +\n          &quot;falconretailagents.falconholidays.ie,&quot; +\n          &quot;retailagents.tuiholidays.ie,&quot; +\n          &quot;retailagents.tuiholidaysprjuat.ie,&quot; +\n          &quot;tuiretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;money4travel.com,&quot; +\n          &quot;inbro.net,&quot; +\n          &quot;tuitickets.com,&quot; +\n          &quot;amazonaws.com&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeMarketingCloudVisitorID&quot;] = (function() {\n      try {\n        return visitor.getMarketingCloudVisitorID();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductString&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met')\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else if ((typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount === 'undefined') &amp;&amp; (typeof tui.analytics.page.PromoValue === 'undefined' || tui.analytics.page.PromoValue === 'null')) {\n                    return dataLayer[0].transactions.items.price.currentPrice\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code\n              function getPromoDiscount() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return '|event154=' + Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return '|event154=' + parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductStringLYP&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met');\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  // New data layer, promo code array\n                  if (dataLayer[0].transactions.total.bookingLevelPromoCodes != 'undefined' &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n                    var promoTotalValue = 0;\n                    for (i = 0; i &lt; promoCodeArray.length; i++) {\n                      promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                    }\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(promoTotalValue);\n                  }\n                  // New data layer, pre-release location of promo code\n                  else if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  }\n                  // New data layer, old data layer for promo code\n                  else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  // New data layer, no promo code present\n                  else if (dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.price) {\n                    return dataLayer[0].transactions.items.price.currentPrice;\n                  } else {\n                    return '';\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code - had to add checks for dataLayer presence due to FO defect\n              function getPromoDiscount() {\n                try {\n                  var dl = window.dataLayer;\n                  var discountString = '';\n                  if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n                    if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        if (/CVHRC/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event158=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event159=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else {\n                          discountString += '|event154=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        }\n                      }\n                    }\n                    // If old object is shown - can be removed at a later date\n                    else if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      // Programme Change Incentive\n                      if (/CVRHC/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else {\n                        return '|event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                      }\n                    }\n                  }\n                  // For legacy data layer\n                  else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n                    if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else {\n                        discountString += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                      }\n                    }\n                  }\n                  return discountString;\n                } catch (err) {\n                  return '';\n                }\n              }\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get the promo discount value\n        function getLegacyPromoDiscount() {\n          try {\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              var legacyPromoDiscount = '';\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                } else {\n                  legacyPromoDiscount += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                }\n              }\n              return legacyPromoDiscount\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax + getLegacyPromoDiscount()].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|bookingConfirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeReportSuite&quot;] = (function() {\n      try {\n        if (/^(hybrisdev|paymentpagedev)$/i.test(Bootstrapper.ensightenOptions.publishPath) || /^(prjuat|staging|st[0-9]|hybd[0-9]|admin|prdsupport|localhost|webcache|cloud|rategain|absolutesurveyors|anite|cms|qa|ceros)$/i.test(window.location.host)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukdev&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukapppdev,tuiukdev&quot;;\n          } else {\n            return &quot;tuiukdev&quot;;\n          }\n        } else if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukprod&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukappprod,tuiukprod&quot;;\n          } else {\n            return &quot;tuiukprod&quot;;\n          }\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;agentID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AgentID) {\n          return tui.analytics.page.AgentID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;airportExtras&quot;] = (function() {\n      try {\n        return window.tui.analytics.page.HXAnc;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;alternativeFlightOptions&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AltFlt) {\n          return tui.analytics.page.AltFlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;appVisitor&quot;] = (function() {\n      try {\n        var paramArray = [];\n        if (s.Util.getQueryParam('utm_medium') === &quot;TDA&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-myfirstchoice_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-myfirstchoice_uk&quot;) {\n          paramArray.push(s.Util.getQueryParam('utm_source'));\n          paramArray.push(s.Util.getQueryParam('utm_campaign'));\n\n          if (s.Util.getQueryParam('utm_content')) {\n            paramArray.push(s.Util.getQueryParam('utm_content'));\n          } else if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push('No content set');\n          }\n\n          if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push(s.Util.getQueryParam(&quot;utm_term&quot;));\n          }\n\n          return 'Native App Visitor' + '|' + paramArray.join('|');\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportCode) {\n          return dataLayer[0].transactions.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportCode) {\n          return dataLayer[0].basket.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportCode) {\n          return dataLayer[0].product.arrivalAirportCode;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData != null &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors != null &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportName) {\n          return dataLayer[0].transactions.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportName) {\n          return dataLayer[0].basket.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportName) {\n          return dataLayer[0].product.arrivalAirportName;\n        } else if (window.jsonData &amp;&amp; jsonData.package &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Board) {\n          return tui.analytics.page.Board.trim();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisCode) {\n          return dataLayer[0].transactions.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisCode) {\n          return dataLayer[0].basket.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisCode) {\n          return dataLayer[0].product.boardBasisCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisName) {\n          return dataLayer[0].transactions.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisName) {\n          return dataLayer[0].basket.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisName) {\n          return dataLayer[0].product.boardBasisName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingDate YYYY-MM-DD&quot;] = (function() {\n      try {\n        var today = new Date();\n        var dd = today.getDate();\n        var mm = today.getMonth() + 1; //January is 0\n        var yyyy = today.getFullYear();\n\n        if (dd &lt; 10) {\n          dd = '0' + dd;\n        }\n\n        if (mm &lt; 10) {\n          mm = '0' + mm;\n        }\n\n        today = yyyy + '-' + mm + '-' + dd;\n        return today;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingOrMmbIncentiveCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n\n          if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRI|CVRM|CVRV/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n              return dataLayer[0].transactions.total.bookingLevelPromoCode;\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRI|CVRM|CVRV/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n              return dataLayer[0].basket.price.bookingLevelPromoCode;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n            if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n              return tui.analytics.page.PromoCode;\n            }\n          }\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReferenceMoney4Travel&quot;] = (function() {\n      try {\n        var element = document.querySelector(&quot;.overall-summary p:nth-child(4)&quot;);\n        return element ? element.textContent : &quot;&quot;;\n      } catch (e) {\n        return ''\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;brand&quot;] = (function() {\n      try {\n        if ((document.location.host.indexOf('tuiretailagents.thomson.co.uk') != -1) || (document.location.host.indexOf('tuiretailagents.thomsonprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tui.co.uk') != -1) || (document.location.host.indexOf('retailagents.tuiprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('falconretailagents.falconholidays.ie') != -1) || (document.location.host.indexOf('falconretailagents.falconholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tuiholidays.ie') != -1) || (document.location.host.indexOf('retailagents.tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('thomson.co.uk') != -1) || (document.location.host.indexOf('thomsonprjuat.co.uk') != -1)) {\n          return &quot;thomson&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.co.uk') != -1) || (document.location.host.indexOf('firstchoiceprjuat.co.uk') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.inbro.net') != -1) || (document.location.host.indexOf('firstchoiceprjuat.inbro.net') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('falconholidays.ie') != -1) || (document.location.host.indexOf('falconholidaysprjuat.ie') != -1)) {\n          return &quot;falconholidays&quot;;\n        } else if ((document.location.host.indexOf('tui.co.uk') != -1) || (document.location.host.indexOf('tuiprjuat.co.uk') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tui.inbro.net') != -1) || (document.location.host.indexOf('tuiprjuat.inbro.net') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tuiholidays.ie') != -1) || (document.location.host.indexOf('tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie&quot;;\n        } else if ((document.location.host.indexOf('tuiretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(tuiretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui retail&quot;;\n        } else if ((document.location.host.indexOf('falconretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(falconretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui ie retail&quot;;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaign&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          var im_id = Bootstrapper.getQueryParam('im_id');\n          if (im_id) {\n            im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // return undefined for PPC and paid social and let autotagging handle setting of campaign\n            return im_id;\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return 'email';\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaignSource&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          if (Bootstrapper.getQueryParam('im_id')) {\n            if (Bootstrapper.getQueryParam('im_id') === 'affiliate') {\n              if (~location.href.toLowerCase().indexOf('ia_id=')) {\n                return Bootstrapper.getQueryParam('ia_id');\n              } else {\n                return Bootstrapper.getQueryParam('im_id');\n              }\n            } else if (~location.href.toLowerCase().indexOf('if_id=')) {\n              return Bootstrapper.getQueryParam('if_id');\n            } else if (Bootstrapper.getQueryParam('im_id') &amp;&amp; Bootstrapper.getQueryParam('im_id') != 'affiliate') {\n              var im_id = Bootstrapper.getQueryParam('im_id');\n              im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // Let autotagging or utms handle ppc and paid social so returning undefined\n              return im_id;\n            } else if (document.referrer) {\n              var parts = document.referrer.split('://')[1].split('/'),\n                host = parts[0];\n              if (~host.indexOf('.google.')) {\n                return 'google';\n              }\n              return host;\n            }\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return Bootstrapper.getQueryParam('ito');\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cancelReason&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.cancelReason) {\n          return dataLayer[0].transactions.total.cancelReason;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierInbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[1];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierOutbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[0];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Channel&quot;] = (function() {\n      if (dataLayer[0].pageName === 'Booking Confirmation') {\n        return 'Sale Ski';\n      } else {\n        return dataLayer[0].sectionName || &quot;&quot;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;childAges&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ChildAges) {\n          return tui.analytics.page.ChildAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.childAges) {\n          return dataLayer[0].product.childAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.childAges) {\n          return dataLayer[0].search.childAges;\n        } else if (window.jsonData &amp;&amp; jsonData.searchRequest &amp;&amp; jsonData.searchRequest.childrenAge) {\n          return jsonData.searchRequest.childrenAge.toString().replace(/,/g, &quot;|&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialSortPriority&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CSPScore) {\n          return tui.analytics.page.CSPScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScore&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScore) {\n          return tui.analytics.page.CVScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScoreType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScoreType) {\n          return tui.analytics.page.CVScoreType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;componentClicked&quot;] = (function() {\n      try {\n        return s.Util.cookieRead('s_comp_click');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentCode) {\n          return dataLayer[0].transactions.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentCode) {\n          return dataLayer[0].basket.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentCode) {\n          return dataLayer[0].product.geo.continentCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentName) {\n          return dataLayer[0].transactions.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentName) {\n          return dataLayer[0].basket.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentName) {\n          return dataLayer[0].product.geo.continentName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cookieLength&quot;] = (function() {\n      try {\n        var cookieSize = document.cookie.length;\n        var cLength = 'unknown';\n        if (!isNaN(cookieSize)) {\n          if (cookieSize &lt; 500)\n            cLength = '&lt; 500';\n          else if (cookieSize &lt; 1024)\n            cLength = '500b-1k';\n          else if (cookieSize &lt; 2048)\n            cLength = '1k-2k';\n          else if (cookieSize &lt; 4096)\n            cLength = '2k-4k';\n          else if (cookieSize &lt; 8192)\n            cLength = '4k-8k';\n          else\n            cLength = 'more than 8k';\n        }\n        return cLength;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryCode) {\n          return dataLayer[0].transactions.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryCode) {\n          return dataLayer[0].basket.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryCode) {\n          return dataLayer[0].product.geo.countryCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n          return dataLayer[0].transactions.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n          return dataLayer[0].basket.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n          return dataLayer[0].product.geo.countryName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].countryName) {\n          return jsonData.packageViewData.accomViewData[0].countryName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;coupon&quot;] = (function() {\n      var returnVal = 'none';\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total) {\n          if (dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode;\n          } else if (dataLayer[0].transactions.total.bookingLevelPromoCode) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCode;\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.toLowerCase() != 'null') {\n          return tui.analytics.page.PromoCode;\n        } else {\n          return returnVal;\n        }\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n          return tui.analytics.page.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteCode) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteCode;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null') {\n          return parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteDiscount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteOriginalBookingID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.originalTransactionId &amp;&amp; tui.analytics.page.originalTransactionId != 'null') {\n          return tui.analytics.page.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.orignalTransactionId) {\n          return dataLayer[0].transactions.total.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.originalTransactionId) {\n          return dataLayer[0].basket.price.totalPrice.originalTransactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteRefundValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteRefundValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue) {\n          return dataLayer[0].transactions.total.creditNoteRefundValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteTotalValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteTotalValue &amp;&amp; tui.analytics.page.creditNoteTotalValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteTotalValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteTotalValue) {\n          return dataLayer[0].transactions.total.creditNoteTotalValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.creditNoteTotalValue) {\n          return dataLayer[0].basket.price.creditNoteTotalValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRCabin) {\n          return tui.analytics.page.CRCabin;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CrCabin) {\n          return tui.analytics.page.CrCabin;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseEpicCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRWhereTo) {\n          return tui.analytics.page.CRWhereTo;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseHotel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRHotel) {\n          return tui.analytics.page.CRHotel;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShip) {\n          return tui.analytics.page.CRShip;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStay&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStay) {\n          return tui.analytics.page.CRStay;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayDuration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur) {\n          return tui.analytics.page.STDur;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayRoomType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STRmSlt) {\n          return tui.analytics.page.STRmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRType) {\n          return tui.analytics.page.CRType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - BkngStep&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.checkout !== undefined) {\n        return dataLayer[0].ecommerce.checkout.actionField.step;\n      } else if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n        return dataLayer[0].ecommerce.purchase.actionField.step;\n      } else return &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - bookingPace&quot;] = (function() {\n      return dataLayer[0].bookingPace || dataLayer[0].searchPace || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - cjevent&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cjevent=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentArrivalAirport&quot;] = (function arrivalAirport() {\n      // returns the arrival airport taken from the route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        var defaultRoute = dataLayer[0].defaultRoute;\n        var defaultRouteArray = defaultRoute.split(&quot;-&quot;);\n        return defaultRouteArray[1];\n      } else if (dataLayer[0].selectedRoute !== undefined) {\n        var selectedRoute = dataLayer[0].defaultRoute;\n        var selectedRouteArray = defaultRoute.split(&quot;-&quot;);\n        return selectedRouteArray[1];\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentCountry&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureAirportArray&quot;] = (function depAirport() {\n      // returns the departure airport\n      if (dataLayer[0].d_airport !== undefined) {\n        return dataLayer[0].d_airport.join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureDate&quot;] = (function currentDepDate() {\n      // returns the current departure date\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout;\n      }\n      if (dataLayer[0].departureDate !== undefined) {\n        return dataLayer[0].departureDate;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDuration&quot;] = (function currentDestination() {\n      // returns the current holiday duration\n      if (dataLayer[0].duration !== undefined) {\n        return dataLayer[0].duration;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentHotelId&quot;] = (function accomId() {\n      // returns the accom id, without the initial letters, where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].id.substring(2);\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPartyType&quot;] = (function currentDepDate() {\n      // returns the current party type\n      if (dataLayer[0].partyType !== undefined) {\n        return dataLayer[0].partyType;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax&quot;] = (function anyPax() {\n      // returns the sum of adults and children from the partyCombination (i.e. excluding infants)\n      if (dataLayer[0].partyCombination !== undefined) {\n        var party = dataLayer[0].partyCombination;\n        var partyArray = party.split(&quot;:&quot;);\n        return parseInt(partyArray[0], 10) + parseInt(partyArray[1], 10);\n      } else if (dataLayer[0].ecommerce !== undefined) {\n        // uses quantity as a fallback if partyCombination is undefined, but will include infants in pax\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax inc infants&quot;] = (function anyPax() {\n      // returns the pax where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentResort&quot;] = (function productCat() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2]\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentRoute&quot;] = (function route() {\n      // returns the current route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        return dataLayer[0].defaultRoute;\n      }\n      if (dataLayer[0].selectedRoute !== undefined) {\n        return dataLayer[0].selectedRoute;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Hit Timestamp&quot;] = (function() {\n      //Get local time as ISO string with offset at the end\n      var now = new Date();\n      var tzo = -now.getTimezoneOffset();\n      var dif = tzo &gt;= 0 ? '+' : '-';\n      var pad = function(num) {\n        var norm = Math.abs(Math.floor(num));\n        return (norm &lt; 10 ? '0' : '') + norm;\n      };\n      return now.getFullYear() +\n        '-' + pad(now.getMonth() + 1) +\n        '-' + pad(now.getDate()) +\n        'T' + pad(now.getHours()) +\n        ':' + pad(now.getMinutes());\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Internal Campaign&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;icid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - NumberOfRooms&quot;] = (function() {\n      return dataLayer[0].numberOfRooms;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - pageName&quot;] = (function() {\n      return dataLayer[0].pageName || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - productName&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].name;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].name;\n        } else if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].name;\n        }\n      } else return &quot;&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - sectionName&quot;] = (function() {\n      return dataLayer[0].sectionName;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Server&quot;] = (function() {\n      return dataLayer[0].server;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - transactionID&quot;] = (function() {\n      return dataLayer[0].transactionID;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Flashtalking Departure Date&quot;] = (function() {\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout.split(&quot;/&quot;).reverse().join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array Search&quot;] = (function() {\n      if (dataLayer[0].sectionName === &quot;Search Results&quot; || dataLayer[0].sectionName === &quot;Deals&quot;) {\n\n        const ids = dataLayer[0].destinationCode || [];\n        const names = dataLayer[0].destinationName || [];\n\n        return ids.map(function(val, i) {\n          return {\n            id: val,\n            name: names[i],\n            list: dataLayer[0].pageName\n          }\n        });\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Currency&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.www.crystalski.co.uk.crystaldev.io', 'qa1.www.crystalski.co.uk.crystaldev.io', 'dev2.www.crystalski.co.uk.crystaldev.io', 'dev1.www.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.agent.crystalski.co.uk.crystaldev.io', 'qa1.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'EUR';\n      } else if (document.location.host.indexOf('stage.www.crystalski.ie.crystaldev.io', 'qa1.www.crystalski.ie.crystaldev.io', 'dev2.www.crystalski.ie.crystaldev.io', 'dev1.www.crystalski.ie.crystaldev.io') != -1) {\n        return 'EUR';\n      }\n      return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;currencyCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.total &amp;&amp; dl.transactions.total.currency) {\n            return dl.transactions.total.currency;\n          } else if (dl.basket &amp;&amp; dl.basket.price &amp;&amp; dl.basket.price.currency) {\n            return dl.basket.price.currency;\n          } else if (dl.product &amp;&amp; dl.product.currency) {\n            return dl.product.currency;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerAccountNumberOfBookings&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CABookings) {\n          return tui.analytics.page.CABookings;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CustID) {\n          return tui.analytics.page.CustID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.customerID) {\n          return dataLayer[0].user.customerID;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;date&quot;] = (function() {\n      try {\n        var ddd = new Date();\n        var fyfyfy = ddd.getFullYear();\n        var mmm = ddd.getMonth() + 1;\n        var zero = &quot;0&quot;\n        if (mmm &lt; 10) {\n          mmm = zero + mmm;\n        } else {\n          mmm = mmm;\n        }\n        var daydayday = ddd.getDate();\n        var zero = &quot;0&quot;\n        if (daydayday &lt; 10) {\n          daydayday = zero + daydayday;\n        } else {\n          daydayday = daydayday;\n        }\n        var slash = &quot;/&quot;\n        var date = daydayday + slash + mmm + slash + fyfyfy\n        return date;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;daysToDeparture&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate) {\n          var depMonthYear = tui.analytics.page.MonthYear.split('/')\n          var departureDate = new Date(depMonthYear[1], depMonthYear[0] - 1, tui.analytics.page.DepDate);\n          var today = new Date();\n\n          Days = departureDate - today;\n\n          var daysToDep = Math.ceil(Days / (1000 * 60 * 60 * 24));\n\n          return daysToDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          return String(dataLayer[0].transactions.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          return String(dataLayer[0].basket.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          return String(dataLayer[0].product.daysToDeparture);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;decibelID&quot;] = (function() {\n      try {\n        var host = location.hostname,\n          returnVal = '';\n\n        if (~host.indexOf('tuiprjuat.co.uk')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('firstchoiceprjuat.co.uk')) {\n          returnVal = '116869';\n        } else if (~host.indexOf('tuiholidaysprjuat.ie')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('tui.co.uk')) {\n          returnVal = '93210';\n        } else if (~host.indexOf('firstchoice.co.uk')) {\n          returnVal = '95707';\n        } else if (~host.indexOf('tuiholidays.ie')) {\n          returnVal = '95715';\n        }\n        return returnVal;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureAirportCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAir) {\n          return tui.analytics.page.DepAir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureAirportCode) {\n          return dataLayer[0].transactions.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureAirportCode) {\n          return dataLayer[0].basket.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureAirportCode) {\n          return dataLayer[0].product.departureAirportCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureDate&quot;] = (function() {\n      //date format dd/mm/yyyy\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; (tui.analytics.page.DepDate || (tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.indexOf('Dates') === -1))) {\n          var day = tui.analytics.page.DepDate;\n          var month = tui.analytics.page.MonthYear.substring(0, 2);\n          var year = tui.analytics.page.MonthYear.substring(3, 7);\n          return (day == undefined ? &quot;&quot; : day == &quot;&quot; ? &quot;&quot; : day) + '/' + month + '/' + year;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDate) {\n          return dataLayer[0].transactions.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDate) {\n          return dataLayer[0].basket.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDate) {\n          return dataLayer[0].product.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search.departureDate) {\n          return dataLayer[0].page.search.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n    try {\n      var returnVal = 'none';\n      // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n      if (typeof b.departureDate === 'string') {\n        var splitDate = b.departureDate.split('/')\n        var year = splitDate[2] &amp;&amp; splitDate[2].length === 4 &amp;&amp; splitDate[2]\n        var month = splitDate[1] &amp;&amp; splitDate[1].length === 2 &amp;&amp; splitDate[1]\n        var day = splitDate[0] &amp;&amp; splitDate[0].length === 2 &amp;&amp; splitDate[0]\n        if (year &amp;&amp; month &amp;&amp; day) {\n          return year + month + day\n        }\n        // sometimes the day isn't selected (like cruises)\n        if (year &amp;&amp; month) {\n          return year + month\n        }\n      }\n      return returnVal\n    } catch (err) {\n      return returnVal;\n    }\n  })()\n\n  /*\n  Doesn't seem to work correctly on https://www.tui.co.uk/cruise/bookitineraries/Mediterranean-Medley-101129?itineraryCodeOne=101129&amp;itineraryCodeTwo=&amp;shipCode=150012&amp;mc=false&amp;isMCTracs=false&amp;isStayBefore=false&amp;stayDuration=0&amp;cruiseDuration=7&amp;duration=1-7&amp;noOfAdults=2&amp;noOfChildren=0&amp;childrenAge=&amp;from[]=BOH:Airport&amp;to[]=101129:Itinerary&amp;flexibility=false&amp;noOfSeniors=0&amp;when=12-10-2021&amp;sailingDate=12Oct21&amp;to[]=&amp;packageId=16340190000001634030400000TOM620416346388000001634643300000TOM62051181672602/3/650/7ZI01&amp;index=3&amp;brandType=null&amp;addAStay=0&amp;cabin[]=1,2&amp;dp=BOH&amp;bb=AI&amp;cabinOnly=false&amp;mcId=101129|T&amp;searchVariant=FLY_CRUISE_ATCOM\n\n  Attempting to replace it\n\n  try {\n    b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n      try {\n        var returnVal = 'none';\n        // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n          var dl = dataLayer[0];\n\n          if (dl.page &amp;&amp; dl.page.search &amp;&amp; dl.page.search.departureDate) {\n            returnVal = dl.page.search.departureDate;\n          } else if (dl.product &amp;&amp; dl.product.departureDate) {\n            returnVal = dl.product.departureDate;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.departureDate) {\n            returnVal = dl.basket.items.departureDate;\n          } else if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.departureDate) {\n            returnVal = dl.transactions.items.departureDate;\n          }\n          return returnVal.replace(/-/g, '');\n        } else if (tui.analytics.page.MonthYear) {\n          var year = tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.split('/').length &gt; 0 ? tui.analytics.page.MonthYear.split('/')[1] : '';\n          month = tui.analytics.page.MonthYear ? tui.analytics.page.MonthYear.split('/')[0] : '';\n          day = tui.analytics.page.DepDate;\n\n          return [year, month, day].join('');\n        }\n        return returnVal;\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  */\n\n  try {\n    b[&quot;departureDateDifference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDateDiff) {\n          return tui.analytics.page.DepDateDiff;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDateDifference) {\n          return dataLayer[0].product.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDateDifference) {\n          return dataLayer[0].basket.items.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDateDifference) {\n          return dataLayer[0].transactions.items.departureDateDifference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionsAvailable&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOpt) {\n          return tui.analytics.page.DepOpt;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.availableDepositOptions) {\n          return dataLayer[0].basket.price.availableDepositOptions;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionSelected&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOptSel) {\n          return tui.analytics.page.DepOptSel;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.depositValue) {\n          return dataLayer[0].transactions.total.depositValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositValueBookflow&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') == -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationBrowse&quot;] = (function() {\n      //to be updated later\n      try {\n        var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n        var destination = (function() {\n          switch (pageType) {\n            case 'COUNTRY':\n            case 'Destination_Country':\n            case 'Destination_Country_TTD':\n            case 'REGION':\n            case 'Destination_Region':\n              return document.getElementsByClassName('pg-heading')[0].innerText.split(&quot; Holidays&quot;)[0];\n            case 'DESTINATION':\n            case 'Destination_Destination':\n            case 'RESORT':\n            case 'Destination_Resort':\n              return document.getElementsByClassName('page-title')[0].innerHTML.split(&quot; Holidays&quot;)[0];\n            case 'ACCOMMODATION':\n            case 'Destination_Accommodation':\n              return document.querySelector(&quot;.bread-viewport&quot;).childNodes[1].childNodes[3].innerText.slice(0, -1);\n            default:\n              return '';\n          }\n        })()\n        return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationCode) {\n          return dataLayer[0].transactions.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationCode) {\n          return dataLayer[0].basket.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationCode) {\n          return dataLayer[0].product.geo.destinationCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationFC&quot;] = (function() {\n      try {\n        function titleCase(str) {\n          str = str ? str.toLowerCase().split(' ') : [];\n          for (var i = 0; i &lt; str.length; i++) {\n            str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n          }\n          return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n        }\n\n        if (tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n          return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/PPPPP/g, &quot;&quot;));\n        } else {\n          return titleCase(document.getElementsByClassName('uppercase tui-dark-blue destinations-name')[0].outerText.replace(&quot;DESTINATIONS IN &quot;, &quot;&quot;));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationIMG&quot;] = (function() {\n      try {\n        var url = document.getElementsByClassName('hero-img')[0].children[0].currentSrc;\n        var widthreplace = url.replace(/width:1080/g, &quot;width:364&quot;);\n        var heightreplace = widthreplace.replace(/height:608/g, &quot;height:180&quot;);\n        return heightreplace;\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationName) {\n          return dataLayer[0].transactions.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationName) {\n          return dataLayer[0].basket.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationName) {\n          return dataLayer[0].product.geo.destinationName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPrice&quot;] = (function() {\n      try {\n        var price;\n\n        if (tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n          price = document.getElementsByClassName('actual-price')[0].outerText;\n        } else {\n          price = document.getElementsByClassName('amount')[0].outerText;\n        }\n        return price;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPush&quot;] = (function() {\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var destination = (function() {\n        switch (pageType) {\n          case 'CONTINENT':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'COUNTRY':\n          case 'Destination_Country':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'Destination_Country_TTD':\n          case 'REGION':\n          case 'Destination_Region':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'DESTINATION':\n          case 'Destination_Destination':\n          case 'RESORT':\n          case 'Destination_Resort':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'ACCOMMODATION':\n          case 'Destination_Accommodation':\n            function titleCase(str) {\n              str = str ? str.toLowerCase().split(' ') : [];\n              for (var i = 0; i &lt; str.length; i++) {\n                str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n              }\n              return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n            }\n            return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/OOOOO/g, &quot;&quot;));\n          default:\n            return 'null';\n        }\n      })()\n      return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;device&quot;] = (function() {\n      try {\n        var deviceDetector = (function() {\n          var ua = navigator.userAgent.toLowerCase();\n          var detect = (function(s) {\n            if (s === undefined) s = ua;\n            else ua = s.toLowerCase();\n            if (/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(ua))\n              return 'Tablet';\n            else\n            if (/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(ua))\n              return 'Mobile';\n            else return 'Desktop';\n          });\n          return {\n            device: detect(),\n            detect: detect,\n            isMobile: ((detect() != 'desktop') ? true : false),\n            userAgent: ua\n          };\n        }());\n\n        return deviceDetector.device;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directDebit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DirectDebit) {\n          return tui.analytics.page.DirectDebit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directOrIndirectFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InDir) {\n          return tui.analytics.page.InDir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.directOrIndirectFlight) {\n          return dataLayer[0].transactions.items.directOrIndirectFlight;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.directOrIndirectFlight) {\n          return dataLayer[0].basket.items.directOrIndirectFlight;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;dreamlinerFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DreamFl) {\n          return tui.analytics.page.DreamFl;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;duration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          return tui.analytics.page.Dur;\n        } else if (tui.analytics.page.STDur &amp;&amp; tui.analytics.page.STDur.toLowerCase() == &quot;null&quot;) {\n          return tui.analytics.page.CRDur;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur &amp;&amp; tui.analytics.page.CRDur) {\n          return parseInt(tui.analytics.page.CRDur) + parseInt(tui.analytics.page.STDur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          return dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          return dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          return dataLayer[0].product.duration;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationCode&quot;] = (function() {\n      try {\n        var dur = &quot;&quot;;\n        var durCode;\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          dur = parseInt(tui.analytics.page.Dur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          dur = dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          dur = dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          dur = dataLayer[0].product.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.duration) {\n          dur = dataLayer[0].page.search.duration;\n        }\n\n\n        switch (dur) {\n          case 1:\n            durCode = '1245';\n            break;\n          case 2:\n          case 3:\n          case 4:\n            durCode = '4321';\n            break;\n          case 5:\n          case 6:\n          case 7:\n          case 8:\n          case 9:\n            durCode = '7114';\n            break;\n          case 10:\n            durCode = '1014';\n            break;\n          case 11:\n            durCode = '1114';\n            break;\n          case 12, 13, 14, 15, 16:\n            durCode = '1413';\n            break;\n          default:\n            durCode = '2118';\n        }\n\n        return durCode;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationSearched&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DurationSearched) {\n          return tui.analytics.page.DurationSearched;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.durationSearched) {\n          return dataLayer[0].page.search.durationSearched;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;emailHash&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Eml) {\n          return tui.analytics.page.Eml;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.hashedEmail) {\n          return dataLayer[0].user.hashedEmail;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;epicCode&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('cruise') == -1) {\n          if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.WhereTo) {\n            return tui.analytics.page.WhereTo;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productID) {\n            return dataLayer[0].transactions.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productID) {\n            return dataLayer[0].basket.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productID) {\n            return dataLayer[0].product.productID;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;facebookPixelFire&quot;] = (function() {\n      try {\n        //let days = Bootstrapper.data.resolve('Manage.TUI UK - Generic.daysToDeparture');\n        let days = b.daysToDeparture\n        //let carrier = Bootstrapper.data.resolve('Manage.TUI UK - Generic.carrierCode');\n        let carrier = b.carrierCode\n        //Fire FB Pixel Logic\n        if (days &lt; 180 &amp;&amp; carrier === &quot;TOM|TOM&quot;) {\n          return 'YES';\n        } else {\n          return 'NO';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterAccommodationType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AccomTypeF) {\n          return tui.analytics.page.AccomTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;accommodationType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBackTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BackTimeF) {\n          return tui.analytics.page.BackTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;inslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBestFor&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BestForF) {\n          return tui.analytics.page.BestForF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;bestfor&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBoard&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BoardF) {\n          return tui.analytics.page.BoardF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;boardBasis&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBudget&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BudgetF) {\n          return tui.analytics.page.BudgetF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;budgettotal&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseCabin&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CabinF) {\n          return tui.analytics.page.CabinF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRGeoF) {\n          return tui.analytics.page.CRGeoF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShipF) {\n          return tui.analytics.page.CRShipF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseStayDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStayF) {\n          return tui.analytics.page.CRStayF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDepartureAirport&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAirF) {\n          return tui.analytics.page.DepAirF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;departurePoints&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.GeoF) {\n          return tui.analytics.page.GeoF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;destinations&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFeatures&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FeaturesF) {\n          return tui.analytics.page.FeaturesF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;features&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFreeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FreeKidsF) {\n          return tui.analytics.page.FreeKidsF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;isFCP&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterHolidayType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.HolTypeF) {\n          return tui.analytics.page.HolTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterOutTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OutTimeF) {\n          return tui.analytics.page.OutTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;outslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterSingleAccommodationEndState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.filters) {\n          return window.tui.analytics.page.filters.reduce(function(a, c, i) {\n            i === 0 ? c.filterValue : a + ',' + c.filterValue;\n          }, '')\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n\n  try {\n    b[&quot;filterSortBy&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SortByF) {\n          return tui.analytics.page.SortByF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTourOperator&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TourOperatorF) {\n          return tui.analytics.page.TourOperatorF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayOperator&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARatingF) {\n          return tui.analytics.page.TARatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;taRatingF&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTuiRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RatingF) {\n          return tui.analytics.page.RatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;fcRating&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;firstPartyAncillaries&quot;] = (function() {\n      try {\n\n        var arrayItems = &quot;&quot;;\n        var itemValue = &quot;&quot;;\n\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TuiAnc) {\n          return tui.analytics.page.TuiAnc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.subItems) {\n          arrayItems = dataLayer[0].transactions.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.subItems) {\n          arrayItems = dataLayer[0].basket.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flexibleDates&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FlexDate) {\n          return tui.analytics.page.FlexDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flexibleDates) {\n          return dataLayer[0].page.search.flexibleDates;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ACSSRef) {\n          return tui.analytics.page.ACSSRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasCheckedInState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CheckIn) {\n          return tui.analytics.page.CheckIn;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasInboundDays&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InboundDays) {\n          return tui.analytics.page.InboundDays;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightInventory&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltInv) {\n          return tui.analytics.page.FltInv;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.flightInventory) {\n          return dataLayer[0].transactions.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.flightInventory) {\n          return dataLayer[0].basket.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.flightInventory) {\n          return dataLayer[0].product.flightInventory;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightOnlyDeparturePeriod&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepPeriod) {\n          return tui.analytics.page.DepPeriod;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltType) {\n          return tui.analytics.page.FltType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productSubType &amp;&amp; (dataLayer[0].transactions.items.productSubType == &quot;Inbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Outbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].transactions.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productSubType &amp;&amp; (dataLayer[0].basket.items.productSubType == &quot;Inbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Outbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].basket.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flightType) {\n          dataLayer[0].page.search.flightType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlacePartySize&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PartySize) {\n          return tui.analytics.page.PartySize;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SelectScope) {\n          return tui.analytics.page.SelectScope;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.freeKidsAvailable) {\n          return dataLayer[0].product.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.freeKidsAvailable) {\n          return dataLayer[0].basket.items.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.freeKidsAvailable) {\n          return dataLayer[0].transactions.items.freeKidsAvailable;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;geoLevel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) {\n          return tui.analytics.page.contextType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;gmpCustomerID&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('qcmk') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;qcmk=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics Property ID&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'UA-64722569-1';\n      } else if ([&quot;dev1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.www.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.www.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64722569-8';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'UA-64996454-1';\n      } else if ([&quot;dev1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.agent.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64996454-2';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'UA-65009155-1';\n      } else if ([&quot;dev1.www.crystalski.ie.crystaldev.io&quot;, &quot;dev2.www.crystalski.ie.crystaldev.io&quot;, &quot;qa1.www.crystalski.ie.crystaldev.io&quot;, &quot;stage.www.crystalski.ie.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-65009155-2';\n      } else return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics - New Property ID&quot;] = (function() {\n\n      var tui_new_prod = 'UA-107596466-5';\n      var tui_new_dev = 'UA-107596466-6';\n      var fc_new_prod = 'UA-107596466-7';\n      var fc_new_dev = 'UA-107596466-8';\n      var tui_ie_new_prod = 'UA-39088453-1';\n      var tui_ie_new_dev = 'UA-39088453-3';\n\n      try {\n        // Check if it is prod bootstrap\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Production\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK - New:' + fc_new_prod);\n            return fc_new_prod;\n          }\n          // TUI IE Production\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE:' + tui_ie_new_prod);\n            return tui_ie_new_prod;\n          }\n          // TUI UK Production\n          else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - New:' + tui_new_prod);\n            return tui_new_prod;\n          } else {\n            return tui_new_dev;\n          }\n        }\n        // Check if it is dev bootstrap\n        else if (/^(hybrisdev|paymentpagedev|dev)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Development\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK Dev - New:' + fc_new_dev);\n            return fc_new_dev;\n          }\n          // TUI IE Development\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE - Dev:' + tui_ie_new_dev);\n            return tui_ie_new_dev;\n          } else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - Dev New:' + tui_new_dev);\n            return tui_new_dev;\n          }\n        }\n        // Fallback to dev\n        else {\n          console.log('GA Property:TUI UK - Dev New FALLBACK:' + tui_new_dev);\n          return tui_new_dev;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsClientID&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('_ga2')) {\n          return Bootstrapper.Cookies.get('_ga2').slice(6);\n        } else if (Bootstrapper.Cookies.get('_ga')) {\n          return Bootstrapper.Cookies.get('_ga').slice(6);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsPropertyID&quot;] = (function() {\n      try {\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          return 'UA-107596466-1';\n        }\n        return 'UA-107596466-3';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;handLuggageOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Hlo) {\n          return tui.analytics.page.Hlo;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.handLuggageOnly) {\n          return dataLayer[0].transactions.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.handLuggageOnly) {\n          return dataLayer[0].basket.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.handLuggageOnly) {\n          return dataLayer[0].product.handLuggageOnly;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;haulTypeSearch&quot;] = (function() {\n\n      //Iterates through search results list and counts SH/LH destinations. Returns haul type with higher count.\n      //Used for audience building/retargeting purposes.\n\n      //Beach Search Results\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList) {\n          var results = dataLayer[0].page.search.resultsList;\n          var haulList = [],\n            countSH = 0,\n            countLH = 0;\n\n          results.forEach(function(item) {\n            if (item.haulCode === 'SH') {\n              countSH++;\n            } else if (item.haulCode === 'LH') {\n              countLH++;\n            }\n          });\n\n          if (countLH &gt; countSH) {\n            return 'LH';\n          } else {\n            return 'SH';\n          }\n        }\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hostname&quot;] = (function() {\n      try {\n        return document.location.host;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hotelName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productName &amp;&amp; dataLayer[0].transactions.items.productType &amp;&amp; (dataLayer[0].transactions.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].transactions.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productName &amp;&amp; dataLayer[0].basket.items.productType &amp;&amp; (dataLayer[0].basket.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].basket.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productName &amp;&amp; dataLayer[0].product.productType &amp;&amp; (dataLayer[0].product.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].product.productName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].accomName) {\n          return jsonData.packageViewData.accomViewData[0].accomName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;irClickID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; irclickid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isAccommodationOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AOType) {\n          return tui.analytics.page.AOType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.isAccommodationOnly) {\n          return dataLayer[0].transactions.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.isAccommodationOnly) {\n          return dataLayer[0].basket.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.isAccommodationOnly) {\n          return dataLayer[0].product.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.isAccommodationOnly) {\n          return dataLayer[0].search.isAccommodationOnly;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isChoiceSearch&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IsChoiceSearch &amp;&amp; tui.analytics.page.IsChoiceSearch != 'null') {\n          return tui.analytics.page.IsChoiceSearch;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isChoiceSearch) {\n          return dataLayer[0].page.search.isChoiceSearch;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking != 'null') {\n          return tui.analytics.page.isCreditNoteBooking;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking) {\n          return dataLayer[0].transactions.total.isCreditNoteBooking;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteIncentiveEligible&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible != 'null') {\n          return tui.analytics.page.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].transactions.total.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].basket.price.isCreditNoteIncentiveEligible.toLowerCase();\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCRM&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;cmid&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isLowDeposit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LowDep) {\n          return tui.analytics.page.LowDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.price.isLowDeposit;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.total.isLowDeposit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isPush&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;im_id=Push&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSearch&quot;] = (function() {\n\n      try {\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else {\n\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSEO&quot;] = (function() {\n      try {\n        var isSearch;\n        var isSEO;\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else {\n\n          isSearch = &quot;NO&quot;;\n        }\n\n        if (isSearch === &quot;YES&quot;) {\n\n          if (window.location.search.indexOf(&quot;im_id&quot;) &gt; -1) {\n\n            isSEO = &quot;NO&quot;;\n          } else {\n\n            isSEO = &quot;YES&quot;;\n          }\n        } else {\n          isSEO = &quot;NO&quot;;\n        }\n        return isSEO;\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvB) {\n          return tui.analytics.page.LimAvB;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilityBeds) {\n          return dataLayer[0].product.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilityBeds) {\n          return dataLayer[0].basket.items.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilityBeds) {\n          return dataLayer[0].transactions.items.limitedAvailabilityBeds;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityCabins&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvC) {\n          return tui.analytics.page.LimAvC;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilitySeats&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvS) {\n          return tui.analytics.page.LimAvS;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilitySeats) {\n          return dataLayer[0].product.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.items.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.items.limitedAvailabilitySeats;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price - Booking Check&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid &amp;&amp; tui.analytics.page.pageUid == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else {\n          return &quot;FireBooking&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Available&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isLockYourPriceAvailable &amp;&amp; (dataLayer[0].basket.price.lockYourPriceCost &gt;= 0)) {\n          return (dataLayer[0].basket.price.isLockYourPriceAvailable + &quot;|&quot; + (dataLayer[0].basket.price.lockYourPriceCost == 0 ? 'zero' : dataLayer[0].basket.price.lockYourPriceCost));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Confirmed Booking&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return 1;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Revenue&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/confirmation') !== -1) {\n          if (window.dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot; || window.dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n            return window.dataLayer[0].transactions.total.lockYourPriceValue;\n          }\n        } else if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return (window.dataLayer[0].transactions.total.lockYourPriceValue * -1);\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking Revenue&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return dataLayer[0].transactions.total.totalPrice;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;loginDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CLogin) {\n          return tui.analytics.page.CLogin;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.loggedInStatus) {\n          return dataLayer[0].user.loggedInStatus;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;minimumPaymentAmount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MinPay) {\n          return tui.analytics.page.MinPay;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.minPaymentAmount) {\n          return dataLayer[0].transactions.items.minPaymentAmount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.minPaymentAmount) {\n          return dataLayer[0].basket.items.minPaymentAmount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RPRef) {\n          return tui.analytics.page.RPRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MMBPayments) {\n          return tui.analytics.page.MMBPayments;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AandCType) {\n          return tui.analytics.page.AandCType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmountOutstanding&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AmountOutstanding) {\n          return tui.analytics.page.AmountOutstanding;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.amountOustanding) {\n          return dataLayer[0].user.currentBookings.amountOustanding;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AcAnc) {\n          return tui.analytics.page.AcAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingAmount&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') != -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BookingType) {\n          return tui.analytics.page.BookingType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbExistingBookingDepartureDate&quot;] = (function() {\n      try {\n        // returns in yyyymmdd format\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.items &amp;&amp; dataLayer[0].user.currentBookings.items.departureDate) {\n          return dataLayer[0].user.currentBookings.items.departureDate.replace(/-/gi, '');\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbPaymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbTransactionValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TransactionValue) {\n          return tui.analytics.page.TransactionValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;month&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear.substring(0, 2);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;monthYear&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].transactions.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].basket.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].product.departureMonth.split('-')[0]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;navigationTracking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.navigation) {\n          return tui.analytics.page.navigation;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newDataLayer&quot;] = (function() {\n      try {\n        return dataLayer[0].page ? 'true' : 'false';\n      } catch (err) {\n        return 'false';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newSEOdata&quot;] = (function() {\n      //Variable Declarations\n      var refOrigin = document.createElement('a');\n      refOrigin.href = document.referrer;\n      var lpurl = window.location.href;\n      var urlLength = lpurl.length;\n      var siteSection;\n      var destination;\n      var pageName = (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) ? dataLayer[0].page.pageID : (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) ? tui.analytics.page.pageUid : '';\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var pageHead = (function() {\n        try {\n          var a = document.getElementsByClassName('pg-heading')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n      var pageTitle = (function() {\n        try {\n          var a = document.getElementsByClassName('page-title')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n\n      if (document.domain === 'www.tui.co.uk') {\n        //TUI SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;cruise&quot;) &gt; -1):\n            siteSection = 'Cruise';\n            break;\n          case (lpurl.indexOf(&quot;flight&quot;) &gt; -1):\n            siteSection = 'Flight';\n            break;\n          case (lpurl.indexOf(&quot;city-breaks&quot;) &gt; -1):\n            siteSection = 'Cities';\n            break;\n          case (lpurl.indexOf(&quot;multi-centre&quot;) &gt; -1):\n            siteSection = 'Multi-Centre';\n            break;\n          case (lpurl.indexOf(&quot;lakes-and-mountains&quot;) &gt; -1):\n            siteSection = 'Lakes-and-Mountains';\n            break;\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account';\n            break;\n          case (lpurl.indexOf(&quot;my-thomson-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/hotels/&quot;) &gt; -1):\n            siteSection = 'Hotels'\n            break;\n            //Discover\n          case (lpurl.indexOf(&quot;discover&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;articles&quot;) &gt; -1):\n            siteSection = 'Discover';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;europe&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;asia&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;africa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;caribbean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;the-americas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;indian-ocean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;holiday-destinations&quot;) &gt; -1):\n            siteSection = 'Destinations';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensimar&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;small-and-friendly&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family-life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;robinson&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;villas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;gold&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;platinum&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;scene&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;a-la-carte&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;3t-favourites&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;skytours&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;simply&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;local-flavour&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;riu&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;tui-blue&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;magic-life&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;couples&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;weddings&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;nightlife&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;collection&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;spa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n            siteSection = 'Best-For';\n            break;\n            //Homepage\n          case (window.location.pathname.length == 1):\n          case (lpurl.substring(urlLength - 13, urlLength) == 'destinations/'):\n            siteSection = 'Homepage'\n            break;\n            //Other\n          case (pageName === &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n            break;\n        }\n        //TUI Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            destination = document.querySelector(&quot;#breadcrumbs&quot;).childNodes[3].text;\n            break;\n          case (siteSection == 'Destinations'):\n            if (pageType === &quot;COUNTRY&quot; || pageType === &quot;REGION&quot;) {\n              destination = pageHead.substring(0, pageHead.length - 10);\n            } else if (pageType === &quot;RESORT&quot; || pageType === &quot;DESTINATION&quot;) {\n              destination = pageTitle;\n            }\n            break;\n          default:\n            destination = 'null';\n        }\n      } else if (document.domain === 'www.firstchoice.co.uk') {\n        //FirstChoice SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account'\n            break;\n          case (lpurl.indexOf(&quot;my-first-choice-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/accommodation&quot;) &gt; -1):\n            siteSection = 'Hotels';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;location&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 12, urlLength) == 'destinations'):\n            siteSection = 'Destinations';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;Holiday-Village&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SplashWorld&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;Magic-Life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SuneoClub&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;premier-holidays&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 3, urlLength) == 'spa'):\n          case (lpurl.substring(urlLength - 9, urlLength) == 'holidays/'):\n            siteSection = 'Best-For';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Homepage\n          case (lpurl.substring(urlLength - 10, urlLength) == 'holiday/'):\n          case (window.location.pathname.length == 1):\n            siteSection = 'Homepage';\n            break;\n          case (pageName == &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n        }\n        //FirstChoice Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            var cutone = lpurl.substring(61, lpurl.length);\n            destination = cutone.substring(0, cutone.indexOf(&quot;/&quot;));\n            break;\n          case (siteSection == 'Destinations'):\n            destination = pageTitle;\n            break;\n          default:\n            destination = 'null';\n        }\n      }\n      //Output\n\n      //return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + encodeURIComponent(lpurl);\n\n      if (lpurl.indexOf(&quot;utm_medium=TDA&quot;) &gt; -1) {\n        return &quot;&quot;;\n      } else {\n        return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + lpurl;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;noOfRooms&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.numberOfRooms) {\n          return dataLayer[0].transactions.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.numberOfRooms) {\n          return dataLayer[0].basket.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.numberOfRooms) {\n          return dataLayer[0].product.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfRooms) {\n          return dataLayer[0].product.noOfRooms;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfAdults&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; jsonData.packageViewData.paxViewData.noOfAdults) {\n          return jsonData.packageViewData.paxViewData.noOfAdults;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults) {\n          return parseInt(tui.analytics.page.Adults);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.adults) {\n          return dataLayer[0].transactions.total.paxDetails.adults\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.adults) {\n          return dataLayer[0].basket.price.paxDetails.adults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfAdults) {\n          return dataLayer[0].product.noOfAdults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfAdults) {\n          return dataLayer[0].page.search.noOfAdults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfChildren&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfChildren) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfChildren &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfChildren;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Children) {\n          return parseInt(tui.analytics.page.Children);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.children\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.children;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfChildren &gt;= 0)) {\n          return dataLayer[0].product.noOfChildren;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfChildren &gt;= 0)) {\n          return dataLayer[0].page.search.noOfChildren;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfInfants&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfInfants) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfInfants &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfInfants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Infants) {\n          return parseInt(tui.analytics.page.Infants);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.infants\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.infants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfInfants &gt;= 0)) {\n          return dataLayer[0].product.noOfInfants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfInfants &gt;= 0)) {\n          return dataLayer[0].page.search.noOfInfants;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfPax&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n          return tui.analytics.page.Pax;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n          return dataLayer[0].transactions.total.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n          return dataLayer[0].basket.price.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n          return dataLayer[0].product.noOfPax.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n          return dataLayer[0].page.search.noOfPax.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfResults&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Results) {\n          return tui.analytics.page.Results;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfResults) {\n          return dataLayer[0].page.search.noOfResults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;onlineDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n          return tui.analytics.page.Disc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n          return Math.round(dataLayer[0].transactions.total.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n          return Math.round(dataLayer[0].basket.price.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n          return Math.round(dataLayer[0].product.discount).toString();\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n          return Math.round(jsonData.packageViewData.onlineDiscount).toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) {\n          return tui.analytics.page.pageUid;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) {\n          return dataLayer[0].page.pageID;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeCount&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          return '1';\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeFullyLoaded&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.loadEventEnd - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeInteractive&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.domInteractive - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageNameTemporary&quot;] = (function() {\n\n      try {\n\n        var path = document.location.href;\n        var pathArray = path.split('/');\n\n\n        if (document.location.hostname.indexOf('thomson.co.uk') != -1 || document.location.hostname.indexOf('thomsonprjuat.co.uk') != -1 || document.location.hostname.indexOf('tui.co.uk') != -1 || document.location.hostname.indexOf('tuiprjuat.co.uk') != -1) {\n          // TUI Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;tui:homepage&quot;;\n          }\n          // TUI Cruise\n          if (document.location.pathname.match(/^\\/$|^\\/cruise/) !== null) {\n            return &quot;tui:cruises&quot;;\n          }\n          // TUI Flights\n          if (document.location.pathname.match(/^\\/$|^\\/flight/) !== null) {\n            return &quot;tui:flights&quot;;\n          }\n          // TUI Deals\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals/) !== null) {\n            return &quot;tui:deals:&quot; + (pathArray[5]);\n          }\n          // CR Deals - this needs updating\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/info\\/summer-2016-cruises/) !== null) {\n            return &quot;tui:cruises:deals:&quot; + (pathArray[5]);\n          }\n          // Flight Deals\n          if (document.location.pathname.match(/^\\/$|^\\/flight\\/deals/) !== null) {\n            return &quot;tui:flights:deals&quot;;\n          }\n          // Deals Landing Page\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/holiday-destinations/) !== null) {\n            return &quot;tui:hol:destinations&quot;;\n          }\n          // TUI Country Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\/|^\\/destinations\\/africa\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]);\n          }\n          // TUI Region/Destination Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[6]);\n          }\n          // TUI Resort Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n          // TUI Hotel Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\/.*\\/.*/) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n        } else if (document.location.hostname.indexOf('firstchoice.co.uk') != -1 || document.location.hostname.indexOf('firstchoiceprjuat.co.uk') != -1) {\n          // FC Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fc:homepage&quot;;\n          }\n          // FC Deals\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/deals\\/|^\\/holiday\\/deals/) !== null) {\n            return &quot;fc:deals:&quot; + (pathArray[5]);\n          }\n          // FC Deals Landing\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/destinations/) !== null) {\n            return &quot;fc:hol:destinations&quot;;\n          }\n        } else if (document.location.hostname.indexOf('falconholidays.ie') != -1 || document.location.hostname.indexOf('falconholidaysprjuat.ie') != -1 || document.location.hostname.indexOf('tuiholidays.ie') != -1 || document.location.hostname.indexOf('tuiholidaysprjuat.ie') != -1) {\n          // TUI IE Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fal:homepage&quot;;\n          }\n          // TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/deals\\/|^\\/f\\/deals/) !== null) {\n            return &quot;fal:deals:&quot; + (pathArray[5]);\n          }\n          //TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/holiday-destinations/) !== null) {\n            return &quot;fal:hol:destinations&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pagePath&quot;] = (function() {\n      try {\n        if (window.location.pathname) {\n          var pagePath = window.location.pathname + window.location.search;\n          return pagePath;\n        } else {\n          return &quot;error&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageSubCategory&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.pageUid &amp;&amp; tui.analytics.pageUid == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else {\n          return dataLayer[0].page.pageSubCategory;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageURL&quot;] = (function() {\n      try {\n        var url = [location.protocol, '//', location.host, location.pathname].join('');\n        return url;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;paymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paymentType) {\n          return dataLayer[0].transactions.total.paymentType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;ppcVariant&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('ppcvariant') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;ppcvariant=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;preferredSearchAvailable&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isPreferredSearchAvailable) {\n          return dataLayer[0].page.search.isPreferredSearchAvailable;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;price&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          if (tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0) {\n            return (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) + parseFloat(tui.analytics.page.Sum)).toString();\n          } else {\n            return tui.analytics.page.Sum;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          if (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount + dataLayer[0].transactions.total.totalPrice).toString();\n          } else {\n            return dataLayer[0].transactions.total.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          if (dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].basket.items.bookingLevelCreditNoteDiscount + dataLayer[0].basket.price.totalPrice).toString();\n          } else {\n            return dataLayer[0].basket.price.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;priceVariationAlert&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n          var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n          var price = document.querySelectorAll('.alertprice');\n\n          if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n            return &quot;Price Increased|&quot; + price[0].innerText.replace(/[£€]/g, '');\n          } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n            return &quot;Price Decreased|&quot; + -price[0].innerText.replace(/[£€]/g, '');\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Analytics Experience&quot;] = (function() {\n      try {\n        var experience = Bootstrapper.gateway &amp;&amp; Bootstrapper.gateway.getCookie ? Bootstrapper.gateway.getCookie('Experience') : Bootstrapper.Cookies.get ? Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') : '';\n        switch (experience) {\n          case 'A':\n            return 'cookie consent - modal experience A';\n          case 'B':\n            return 'cookie consent - banner experience B';\n          case 'C':\n            return 'cookie consent - control experience C';\n          case 'Av2':\n            return 'cookie consent - modal experience A v2';\n          case 'Bv2':\n            return 'cookie consent - modal experience B v2';\n          case 'Cv2':\n            return 'cookie consent - modal experience C v2 - control';\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Experience&quot;] = (function() {\n      try {\n        return Bootstrapper.gateway ? Bootstrapper.gateway.getCookie('Experience') : undefined;\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories&quot;] = (function() {\n      try {\n        var types = Bootstrapper.gateway.getCookieTypes(),\n          cookiesNotSet = [],\n          returnVal = [];\n\n        for (var i = 0; i &lt; types.length; i++) {\n          var currentType = types[i];\n          if (Bootstrapper.gateway.getCookie(currentType) === '0') {\n            returnVal.push(currentType);\n          } else if (!Bootstrapper.gateway.getCookie(currentType)) {\n            cookiesNotSet.push(currentType);\n          }\n        }\n\n        if (cookiesNotSet.length === types.length) {\n          // cookies have not been set\n          return undefined;\n        } else if (returnVal.length === 0) {\n          return 'all categories accepted';\n        }\n        return returnVal.join(',').toLowerCase();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories Page Load&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') == 'C') {\n          return 'not applicable';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'personalisation,targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'all categories accepted';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'personalisation';\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SubProd) {\n          return tui.analytics.page.SubProd;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionCode) {\n          return dataLayer[0].transactions.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionCode) {\n          return dataLayer[0].basket.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionCode) {\n          return dataLayer[0].product.productCollectionCode;\n        }\n\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionName) {\n          return dataLayer[0].transactions.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionName) {\n          return dataLayer[0].basket.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionName) {\n          return dataLayer[0].product.productCollectionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productID&quot;] = (function() {\n      try {\n        // WhereTo for both regular holidays and cruises\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.productID) {\n            return dl.transactions.items.productID;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.productID) {\n            return dl.basket.items.productID;\n          } else if (dl.product &amp;&amp; dl.product.productID) {\n            return dl.product.productID;\n          } else if (dl.page.search &amp;&amp; dl.page.search.destinationId) {\n            return dataLayer[0].page.search.destinationId;\n          }\n\n\n\n\n        } else {\n          if (String(typeof tui.analytics.page.CRWhereTo) !== 'undefined') {\n            return tui.analytics.page.CRWhereTo;\n          } else if (String(typeof tui.analytics.page.WhereTo) !== 'undefined') {\n            return tui.analytics.page.WhereTo;\n          }\n        }\n        return 'none';\n      } catch (err) {\n        return 'none';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productTypeMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;#content &gt; div &gt; div.summary.review &gt; div.basket.payment-summary &gt; div &gt; div:nth-child(1) &gt; h3:nth-child(1) &gt; span&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeFreeAmends&quot;] = (function() {\n      try {\n        var freeDaysOriginal = '',\n          freeDaysLeft = '';\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysOriginal != undefined &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysLeft != undefined) {\n          if (dataLayer[0].user.currentBookings.freeAmendDaysOriginal == 0) {\n            freeDaysOriginal = 'Zero';\n          } else {\n            freeDaysOriginal = dataLayer[0].user.currentBookings.freeAmendDaysOriginal.toString();\n          }\n          if (dataLayer[0].user.currentBookings.freeAmendDaysLeft == 0) {\n            freeDaysLeft = 'Zero';\n          } else {\n            freeDaysLeft = dataLayer[0].user.currentBookings.freeAmendDaysLeft.toString();\n          }\n          return freeDaysOriginal + '|' + freeDaysLeft;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeIncentiveCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n\n          if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n              return dataLayer[0].transactions.total.bookingLevelPromoCode;\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n              return dataLayer[0].basket.price.bookingLevelPromoCode;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n              return tui.analytics.page.PromoCode;\n            }\n          }\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeMemoNotes&quot;] = (function() {\n      // Returns a comma separated list of memo notes from the memoNotes array\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.memoNotes) {\n          var results = [];\n          var memoArray = dataLayer[0].user.currentBookings.memoNotes;\n\n          for (i = 0; i &lt; memoArray.length; i++) {\n            results.push(memoArray[i].memoNoteCode);\n          }\n\n          if (results.length &gt; 0) {\n            return results.join(&quot;,&quot;)\n          } else {\n            return undefined;\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;promoCodeName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              return '';\n            } else {\n              return promoCodeArray[i].bookingLevelPromoCode;\n            }\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              return '';\n            } else {\n              return promoCodeArray[i].bookingLevelPromoCode;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            return '';\n          } else {\n            return tui.analytics.page.PromoCode;\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(tui.analytics.page.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return tui.analytics.page.bookingLevelPromoCode;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return dataLayer[0].transactions.total.bookingLevelPromoCode;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return dataLayer[0].basket.price.bookingLevelPromoCode;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;promoCodeValue&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              return '';\n            } else {\n              return promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n          var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n          for (i = 0; i &lt; promoCodeArray.length; i++) {\n            if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n              return '';\n            } else {\n              return promoCodeArray[i].bookingLevelPromoDiscount;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n            return '';\n          } else {\n            return tui.analytics.page.PromoValue;\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(tui.analytics.page.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return tui.analytics.page.bookingLevelPromoDiscount;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return dataLayer[0].transactions.total.bookingLevelPromoDiscount;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n          if (/CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n            return '';\n          } else {\n            return dataLayer[0].basket.price.bookingLevelPromoDiscount;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;protocol&quot;] = (function() {\n      try {\n        if (window.location &amp;&amp; window.location.protocol) {\n          return window.location.protocol;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;purchaseID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref &amp;&amp; tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react') {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pushData&quot;] = (function() {\n\n      function getParameterByName(name, url) {\n        if (!url) url = window.location.href;\n        name = name.replace(/[\\[\\]]/g, '\\\\$&amp;');\n        var regex = new RegExp('[?&amp;]' + name + '(=([^&amp;#]*)|&amp;|#|$)'),\n          results = regex.exec(url);\n        if (!results) return null;\n        if (!results[2]) return '';\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n      }\n\n      try {\n        var host = window.location.host,\n          imid = getParameterByName('im_id'),\n          ipid = getParameterByName('ip_id');\n\n        if (host &amp;&amp; ipid &amp;&amp; imid === 'Push') {\n          return host + '|' + 'PushNotification' + '.' + ipid + '.' + ipid + '.' + ipid\n        } else {\n          return ''\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryString&quot;] = (function() {\n      try {\n        return document.URL.split('?')[1];\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamCmid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cmid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  try {\n    b[&quot;queryStringParamGaid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ga_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n\n  try {\n    b[&quot;queryStringParamGclid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;gclid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIkid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ik_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIto&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ito=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamQ&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;q=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamVlid&quot;] = (function() {\n      try {\n        return Bootstrapper.getQueryParam('vlid') || Bootstrapper.getQueryParam('vlids') || Bootstrapper.getQueryParam('VLID');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionCode) {\n          return dataLayer[0].transactions.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionCode) {\n          return dataLayer[0].basket.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionCode) {\n          return dataLayer[0].product.geo.regionCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionName) {\n          return dataLayer[0].transactions.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionName) {\n          return dataLayer[0].basket.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionName) {\n          return dataLayer[0].product.geo.regionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortID) {\n          return dataLayer[0].transactions.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortID) {\n          return dataLayer[0].basket.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortID) {\n          return dataLayer[0].product.geo.resortID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortName) {\n          return dataLayer[0].transactions.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortName) {\n          return dataLayer[0].basket.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortName) {\n          return dataLayer[0].product.geo.resortName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName) {\n          return jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;retailVisitorIDValueChange&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RetVisID) {\n          return tui.analytics.page.RetVisID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;returnDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate &amp;&amp; tui.analytics.page.MonthYear) {\n          var date1 = tui.analytics.page.DepDate;\n          var month1 = tui.analytics.page.MonthYear.substring(0, 2);\n          var year1 = tui.analytics.page.MonthYear.substring(3, 7);\n          var duration = (window.location.href.indexOf('/cruise/book/') &gt; -1) ? tui.analytics.page.CRDur : tui.analytics.page.Dur;\n          var addition = parseInt(date1, 10) + parseInt(duration, 10);\n          var depDate = new Date(year1, month1, date1);\n          var outDate = new Date(depDate);\n          outDate.setDate(addition);\n          var date2 = String(outDate.getDate());\n          var date3;\n          var d = date2.length;\n          if (d == 2) {\n            date3 = date2;\n          }\n          if (d == 1) {\n            date3 = '0' + date2;\n          }\n          var month2 = String(outDate.getMonth());\n          var month3;\n          var m = month2.length;\n          if (m == 2) {\n            month3 = month2;\n          }\n          if (m == 1) {\n            month3 = '0' + month2;\n          }\n\n          var year2 = outDate.getFullYear();\n          var lastDate = year2 + '-' + month3 + '-' + date3;\n          return lastDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.returnDate) {\n          return dataLayer[0].transactions.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.returnDate) {\n          return dataLayer[0].basket.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.returnDate) {\n          return dataLayer[0].product.returnDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;revenueMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;.grand-total.align-right&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomAllocation&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmAlloc) {\n          return tui.analytics.page.RmAlloc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomComposition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults &amp;&amp; tui.analytics.page.Children &amp;&amp; tui.analytics.page.Infants) {\n          return tui.analytics.page.Adults + '/' + window.tui.analytics.page.Children + '/' + window.tui.analytics.page.Infants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Party) {\n          return tui.analytics.page.Party;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.roomComposition) {\n          return dataLayer[0].transactions.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.roomComposition) {\n          return dataLayer[0].basket.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.roomComposition) {\n          return dataLayer[0].product.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].roomComposition) {\n          return dataLayer[0].page.search.resultsList[0].roomComposition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomOrCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmSlt) {\n          return tui.analytics.page.RmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;screenSizeIncludingIPhones&quot;] = (function() {\n      try {\n        if (typeof screen.width === &quot;number&quot; &amp;&amp; typeof screen.height === &quot;number&quot;) {\n          return (screen.width + &quot;x&quot; + screen.height);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDepartureDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OrigDepDate) {\n          return tui.analytics.page.OrigDepDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationIDs&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationId) {\n          return dataLayer[0].page.search.searchedDestinationId;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationNames&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationName) {\n          return dataLayer[0].page.search.searchedDestinationName;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchResultsFinalPosition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FinPos) {\n          return tui.analytics.page.FinPos;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.finalPosition) {\n          return dataLayer[0].product.finalPosition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SearchType &amp;&amp; tui.analytics.page.SearchType != 'null') {\n          return tui.analytics.page.SearchType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchType) {\n          return dataLayer[0].page.search.searchType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;season&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          var season = '';\n          var d = tui.analytics.page.MonthYear.split('/');\n          var m = d[0];\n          var y = d[1].slice(-2);\n\n          if (m &gt;= 1 &amp;&amp; m &lt;= 4) {\n            season = 'W' + (y - 1);\n          } else if (m &gt;= 5 &amp;&amp; m &lt;= 10) {\n            season = 'S' + y;\n          } else if (m &gt;= 11) {\n            season = 'W' + y;\n          }\n          return season;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureSeason) {\n          return dataLayer[0].transactions.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureSeason) {\n          return dataLayer[0].basket.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureSeason) {\n          return dataLayer[0].product.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].departureSeason) {\n          return dataLayer[0].page.search.resultsList[0].departureSeason;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sellingCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.sellingCode) {\n          return String(dataLayer[0].transactions.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.sellingCode) {\n          return String(dataLayer[0].basket.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.sellingCode) {\n          return String(dataLayer[0].product.sellingCode);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.sessionID) {\n          return tui.analytics.sessionID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.sessionState) {\n          return tui.analytics.page.sessionState;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.sessionState) {\n          return dataLayer[0].page.sessionState;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;shortlist&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Shortlist) {\n          return tui.analytics.page.Shortlist;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSection&quot;] = (function() {\n      try {\n        // function for returning Site Section, used in Adobe Site Section (s.channel). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/04/19\n        var b = Bootstrapper.getQueryParam('b'),\n          host = location.host,\n          path = location.pathname;\n\n        if (~host.indexOf('thomson.co.uk') || ~host.indexOf('thomsonprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || (location.pathname.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) !== null) &amp;&amp; (location.pathname.match(/cruise(s?)/) === null)) {\n            return 'TH Beach';\n          } else if (~host.indexOf('flights.thomson.co.uk') || ~host.indexOf('flights.thomsonprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TH Flight-Only';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TH Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TH Accomm Only';\n          }\n        } else if (~host.indexOf('firstchoice.co.uk') || ~host.indexOf('firstchoiceprjuat.co.uk')) {\n          if (~b.indexOf('31000') || ~b.indexOf('10000') || ~b.indexOf('52000') || ~b.indexOf('20000') || ~b.indexOf('42000') || path.match(/^\\/$|^\\/holiday\\/?|^\\/holidays\\/?|^\\/sun-holidays\\/?|^\\/last-minute-holidays\\/?|^\\/destinations\\/?|^\\/departure-airports\\/?|^\\/last-minute-deals\\/?|^\\/2wentys|^\\/myholidayalerts/)) {\n            return 'FC Beach';\n          } else if (~b.indexOf('12000') || path.match(/^\\/$|^\\/hotels\\/|^\\/accom\\//)) {\n            return 'FC Accomm Only';\n          } else if (path === '/') {\n            return 'FC Beach';\n          }\n        } else if (~host.indexOf('falconholidays.ie') || ~host.indexOf('falconholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'Falcon';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'Falcon FO';\n          }\n        } else if (~host.indexOf('retailagents.tui.co.uk') || ~host.indexOf('retailagents.tuiprjuat.co.uk')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (~host.indexOf('retailagents.tuiholidays.ie') || ~host.indexOf('retailagents.tuiholidaysprjuat.ie')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        } else if (~host.indexOf('tui.co.uk') || ~host.indexOf('tuiprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || ~b.indexOf('51000') || path.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) &amp;&amp; !path.match(/cruise(s?)/)) {\n            return 'TUI UK Beach';\n          } else if (~host.indexOf('flights.tui.co.uk') || ~host.indexOf('flights.tuiprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || ~b.indexOf('59000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI UK Flight-Only';\n          } else if (~b.indexOf('58000') || path.match(/^\\/$|^\\/river-cruise(s?)\\/|^\\/river-cruise-deals\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TUI UK Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TUI UK Accomm Only';\n          }\n        }\n        if (~host.indexOf('tuiholidays.ie') || ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || ~b.indexOf('53000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'TUI IE Beach';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || ~b.indexOf('60000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI IE Flight-Only';\n          }\n        } else if (host.match(/(tuiretailhish\\-(live|st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (host.match(/(falconretailhish\\-(live|st.*|hyd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        }\n        return '';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSubSection&quot;] = (function() {\n      try {\n        // function for returning Site SubSection (evar1). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 24/10/17\n        var pageUid = '',\n          geoLevel = '',\n          host = location.host,\n          path = location.pathname;\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          pageUid = tui.analytics.page.pageUid || '';\n          geoLevel = tui.analytics.page.contextType || '';\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          pageUid = dataLayer[0].page.pageID || '';\n          geoLevel = dataLayer[0].page.pageCategory || '';\n        }\n\n        if (~host.indexOf('thomson.co.uk') ||\n          ~host.indexOf('thomsonprjuat.co.uk') ||\n          ~host.indexOf('flights.thomson.co.uk') ||\n          ~host.indexOf('flights.thomsonprjuat.co.uk') ||\n          ~host.indexOf('firstchoice.co.uk') ||\n          ~host.indexOf('firstchoiceprjuat.co.uk') ||\n          ~host.indexOf('falconholidays.ie') ||\n          ~host.indexOf('falconholidaysprjuat.ie') ||\n          ~host.indexOf('tui.co.uk') ||\n          ~host.indexOf('tuiprjuat.co.uk') ||\n          ~host.indexOf('flights.tui.co.uk') ||\n          ~host.indexOf('flights.tuiprjuat.co.uk') ||\n          ~host.indexOf('tuiholidays.ie') ||\n          ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (path === '/') {\n            return 'Home Page/Landing Page';\n          } else if (path.match(/^\\/$|^\\/blog|^\\/blog\\//)) {\n            return 'Blog';\n          } else if (path.match(/^\\/$|^\\/holidays\\/lakes-and-mountains|^\\/destinations\\/info\\/why-lakes-and-mountains|^\\/destinations\\/deals\\/italian-lakes-deals|^\\/destinations\\/deals\\/lakes-mountains-platinum|^\\/destinations\\/deals\\/austria-deals|^\\/destinations\\/deals\\/lake-garda-deals|^\\/destinations\\/deals\\/lakes-mountains-summer-holidays/)) {\n            return 'Lakes &amp; Mountains';\n          } else if ((pageUid === 'lastMinuteHolidayFinderPage') || (pageUid == 'page_00000IIZ') || path.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals|^\\/deals\\/summer-2016-cruises|^\\/holiday\\/deals\\/|^\\/holiday\\/deals|^\\/f\\/deals\\/|^\\/f\\/deals|^\\/flight\\/deals|^\\/flight\\/deals\\//)) {\n            return 'Deals';\n          } else if (path.match(/^\\/$|^\\/destinations\\/multi-centre\\/|^\\/holidays\\/multi-centre/)) {\n            return 'MultiCentres';\n          } else if (/^(ACCOMMODATION|RESORT|DESTINATION|REGION|COUNTRY|destinationlanding|ATTRACTION|ITINERARY|PORTS OF CALL|CRUISE REGION LANDING|CRUISE DESTINATION LANDING|SHIPS LANDING|SHIP|CRUISE &amp; STAY LANDING|cruise-calender|ONBOARD-EXPERIENCE|PORTS OF CALL LANDING)$/.test(geoLevel) || path.match(/^\\/$|^\\/thomson\\/en-GB\\/timetable\\/default|^\\/flight\\/arrivals-and-departures|^\\/destinations\\/product\\/|^\\/holidays\\/|^\\/holiday\\/product\\/|^\\/holiday\\/inventory\\/|^\\/holiday\\/collections\\/|^\\/f\\/products\\/|^\\/f\\/holidays\\/|^\\/sun-holidays\\/|^\\/destinations\\/viewAnonymousShortlist\\/|^\\/holiday\\/viewAnonymousShortlist\\/|^\\/en\\/destination\\/|^\\/flights\\//)) {\n            return 'Browse';\n          } else if ((pageUid === 'travel-information') || path.match(/^\\/$|^\\/holiday-extras.html|^\\/editorial\\/|^\\/gsa\\/|^\\/affiliates.html|^\\/information\\/|^\\/our-policies\\/|^\\/contact-us\\/|^\\/myapp\\/|^\\/destinations\\/shop-finder\\/|^\\/holiday\\/shop-finder\\/|^\\/holiday\\/faqCategories\\/|^\\/f\\/faqCategories\\/|^\\/f\\/travel-information\\/|^\\/all-inclusive-calculator\\/|^\\/about-us\\/|^\\/destinations\\/info\\/|^\\/destinations\\/faqCategories|^\\/myapp\\//)) {\n            return 'Editorial';\n          } else if (path.match(/^\\/$|^\\/destinations\\/book\\/|^\\/holiday\\/book\\/|^\\/f\\/book\\/|^\\/cruise\\/book\\/|^\\/flight\\/book\\/|^\\/cruise\\/bookitineraries\\/|^\\/cruise\\/packages\\/hotels|^\\/cruise\\/bookHotelDetails|^\\/destinations\\/bookaccommodation|^\\/holiday\\/bookaccommodation|^\\/cps\\/pageRender|^\\/f\\/bookaccommodation/)) {\n            return 'Bookflow';\n          } else if (path.match(/^\\/$|^\\/destinations\\/packages|^\\/holiday\\/packages|^\\/f\\/packages|^\\/cruise\\/packages|^\\/flight\\/search/)) {\n            return 'Search';\n          } else if (path.match(/^\\/$|^\\/destinations\\/manage\\/|^\\/t\\//)) {\n            return 'Customer Account';\n          } else if (path.match(/^\\/$|^\\/cruise|^\\/flight/)) {\n            return 'Home Page/Landing Page';\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgRef) {\n          return tui.analytics.page.SrcBkgRef;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.bookingReference) {\n          return dataLayer[0].user.currentBookings.bookingReference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingSystem&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgSys) {\n          return tui.analytics.page.SrcBkgSys;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - CD - BOARD&quot;] = (function() {\n      return tui.analytics.page.Board;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Affiliation&quot;] = (function() {\n      return &quot;CruiseDeals.co.uk&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - BrandName&quot;] = (function() {\n      return &quot;Marella Cruises&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Category&quot;] = (function() {\n      return &quot;Cruise&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRType&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CruiseId&quot;] = (function() {\n      //Ship name, destination(s), depDate and Duration\n      return tui.analytics.page.CRShip + '-' + tui.analytics.page.CRWhereTo + '-' + tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear + '-' + tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRWhereTo&quot;] = (function() {\n      return tui.analytics.page.CRWhereTo;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - DepartureDate&quot;] = (function() {\n      return tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Discount&quot;] = (function() {\n      return tui.analytics.page.Disc;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration - New&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - ShipName&quot;] = (function() {\n      return tui.analytics.page.CRShip;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Sum&quot;] = (function() {\n      return tui.analytics.page.Sum;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Variant&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPAnc) {\n          return tui.analytics.page.TPAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPB) {\n          return tui.analytics.page.TPB;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBedsSupplier&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPBSupp) {\n          return tui.analytics.page.TPBSupp;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyFlightDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPFU) {\n          return tui.analytics.page.TPFU;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;top5SearchResults&quot;] = (function() {\n      try {\n        var FBdata;\n        var arr = [];\n        var sr = jsonData.searchResult.holidays;\n\n        sr.forEach(function(e) {\n          FBData = e.itinerary.outbounds[0].departureAirportCode + '|' + e.accommodation.code;\n          arr.push(FBData);\n        });\n\n        return arr.slice(0, 5).join();\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tradingCycle&quot;] = (function() {\n      // Function for returning Trading Cycle, based on Days To Departure. The UK trading team uses Early and Late classification, so any bookings \n      // made within 84 days (12 weeks) to departure are defined as late and greater than 84 days to dept are early .\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          if (dataLayer[0].transactions.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].transactions.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          if (dataLayer[0].basket.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].basket.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          if (dataLayer[0].product.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].product.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (typeof tui != &quot;undefined&quot; &amp;&amp; typeof tui.analytics != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page.DepDate != &quot;undefined&quot;) {\n          // todays date\n          var date1 = new Date();\n          // dep  date\n          var depdate = ((typeof window.tui.analytics.page.MonthYear !== 'undefined') ? ((window.tui.analytics.page.DepDate || '') + '/' + window.tui.analytics.page.MonthYear) : '');\n          var splitDate = depdate.split('/');\n\n          day = splitDate[0];\n          daystring = day.toString();\n          month = splitDate[1];\n          monthstring = month.toString();\n          year = splitDate[2];\n          yearstring = year.toString();\n\n          var slash = &quot;/&quot;;\n\n          daterage = monthstring + slash + daystring + slash + yearstring;\n          date3 = new Date(daterage);\n\n          var timeDiff = Math.abs(date3.getTime() - date1.getTime());\n          var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));\n          var tradingCycle = '';\n          if (diffDays &lt;= 84) {\n            tradingCycle = &quot;late&quot;;\n          }\n          if (diffDays &gt; 84) {\n            tradingCycle = &quot;early&quot;;\n          }\n\n          return tradingCycle;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorEventID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; taeventid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; typeof dataLayer[0].transactions.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].transactions.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; typeof dataLayer[0].basket.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].basket.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; typeof dataLayer[0].product.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].product.tripAdvisorProductRating);\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARating &amp;&amp; typeof tui.analytics.page.TARating != 'undefined') {\n          return tui.analytics.page.TARating;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripType&quot;] = (function() {\n      try {\n        var url = location.href;\n\n        if (url.indexOf(&quot;flight/book&quot;) &gt; -1) {\n          return tui.analytics.page.FltType;\n        } else if (url.indexOf(&quot;cruise/book&quot;) &gt; -1) {\n          if (typeof(tui.analytics.page.CRType) == &quot;undefined&quot;) {\n            return &quot;null&quot;;\n          } else {\n            return tui.analytics.page.CRType;\n          }\n        } else {\n          return '';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;trv_reference&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; trv_reference=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tuiProductRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TUIRating) {\n          return tui.analytics.page.TUIRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.tuiProductRating) {\n          return dataLayer[0].product.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.tuiProductRating) {\n          return dataLayer[0].basket.items.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.tuiProductRating) {\n          return dataLayer[0].transactions.items.tuiProductRating;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPrice&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          return tui.analytics.page.Sum;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          return dataLayer[0].transactions.total.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          return dataLayer[0].basket.price.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPromoCodeName&quot;] = (function() {\n    try {\n        var strArray = [];\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode.length &gt; 0 &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n            strArray.push(tui.analytics.page.bookingLevelCreditNoteCode.split(':')[0]);\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; typeof(tui.analytics.page.IncentivePromoCode) != &quot;undefined&quot;){\n                strArray.push(tui.analytics.page.IncentivePromoCode); \n            } \n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0){\n                strArray.push(tui.analytics.page.PromoCode);\n            } \n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode.length &gt; 0) {\n            if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n\t\t        for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t        strArray.push(promoCodeArray[i].bookingLevelPromoCode);\n\t\t\t    }\n\t        } else {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n            }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0) {\n            strArray.push(tui.analytics.page.PromoCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCode);\n        } else if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode);\n        } else {\n\t\t    return '';\n\t    }\n\t    return strArray.join(&quot;|&quot;);\n    } catch (err) {\n        return &quot;&quot;;\n    }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {}\n  }\n\n  try {\n    b[&quot;userAgent&quot;] = (function() {\n      try {\n        return navigator.userAgent\n      } catch (e) {\n        return 'error'\n      }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {\n      utag.DB(e)\n    } else {}\n  }\n\n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}","name":"qa"},"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"promotedBy":"gabriele.giucca@tui.co.uk","promotedDraftName":"legacy prefixes","promotedTimestamp":"202101181719","name":"dev","code":"// enables console testing (but still works in Tealium iQ)\nvar b = b || (utag &amp;&amp; utag.data) || {}\n\nvar legacyPrefix = 'legacy_'\n\n// spoof some Ensighten functionality\nvar Bootstrapper = {}\nBootstrapper.ensightenOptions = {}\nBootstrapper.ensightenOptions.publishPath = b.tealium_environment === 'prod' ? 'hybrisprod' : 'hybrisdev';\n\nBootstrapper.getQueryParam = function (qp_name) {\n  var b = b || {}\n  return b['qp.' + qp_name] || &quot;&quot;\n}\n\n/*\n// there were only three instances of this being called and the timing was tricky, so I modified the below code a touch\nBootstrapper.data = {}\nBootstrapper.data.resolve = function (name) {\n  name = getCleanLegacyNameForLookup(name)\n  console.log('RESOLVING ' + name + ' to ' + b[name] )\n  return b[name]\n}\n*/\n\nfunction getCleanLegacyNameForLookup (longEnsightenName) {\n  var arr = longEnsightenName.split('.')\n  var lastString = arr[arr.length - 1]\n  var cleanWithLegacyPrefix = legacyPrefix + getSanitizedVariableName(lastString)\n  return cleanWithLegacyPrefix\n}\n\nBootstrapper.Cookies = {}\nBootstrapper.Cookies.get = function (cookieName) {\n  var b = b || {}\n  return b['cp.' + cookieName]\n}\n\n// make sure this object is defined to avoid errors\nwindow.tui = window.tui || {}\nwindow.tui.page = window.tui.page || {}\nwindow.tui.page.analytics = window.tui.page.analytics || {}\n\n// add the legacy ensighten variables\nb = addEnsightenVariables(b)\n\nfunction getSanitizedVariableName (oldName) {\n  // sanitation regex, only allow letters, numbers, underscores, dollar signs,\n  // array brackets, periods (same as TiQ Data Layer interface), remove others\n  var blacklist = /[^0-9A-Z_$\\[\\]\\.]/gi;\n  var spacesAndHyphens = /[\\s-]+/g;\n  // replace groups of spaces and hyphens with underscores\n  newName = oldName.replace(spacesAndHyphens, '_');\n  // sanitize name\n  newName = newName.replace(blacklist, '');\n  return newName\n}\n\nfunction sanitizeAllVariableNames (b) {\n  // Sanitize attribute names to remove any characters that \n  // Tealium doesn't allow (full list in comments):\n  //    - first replace any groups of spaces/hyphens with a single underscore\n  //    - then remove disallowed characters (no replacement character)\n\n\n  // fallback in case scope is changed and to allow console-based testing\n  b = b || {}\n\n  // get the list of attributes\n  var attributes = Object.keys(b);\n\n  // initialize loop vars\n  var i, len, oldName, newName;\n\n  // get the value for each of the keys and add it to b if non-empty\n  for (i = 0, len = attributes.length; i &lt; len; i++) {\n    oldName = attributes[i];\n    newName = getSanitizedVariableName(oldName)\n    if (oldName !== newName) {\n      // copy value\n      b[newName] = b[oldName];\n      // remove old key\n      delete b[oldName];\n    }\n  }\n  return b\n}\n\nfunction logError (e) {\n  console.log(&quot;UDO population function error: &quot; + e)\n}\n\nfunction addEnsightenVariables (b) {\n  b = b || {}\n  b = addUnconditionalEnsightenVariables(b)\n  b = addConditionalEnsightenVariables(b)\n  b = sanitizeAllVariableNames(b)\n  return b\n}\n\nfunction addConditionalEnsightenVariables (originalB) {\n  // a little confusing, but this is the 'new' b and the standard one is called originalB in this function\n  var b = {}\n  // a map of relevant Ensightten condition IDs to Load Rule UIDs\n  var conditionMap = {\n    &quot;205270&quot;: &quot;893&quot;,\n    &quot;205366&quot;: &quot;892&quot;,\n    &quot;205384&quot;: &quot;891&quot;,\n    &quot;205444&quot;: &quot;890&quot;,\n    &quot;231659&quot;: &quot;889&quot;,\n    &quot;275650&quot;: &quot;888&quot;,\n    &quot;292050&quot;: &quot;887&quot;,\n    &quot;306764&quot;: &quot;886&quot;,\n    &quot;317190&quot;: &quot;885&quot;,\n    &quot;318035&quot;: &quot;884&quot;,\n    &quot;319261&quot;: &quot;883&quot;,\n    &quot;321929&quot;: &quot;882&quot;,\n    &quot;321966&quot;: &quot;881&quot;,\n    &quot;322010&quot;: &quot;880&quot;,\n    &quot;323412&quot;: &quot;879&quot;,\n    &quot;326082&quot;: &quot;878&quot;,\n    &quot;330432&quot;: &quot;877&quot;,\n    &quot;334450&quot;: &quot;876&quot;,\n    &quot;338073&quot;: &quot;875&quot;,\n    &quot;338075&quot;: &quot;874&quot;,\n    &quot;342693&quot;: &quot;873&quot;,\n    &quot;356822&quot;: &quot;872&quot;,\n    &quot;381988&quot;: &quot;871&quot;,\n    &quot;381989&quot;: &quot;870&quot;,\n    &quot;381990&quot;: &quot;869&quot;,\n    &quot;381991&quot;: &quot;868&quot;,\n    &quot;386001&quot;: &quot;867&quot;,\n    &quot;386052&quot;: &quot;866&quot;,\n    &quot;386059&quot;: &quot;865&quot;,\n    &quot;386105&quot;: &quot;864&quot;,\n    &quot;386268&quot;: &quot;863&quot;,\n    &quot;386269&quot;: &quot;862&quot;,\n    &quot;386721&quot;: &quot;861&quot;,\n    &quot;392738&quot;: &quot;860&quot;,\n    &quot;392739&quot;: &quot;859&quot;,\n    &quot;392856&quot;: &quot;858&quot;,\n    &quot;393317&quot;: &quot;857&quot;,\n    &quot;398051&quot;: &quot;856&quot;,\n    &quot;413257&quot;: &quot;855&quot;,\n    &quot;413766&quot;: &quot;854&quot;,\n    &quot;415650&quot;: &quot;853&quot;,\n    &quot;416216&quot;: &quot;852&quot;,\n    &quot;420785&quot;: &quot;851&quot;,\n    &quot;420787&quot;: &quot;850&quot;,\n    &quot;421343&quot;: &quot;849&quot;,\n    &quot;423206&quot;: &quot;848&quot;,\n    &quot;441328&quot;: &quot;847&quot;,\n    &quot;455789&quot;: &quot;846&quot;,\n    &quot;461304&quot;: &quot;845&quot;,\n    &quot;461309&quot;: &quot;844&quot;,\n    &quot;463175&quot;: &quot;843&quot;,\n    &quot;470245&quot;: &quot;842&quot;,\n    &quot;470253&quot;: &quot;841&quot;,\n    &quot;470312&quot;: &quot;840&quot;,\n    &quot;470318&quot;: &quot;839&quot;,\n    &quot;473997&quot;: &quot;838&quot;,\n    &quot;476525&quot;: &quot;837&quot;,\n    &quot;476526&quot;: &quot;836&quot;,\n    &quot;476527&quot;: &quot;835&quot;,\n    &quot;476528&quot;: &quot;834&quot;,\n    &quot;480498&quot;: &quot;833&quot;,\n    &quot;480964&quot;: &quot;832&quot;,\n    &quot;481202&quot;: &quot;831&quot;,\n    &quot;483445&quot;: &quot;830&quot;,\n    &quot;491253&quot;: &quot;829&quot;,\n    &quot;493179&quot;: &quot;828&quot;,\n    &quot;493721&quot;: &quot;827&quot;,\n    &quot;496357&quot;: &quot;826&quot;,\n    &quot;501484&quot;: &quot;825&quot;,\n    &quot;501601&quot;: &quot;824&quot;,\n    &quot;510366&quot;: &quot;823&quot;,\n    &quot;513827&quot;: &quot;822&quot;,\n    &quot;635858&quot;: &quot;821&quot;,\n    &quot;635859&quot;: &quot;820&quot;,\n    &quot;635860&quot;: &quot;819&quot;,\n    &quot;635861&quot;: &quot;818&quot;,\n    &quot;635862&quot;: &quot;817&quot;,\n    &quot;635863&quot;: &quot;816&quot;,\n    &quot;636023&quot;: &quot;815&quot;,\n    &quot;636029&quot;: &quot;814&quot;,\n    &quot;636046&quot;: &quot;813&quot;,\n    &quot;648421&quot;: &quot;812&quot;,\n    &quot;649595&quot;: &quot;811&quot;,\n    &quot;649596&quot;: &quot;810&quot;,\n    &quot;649969&quot;: &quot;809&quot;,\n    &quot;650179&quot;: &quot;808&quot;,\n    &quot;650416&quot;: &quot;807&quot;,\n    &quot;650480&quot;: &quot;806&quot;,\n    &quot;650484&quot;: &quot;805&quot;,\n    &quot;650680&quot;: &quot;804&quot;,\n    &quot;650692&quot;: &quot;803&quot;,\n    &quot;650702&quot;: &quot;802&quot;,\n    &quot;650703&quot;: &quot;801&quot;,\n    &quot;650766&quot;: &quot;800&quot;,\n    &quot;650778&quot;: &quot;799&quot;,\n    &quot;650782&quot;: &quot;798&quot;,\n    &quot;650787&quot;: &quot;797&quot;,\n    &quot;650789&quot;: &quot;796&quot;,\n    &quot;650792&quot;: &quot;795&quot;,\n    &quot;651200&quot;: &quot;794&quot;,\n    &quot;653983&quot;: &quot;793&quot;,\n    &quot;664297&quot;: &quot;792&quot;,\n    &quot;664415&quot;: &quot;791&quot;,\n    &quot;664554&quot;: &quot;790&quot;,\n    &quot;664567&quot;: &quot;789&quot;,\n    &quot;664568&quot;: &quot;788&quot;,\n    &quot;664569&quot;: &quot;787&quot;,\n    &quot;664582&quot;: &quot;786&quot;,\n    &quot;664583&quot;: &quot;785&quot;,\n    &quot;664585&quot;: &quot;784&quot;,\n    &quot;664594&quot;: &quot;783&quot;,\n    &quot;664595&quot;: &quot;782&quot;,\n    &quot;664597&quot;: &quot;781&quot;,\n    &quot;664598&quot;: &quot;780&quot;,\n    &quot;664604&quot;: &quot;779&quot;,\n    &quot;664609&quot;: &quot;778&quot;,\n    &quot;664610&quot;: &quot;777&quot;,\n    &quot;664611&quot;: &quot;776&quot;,\n    &quot;664619&quot;: &quot;775&quot;,\n    &quot;664620&quot;: &quot;774&quot;,\n    &quot;664621&quot;: &quot;773&quot;,\n    &quot;664623&quot;: &quot;772&quot;,\n    &quot;664624&quot;: &quot;771&quot;,\n    &quot;664631&quot;: &quot;770&quot;,\n    &quot;671183&quot;: &quot;769&quot;,\n    &quot;671185&quot;: &quot;768&quot;,\n    &quot;671190&quot;: &quot;767&quot;,\n    &quot;671227&quot;: &quot;766&quot;,\n    &quot;671238&quot;: &quot;765&quot;,\n    &quot;671240&quot;: &quot;764&quot;,\n    &quot;671252&quot;: &quot;763&quot;,\n    &quot;671355&quot;: &quot;762&quot;,\n    &quot;682688&quot;: &quot;761&quot;,\n    &quot;686121&quot;: &quot;760&quot;,\n    &quot;686122&quot;: &quot;759&quot;,\n    &quot;686123&quot;: &quot;758&quot;,\n    &quot;686171&quot;: &quot;757&quot;,\n    &quot;686172&quot;: &quot;756&quot;,\n    &quot;686176&quot;: &quot;755&quot;,\n    &quot;686177&quot;: &quot;754&quot;,\n    &quot;686178&quot;: &quot;753&quot;,\n    &quot;686222&quot;: &quot;752&quot;,\n    &quot;686224&quot;: &quot;751&quot;,\n    &quot;686225&quot;: &quot;750&quot;,\n    &quot;686278&quot;: &quot;749&quot;,\n    &quot;696836&quot;: &quot;748&quot;,\n    &quot;696873&quot;: &quot;747&quot;,\n    &quot;696915&quot;: &quot;746&quot;,\n    &quot;698739&quot;: &quot;745&quot;,\n    &quot;698824&quot;: &quot;744&quot;,\n    &quot;701720&quot;: &quot;743&quot;,\n    &quot;701770&quot;: &quot;742&quot;,\n    &quot;701995&quot;: &quot;741&quot;,\n    &quot;702164&quot;: &quot;740&quot;,\n    &quot;717653&quot;: &quot;739&quot;,\n    &quot;717654&quot;: &quot;738&quot;,\n    &quot;717953&quot;: &quot;737&quot;,\n    &quot;717954&quot;: &quot;736&quot;,\n    &quot;718305&quot;: &quot;735&quot;,\n    &quot;718376&quot;: &quot;734&quot;,\n    &quot;758676&quot;: &quot;733&quot;,\n    &quot;763283&quot;: &quot;732&quot;,\n    &quot;767006&quot;: &quot;731&quot;,\n    &quot;794187&quot;: &quot;730&quot;,\n    &quot;821088&quot;: &quot;729&quot;,\n    &quot;835611&quot;: &quot;728&quot;,\n    &quot;836311&quot;: &quot;727&quot;,\n    &quot;840126&quot;: &quot;726&quot;,\n    &quot;840127&quot;: &quot;725&quot;,\n    &quot;840747&quot;: &quot;724&quot;,\n    &quot;840748&quot;: &quot;723&quot;,\n    &quot;840749&quot;: &quot;722&quot;,\n    &quot;853791&quot;: &quot;721&quot;,\n    &quot;853792&quot;: &quot;720&quot;,\n    &quot;882958&quot;: &quot;719&quot;,\n    &quot;887343&quot;: &quot;718&quot;,\n    &quot;899054&quot;: &quot;717&quot;,\n    &quot;899844&quot;: &quot;716&quot;,\n    &quot;901069&quot;: &quot;715&quot;,\n    &quot;901080&quot;: &quot;714&quot;,\n    &quot;901330&quot;: &quot;713&quot;,\n    &quot;901338&quot;: &quot;712&quot;,\n    &quot;901352&quot;: &quot;711&quot;,\n    &quot;962796&quot;: &quot;710&quot;,\n    &quot;1042978&quot;: &quot;709&quot;,\n    &quot;1043130&quot;: &quot;708&quot;,\n    &quot;1081657&quot;: &quot;707&quot;,\n    &quot;1081697&quot;: &quot;706&quot;,\n    &quot;1187972&quot;: &quot;705&quot;,\n    &quot;1187977&quot;: &quot;704&quot;,\n    &quot;1187985&quot;: &quot;703&quot;,\n    &quot;1187989&quot;: &quot;702&quot;,\n    &quot;1187995&quot;: &quot;701&quot;,\n    &quot;1188366&quot;: &quot;700&quot;,\n    &quot;1207206&quot;: &quot;699&quot;,\n    &quot;1207254&quot;: &quot;698&quot;,\n    &quot;1210674&quot;: &quot;697&quot;,\n    &quot;1211596&quot;: &quot;696&quot;,\n    &quot;1211720&quot;: &quot;695&quot;,\n    &quot;1211741&quot;: &quot;694&quot;,\n    &quot;1211742&quot;: &quot;693&quot;,\n    &quot;1211743&quot;: &quot;692&quot;,\n    &quot;1216621&quot;: &quot;691&quot;,\n    &quot;1217836&quot;: &quot;690&quot;,\n    &quot;1217852&quot;: &quot;689&quot;,\n    &quot;1218080&quot;: &quot;688&quot;,\n    &quot;1218101&quot;: &quot;687&quot;,\n    &quot;1219690&quot;: &quot;686&quot;,\n    &quot;1249258&quot;: &quot;685&quot;,\n    &quot;1417083&quot;: &quot;684&quot;,\n    &quot;1417130&quot;: &quot;683&quot;,\n    &quot;1495684&quot;: &quot;682&quot;,\n    &quot;1512996&quot;: &quot;681&quot;,\n    &quot;1512997&quot;: &quot;680&quot;,\n    &quot;1513092&quot;: &quot;679&quot;,\n    &quot;1513465&quot;: &quot;678&quot;,\n    &quot;1513466&quot;: &quot;677&quot;,\n    &quot;1514697&quot;: &quot;676&quot;,\n    &quot;1514864&quot;: &quot;675&quot;,\n    &quot;1514958&quot;: &quot;674&quot;,\n    &quot;1515424&quot;: &quot;673&quot;,\n    &quot;1531045&quot;: &quot;672&quot;,\n    &quot;1531096&quot;: &quot;671&quot;,\n    &quot;1531141&quot;: &quot;670&quot;,\n    &quot;1531422&quot;: &quot;669&quot;,\n    &quot;1532177&quot;: &quot;668&quot;,\n    &quot;1668141&quot;: &quot;667&quot;,\n    &quot;1769738&quot;: &quot;666&quot;,\n    &quot;1778256&quot;: &quot;665&quot;,\n    &quot;2081444&quot;: &quot;664&quot;,\n    &quot;2081446&quot;: &quot;663&quot;,\n    &quot;2082484&quot;: &quot;662&quot;,\n    &quot;2279242&quot;: &quot;661&quot;,\n    &quot;2279323&quot;: &quot;660&quot;,\n    &quot;2503734&quot;: &quot;659&quot;,\n    &quot;2503735&quot;: &quot;658&quot;,\n    &quot;2503818&quot;: &quot;657&quot;,\n    &quot;2518567&quot;: &quot;656&quot;,\n    &quot;2518982&quot;: &quot;655&quot;,\n    &quot;2662663&quot;: &quot;654&quot;,\n    &quot;2662758&quot;: &quot;653&quot;,\n    &quot;2664033&quot;: &quot;652&quot;,\n    &quot;2664082&quot;: &quot;651&quot;,\n    &quot;2665581&quot;: &quot;650&quot;,\n    &quot;2665582&quot;: &quot;649&quot;,\n    &quot;2708240&quot;: &quot;648&quot;,\n    &quot;2712769&quot;: &quot;647&quot;,\n    &quot;2712827&quot;: &quot;646&quot;,\n    &quot;2733381&quot;: &quot;645&quot;,\n    &quot;2733382&quot;: &quot;644&quot;,\n    &quot;2910769&quot;: &quot;643&quot;,\n    &quot;2917920&quot;: &quot;642&quot;,\n    &quot;3565541&quot;: &quot;641&quot;,\n    &quot;3584019&quot;: &quot;640&quot;,\n    &quot;3600994&quot;: &quot;639&quot;,\n    &quot;3834892&quot;: &quot;638&quot;,\n    &quot;4143702&quot;: &quot;637&quot;,\n    &quot;4151405&quot;: &quot;636&quot;,\n    &quot;4151407&quot;: &quot;635&quot;,\n    &quot;4151409&quot;: &quot;634&quot;,\n    &quot;4190389&quot;: &quot;633&quot;,\n    &quot;4821493&quot;: &quot;632&quot;,\n    &quot;4821495&quot;: &quot;631&quot;,\n    &quot;4821610&quot;: &quot;630&quot;,\n    &quot;4821659&quot;: &quot;629&quot;,\n    &quot;4821660&quot;: &quot;628&quot;,\n    &quot;4821661&quot;: &quot;627&quot;,\n    &quot;4821662&quot;: &quot;626&quot;,\n    &quot;4823353&quot;: &quot;625&quot;,\n    &quot;4823354&quot;: &quot;624&quot;,\n    &quot;4823597&quot;: &quot;623&quot;,\n    &quot;4823969&quot;: &quot;622&quot;,\n    &quot;4823970&quot;: &quot;621&quot;,\n    &quot;4824954&quot;: &quot;620&quot;,\n    &quot;4824955&quot;: &quot;619&quot;,\n    &quot;4825150&quot;: &quot;618&quot;,\n    &quot;4825427&quot;: &quot;617&quot;,\n    &quot;4825428&quot;: &quot;616&quot;,\n    &quot;4825462&quot;: &quot;615&quot;,\n    &quot;4825463&quot;: &quot;614&quot;,\n    &quot;4825556&quot;: &quot;613&quot;,\n    &quot;4825566&quot;: &quot;612&quot;,\n    &quot;4825579&quot;: &quot;611&quot;,\n    &quot;4825887&quot;: &quot;610&quot;,\n    &quot;4828711&quot;: &quot;609&quot;,\n    &quot;4828847&quot;: &quot;608&quot;,\n    &quot;4829563&quot;: &quot;607&quot;,\n    &quot;4834079&quot;: &quot;606&quot;,\n    &quot;4834101&quot;: &quot;605&quot;,\n    &quot;4834967&quot;: &quot;604&quot;,\n    &quot;4834971&quot;: &quot;603&quot;,\n    &quot;4835548&quot;: &quot;602&quot;,\n    &quot;4835555&quot;: &quot;601&quot;,\n    &quot;4836637&quot;: &quot;600&quot;,\n    &quot;4836638&quot;: &quot;599&quot;,\n    &quot;4836899&quot;: &quot;598&quot;,\n    &quot;4836986&quot;: &quot;597&quot;,\n    &quot;4836987&quot;: &quot;596&quot;,\n    &quot;4836995&quot;: &quot;595&quot;,\n    &quot;4837297&quot;: &quot;594&quot;,\n    &quot;4837976&quot;: &quot;593&quot;,\n    &quot;4837985&quot;: &quot;592&quot;,\n    &quot;4837986&quot;: &quot;591&quot;,\n    &quot;4837987&quot;: &quot;590&quot;,\n    &quot;4837989&quot;: &quot;589&quot;,\n    &quot;4838170&quot;: &quot;588&quot;,\n    &quot;4838540&quot;: &quot;587&quot;,\n    &quot;4838547&quot;: &quot;586&quot;,\n    &quot;4838593&quot;: &quot;585&quot;,\n    &quot;4840815&quot;: &quot;584&quot;,\n    &quot;4841313&quot;: &quot;583&quot;,\n    &quot;4841758&quot;: &quot;582&quot;,\n    &quot;4842201&quot;: &quot;581&quot;,\n    &quot;4843069&quot;: &quot;580&quot;,\n    &quot;4843070&quot;: &quot;579&quot;,\n    &quot;4843071&quot;: &quot;578&quot;,\n    &quot;4844445&quot;: &quot;577&quot;,\n    &quot;4844447&quot;: &quot;576&quot;,\n    &quot;4844577&quot;: &quot;575&quot;,\n    &quot;4844916&quot;: &quot;574&quot;,\n    &quot;4845253&quot;: &quot;573&quot;,\n    &quot;4845255&quot;: &quot;572&quot;,\n    &quot;4845258&quot;: &quot;571&quot;,\n    &quot;4845356&quot;: &quot;570&quot;,\n    &quot;4845366&quot;: &quot;569&quot;,\n    &quot;4845617&quot;: &quot;568&quot;,\n    &quot;4847129&quot;: &quot;567&quot;,\n    &quot;4847477&quot;: &quot;566&quot;,\n    &quot;4847478&quot;: &quot;565&quot;,\n    &quot;4848441&quot;: &quot;564&quot;,\n    &quot;4848815&quot;: &quot;563&quot;,\n    &quot;4851962&quot;: &quot;562&quot;,\n    &quot;4851964&quot;: &quot;561&quot;,\n    &quot;4852083&quot;: &quot;560&quot;,\n    &quot;4852084&quot;: &quot;559&quot;,\n    &quot;4852282&quot;: &quot;558&quot;,\n    &quot;4852283&quot;: &quot;557&quot;,\n    &quot;4852362&quot;: &quot;556&quot;,\n    &quot;4852363&quot;: &quot;555&quot;,\n    &quot;4852658&quot;: &quot;554&quot;,\n    &quot;4852659&quot;: &quot;553&quot;,\n    &quot;4852660&quot;: &quot;552&quot;,\n    &quot;4853590&quot;: &quot;551&quot;,\n    &quot;4854987&quot;: &quot;550&quot;,\n    &quot;4857995&quot;: &quot;549&quot;,\n    &quot;4858047&quot;: &quot;548&quot;,\n    &quot;4858048&quot;: &quot;547&quot;,\n    &quot;4858051&quot;: &quot;546&quot;,\n    &quot;4858052&quot;: &quot;545&quot;,\n    &quot;4859198&quot;: &quot;544&quot;,\n    &quot;4859386&quot;: &quot;543&quot;,\n    &quot;4860037&quot;: &quot;542&quot;,\n    &quot;4860043&quot;: &quot;541&quot;,\n    &quot;4860384&quot;: &quot;540&quot;,\n    &quot;4860389&quot;: &quot;539&quot;,\n    &quot;4860392&quot;: &quot;538&quot;,\n    &quot;4860393&quot;: &quot;537&quot;,\n    &quot;4860396&quot;: &quot;536&quot;,\n    &quot;4860489&quot;: &quot;535&quot;,\n    &quot;4860666&quot;: &quot;534&quot;,\n    &quot;4861558&quot;: &quot;533&quot;,\n    &quot;4861560&quot;: &quot;532&quot;,\n    &quot;4861724&quot;: &quot;531&quot;,\n    &quot;4861979&quot;: &quot;530&quot;,\n    &quot;4862577&quot;: &quot;529&quot;,\n    &quot;4862583&quot;: &quot;528&quot;,\n    &quot;4862586&quot;: &quot;527&quot;,\n    &quot;4862928&quot;: &quot;526&quot;,\n    &quot;4863228&quot;: &quot;525&quot;,\n    &quot;4863575&quot;: &quot;524&quot;,\n    &quot;4863765&quot;: &quot;523&quot;,\n    &quot;4863775&quot;: &quot;522&quot;,\n    &quot;4863805&quot;: &quot;521&quot;,\n    &quot;4863806&quot;: &quot;520&quot;,\n    &quot;4863807&quot;: &quot;519&quot;,\n    &quot;4863888&quot;: &quot;518&quot;,\n    &quot;4863889&quot;: &quot;517&quot;,\n    &quot;4864153&quot;: &quot;516&quot;,\n    &quot;4864565&quot;: &quot;515&quot;,\n    &quot;4865543&quot;: &quot;514&quot;,\n    &quot;4868062&quot;: &quot;513&quot;,\n    &quot;4868261&quot;: &quot;512&quot;,\n    &quot;4868262&quot;: &quot;511&quot;,\n    &quot;4868283&quot;: &quot;510&quot;,\n    &quot;4868358&quot;: &quot;509&quot;,\n    &quot;4868359&quot;: &quot;508&quot;,\n    &quot;4868360&quot;: &quot;507&quot;,\n    &quot;4868361&quot;: &quot;506&quot;,\n    &quot;4868362&quot;: &quot;505&quot;,\n    &quot;4868392&quot;: &quot;504&quot;,\n    &quot;4868449&quot;: &quot;503&quot;,\n    &quot;4868450&quot;: &quot;502&quot;,\n    &quot;4868451&quot;: &quot;501&quot;,\n    &quot;4868452&quot;: &quot;500&quot;,\n    &quot;4868453&quot;: &quot;499&quot;,\n    &quot;4868454&quot;: &quot;498&quot;,\n    &quot;4868455&quot;: &quot;497&quot;,\n    &quot;4868457&quot;: &quot;496&quot;,\n    &quot;4868458&quot;: &quot;495&quot;,\n    &quot;4869584&quot;: &quot;494&quot;,\n    &quot;4869945&quot;: &quot;493&quot;,\n    &quot;4869951&quot;: &quot;492&quot;,\n    &quot;4869954&quot;: &quot;491&quot;,\n    &quot;4870035&quot;: &quot;490&quot;,\n    &quot;4870036&quot;: &quot;489&quot;,\n    &quot;4870216&quot;: &quot;488&quot;,\n    &quot;4870973&quot;: &quot;487&quot;,\n    &quot;4871232&quot;: &quot;486&quot;,\n    &quot;4871233&quot;: &quot;485&quot;,\n    &quot;4871234&quot;: &quot;484&quot;,\n    &quot;4871236&quot;: &quot;483&quot;,\n    &quot;4871237&quot;: &quot;482&quot;,\n    &quot;4871243&quot;: &quot;481&quot;,\n    &quot;4871370&quot;: &quot;480&quot;,\n    &quot;4871371&quot;: &quot;479&quot;,\n    &quot;4871372&quot;: &quot;478&quot;,\n    &quot;4872478&quot;: &quot;477&quot;,\n    &quot;4872479&quot;: &quot;476&quot;,\n    &quot;4873112&quot;: &quot;475&quot;,\n    &quot;4873113&quot;: &quot;474&quot;,\n    &quot;4873115&quot;: &quot;473&quot;,\n    &quot;4873116&quot;: &quot;472&quot;,\n    &quot;4873541&quot;: &quot;471&quot;,\n    &quot;4873810&quot;: &quot;470&quot;,\n    &quot;4874021&quot;: &quot;469&quot;,\n    &quot;4874022&quot;: &quot;468&quot;,\n    &quot;4874023&quot;: &quot;467&quot;,\n    &quot;4874054&quot;: &quot;466&quot;,\n    &quot;4874525&quot;: &quot;465&quot;,\n    &quot;4874978&quot;: &quot;464&quot;,\n    &quot;4878074&quot;: &quot;463&quot;,\n    &quot;4878311&quot;: &quot;462&quot;,\n    &quot;4878451&quot;: &quot;461&quot;,\n    &quot;4878452&quot;: &quot;460&quot;,\n    &quot;4878453&quot;: &quot;459&quot;,\n    &quot;4878454&quot;: &quot;458&quot;,\n    &quot;4878457&quot;: &quot;457&quot;,\n    &quot;4878459&quot;: &quot;456&quot;,\n    &quot;4878460&quot;: &quot;455&quot;,\n    &quot;4878461&quot;: &quot;454&quot;,\n    &quot;4878462&quot;: &quot;453&quot;,\n    &quot;4878475&quot;: &quot;452&quot;,\n    &quot;4878884&quot;: &quot;451&quot;,\n    &quot;4879254&quot;: &quot;450&quot;,\n    &quot;4879515&quot;: &quot;449&quot;,\n    &quot;4879516&quot;: &quot;448&quot;,\n    &quot;4879518&quot;: &quot;447&quot;,\n    &quot;4879521&quot;: &quot;446&quot;,\n    &quot;4879526&quot;: &quot;445&quot;,\n    &quot;4879546&quot;: &quot;444&quot;,\n    &quot;4879565&quot;: &quot;443&quot;,\n    &quot;4879595&quot;: &quot;442&quot;,\n    &quot;4879598&quot;: &quot;441&quot;,\n    &quot;4879602&quot;: &quot;440&quot;,\n    &quot;4879676&quot;: &quot;439&quot;,\n    &quot;4879678&quot;: &quot;438&quot;,\n    &quot;4879679&quot;: &quot;437&quot;,\n    &quot;4879685&quot;: &quot;436&quot;,\n    &quot;4879704&quot;: &quot;435&quot;,\n    &quot;4879714&quot;: &quot;434&quot;,\n    &quot;4879716&quot;: &quot;433&quot;,\n    &quot;4879808&quot;: &quot;432&quot;,\n    &quot;4879809&quot;: &quot;431&quot;,\n    &quot;4879813&quot;: &quot;430&quot;,\n    &quot;4879814&quot;: &quot;429&quot;,\n    &quot;4879815&quot;: &quot;428&quot;,\n    &quot;4880004&quot;: &quot;427&quot;,\n    &quot;4880008&quot;: &quot;426&quot;,\n    &quot;4880055&quot;: &quot;425&quot;,\n    &quot;4880056&quot;: &quot;424&quot;,\n    &quot;4880058&quot;: &quot;423&quot;,\n    &quot;4880059&quot;: &quot;422&quot;,\n    &quot;4880060&quot;: &quot;421&quot;,\n    &quot;4880061&quot;: &quot;420&quot;,\n    &quot;4880062&quot;: &quot;419&quot;,\n    &quot;4880063&quot;: &quot;418&quot;,\n    &quot;4880064&quot;: &quot;417&quot;,\n    &quot;4880065&quot;: &quot;416&quot;,\n    &quot;4880066&quot;: &quot;415&quot;,\n    &quot;4880598&quot;: &quot;414&quot;,\n    &quot;4880599&quot;: &quot;413&quot;,\n    &quot;4880600&quot;: &quot;412&quot;,\n    &quot;4880601&quot;: &quot;411&quot;,\n    &quot;4880840&quot;: &quot;410&quot;,\n    &quot;4881012&quot;: &quot;409&quot;,\n    &quot;4882458&quot;: &quot;408&quot;,\n    &quot;4885030&quot;: &quot;407&quot;,\n    &quot;4885031&quot;: &quot;406&quot;,\n    &quot;4885035&quot;: &quot;405&quot;,\n    &quot;4885036&quot;: &quot;404&quot;,\n    &quot;4885040&quot;: &quot;403&quot;,\n    &quot;4885041&quot;: &quot;402&quot;,\n    &quot;4885054&quot;: &quot;401&quot;,\n    &quot;4885055&quot;: &quot;400&quot;,\n    &quot;4885056&quot;: &quot;399&quot;,\n    &quot;4885057&quot;: &quot;398&quot;,\n    &quot;4885058&quot;: &quot;397&quot;,\n    &quot;4885059&quot;: &quot;396&quot;,\n    &quot;4885060&quot;: &quot;395&quot;,\n    &quot;4885061&quot;: &quot;394&quot;,\n    &quot;4885406&quot;: &quot;393&quot;,\n    &quot;4885411&quot;: &quot;392&quot;,\n    &quot;4885412&quot;: &quot;391&quot;,\n    &quot;4885470&quot;: &quot;390&quot;,\n    &quot;4886176&quot;: &quot;389&quot;,\n    &quot;4890965&quot;: &quot;388&quot;,\n    &quot;4890966&quot;: &quot;387&quot;,\n    &quot;4890967&quot;: &quot;386&quot;\n  }\n  // expects a space-delimited string of Ensighten condition IDs, returns a boolean that says if ANY were true\n  function checkConditions (condString) {\n    try {\n      condString = condString || &quot;&quot;\n      var condList = condString.trim().split(/\\s+/)\n      var conditions = {}\n      var translatedId\n      condList.forEach((ensightenCondId) =&gt; {\n        // populate the object with 'false' to start\n        translatedId = conditionMap[ensightenCondId]\n        if (typeof translatedId === 'string') {\n          conditions[translatedId] = false\n        }\n      })\n      window.utag.loader.loadrules(originalB, conditions)\n      // console.log(conditions)\n      var conditionMet = false\n      var finalConditions = Object.keys(conditions)\n      finalConditions.forEach((id) =&gt; {\n        if (conditions[id]) {\n          conditionMet = true\n        }\n      })\n      return conditionMet\n    } catch (e) {\n      console.log('checkConditions error', e)\n      return false\n    }\n  }\n\n  if (checkConditions(&quot; 4874978 &quot;)) {\n    try {\n      b[&quot;content_id&quot;] = (function() {\n        return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n          .split(&quot;&amp;units[]=&quot;).pop()\n          .split(&quot;&amp;&quot;).shift();\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4825462  2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - Affiliate Order Detail&quot;] = (function() {\n        var boughtCat = dataLayer[0].ecommerce.purchase.products[0].category;\n        var partDetail = boughtCat.split('/');\n        var ref = dataLayer[0].ecommerce.purchase.actionField.id;\n        return ref + &quot;_&quot; + partDetail[1] + &quot;_&quot; + partDetail[2] + &quot;_&quot; + partDetail[3] + &quot;_&quot; + dataLayer[0].departureAirport + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].name + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].quantity + &quot;_&quot; + dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - BookingRef&quot;] = (function() {\n        if (dataLayer[0].eCommerce !== undefined) {\n          return dataLayer[0].eCommerce.purchase ? dataLayer[0].eCommerce.purchase.actionField.id : &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtAdults&quot;] = (function boughtAdults() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtChildren&quot;] = (function boughtChildren() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836899  4836987  4151406  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCountry&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : dataLayer[0].ecommerce.checkout.products[0].quantity;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPeriod&quot;] = (function anon() {\n        var boughtFrom = dataLayer[0].departureDate;\n        var boughtTo = dataLayer[0].returnDate;\n\n        if (boughtFrom !== undefined) {\n          return (boughtFrom + &quot; - &quot; + boughtTo);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.actionField.revenue;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtResort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - departureDate&quot;] = (function() {\n        return dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4844447  4844445 &quot;)) {\n    try {\n      b[&quot;Crystal - productBrand&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].brand : dataLayer[0].ecommerce.detail.products[0].brand;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory1&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : (dataLayer[0].ecommerce.checkout.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory2&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  4834971  2503818  4834967  4844577  4825428 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory3 - Resort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151409  2503818 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151407 &quot;)) {\n    try {\n      b[&quot;Crystal - productID&quot;] = (function anon() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productID - Facebook&quot;] = (function anon() {\n        var accomID = dataLayer[0].ecommerce &amp;&amp; dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        return accomID.substring(2);\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4151406 &quot;)) {\n    try {\n      b[&quot;Crystal - productPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].quantity : (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : &quot;&quot;);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].price : dataLayer[0].ecommerce.detail.products[0].price;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - Selected Flight Position&quot;] = (function() {\n        if (dataLayer[0].flightposition !== undefined) {\n          return parseInt(dataLayer[0].flightPosition) + 1;\n        } else return &quot;&quot;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836987  2518567 &quot;)) {\n    try {\n      b[&quot;Crystal - TravelType&quot;] = (function() {\n        if (dataLayer[0].departureAirport === &quot;ASH&quot; || dataLayer[0].departureAirport === &quot;STP&quot;) {\n          return &quot;Train&quot;;\n        }\n        return &quot;Flight&quot;;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - Affiliate Cookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; AffiliateCJcookie=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - cjCookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; cjevent=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 386105 &quot;)) {\n    try {\n      b[&quot;geoCountry&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n            return dataLayer[0].transactions.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n            return dataLayer[0].basket.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n            return dataLayer[0].product.geo.countryName;\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n\n  // not sure why this is defined once conditional and once unconditional\n  try {\n    b[&quot;productType&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('flight/book') &gt; -1) {\n          return &quot;Flight&quot;;\n        } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n          return &quot;River Cruise&quot;;\n        } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n          return &quot;Cruise&quot;;\n        } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n          return &quot;Multi-Centre&quot;;\n        } else {\n          if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n            return &quot;Hotel Only&quot;;\n          } else {\n            return &quot;Package&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  /*\n  if (checkConditions(&quot; 696873  4845366  470318  4845258  4845255  4845356  4845253  4878884  4873541 &quot;)) {\n    try {\n      b[&quot;productType&quot;] = (function() {\n        try {\n          if (document.location.href.indexOf('flight/book') &gt; -1) {\n            return &quot;&quot;;\n          } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n            return &quot;River Cruise&quot;;\n          } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n            return &quot;Cruise&quot;;\n          } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n            return &quot;Multi-Centre&quot;;\n          } else {\n            if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n              return &quot;Hotel Only&quot;;\n            } else {\n              return &quot;Package&quot;;\n            }\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  */\n\n  \n  // depends on &quot;legacy_productType&quot;\n  if (checkConditions(&quot; 4845255  4845356  4845253  4878884  696873  4845366  4873541  4859386  4845258 &quot;)) {\n    try {\n      b[&quot;productList&quot;] = (function() {\n\n        var productObj = {},\n          product = '',\n          dl = '',\n          returnVal = [];\n\n        function mapProductObj(id, name, brand, price, quantity, productType, numPax) {\n          var tempObj = {};\n          tempObj.id = id;\n          tempObj.name = name;\n          tempObj.brand = brand || '';\n          tempObj.price = price ? (String(parseFloat(price) / parseInt(quantity, 10))) : price;\n          tempObj.quantity = String(quantity);\n          tempObj.productType = productType || masterProductType;\n          tempObj.metric1 = String(numPax);\n          return tempObj;\n        };\n\n        try {\n          // var masterProductType = Bootstrapper.data.resolve('Manage.TUI UK - Google Analytics.productType');\n          var masterProductType = b.productType\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n            dl = dataLayer[0];\n            if (dl.product &amp;&amp; dl.product.productID) {\n              // Individual Product Impression\n              product = dl.product;\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, product.currentPrice, 1, '', product.noOfPax);\n              returnVal.push(productObj);\n            } else if (dl.page.search) {\n              // Search Term\n              product = dl.page.search;\n              var noOfPax = dl.page.search.noOfPax.toString();\n              if (product.destinationId || product.destinationName) {\n                // Splits the searched destinations up\n                var delimiter = '|',\n                  destinationIds = product.destinationId ? product.destinationId.split(delimiter) : [],\n                  destinationNames = product.destinationName ? product.destinationName.split(delimiter) : [],\n                  maxLength = destinationIds.length &gt;= destinationNames.length ? destinationIds.length : destinationNames.length;\n\n                for (var i = 0; i &lt; maxLength; i++) {\n                  var searchedObj = {\n                    'list': 'Search Term',\n                    'metric1': noOfPax\n                  };\n\n                  if (destinationIds[i]) {\n                    searchedObj.productID = destinationIds[i];\n                  }\n                  if (destinationNames[i]) {\n                    searchedObj.productName = destinationNames[i];\n                  }\n                  returnVal.push(searchedObj);\n                }\n              }\n\n              // Search Results\n              if (product &amp;&amp; product.resultsList) {\n                for (var j = 0; j &lt; product.resultsList.length; j++) {\n                  var currentResult = product.resultsList[j];\n                  currentResult.position = currentResult.position || (j + 1);\n                  currentResult.list = dl.page.pageSubCategory;\n                  currentResult.metric1 = noOfPax;\n                  returnVal.push(currentResult);\n                }\n              }\n            } else if (dl.basket || dl.transactions) {\n              // main item\n              product = dl.basket ? dl.basket.items : (dl.transactions ? dl.transactions.items : {});\n\n              var numPax = dl.basket ? dl.basket.price.paxDetails.total : dl.transactions.total.paxDetails.total,\n                promoDiscount = (function() {\n                  try {\n                    //Added for new array\n                    if (dl.transactions.total &amp;&amp; dl.transactions.total.bookingLevelPromoCodes &amp;&amp; dl.transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl.transactions.total.bookingLevelPromoCodes;\n                      var promoTotalValue = 0;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                      }\n                      return promoTotalValue;\n                    } else if (typeof dl.transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      return Math.abs(dl.transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                    } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                    }\n                    return 0;\n                  } catch (err) {\n                    return 0;\n                  }\n                })(),\n                price = product.price.currentPrice - promoDiscount;\n\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, price, product.quantity.quantity, '', numPax.toString());\n              returnVal.push(productObj);\n\n              // ancillaries\n              var subItems = product.subItems || [];\n              for (var s = 0; s &lt; subItems.length; s++) {\n                var currentSubItem = subItems[s];\n                if (currentSubItem.productSubType.toLowerCase() == &quot;room upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;room downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Downgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Downgrade', currentSubItem.quantity.pax.toString());\n                } else {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Ancillary', currentSubItem.quantity.pax.toString());\n                }\n\n                returnVal.push(subItemObj);\n              }\n            }\n          }\n          // For old data layer\n          else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n            product = tui.analytics.page;\n\n            var productSum = product.Sum || 0,\n              promoDiscount = (function() {\n                try {\n                  if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  return 0\n                } catch (err) {\n                  return 0;\n                }\n              })(),\n              price = product.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(product.bookingLevelCreditNoteDiscount) &gt; 0) ? (parseFloat(product.bookingLevelCreditNoteDiscount) + parseFloat(productSum)) : productSum,\n              id = product.CRWhereTo || product.WhereTo;\n\n            price = price ? price : '';\n            productObj = mapProductObj(id, id, '', price, 1, masterProductType, product.Pax.toString()); // Credit note change - add credit note value if present\n            returnVal.push(productObj);\n          }\n          return returnVal;\n        } catch (err) {\n          return returnVal;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n \n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - CD - Cabin&quot;] = (function() {\n        return tui.analytics.page.CRCabin;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BoardFilter&quot;] = (function() {\n        return tui.analytics.page.BoardF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BudgetFilter&quot;] = (function() {\n        return tui.analytics.page.BudgetF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - CabinFilter&quot;] = (function() {\n        return tui.analytics.page.CabinF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Confirmation - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('title tui-bold')[0].innerHTML;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211741  1207206 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Details - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('inline-title')[0].innerText.replace(/(\\r\\n|\\n|\\r)/gm, &quot; &quot;);\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1210674  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Options - Itinerary Name&quot;] = (function() {\n        var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211742  1211743  1211741  1207254  1207206  1210674  1211596  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DaysUntilDeparture&quot;] = (function() {\n        //Build raw date\n        var rawDate = tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n        //Change to american formatting\n        var depDate = new Date(rawDate.split(&quot;/&quot;)[1] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[0] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[2]);\n        var today = new Date();\n        return parseInt((depDate - today) / (1000 * 60 * 60 * 24)) + 1;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211741  1211720  1211742  1211743 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirport&quot;] = (function() {\n        return tui.analytics.page.DepAir;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirportFilter&quot;] = (function() {\n        return tui.analytics.page.DepAirF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DestinationFilter&quot;] = (function() {\n        return tui.analytics.page.CRGeoF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211743  1207254  1210674  1211596  1211720  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Hotel&quot;] = (function() {\n        return tui.analytics.page.CRHotel;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211742  1211743  1211720  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Party&quot;] = (function() {\n        return tui.analytics.page.Party;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211596  1211743 &quot;)) {\n    try {\n      b[&quot;Stockton - DD - Passenger Details - Itinerary Name&quot;] = (function() {\n        try {\n          var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n          if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n            itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n          }\n\n          if (itineraryName == null || itineraryName == '') {\n            itineraryName = tui.analytics.page.CRWhereTo;\n          }\n\n          return itineraryName;\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PaymentType&quot;] = (function() {\n        return tui.analytics.page.PayType;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PromoCode&quot;] = (function() {\n        return tui.analytics.page.PromoCode;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - ShipFilter&quot;] = (function() {\n        return tui.analytics.page.CRShip;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - TransactionId&quot;] = (function() {\n        return tui.analytics.page.Tracsref;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4879518  4880063  4880064  4880065  4880066 &quot;)) {\n    try {\n      b[&quot;uniqodoBookingReference&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n            return dataLayer[0].transactions.total.transactionId.toString().split('-')[0];\n          } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n            return tui.analytics.page.Tracsref.toString().split('-')[0];\n          }\n        } catch (err) {\n          return '';\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}\n\nfunction addUnconditionalEnsightenVariables (originalB) {\n  var b = {}\n  try {\n    b[&quot;abtaNumber&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ShopID) {\n          return tui.analytics.page.ShopID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;abTest&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.abtestV2) {\n          return tui.analytics.page.abtestV2;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.abTestV2) {\n          return dataLayer[0].page.abTestV2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeCookieDomainPeriods&quot;] = (function() {\n      try {\n        if (document.location.host.indexOf(&quot;.co.uk&quot;) &gt; 0) {\n          return 3;\n        } else if (document.location.hostname.match(/(\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          return 3;\n        } else {\n          return 2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeDownloadFileTypes&quot;] = (function() {\n      try {\n        return &quot;exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeLinkInternalFilters&quot;] = (function() {\n      try {\n        return &quot;javascript:,&quot; +\n          &quot;firstchoice.co.uk,&quot; +\n          &quot;firstchoiceprjuat.co.uk,&quot; +\n          &quot;thomson.co.uk,&quot; +\n          &quot;thomsonprjuat.co.uk,&quot; +\n          &quot;falconholidays.ie,&quot; +\n          &quot;falconholidaysprjuat.ie,&quot; +\n          &quot;tui.co.uk,&quot; +\n          &quot;tuiprjuat.co.uk,&quot; +\n          &quot;tuiholidays.ie,&quot; +\n          &quot;tuiholidaysprjuat.ie,&quot; +\n          &quot;i.4see.mobi,&quot; +\n          &quot;survey.foreseeresults.com,&quot; +\n          &quot;tuiretailagents.thomson.co.uk,&quot; +\n          &quot;retailagents.tui.co.uk,&quot; +\n          &quot;falconretailagents.falconholidays.ie,&quot; +\n          &quot;retailagents.tuiholidays.ie,&quot; +\n          &quot;retailagents.tuiholidaysprjuat.ie,&quot; +\n          &quot;tuiretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;money4travel.com,&quot; +\n          &quot;inbro.net,&quot; +\n          &quot;tuitickets.com,&quot; +\n          &quot;amazonaws.com&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeMarketingCloudVisitorID&quot;] = (function() {\n      try {\n        return visitor.getMarketingCloudVisitorID();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductString&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met')\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else if ((typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount === 'undefined') &amp;&amp; (typeof tui.analytics.page.PromoValue === 'undefined' || tui.analytics.page.PromoValue === 'null')) {\n                    return dataLayer[0].transactions.items.price.currentPrice\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code\n              function getPromoDiscount() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return '|event154=' + Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return '|event154=' + parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductStringLYP&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met');\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  // New data layer, promo code array\n                  if (dataLayer[0].transactions.total.bookingLevelPromoCodes != 'undefined' &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n                    var promoTotalValue = 0;\n                    for (i = 0; i &lt; promoCodeArray.length; i++) {\n                      promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                    }\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(promoTotalValue);\n                  }\n                  // New data layer, pre-release location of promo code\n                  else if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  }\n                  // New data layer, old data layer for promo code\n                  else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  // New data layer, no promo code present\n                  else if (dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.price) {\n                    return dataLayer[0].transactions.items.price.currentPrice;\n                  } else {\n                    return '';\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code - had to add checks for dataLayer presence due to FO defect\n              function getPromoDiscount() {\n                try {\n                  var dl = window.dataLayer;\n                  var discountString = '';\n                  if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n                    if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        if (/CVHRC/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event158=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event159=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else {\n                          discountString += '|event154=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        }\n                      }\n                    }\n                    // If old object is shown - can be removed at a later date\n                    else if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      // Programme Change Incentive\n                      if (/CVRHC/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else {\n                        return '|event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                      }\n                    }\n                  }\n                  // For legacy data layer\n                  else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n                    if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else {\n                        discountString += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                      }\n                    }\n                  }\n                  return discountString;\n                } catch (err) {\n                  return '';\n                }\n              }\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get the promo discount value\n        function getLegacyPromoDiscount() {\n          try {\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              var legacyPromoDiscount = '';\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                } else {\n                  legacyPromoDiscount += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                }\n              }\n              return legacyPromoDiscount\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax + getLegacyPromoDiscount()].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|bookingConfirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeReportSuite&quot;] = (function() {\n      try {\n        if (/^(hybrisdev|paymentpagedev)$/i.test(Bootstrapper.ensightenOptions.publishPath) || /^(prjuat|staging|st[0-9]|hybd[0-9]|admin|prdsupport|localhost|webcache|cloud|rategain|absolutesurveyors|anite|cms|qa|ceros)$/i.test(window.location.host)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukdev&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukapppdev,tuiukdev&quot;;\n          } else {\n            return &quot;tuiukdev&quot;;\n          }\n        } else if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukprod&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukappprod,tuiukprod&quot;;\n          } else {\n            return &quot;tuiukprod&quot;;\n          }\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;agentID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AgentID) {\n          return tui.analytics.page.AgentID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;airportExtras&quot;] = (function() {\n      try {\n        return window.tui.analytics.page.HXAnc;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;alternativeFlightOptions&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AltFlt) {\n          return tui.analytics.page.AltFlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;appVisitor&quot;] = (function() {\n      try {\n        var paramArray = [];\n        if (s.Util.getQueryParam('utm_medium') === &quot;TDA&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-myfirstchoice_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-myfirstchoice_uk&quot;) {\n          paramArray.push(s.Util.getQueryParam('utm_source'));\n          paramArray.push(s.Util.getQueryParam('utm_campaign'));\n\n          if (s.Util.getQueryParam('utm_content')) {\n            paramArray.push(s.Util.getQueryParam('utm_content'));\n          } else if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push('No content set');\n          }\n\n          if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push(s.Util.getQueryParam(&quot;utm_term&quot;));\n          }\n\n          return 'Native App Visitor' + '|' + paramArray.join('|');\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportCode) {\n          return dataLayer[0].transactions.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportCode) {\n          return dataLayer[0].basket.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportCode) {\n          return dataLayer[0].product.arrivalAirportCode;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData != null &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors != null &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportName) {\n          return dataLayer[0].transactions.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportName) {\n          return dataLayer[0].basket.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportName) {\n          return dataLayer[0].product.arrivalAirportName;\n        } else if (window.jsonData &amp;&amp; jsonData.package &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Board) {\n          return tui.analytics.page.Board.trim();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisCode) {\n          return dataLayer[0].transactions.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisCode) {\n          return dataLayer[0].basket.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisCode) {\n          return dataLayer[0].product.boardBasisCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisName) {\n          return dataLayer[0].transactions.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisName) {\n          return dataLayer[0].basket.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisName) {\n          return dataLayer[0].product.boardBasisName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingDate YYYY-MM-DD&quot;] = (function() {\n      try {\n        var today = new Date();\n        var dd = today.getDate();\n        var mm = today.getMonth() + 1; //January is 0\n        var yyyy = today.getFullYear();\n\n        if (dd &lt; 10) {\n          dd = '0' + dd;\n        }\n\n        if (mm &lt; 10) {\n          mm = '0' + mm;\n        }\n\n        today = yyyy + '-' + mm + '-' + dd;\n        return today;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n   try {\n\tb[&quot;bookingOrMmbIncentiveCode&quot;] = (function() {\n\t  try {\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; (dataLayer[0].basket || dataLayer[0].transactions)) {\n\n\t\t  if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t\tvar promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t\tfor (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t  if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\treturn promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t  }\n\t\t\t}\n\t\t  } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t  return dataLayer[0].transactions.total.bookingLevelPromoCode;\n\t\t\t}\n\t\t  } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t\tvar promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t\tfor (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t  if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\treturn promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t  }\n\t\t\t}\n\t\t  } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t  return dataLayer[0].basket.price.bookingLevelPromoCode;\n\t\t\t}\n\t\t  }\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n\t\t  if (typeof tui.analytics.page.IncentivePromoCode !== 'undefined' &amp;&amp; tui.analytics.page.IncentivePromoCode !== 'null') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.IncentivePromoCode)) {\n\t\t\t  return tui.analytics.page.IncentivePromoCode;\n\t\t\t}\n\t\t  } else if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n\t\t\t  return tui.analytics.page.PromoCode;\n\t\t\t}\n\t\t  }\n\t\t} else {\n\t\t  return undefined;\n\t\t}\n\t  } catch (err) {\n\t\treturn undefined;\n\t  }\n\t})()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReferenceMoney4Travel&quot;] = (function() {\n      try {\n        var element = document.querySelector(&quot;.overall-summary p:nth-child(4)&quot;);\n        return element ? element.textContent : &quot;&quot;;\n      } catch (e) {\n        return ''\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;brand&quot;] = (function() {\n      try {\n        if ((document.location.host.indexOf('tuiretailagents.thomson.co.uk') != -1) || (document.location.host.indexOf('tuiretailagents.thomsonprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tui.co.uk') != -1) || (document.location.host.indexOf('retailagents.tuiprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('falconretailagents.falconholidays.ie') != -1) || (document.location.host.indexOf('falconretailagents.falconholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tuiholidays.ie') != -1) || (document.location.host.indexOf('retailagents.tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('thomson.co.uk') != -1) || (document.location.host.indexOf('thomsonprjuat.co.uk') != -1)) {\n          return &quot;thomson&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.co.uk') != -1) || (document.location.host.indexOf('firstchoiceprjuat.co.uk') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.inbro.net') != -1) || (document.location.host.indexOf('firstchoiceprjuat.inbro.net') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('falconholidays.ie') != -1) || (document.location.host.indexOf('falconholidaysprjuat.ie') != -1)) {\n          return &quot;falconholidays&quot;;\n        } else if ((document.location.host.indexOf('tui.co.uk') != -1) || (document.location.host.indexOf('tuiprjuat.co.uk') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tui.inbro.net') != -1) || (document.location.host.indexOf('tuiprjuat.inbro.net') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tuiholidays.ie') != -1) || (document.location.host.indexOf('tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie&quot;;\n        } else if ((document.location.host.indexOf('tuiretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(tuiretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui retail&quot;;\n        } else if ((document.location.host.indexOf('falconretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(falconretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui ie retail&quot;;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaign&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          var im_id = Bootstrapper.getQueryParam('im_id');\n          if (im_id) {\n            im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // return undefined for PPC and paid social and let autotagging handle setting of campaign\n            return im_id;\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return 'email';\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaignSource&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          if (Bootstrapper.getQueryParam('im_id')) {\n            if (Bootstrapper.getQueryParam('im_id') === 'affiliate') {\n              if (~location.href.toLowerCase().indexOf('ia_id=')) {\n                return Bootstrapper.getQueryParam('ia_id');\n              } else {\n                return Bootstrapper.getQueryParam('im_id');\n              }\n            } else if (~location.href.toLowerCase().indexOf('if_id=')) {\n              return Bootstrapper.getQueryParam('if_id');\n            } else if (Bootstrapper.getQueryParam('im_id') &amp;&amp; Bootstrapper.getQueryParam('im_id') != 'affiliate') {\n              var im_id = Bootstrapper.getQueryParam('im_id');\n              im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // Let autotagging or utms handle ppc and paid social so returning undefined\n              return im_id;\n            } else if (document.referrer) {\n              var parts = document.referrer.split('://')[1].split('/'),\n                host = parts[0];\n              if (~host.indexOf('.google.')) {\n                return 'google';\n              }\n              return host;\n            }\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return Bootstrapper.getQueryParam('ito');\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cancelReason&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.cancelReason) {\n          return dataLayer[0].transactions.total.cancelReason;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierInbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[1];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierOutbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[0];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Channel&quot;] = (function() {\n      if (dataLayer[0].pageName === 'Booking Confirmation') {\n        return 'Sale Ski';\n      } else {\n        return dataLayer[0].sectionName || &quot;&quot;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;childAges&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ChildAges) {\n          return tui.analytics.page.ChildAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.childAges) {\n          return dataLayer[0].product.childAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.childAges) {\n          return dataLayer[0].search.childAges;\n        } else if (window.jsonData &amp;&amp; jsonData.searchRequest &amp;&amp; jsonData.searchRequest.childrenAge) {\n          return jsonData.searchRequest.childrenAge.toString().replace(/,/g, &quot;|&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialSortPriority&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CSPScore) {\n          return tui.analytics.page.CSPScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScore&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScore) {\n          return tui.analytics.page.CVScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScoreType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScoreType) {\n          return tui.analytics.page.CVScoreType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;componentClicked&quot;] = (function() {\n      try {\n        return s.Util.cookieRead('s_comp_click');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentCode) {\n          return dataLayer[0].transactions.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentCode) {\n          return dataLayer[0].basket.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentCode) {\n          return dataLayer[0].product.geo.continentCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentName) {\n          return dataLayer[0].transactions.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentName) {\n          return dataLayer[0].basket.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentName) {\n          return dataLayer[0].product.geo.continentName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cookieLength&quot;] = (function() {\n      try {\n        var cookieSize = document.cookie.length;\n        var cLength = 'unknown';\n        if (!isNaN(cookieSize)) {\n          if (cookieSize &lt; 500)\n            cLength = '&lt; 500';\n          else if (cookieSize &lt; 1024)\n            cLength = '500b-1k';\n          else if (cookieSize &lt; 2048)\n            cLength = '1k-2k';\n          else if (cookieSize &lt; 4096)\n            cLength = '2k-4k';\n          else if (cookieSize &lt; 8192)\n            cLength = '4k-8k';\n          else\n            cLength = 'more than 8k';\n        }\n        return cLength;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryCode) {\n          return dataLayer[0].transactions.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryCode) {\n          return dataLayer[0].basket.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryCode) {\n          return dataLayer[0].product.geo.countryCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n          return dataLayer[0].transactions.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n          return dataLayer[0].basket.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n          return dataLayer[0].product.geo.countryName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].countryName) {\n          return jsonData.packageViewData.accomViewData[0].countryName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;coupon&quot;] = (function() {\n      var returnVal = 'none';\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total) {\n          if (dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode;\n          } else if (dataLayer[0].transactions.total.bookingLevelPromoCode) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCode;\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.toLowerCase() != 'null') {\n          return tui.analytics.page.PromoCode;\n        } else {\n          return returnVal;\n        }\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n          return tui.analytics.page.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteCode) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteCode;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null') {\n          return parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteDiscount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteOriginalBookingID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.originalTransactionId &amp;&amp; tui.analytics.page.originalTransactionId != 'null') {\n          return tui.analytics.page.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.orignalTransactionId) {\n          return dataLayer[0].transactions.total.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.originalTransactionId) {\n          return dataLayer[0].basket.price.totalPrice.originalTransactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteRefundValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteRefundValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue) {\n          return dataLayer[0].transactions.total.creditNoteRefundValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteTotalValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteTotalValue &amp;&amp; tui.analytics.page.creditNoteTotalValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteTotalValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteTotalValue) {\n          return dataLayer[0].transactions.total.creditNoteTotalValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.creditNoteTotalValue) {\n          return dataLayer[0].basket.price.creditNoteTotalValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRCabin) {\n          return tui.analytics.page.CRCabin;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CrCabin) {\n          return tui.analytics.page.CrCabin;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseEpicCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRWhereTo) {\n          return tui.analytics.page.CRWhereTo;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseHotel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRHotel) {\n          return tui.analytics.page.CRHotel;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShip) {\n          return tui.analytics.page.CRShip;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStay&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStay) {\n          return tui.analytics.page.CRStay;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayDuration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur) {\n          return tui.analytics.page.STDur;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayRoomType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STRmSlt) {\n          return tui.analytics.page.STRmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRType) {\n          return tui.analytics.page.CRType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - BkngStep&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.checkout !== undefined) {\n        return dataLayer[0].ecommerce.checkout.actionField.step;\n      } else if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n        return dataLayer[0].ecommerce.purchase.actionField.step;\n      } else return &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - bookingPace&quot;] = (function() {\n      return dataLayer[0].bookingPace || dataLayer[0].searchPace || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - cjevent&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cjevent=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentArrivalAirport&quot;] = (function arrivalAirport() {\n      // returns the arrival airport taken from the route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        var defaultRoute = dataLayer[0].defaultRoute;\n        var defaultRouteArray = defaultRoute.split(&quot;-&quot;);\n        return defaultRouteArray[1];\n      } else if (dataLayer[0].selectedRoute !== undefined) {\n        var selectedRoute = dataLayer[0].defaultRoute;\n        var selectedRouteArray = defaultRoute.split(&quot;-&quot;);\n        return selectedRouteArray[1];\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentCountry&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureAirportArray&quot;] = (function depAirport() {\n      // returns the departure airport\n      if (dataLayer[0].d_airport !== undefined) {\n        return dataLayer[0].d_airport.join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureDate&quot;] = (function currentDepDate() {\n      // returns the current departure date\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout;\n      }\n      if (dataLayer[0].departureDate !== undefined) {\n        return dataLayer[0].departureDate;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDuration&quot;] = (function currentDestination() {\n      // returns the current holiday duration\n      if (dataLayer[0].duration !== undefined) {\n        return dataLayer[0].duration;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentHotelId&quot;] = (function accomId() {\n      // returns the accom id, without the initial letters, where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].id.substring(2);\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPartyType&quot;] = (function currentDepDate() {\n      // returns the current party type\n      if (dataLayer[0].partyType !== undefined) {\n        return dataLayer[0].partyType;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax&quot;] = (function anyPax() {\n      // returns the sum of adults and children from the partyCombination (i.e. excluding infants)\n      if (dataLayer[0].partyCombination !== undefined) {\n        var party = dataLayer[0].partyCombination;\n        var partyArray = party.split(&quot;:&quot;);\n        return parseInt(partyArray[0], 10) + parseInt(partyArray[1], 10);\n      } else if (dataLayer[0].ecommerce !== undefined) {\n        // uses quantity as a fallback if partyCombination is undefined, but will include infants in pax\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax inc infants&quot;] = (function anyPax() {\n      // returns the pax where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentResort&quot;] = (function productCat() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2]\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentRoute&quot;] = (function route() {\n      // returns the current route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        return dataLayer[0].defaultRoute;\n      }\n      if (dataLayer[0].selectedRoute !== undefined) {\n        return dataLayer[0].selectedRoute;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Hit Timestamp&quot;] = (function() {\n      //Get local time as ISO string with offset at the end\n      var now = new Date();\n      var tzo = -now.getTimezoneOffset();\n      var dif = tzo &gt;= 0 ? '+' : '-';\n      var pad = function(num) {\n        var norm = Math.abs(Math.floor(num));\n        return (norm &lt; 10 ? '0' : '') + norm;\n      };\n      return now.getFullYear() +\n        '-' + pad(now.getMonth() + 1) +\n        '-' + pad(now.getDate()) +\n        'T' + pad(now.getHours()) +\n        ':' + pad(now.getMinutes());\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Internal Campaign&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;icid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - NumberOfRooms&quot;] = (function() {\n      return dataLayer[0].numberOfRooms;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - pageName&quot;] = (function() {\n      return dataLayer[0].pageName || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - productName&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].name;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].name;\n        } else if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].name;\n        }\n      } else return &quot;&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - sectionName&quot;] = (function() {\n      return dataLayer[0].sectionName;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Server&quot;] = (function() {\n      return dataLayer[0].server;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - transactionID&quot;] = (function() {\n      return dataLayer[0].transactionID;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Flashtalking Departure Date&quot;] = (function() {\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout.split(&quot;/&quot;).reverse().join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array Search&quot;] = (function() {\n      if (dataLayer[0].sectionName === &quot;Search Results&quot; || dataLayer[0].sectionName === &quot;Deals&quot;) {\n\n        const ids = dataLayer[0].destinationCode || [];\n        const names = dataLayer[0].destinationName || [];\n\n        return ids.map(function(val, i) {\n          return {\n            id: val,\n            name: names[i],\n            list: dataLayer[0].pageName\n          }\n        });\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Currency&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.www.crystalski.co.uk.crystaldev.io', 'qa1.www.crystalski.co.uk.crystaldev.io', 'dev2.www.crystalski.co.uk.crystaldev.io', 'dev1.www.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.agent.crystalski.co.uk.crystaldev.io', 'qa1.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'EUR';\n      } else if (document.location.host.indexOf('stage.www.crystalski.ie.crystaldev.io', 'qa1.www.crystalski.ie.crystaldev.io', 'dev2.www.crystalski.ie.crystaldev.io', 'dev1.www.crystalski.ie.crystaldev.io') != -1) {\n        return 'EUR';\n      }\n      return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;currencyCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.total &amp;&amp; dl.transactions.total.currency) {\n            return dl.transactions.total.currency;\n          } else if (dl.basket &amp;&amp; dl.basket.price &amp;&amp; dl.basket.price.currency) {\n            return dl.basket.price.currency;\n          } else if (dl.product &amp;&amp; dl.product.currency) {\n            return dl.product.currency;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerAccountNumberOfBookings&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CABookings) {\n          return tui.analytics.page.CABookings;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CustID) {\n          return tui.analytics.page.CustID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.customerID) {\n          return dataLayer[0].user.customerID;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;date&quot;] = (function() {\n      try {\n        var ddd = new Date();\n        var fyfyfy = ddd.getFullYear();\n        var mmm = ddd.getMonth() + 1;\n        var zero = &quot;0&quot;\n        if (mmm &lt; 10) {\n          mmm = zero + mmm;\n        } else {\n          mmm = mmm;\n        }\n        var daydayday = ddd.getDate();\n        var zero = &quot;0&quot;\n        if (daydayday &lt; 10) {\n          daydayday = zero + daydayday;\n        } else {\n          daydayday = daydayday;\n        }\n        var slash = &quot;/&quot;\n        var date = daydayday + slash + mmm + slash + fyfyfy\n        return date;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;daysToDeparture&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate) {\n          var depMonthYear = tui.analytics.page.MonthYear.split('/')\n          var departureDate = new Date(depMonthYear[1], depMonthYear[0] - 1, tui.analytics.page.DepDate);\n          var today = new Date();\n\n          Days = departureDate - today;\n\n          var daysToDep = Math.ceil(Days / (1000 * 60 * 60 * 24));\n\n          return daysToDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          return String(dataLayer[0].transactions.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          return String(dataLayer[0].basket.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          return String(dataLayer[0].product.daysToDeparture);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;decibelID&quot;] = (function() {\n      try {\n        var host = location.hostname,\n          returnVal = '';\n\n        if (~host.indexOf('tuiprjuat.co.uk')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('firstchoiceprjuat.co.uk')) {\n          returnVal = '116869';\n        } else if (~host.indexOf('tuiholidaysprjuat.ie')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('tui.co.uk')) {\n          returnVal = '93210';\n        } else if (~host.indexOf('firstchoice.co.uk')) {\n          returnVal = '95707';\n        } else if (~host.indexOf('tuiholidays.ie')) {\n          returnVal = '95715';\n        }\n        return returnVal;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureAirportCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAir) {\n          return tui.analytics.page.DepAir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureAirportCode) {\n          return dataLayer[0].transactions.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureAirportCode) {\n          return dataLayer[0].basket.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureAirportCode) {\n          return dataLayer[0].product.departureAirportCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureDate&quot;] = (function() {\n      //date format dd/mm/yyyy\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; (tui.analytics.page.DepDate || (tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.indexOf('Dates') === -1))) {\n          var day = tui.analytics.page.DepDate;\n          var month = tui.analytics.page.MonthYear.substring(0, 2);\n          var year = tui.analytics.page.MonthYear.substring(3, 7);\n          return (day == undefined ? &quot;&quot; : day == &quot;&quot; ? &quot;&quot; : day) + '/' + month + '/' + year;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDate) {\n          return dataLayer[0].transactions.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDate) {\n          return dataLayer[0].basket.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDate) {\n          return dataLayer[0].product.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search.departureDate) {\n          return dataLayer[0].page.search.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n    try {\n      var returnVal = 'none';\n      // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n      if (typeof b.departureDate === 'string') {\n        var splitDate = b.departureDate.split('/')\n        var year = splitDate[2] &amp;&amp; splitDate[2].length === 4 &amp;&amp; splitDate[2]\n        var month = splitDate[1] &amp;&amp; splitDate[1].length === 2 &amp;&amp; splitDate[1]\n        var day = splitDate[0] &amp;&amp; splitDate[0].length === 2 &amp;&amp; splitDate[0]\n        if (year &amp;&amp; month &amp;&amp; day) {\n          return year + month + day\n        }\n        // sometimes the day isn't selected (like cruises)\n        if (year &amp;&amp; month) {\n          return year + month\n        }\n      }\n      return returnVal\n    } catch (err) {\n      return returnVal;\n    }\n  })()\n\n  /*\n  Doesn't seem to work correctly on https://www.tui.co.uk/cruise/bookitineraries/Mediterranean-Medley-101129?itineraryCodeOne=101129&amp;itineraryCodeTwo=&amp;shipCode=150012&amp;mc=false&amp;isMCTracs=false&amp;isStayBefore=false&amp;stayDuration=0&amp;cruiseDuration=7&amp;duration=1-7&amp;noOfAdults=2&amp;noOfChildren=0&amp;childrenAge=&amp;from[]=BOH:Airport&amp;to[]=101129:Itinerary&amp;flexibility=false&amp;noOfSeniors=0&amp;when=12-10-2021&amp;sailingDate=12Oct21&amp;to[]=&amp;packageId=16340190000001634030400000TOM620416346388000001634643300000TOM62051181672602/3/650/7ZI01&amp;index=3&amp;brandType=null&amp;addAStay=0&amp;cabin[]=1,2&amp;dp=BOH&amp;bb=AI&amp;cabinOnly=false&amp;mcId=101129|T&amp;searchVariant=FLY_CRUISE_ATCOM\n\n  Attempting to replace it\n\n  try {\n    b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n      try {\n        var returnVal = 'none';\n        // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n          var dl = dataLayer[0];\n\n          if (dl.page &amp;&amp; dl.page.search &amp;&amp; dl.page.search.departureDate) {\n            returnVal = dl.page.search.departureDate;\n          } else if (dl.product &amp;&amp; dl.product.departureDate) {\n            returnVal = dl.product.departureDate;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.departureDate) {\n            returnVal = dl.basket.items.departureDate;\n          } else if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.departureDate) {\n            returnVal = dl.transactions.items.departureDate;\n          }\n          return returnVal.replace(/-/g, '');\n        } else if (tui.analytics.page.MonthYear) {\n          var year = tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.split('/').length &gt; 0 ? tui.analytics.page.MonthYear.split('/')[1] : '';\n          month = tui.analytics.page.MonthYear ? tui.analytics.page.MonthYear.split('/')[0] : '';\n          day = tui.analytics.page.DepDate;\n\n          return [year, month, day].join('');\n        }\n        return returnVal;\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  */\n\n  try {\n    b[&quot;departureDateDifference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDateDiff) {\n          return tui.analytics.page.DepDateDiff;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDateDifference) {\n          return dataLayer[0].product.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDateDifference) {\n          return dataLayer[0].basket.items.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDateDifference) {\n          return dataLayer[0].transactions.items.departureDateDifference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionsAvailable&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOpt) {\n          return tui.analytics.page.DepOpt;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.availableDepositOptions) {\n          return dataLayer[0].basket.price.availableDepositOptions;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionSelected&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOptSel) {\n          return tui.analytics.page.DepOptSel;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.depositValue) {\n          return dataLayer[0].transactions.total.depositValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositValueBookflow&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') == -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationBrowse&quot;] = (function() {\n      //to be updated later\n      try {\n        var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n        var destination = (function() {\n          switch (pageType) {\n            case 'COUNTRY':\n            case 'Destination_Country':\n            case 'Destination_Country_TTD':\n            case 'REGION':\n            case 'Destination_Region':\n              return document.getElementsByClassName('pg-heading')[0].innerText.split(&quot; Holidays&quot;)[0];\n            case 'DESTINATION':\n            case 'Destination_Destination':\n            case 'RESORT':\n            case 'Destination_Resort':\n              return document.getElementsByClassName('page-title')[0].innerHTML.split(&quot; Holidays&quot;)[0];\n            case 'ACCOMMODATION':\n            case 'Destination_Accommodation':\n              return document.querySelector(&quot;.bread-viewport&quot;).childNodes[1].childNodes[3].innerText.slice(0, -1);\n            default:\n              return '';\n          }\n        })()\n        return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationCode) {\n          return dataLayer[0].transactions.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationCode) {\n          return dataLayer[0].basket.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationCode) {\n          return dataLayer[0].product.geo.destinationCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationFC&quot;] = (function() {\n      try {\n        function titleCase(str) {\n          str = str ? str.toLowerCase().split(' ') : [];\n          for (var i = 0; i &lt; str.length; i++) {\n            str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n          }\n          return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n        }\n\n        if (tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n          return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/PPPPP/g, &quot;&quot;));\n        } else {\n          return titleCase(document.getElementsByClassName('uppercase tui-dark-blue destinations-name')[0].outerText.replace(&quot;DESTINATIONS IN &quot;, &quot;&quot;));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationIMG&quot;] = (function() {\n      try {\n        var url = document.getElementsByClassName('hero-img')[0].children[0].currentSrc;\n        var widthreplace = url.replace(/width:1080/g, &quot;width:364&quot;);\n        var heightreplace = widthreplace.replace(/height:608/g, &quot;height:180&quot;);\n        return heightreplace;\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationName) {\n          return dataLayer[0].transactions.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationName) {\n          return dataLayer[0].basket.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationName) {\n          return dataLayer[0].product.geo.destinationName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPrice&quot;] = (function() {\n      try {\n\t\tif(tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n\t\t\treturn document.getElementsByClassName('actual-price')[0].outerText;\n\t\t}\n\t\telse {\n\t\t\treturn document.getElementsByClassName('amount')[0].outerText;\n\t\t}\n\t}\n\tcatch (err){\n\t\treturn &quot;500&quot;;\n\t}\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPush&quot;] = (function() {\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var destination = (function() {\n        switch (pageType) {\n          case 'CONTINENT':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'COUNTRY':\n          case 'Destination_Country':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'Destination_Country_TTD':\n          case 'REGION':\n          case 'Destination_Region':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'DESTINATION':\n          case 'Destination_Destination':\n          case 'RESORT':\n          case 'Destination_Resort':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'ACCOMMODATION':\n          case 'Destination_Accommodation':\n            function titleCase(str) {\n              str = str ? str.toLowerCase().split(' ') : [];\n              for (var i = 0; i &lt; str.length; i++) {\n                str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n              }\n              return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n            }\n            return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/OOOOO/g, &quot;&quot;));\n          default:\n            return 'a holiday';\n        }\n      })()\n      return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;device&quot;] = (function() {\n      try {\n        var deviceDetector = (function() {\n          var ua = navigator.userAgent.toLowerCase();\n          var detect = (function(s) {\n            if (s === undefined) s = ua;\n            else ua = s.toLowerCase();\n            if (/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(ua))\n              return 'Tablet';\n            else\n            if (/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(ua))\n              return 'Mobile';\n            else return 'Desktop';\n          });\n          return {\n            device: detect(),\n            detect: detect,\n            isMobile: ((detect() != 'desktop') ? true : false),\n            userAgent: ua\n          };\n        }());\n\n        return deviceDetector.device;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directDebit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DirectDebit) {\n          return tui.analytics.page.DirectDebit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directOrIndirectFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InDir) {\n          return tui.analytics.page.InDir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.directOrIndirectFlight) {\n          return dataLayer[0].transactions.items.directOrIndirectFlight;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.directOrIndirectFlight) {\n          return dataLayer[0].basket.items.directOrIndirectFlight;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;dreamlinerFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DreamFl) {\n          return tui.analytics.page.DreamFl;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;duration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          return tui.analytics.page.Dur;\n        } else if (tui.analytics.page.STDur &amp;&amp; tui.analytics.page.STDur.toLowerCase() == &quot;null&quot;) {\n          return tui.analytics.page.CRDur;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur &amp;&amp; tui.analytics.page.CRDur) {\n          return parseInt(tui.analytics.page.CRDur) + parseInt(tui.analytics.page.STDur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          return dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          return dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          return dataLayer[0].product.duration;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationCode&quot;] = (function() {\n      try {\n        var dur = &quot;&quot;;\n        var durCode;\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          dur = parseInt(tui.analytics.page.Dur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          dur = dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          dur = dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          dur = dataLayer[0].product.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.duration) {\n          dur = dataLayer[0].page.search.duration;\n        }\n\n\n        switch (dur) {\n          case 1:\n            durCode = '1245';\n            break;\n          case 2:\n          case 3:\n          case 4:\n            durCode = '4321';\n            break;\n          case 5:\n          case 6:\n          case 7:\n          case 8:\n          case 9:\n            durCode = '7114';\n            break;\n          case 10:\n            durCode = '1014';\n            break;\n          case 11:\n            durCode = '1114';\n            break;\n          case 12, 13, 14, 15, 16:\n            durCode = '1413';\n            break;\n          default:\n            durCode = '2118';\n        }\n\n        return durCode;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationSearched&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DurationSearched) {\n          return tui.analytics.page.DurationSearched;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.durationSearched) {\n          return dataLayer[0].page.search.durationSearched;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;emailHash&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Eml) {\n          return tui.analytics.page.Eml;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.hashedEmail) {\n          return dataLayer[0].user.hashedEmail;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;epicCode&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('cruise') == -1) {\n          if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.WhereTo) {\n            return tui.analytics.page.WhereTo;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productID) {\n            return dataLayer[0].transactions.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productID) {\n            return dataLayer[0].basket.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productID) {\n            return dataLayer[0].product.productID;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;facebookPixelFire&quot;] = (function() {\n      try {\n        //let days = Bootstrapper.data.resolve('Manage.TUI UK - Generic.daysToDeparture');\n        let days = b.daysToDeparture\n        //let carrier = Bootstrapper.data.resolve('Manage.TUI UK - Generic.carrierCode');\n        let carrier = b.carrierCode\n        //Fire FB Pixel Logic\n        if (days &lt; 180 &amp;&amp; carrier === &quot;TOM|TOM&quot;) {\n          return 'YES';\n        } else {\n          return 'NO';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterAccommodationType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AccomTypeF) {\n          return tui.analytics.page.AccomTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;accommodationType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBackTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BackTimeF) {\n          return tui.analytics.page.BackTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;inslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBestFor&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BestForF) {\n          return tui.analytics.page.BestForF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;bestfor&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBoard&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BoardF) {\n          return tui.analytics.page.BoardF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;boardBasis&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBudget&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BudgetF) {\n          return tui.analytics.page.BudgetF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;budgettotal&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseCabin&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CabinF) {\n          return tui.analytics.page.CabinF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRGeoF) {\n          return tui.analytics.page.CRGeoF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShipF) {\n          return tui.analytics.page.CRShipF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseStayDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStayF) {\n          return tui.analytics.page.CRStayF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDepartureAirport&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAirF) {\n          return tui.analytics.page.DepAirF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;departurePoints&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.GeoF) {\n          return tui.analytics.page.GeoF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;destinations&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFeatures&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FeaturesF) {\n          return tui.analytics.page.FeaturesF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;features&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFreeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FreeKidsF) {\n          return tui.analytics.page.FreeKidsF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;isFCP&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterHolidayType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.HolTypeF) {\n          return tui.analytics.page.HolTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterOutTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OutTimeF) {\n          return tui.analytics.page.OutTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;outslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterSingleAccommodationEndState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.filters) {\n          return window.tui.analytics.page.filters.reduce(function(a, c, i) {\n            i === 0 ? c.filterValue : a + ',' + c.filterValue;\n          }, '')\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n\n  try {\n    b[&quot;filterSortBy&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SortByF) {\n          return tui.analytics.page.SortByF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTourOperator&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TourOperatorF) {\n          return tui.analytics.page.TourOperatorF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayOperator&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARatingF) {\n          return tui.analytics.page.TARatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;taRatingF&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTuiRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RatingF) {\n          return tui.analytics.page.RatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;fcRating&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;firstPartyAncillaries&quot;] = (function() {\n      try {\n\n        var arrayItems = &quot;&quot;;\n        var itemValue = &quot;&quot;;\n\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TuiAnc) {\n          return tui.analytics.page.TuiAnc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.subItems) {\n          arrayItems = dataLayer[0].transactions.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.subItems) {\n          arrayItems = dataLayer[0].basket.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flexibleDates&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FlexDate) {\n          return tui.analytics.page.FlexDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flexibleDates) {\n          return dataLayer[0].page.search.flexibleDates;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ACSSRef) {\n          return tui.analytics.page.ACSSRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasCheckedInState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CheckIn) {\n          return tui.analytics.page.CheckIn;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasInboundDays&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InboundDays) {\n          return tui.analytics.page.InboundDays;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightInventory&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltInv) {\n          return tui.analytics.page.FltInv;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.flightInventory) {\n          return dataLayer[0].transactions.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.flightInventory) {\n          return dataLayer[0].basket.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.flightInventory) {\n          return dataLayer[0].product.flightInventory;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightOnlyDeparturePeriod&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepPeriod) {\n          return tui.analytics.page.DepPeriod;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltType) {\n          return tui.analytics.page.FltType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productSubType &amp;&amp; (dataLayer[0].transactions.items.productSubType == &quot;Inbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Outbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].transactions.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productSubType &amp;&amp; (dataLayer[0].basket.items.productSubType == &quot;Inbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Outbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].basket.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flightType) {\n          dataLayer[0].page.search.flightType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlacePartySize&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PartySize) {\n          return tui.analytics.page.PartySize;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SelectScope) {\n          return tui.analytics.page.SelectScope;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.freeKidsAvailable) {\n          return dataLayer[0].product.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.freeKidsAvailable) {\n          return dataLayer[0].basket.items.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.freeKidsAvailable) {\n          return dataLayer[0].transactions.items.freeKidsAvailable;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;geoLevel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) {\n          return tui.analytics.page.contextType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;gmpCustomerID&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('qcmk') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;qcmk=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics Property ID&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'UA-64722569-1';\n      } else if ([&quot;dev1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.www.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.www.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64722569-8';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'UA-64996454-1';\n      } else if ([&quot;dev1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.agent.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64996454-2';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'UA-65009155-1';\n      } else if ([&quot;dev1.www.crystalski.ie.crystaldev.io&quot;, &quot;dev2.www.crystalski.ie.crystaldev.io&quot;, &quot;qa1.www.crystalski.ie.crystaldev.io&quot;, &quot;stage.www.crystalski.ie.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-65009155-2';\n      } else return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics - New Property ID&quot;] = (function() {\n\n      var tui_new_prod = 'UA-107596466-5';\n      var tui_new_dev = 'UA-107596466-6';\n      var fc_new_prod = 'UA-107596466-7';\n      var fc_new_dev = 'UA-107596466-8';\n      var tui_ie_new_prod = 'UA-39088453-1';\n      var tui_ie_new_dev = 'UA-39088453-3';\n\n      try {\n        // Check if it is prod bootstrap\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Production\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK - New:' + fc_new_prod);\n            return fc_new_prod;\n          }\n          // TUI IE Production\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE:' + tui_ie_new_prod);\n            return tui_ie_new_prod;\n          }\n          // TUI UK Production\n          else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - New:' + tui_new_prod);\n            return tui_new_prod;\n          } else {\n            return tui_new_dev;\n          }\n        }\n        // Check if it is dev bootstrap\n        else if (/^(hybrisdev|paymentpagedev|dev)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Development\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK Dev - New:' + fc_new_dev);\n            return fc_new_dev;\n          }\n          // TUI IE Development\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE - Dev:' + tui_ie_new_dev);\n            return tui_ie_new_dev;\n          } else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - Dev New:' + tui_new_dev);\n            return tui_new_dev;\n          }\n        }\n        // Fallback to dev\n        else {\n          console.log('GA Property:TUI UK - Dev New FALLBACK:' + tui_new_dev);\n          return tui_new_dev;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsClientID&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('_ga2')) {\n          return Bootstrapper.Cookies.get('_ga2').slice(6);\n        } else if (Bootstrapper.Cookies.get('_ga')) {\n          return Bootstrapper.Cookies.get('_ga').slice(6);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsPropertyID&quot;] = (function() {\n      try {\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          return 'UA-107596466-1';\n        }\n        return 'UA-107596466-3';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;handLuggageOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Hlo) {\n          return tui.analytics.page.Hlo;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.handLuggageOnly) {\n          return dataLayer[0].transactions.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.handLuggageOnly) {\n          return dataLayer[0].basket.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.handLuggageOnly) {\n          return dataLayer[0].product.handLuggageOnly;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;haulTypeSearch&quot;] = (function() {\n\n      //Iterates through search results list and counts SH/LH destinations. Returns haul type with higher count.\n      //Used for audience building/retargeting purposes.\n\n      //Beach Search Results\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList) {\n          var results = dataLayer[0].page.search.resultsList;\n          var haulList = [],\n            countSH = 0,\n            countLH = 0;\n\n          results.forEach(function(item) {\n            if (item.haulCode === 'SH') {\n              countSH++;\n            } else if (item.haulCode === 'LH') {\n              countLH++;\n            }\n          });\n\n          if (countLH &gt; countSH) {\n            return 'LH';\n          } else {\n            return 'SH';\n          }\n        }\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hostname&quot;] = (function() {\n      try {\n        return document.location.host;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hotelName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productName &amp;&amp; dataLayer[0].transactions.items.productType &amp;&amp; (dataLayer[0].transactions.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].transactions.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productName &amp;&amp; dataLayer[0].basket.items.productType &amp;&amp; (dataLayer[0].basket.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].basket.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productName &amp;&amp; dataLayer[0].product.productType &amp;&amp; (dataLayer[0].product.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].product.productName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].accomName) {\n          return jsonData.packageViewData.accomViewData[0].accomName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;irClickID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; irclickid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isAccommodationOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AOType) {\n          return tui.analytics.page.AOType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.isAccommodationOnly) {\n          return dataLayer[0].transactions.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.isAccommodationOnly) {\n          return dataLayer[0].basket.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.isAccommodationOnly) {\n          return dataLayer[0].product.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.isAccommodationOnly) {\n          return dataLayer[0].search.isAccommodationOnly;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isChoiceSearch&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IsChoiceSearch &amp;&amp; tui.analytics.page.IsChoiceSearch != 'null') {\n          return tui.analytics.page.IsChoiceSearch;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isChoiceSearch) {\n          return dataLayer[0].page.search.isChoiceSearch;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking != 'null') {\n          return tui.analytics.page.isCreditNoteBooking;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking) {\n          return dataLayer[0].transactions.total.isCreditNoteBooking;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteIncentiveEligible&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible != 'null') {\n          return tui.analytics.page.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].transactions.total.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].basket.price.isCreditNoteIncentiveEligible.toLowerCase();\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCRM&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;cmid&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isLowDeposit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LowDep) {\n          return tui.analytics.page.LowDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.price.isLowDeposit;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.total.isLowDeposit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isPush&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;im_id=Push&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSearch&quot;] = (function() {\n\n      try {\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else {\n\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSEO&quot;] = (function() {\n      try {\n        var isSearch;\n        var isSEO;\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else {\n\n          isSearch = &quot;NO&quot;;\n        }\n\n        if (isSearch === &quot;YES&quot;) {\n\n          if (window.location.search.indexOf(&quot;im_id&quot;) &gt; -1) {\n\n            isSEO = &quot;NO&quot;;\n          } else {\n\n            isSEO = &quot;YES&quot;;\n          }\n        } else {\n          isSEO = &quot;NO&quot;;\n        }\n        return isSEO;\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvB) {\n          return tui.analytics.page.LimAvB;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilityBeds) {\n          return dataLayer[0].product.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilityBeds) {\n          return dataLayer[0].basket.items.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilityBeds) {\n          return dataLayer[0].transactions.items.limitedAvailabilityBeds;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityCabins&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvC) {\n          return tui.analytics.page.LimAvC;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilitySeats&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvS) {\n          return tui.analytics.page.LimAvS;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilitySeats) {\n          return dataLayer[0].product.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.items.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.items.limitedAvailabilitySeats;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price - Booking Check&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid &amp;&amp; tui.analytics.page.pageUid == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else {\n          return &quot;FireBooking&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Available&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isLockYourPriceAvailable &amp;&amp; (dataLayer[0].basket.price.lockYourPriceCost &gt;= 0)) {\n          return (dataLayer[0].basket.price.isLockYourPriceAvailable + &quot;|&quot; + (dataLayer[0].basket.price.lockYourPriceCost == 0 ? 'zero' : dataLayer[0].basket.price.lockYourPriceCost));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Confirmed Booking&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return 1;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Revenue&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/confirmation') !== -1) {\n          if (window.dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot; || window.dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n            return window.dataLayer[0].transactions.total.lockYourPriceValue;\n          }\n        } else if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return (window.dataLayer[0].transactions.total.lockYourPriceValue * -1);\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking Revenue&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return dataLayer[0].transactions.total.totalPrice;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;loginDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CLogin) {\n          return tui.analytics.page.CLogin;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.loggedInStatus) {\n          return dataLayer[0].user.loggedInStatus;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;minimumPaymentAmount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MinPay) {\n          return tui.analytics.page.MinPay;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.minPaymentAmount) {\n          return dataLayer[0].transactions.items.minPaymentAmount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.minPaymentAmount) {\n          return dataLayer[0].basket.items.minPaymentAmount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RPRef) {\n          return tui.analytics.page.RPRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MMBPayments) {\n          return tui.analytics.page.MMBPayments;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AandCType) {\n          return tui.analytics.page.AandCType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmountOutstanding&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AmountOutstanding) {\n          return tui.analytics.page.AmountOutstanding;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.amountOustanding) {\n          return dataLayer[0].user.currentBookings.amountOustanding;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AcAnc) {\n          return tui.analytics.page.AcAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingAmount&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') != -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BookingType) {\n          return tui.analytics.page.BookingType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbExistingBookingDepartureDate&quot;] = (function() {\n      try {\n        // returns in yyyymmdd format\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.items &amp;&amp; dataLayer[0].user.currentBookings.items.departureDate) {\n          return dataLayer[0].user.currentBookings.items.departureDate.replace(/-/gi, '');\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbPaymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbTransactionValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TransactionValue) {\n          return tui.analytics.page.TransactionValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;month&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear.substring(0, 2);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;monthYear&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].transactions.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].basket.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].product.departureMonth.split('-')[0]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;navigationTracking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.navigation) {\n          return tui.analytics.page.navigation;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newDataLayer&quot;] = (function() {\n      try {\n        return dataLayer[0].page ? 'true' : 'false';\n      } catch (err) {\n        return 'false';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newSEOdata&quot;] = (function() {\n      //Variable Declarations\n      var refOrigin = document.createElement('a');\n      refOrigin.href = document.referrer;\n      var lpurl = window.location.href;\n      var urlLength = lpurl.length;\n      var siteSection;\n      var destination;\n      var pageName = (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) ? dataLayer[0].page.pageID : (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) ? tui.analytics.page.pageUid : '';\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var pageHead = (function() {\n        try {\n          var a = document.getElementsByClassName('pg-heading')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n      var pageTitle = (function() {\n        try {\n          var a = document.getElementsByClassName('page-title')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n\n      if (document.domain === 'www.tui.co.uk') {\n        //TUI SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;cruise&quot;) &gt; -1):\n            siteSection = 'Cruise';\n            break;\n          case (lpurl.indexOf(&quot;flight&quot;) &gt; -1):\n            siteSection = 'Flight';\n            break;\n          case (lpurl.indexOf(&quot;city-breaks&quot;) &gt; -1):\n            siteSection = 'Cities';\n            break;\n          case (lpurl.indexOf(&quot;multi-centre&quot;) &gt; -1):\n            siteSection = 'Multi-Centre';\n            break;\n          case (lpurl.indexOf(&quot;lakes-and-mountains&quot;) &gt; -1):\n            siteSection = 'Lakes-and-Mountains';\n            break;\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account';\n            break;\n          case (lpurl.indexOf(&quot;my-thomson-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/hotels/&quot;) &gt; -1):\n            siteSection = 'Hotels'\n            break;\n            //Discover\n          case (lpurl.indexOf(&quot;discover&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;articles&quot;) &gt; -1):\n            siteSection = 'Discover';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;europe&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;asia&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;africa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;caribbean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;the-americas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;indian-ocean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;holiday-destinations&quot;) &gt; -1):\n            siteSection = 'Destinations';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensimar&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;small-and-friendly&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family-life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;robinson&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;villas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;gold&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;platinum&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;scene&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;a-la-carte&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;3t-favourites&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;skytours&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;simply&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;local-flavour&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;riu&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;tui-blue&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;magic-life&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;couples&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;weddings&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;nightlife&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;collection&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;spa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n            siteSection = 'Best-For';\n            break;\n            //Homepage\n          case (window.location.pathname.length == 1):\n          case (lpurl.substring(urlLength - 13, urlLength) == 'destinations/'):\n            siteSection = 'Homepage'\n            break;\n            //Other\n          case (pageName === &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n            break;\n        }\n        //TUI Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            destination = document.querySelector(&quot;#breadcrumbs&quot;).childNodes[3].text;\n            break;\n          case (siteSection == 'Destinations'):\n            if (pageType === &quot;COUNTRY&quot; || pageType === &quot;REGION&quot;) {\n              destination = pageHead.substring(0, pageHead.length - 10);\n            } else if (pageType === &quot;RESORT&quot; || pageType === &quot;DESTINATION&quot;) {\n              destination = pageTitle;\n            }\n            break;\n          default:\n            destination = 'null';\n        }\n      } else if (document.domain === 'www.firstchoice.co.uk') {\n        //FirstChoice SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account'\n            break;\n          case (lpurl.indexOf(&quot;my-first-choice-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/accommodation&quot;) &gt; -1):\n            siteSection = 'Hotels';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;location&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 12, urlLength) == 'destinations'):\n            siteSection = 'Destinations';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;Holiday-Village&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SplashWorld&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;Magic-Life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SuneoClub&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;premier-holidays&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 3, urlLength) == 'spa'):\n          case (lpurl.substring(urlLength - 9, urlLength) == 'holidays/'):\n            siteSection = 'Best-For';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Homepage\n          case (lpurl.substring(urlLength - 10, urlLength) == 'holiday/'):\n          case (window.location.pathname.length == 1):\n            siteSection = 'Homepage';\n            break;\n          case (pageName == &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n        }\n        //FirstChoice Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            var cutone = lpurl.substring(61, lpurl.length);\n            destination = cutone.substring(0, cutone.indexOf(&quot;/&quot;));\n            break;\n          case (siteSection == 'Destinations'):\n            destination = pageTitle;\n            break;\n          default:\n            destination = 'null';\n        }\n      }\n      //Output\n\n      //return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + encodeURIComponent(lpurl);\n\n      if (lpurl.indexOf(&quot;utm_medium=TDA&quot;) &gt; -1) {\n        return &quot;&quot;;\n      } else {\n        return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + lpurl;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;noOfRooms&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.numberOfRooms) {\n          return dataLayer[0].transactions.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.numberOfRooms) {\n          return dataLayer[0].basket.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.numberOfRooms) {\n          return dataLayer[0].product.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfRooms) {\n          return dataLayer[0].product.noOfRooms;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfAdults&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; jsonData.packageViewData.paxViewData.noOfAdults) {\n          return jsonData.packageViewData.paxViewData.noOfAdults;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults) {\n          return parseInt(tui.analytics.page.Adults);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.adults) {\n          return dataLayer[0].transactions.total.paxDetails.adults\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.adults) {\n          return dataLayer[0].basket.price.paxDetails.adults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfAdults) {\n          return dataLayer[0].product.noOfAdults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfAdults) {\n          return dataLayer[0].page.search.noOfAdults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfChildren&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfChildren) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfChildren &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfChildren;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Children) {\n          return parseInt(tui.analytics.page.Children);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.children\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.children;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfChildren &gt;= 0)) {\n          return dataLayer[0].product.noOfChildren;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfChildren &gt;= 0)) {\n          return dataLayer[0].page.search.noOfChildren;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfInfants&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfInfants) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfInfants &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfInfants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Infants) {\n          return parseInt(tui.analytics.page.Infants);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.infants\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.infants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfInfants &gt;= 0)) {\n          return dataLayer[0].product.noOfInfants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfInfants &gt;= 0)) {\n          return dataLayer[0].page.search.noOfInfants;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfPax&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n          return tui.analytics.page.Pax;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n          return dataLayer[0].transactions.total.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n          return dataLayer[0].basket.price.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n          return dataLayer[0].product.noOfPax.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n          return dataLayer[0].page.search.noOfPax.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfResults&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Results) {\n          return tui.analytics.page.Results;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfResults) {\n          return dataLayer[0].page.search.noOfResults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;onlineDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n          return tui.analytics.page.Disc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n          return Math.round(dataLayer[0].transactions.total.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n          return Math.round(dataLayer[0].basket.price.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n          return Math.round(dataLayer[0].product.discount).toString();\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n          return Math.round(jsonData.packageViewData.onlineDiscount).toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) {\n          return tui.analytics.page.pageUid;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) {\n          return dataLayer[0].page.pageID;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeCount&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          return '1';\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeFullyLoaded&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.loadEventEnd - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeInteractive&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.domInteractive - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageNameTemporary&quot;] = (function() {\n\n      try {\n\n        var path = document.location.href;\n        var pathArray = path.split('/');\n\n\n        if (document.location.hostname.indexOf('thomson.co.uk') != -1 || document.location.hostname.indexOf('thomsonprjuat.co.uk') != -1 || document.location.hostname.indexOf('tui.co.uk') != -1 || document.location.hostname.indexOf('tuiprjuat.co.uk') != -1) {\n          // TUI Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;tui:homepage&quot;;\n          }\n          // TUI Cruise\n          if (document.location.pathname.match(/^\\/$|^\\/cruise/) !== null) {\n            return &quot;tui:cruises&quot;;\n          }\n          // TUI Flights\n          if (document.location.pathname.match(/^\\/$|^\\/flight/) !== null) {\n            return &quot;tui:flights&quot;;\n          }\n          // TUI Deals\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals/) !== null) {\n            return &quot;tui:deals:&quot; + (pathArray[5]);\n          }\n          // CR Deals - this needs updating\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/info\\/summer-2016-cruises/) !== null) {\n            return &quot;tui:cruises:deals:&quot; + (pathArray[5]);\n          }\n          // Flight Deals\n          if (document.location.pathname.match(/^\\/$|^\\/flight\\/deals/) !== null) {\n            return &quot;tui:flights:deals&quot;;\n          }\n          // Deals Landing Page\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/holiday-destinations/) !== null) {\n            return &quot;tui:hol:destinations&quot;;\n          }\n          // TUI Country Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\/|^\\/destinations\\/africa\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]);\n          }\n          // TUI Region/Destination Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[6]);\n          }\n          // TUI Resort Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n          // TUI Hotel Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\/.*\\/.*/) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n        } else if (document.location.hostname.indexOf('firstchoice.co.uk') != -1 || document.location.hostname.indexOf('firstchoiceprjuat.co.uk') != -1) {\n          // FC Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fc:homepage&quot;;\n          }\n          // FC Deals\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/deals\\/|^\\/holiday\\/deals/) !== null) {\n            return &quot;fc:deals:&quot; + (pathArray[5]);\n          }\n          // FC Deals Landing\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/destinations/) !== null) {\n            return &quot;fc:hol:destinations&quot;;\n          }\n        } else if (document.location.hostname.indexOf('falconholidays.ie') != -1 || document.location.hostname.indexOf('falconholidaysprjuat.ie') != -1 || document.location.hostname.indexOf('tuiholidays.ie') != -1 || document.location.hostname.indexOf('tuiholidaysprjuat.ie') != -1) {\n          // TUI IE Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fal:homepage&quot;;\n          }\n          // TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/deals\\/|^\\/f\\/deals/) !== null) {\n            return &quot;fal:deals:&quot; + (pathArray[5]);\n          }\n          //TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/holiday-destinations/) !== null) {\n            return &quot;fal:hol:destinations&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pagePath&quot;] = (function() {\n      try {\n        if (window.location.pathname) {\n          var pagePath = window.location.pathname + window.location.search;\n          return pagePath;\n        } else {\n          return &quot;error&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageSubCategory&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.pageUid &amp;&amp; tui.analytics.pageUid == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else {\n          return dataLayer[0].page.pageSubCategory;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageURL&quot;] = (function() {\n      try {\n        var url = [location.protocol, '//', location.host, location.pathname].join('');\n        return url;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;paymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paymentType) {\n          return dataLayer[0].transactions.total.paymentType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;ppcVariant&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('ppcvariant') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;ppcvariant=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;preferredSearchAvailable&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isPreferredSearchAvailable) {\n          return dataLayer[0].page.search.isPreferredSearchAvailable;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;price&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          if (tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0) {\n            return (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) + parseFloat(tui.analytics.page.Sum)).toString();\n          } else {\n            return tui.analytics.page.Sum;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          if (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount + dataLayer[0].transactions.total.totalPrice).toString();\n          } else {\n            return dataLayer[0].transactions.total.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          if (dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].basket.items.bookingLevelCreditNoteDiscount + dataLayer[0].basket.price.totalPrice).toString();\n          } else {\n            return dataLayer[0].basket.price.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;priceVariationAlert&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n          var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n          var price = document.querySelectorAll('.alertprice');\n\n          if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n            return &quot;Price Increased|&quot; + price[0].innerText.replace(/[£€]/g, '');\n          } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n            return &quot;Price Decreased|&quot; + -price[0].innerText.replace(/[£€]/g, '');\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Analytics Experience&quot;] = (function() {\n      try {\n        var experience = Bootstrapper.gateway &amp;&amp; Bootstrapper.gateway.getCookie ? Bootstrapper.gateway.getCookie('Experience') : Bootstrapper.Cookies.get ? Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') : '';\n        switch (experience) {\n          case 'A':\n            return 'cookie consent - modal experience A';\n          case 'B':\n            return 'cookie consent - banner experience B';\n          case 'C':\n            return 'cookie consent - control experience C';\n          case 'Av2':\n            return 'cookie consent - modal experience A v2';\n          case 'Bv2':\n            return 'cookie consent - modal experience B v2';\n          case 'Cv2':\n            return 'cookie consent - modal experience C v2 - control';\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Experience&quot;] = (function() {\n      try {\n        return Bootstrapper.gateway ? Bootstrapper.gateway.getCookie('Experience') : undefined;\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories&quot;] = (function() {\n      try {\n        var types = Bootstrapper.gateway.getCookieTypes(),\n          cookiesNotSet = [],\n          returnVal = [];\n\n        for (var i = 0; i &lt; types.length; i++) {\n          var currentType = types[i];\n          if (Bootstrapper.gateway.getCookie(currentType) === '0') {\n            returnVal.push(currentType);\n          } else if (!Bootstrapper.gateway.getCookie(currentType)) {\n            cookiesNotSet.push(currentType);\n          }\n        }\n\n        if (cookiesNotSet.length === types.length) {\n          // cookies have not been set\n          return undefined;\n        } else if (returnVal.length === 0) {\n          return 'all categories accepted';\n        }\n        return returnVal.join(',').toLowerCase();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories Page Load&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') == 'C') {\n          return 'not applicable';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'personalisation,targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'all categories accepted';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'personalisation';\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SubProd) {\n          return tui.analytics.page.SubProd;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionCode) {\n          return dataLayer[0].transactions.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionCode) {\n          return dataLayer[0].basket.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionCode) {\n          return dataLayer[0].product.productCollectionCode;\n        }\n\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionName) {\n          return dataLayer[0].transactions.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionName) {\n          return dataLayer[0].basket.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionName) {\n          return dataLayer[0].product.productCollectionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productID&quot;] = (function() {\n      try {\n        // WhereTo for both regular holidays and cruises\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.productID) {\n            return dl.transactions.items.productID;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.productID) {\n            return dl.basket.items.productID;\n          } else if (dl.product &amp;&amp; dl.product.productID) {\n            return dl.product.productID;\n          } else if (dl.page.search &amp;&amp; dl.page.search.destinationId) {\n            return dataLayer[0].page.search.destinationId;\n          }\n\n\n\n\n        } else {\n          if (String(typeof tui.analytics.page.CRWhereTo) !== 'undefined') {\n            return tui.analytics.page.CRWhereTo;\n          } else if (String(typeof tui.analytics.page.WhereTo) !== 'undefined') {\n            return tui.analytics.page.WhereTo;\n          }\n        }\n        return 'none';\n      } catch (err) {\n        return 'none';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productTypeMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;#content &gt; div &gt; div.summary.review &gt; div.basket.payment-summary &gt; div &gt; div:nth-child(1) &gt; h3:nth-child(1) &gt; span&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeFreeAmends&quot;] = (function() {\n      try {\n        var freeDaysOriginal = '',\n          freeDaysLeft = '';\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysOriginal != undefined &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysLeft != undefined) {\n          if (dataLayer[0].user.currentBookings.freeAmendDaysOriginal == 0) {\n            freeDaysOriginal = 'Zero';\n          } else {\n            freeDaysOriginal = dataLayer[0].user.currentBookings.freeAmendDaysOriginal.toString();\n          }\n          if (dataLayer[0].user.currentBookings.freeAmendDaysLeft == 0) {\n            freeDaysLeft = 'Zero';\n          } else {\n            freeDaysLeft = dataLayer[0].user.currentBookings.freeAmendDaysLeft.toString();\n          }\n          return freeDaysOriginal + '|' + freeDaysLeft;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeIncentiveCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n\n          if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n              return dataLayer[0].transactions.total.bookingLevelPromoCode;\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n              return dataLayer[0].basket.price.bookingLevelPromoCode;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n              return tui.analytics.page.PromoCode;\n            }\n          }\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeMemoNotes&quot;] = (function() {\n      // Returns a comma separated list of memo notes from the memoNotes array\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.memoNotes) {\n          var results = [];\n          var memoArray = dataLayer[0].user.currentBookings.memoNotes;\n\n          for (i = 0; i &lt; memoArray.length; i++) {\n            results.push(memoArray[i].memoNoteCode);\n          }\n\n          if (results.length &gt; 0) {\n            return results.join(&quot;,&quot;)\n          } else {\n            return undefined;\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\ntry {\t\n\tb[&quot;promoCodeName&quot;] = (function() {\n\t  try {\n\t\tvar rgx = new RegExp('^((?!(CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV)).)*$', 'i');\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult = promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult = promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.PromoCode)) {\n\t\t\t\treturn tui.analytics.page.PromoCode;\n\t\t\t} \n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.bookingLevelPromoCode)) {\n\t\t\t\treturn tui.analytics.page.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].transactions.total.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].basket.price.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else {\n\t\t\treturn 'null';\n\t\t}\n\t  } catch (err) {\n\t\treturn &quot;&quot;;\n\t  }\n\t})()\n  } catch (e) {\n    logError(e)\n  }\t\n  \n\n  try {\t\n\tb[&quot;promoCodeValue&quot;] = (function() {\n\t  try {\n\t\tvar rgx = new RegExp('^((?!(CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV)).)*$', 'i');\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult =  promoCodeArray[i].bookingLevelPromoDiscount;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult =  promoCodeArray[i].bookingLevelPromoDiscount;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.PromoCode)) {\n\t\t\t\treturn tui.analytics.page.PromoValue;\n\t\t\t} \n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.bookingLevelPromoCode)) {\n\t\t\t\treturn tui.analytics.page.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].transactions.total.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].basket.price.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else {\n\t\t\treturn 'null';\n\t\t}\n\t  } catch (err) {\n\t\treturn &quot;&quot;;\n\t  }\n\t})()\n  } catch (e){\n\t  logError(e)\n  }\n\n  try {\n    b[&quot;protocol&quot;] = (function() {\n      try {\n        if (window.location &amp;&amp; window.location.protocol) {\n          return window.location.protocol;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;purchaseID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref &amp;&amp; tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react') {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pushData&quot;] = (function() {\n\n      function getParameterByName(name, url) {\n        if (!url) url = window.location.href;\n        name = name.replace(/[\\[\\]]/g, '\\\\$&amp;');\n        var regex = new RegExp('[?&amp;]' + name + '(=([^&amp;#]*)|&amp;|#|$)'),\n          results = regex.exec(url);\n        if (!results) return null;\n        if (!results[2]) return '';\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n      }\n\n      try {\n        var host = window.location.host,\n          imid = getParameterByName('im_id'),\n          ipid = getParameterByName('ip_id');\n\n        if (host &amp;&amp; ipid &amp;&amp; imid === 'Push') {\n          return host + '|' + 'PushNotification' + '.' + ipid + '.' + ipid + '.' + ipid\n        } else {\n          return ''\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryString&quot;] = (function() {\n      try {\n        return document.URL.split('?')[1];\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamCmid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cmid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  try {\n    b[&quot;queryStringParamGaid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ga_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n\n  try {\n    b[&quot;queryStringParamGclid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;gclid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIkid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ik_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIto&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ito=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamQ&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;q=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamVlid&quot;] = (function() {\n      try {\n        return Bootstrapper.getQueryParam('vlid') || Bootstrapper.getQueryParam('vlids') || Bootstrapper.getQueryParam('VLID');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionCode) {\n          return dataLayer[0].transactions.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionCode) {\n          return dataLayer[0].basket.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionCode) {\n          return dataLayer[0].product.geo.regionCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionName) {\n          return dataLayer[0].transactions.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionName) {\n          return dataLayer[0].basket.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionName) {\n          return dataLayer[0].product.geo.regionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortID) {\n          return dataLayer[0].transactions.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortID) {\n          return dataLayer[0].basket.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortID) {\n          return dataLayer[0].product.geo.resortID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortName) {\n          return dataLayer[0].transactions.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortName) {\n          return dataLayer[0].basket.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortName) {\n          return dataLayer[0].product.geo.resortName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName) {\n          return jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;retailVisitorIDValueChange&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RetVisID) {\n          return tui.analytics.page.RetVisID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;returnDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate &amp;&amp; tui.analytics.page.MonthYear) {\n          var date1 = tui.analytics.page.DepDate;\n          var month1 = tui.analytics.page.MonthYear.substring(0, 2);\n          var year1 = tui.analytics.page.MonthYear.substring(3, 7);\n          var duration = (window.location.href.indexOf('/cruise/book/') &gt; -1) ? tui.analytics.page.CRDur : tui.analytics.page.Dur;\n          var addition = parseInt(date1, 10) + parseInt(duration, 10);\n          var depDate = new Date(year1, month1, date1);\n          var outDate = new Date(depDate);\n          outDate.setDate(addition);\n          var date2 = String(outDate.getDate());\n          var date3;\n          var d = date2.length;\n          if (d == 2) {\n            date3 = date2;\n          }\n          if (d == 1) {\n            date3 = '0' + date2;\n          }\n          var month2 = String(outDate.getMonth());\n          var month3;\n          var m = month2.length;\n          if (m == 2) {\n            month3 = month2;\n          }\n          if (m == 1) {\n            month3 = '0' + month2;\n          }\n\n          var year2 = outDate.getFullYear();\n          var lastDate = year2 + '-' + month3 + '-' + date3;\n          return lastDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.returnDate) {\n          return dataLayer[0].transactions.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.returnDate) {\n          return dataLayer[0].basket.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.returnDate) {\n          return dataLayer[0].product.returnDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;revenueMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;.grand-total.align-right&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomAllocation&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmAlloc) {\n          return tui.analytics.page.RmAlloc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomComposition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults &amp;&amp; tui.analytics.page.Children &amp;&amp; tui.analytics.page.Infants) {\n          return tui.analytics.page.Adults + '/' + window.tui.analytics.page.Children + '/' + window.tui.analytics.page.Infants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Party) {\n          return tui.analytics.page.Party;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.roomComposition) {\n          return dataLayer[0].transactions.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.roomComposition) {\n          return dataLayer[0].basket.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.roomComposition) {\n          return dataLayer[0].product.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].roomComposition) {\n          return dataLayer[0].page.search.resultsList[0].roomComposition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomOrCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmSlt) {\n          return tui.analytics.page.RmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;screenSizeIncludingIPhones&quot;] = (function() {\n      try {\n        if (typeof screen.width === &quot;number&quot; &amp;&amp; typeof screen.height === &quot;number&quot;) {\n          return (screen.width + &quot;x&quot; + screen.height);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDepartureDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OrigDepDate) {\n          return tui.analytics.page.OrigDepDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationIDs&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationId) {\n          return dataLayer[0].page.search.searchedDestinationId;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationNames&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationName) {\n          return dataLayer[0].page.search.searchedDestinationName;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchResultsFinalPosition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FinPos) {\n          return tui.analytics.page.FinPos;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.finalPosition) {\n          return dataLayer[0].product.finalPosition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SearchType &amp;&amp; tui.analytics.page.SearchType != 'null') {\n          return tui.analytics.page.SearchType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchType) {\n          return dataLayer[0].page.search.searchType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;season&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          var season = '';\n          var d = tui.analytics.page.MonthYear.split('/');\n          var m = d[0];\n          var y = d[1].slice(-2);\n\n          if (m &gt;= 1 &amp;&amp; m &lt;= 4) {\n            season = 'W' + (y - 1);\n          } else if (m &gt;= 5 &amp;&amp; m &lt;= 10) {\n            season = 'S' + y;\n          } else if (m &gt;= 11) {\n            season = 'W' + y;\n          }\n          return season;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureSeason) {\n          return dataLayer[0].transactions.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureSeason) {\n          return dataLayer[0].basket.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureSeason) {\n          return dataLayer[0].product.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].departureSeason) {\n          return dataLayer[0].page.search.resultsList[0].departureSeason;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sellingCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.sellingCode) {\n          return String(dataLayer[0].transactions.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.sellingCode) {\n          return String(dataLayer[0].basket.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.sellingCode) {\n          return String(dataLayer[0].product.sellingCode);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.sessionID) {\n          return tui.analytics.sessionID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.sessionState) {\n          return tui.analytics.page.sessionState;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.sessionState) {\n          return dataLayer[0].page.sessionState;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;shortlist&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Shortlist) {\n          return tui.analytics.page.Shortlist;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSection&quot;] = (function() {\n      try {\n        // function for returning Site Section, used in Adobe Site Section (s.channel). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/04/19\n        var b = Bootstrapper.getQueryParam('b'),\n          host = location.host,\n          path = location.pathname;\n\n        if (~host.indexOf('thomson.co.uk') || ~host.indexOf('thomsonprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || (location.pathname.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) !== null) &amp;&amp; (location.pathname.match(/cruise(s?)/) === null)) {\n            return 'TH Beach';\n          } else if (~host.indexOf('flights.thomson.co.uk') || ~host.indexOf('flights.thomsonprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TH Flight-Only';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TH Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TH Accomm Only';\n          }\n        } else if (~host.indexOf('firstchoice.co.uk') || ~host.indexOf('firstchoiceprjuat.co.uk')) {\n          if (~b.indexOf('31000') || ~b.indexOf('10000') || ~b.indexOf('52000') || ~b.indexOf('20000') || ~b.indexOf('42000') || path.match(/^\\/$|^\\/holiday\\/?|^\\/holidays\\/?|^\\/sun-holidays\\/?|^\\/last-minute-holidays\\/?|^\\/destinations\\/?|^\\/departure-airports\\/?|^\\/last-minute-deals\\/?|^\\/2wentys|^\\/myholidayalerts/)) {\n            return 'FC Beach';\n          } else if (~b.indexOf('12000') || path.match(/^\\/$|^\\/hotels\\/|^\\/accom\\//)) {\n            return 'FC Accomm Only';\n          } else if (path === '/') {\n            return 'FC Beach';\n          }\n        } else if (~host.indexOf('falconholidays.ie') || ~host.indexOf('falconholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'Falcon';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'Falcon FO';\n          }\n        } else if (~host.indexOf('retailagents.tui.co.uk') || ~host.indexOf('retailagents.tuiprjuat.co.uk')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (~host.indexOf('retailagents.tuiholidays.ie') || ~host.indexOf('retailagents.tuiholidaysprjuat.ie')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        } else if (~host.indexOf('tui.co.uk') || ~host.indexOf('tuiprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || ~b.indexOf('51000') || path.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) &amp;&amp; !path.match(/cruise(s?)/)) {\n            return 'TUI UK Beach';\n          } else if (~host.indexOf('flights.tui.co.uk') || ~host.indexOf('flights.tuiprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || ~b.indexOf('59000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI UK Flight-Only';\n          } else if (~b.indexOf('58000') || path.match(/^\\/$|^\\/river-cruise(s?)\\/|^\\/river-cruise-deals\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TUI UK Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TUI UK Accomm Only';\n          }\n        }\n        if (~host.indexOf('tuiholidays.ie') || ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || ~b.indexOf('53000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'TUI IE Beach';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || ~b.indexOf('60000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI IE Flight-Only';\n          }\n        } else if (host.match(/(tuiretailhish\\-(live|st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (host.match(/(falconretailhish\\-(live|st.*|hyd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        }\n        return '';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSubSection&quot;] = (function() {\n      try {\n        // function for returning Site SubSection (evar1). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 24/10/17\n        var pageUid = '',\n          geoLevel = '',\n          host = location.host,\n          path = location.pathname;\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          pageUid = tui.analytics.page.pageUid || '';\n          geoLevel = tui.analytics.page.contextType || '';\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          pageUid = dataLayer[0].page.pageID || '';\n          geoLevel = dataLayer[0].page.pageCategory || '';\n        }\n\n        if (~host.indexOf('thomson.co.uk') ||\n          ~host.indexOf('thomsonprjuat.co.uk') ||\n          ~host.indexOf('flights.thomson.co.uk') ||\n          ~host.indexOf('flights.thomsonprjuat.co.uk') ||\n          ~host.indexOf('firstchoice.co.uk') ||\n          ~host.indexOf('firstchoiceprjuat.co.uk') ||\n          ~host.indexOf('falconholidays.ie') ||\n          ~host.indexOf('falconholidaysprjuat.ie') ||\n          ~host.indexOf('tui.co.uk') ||\n          ~host.indexOf('tuiprjuat.co.uk') ||\n          ~host.indexOf('flights.tui.co.uk') ||\n          ~host.indexOf('flights.tuiprjuat.co.uk') ||\n          ~host.indexOf('tuiholidays.ie') ||\n          ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (path === '/') {\n            return 'Home Page/Landing Page';\n          } else if (path.match(/^\\/$|^\\/blog|^\\/blog\\//)) {\n            return 'Blog';\n          } else if (path.match(/^\\/$|^\\/holidays\\/lakes-and-mountains|^\\/destinations\\/info\\/why-lakes-and-mountains|^\\/destinations\\/deals\\/italian-lakes-deals|^\\/destinations\\/deals\\/lakes-mountains-platinum|^\\/destinations\\/deals\\/austria-deals|^\\/destinations\\/deals\\/lake-garda-deals|^\\/destinations\\/deals\\/lakes-mountains-summer-holidays/)) {\n            return 'Lakes &amp; Mountains';\n          } else if ((pageUid === 'lastMinuteHolidayFinderPage') || (pageUid == 'page_00000IIZ') || path.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals|^\\/deals\\/summer-2016-cruises|^\\/holiday\\/deals\\/|^\\/holiday\\/deals|^\\/f\\/deals\\/|^\\/f\\/deals|^\\/flight\\/deals|^\\/flight\\/deals\\//)) {\n            return 'Deals';\n          } else if (path.match(/^\\/$|^\\/destinations\\/multi-centre\\/|^\\/holidays\\/multi-centre/)) {\n            return 'MultiCentres';\n          } else if (/^(ACCOMMODATION|RESORT|DESTINATION|REGION|COUNTRY|destinationlanding|ATTRACTION|ITINERARY|PORTS OF CALL|CRUISE REGION LANDING|CRUISE DESTINATION LANDING|SHIPS LANDING|SHIP|CRUISE &amp; STAY LANDING|cruise-calender|ONBOARD-EXPERIENCE|PORTS OF CALL LANDING)$/.test(geoLevel) || path.match(/^\\/$|^\\/thomson\\/en-GB\\/timetable\\/default|^\\/flight\\/arrivals-and-departures|^\\/destinations\\/product\\/|^\\/holidays\\/|^\\/holiday\\/product\\/|^\\/holiday\\/inventory\\/|^\\/holiday\\/collections\\/|^\\/f\\/products\\/|^\\/f\\/holidays\\/|^\\/sun-holidays\\/|^\\/destinations\\/viewAnonymousShortlist\\/|^\\/holiday\\/viewAnonymousShortlist\\/|^\\/en\\/destination\\/|^\\/flights\\//)) {\n            return 'Browse';\n          } else if ((pageUid === 'travel-information') || path.match(/^\\/$|^\\/holiday-extras.html|^\\/editorial\\/|^\\/gsa\\/|^\\/affiliates.html|^\\/information\\/|^\\/our-policies\\/|^\\/contact-us\\/|^\\/myapp\\/|^\\/destinations\\/shop-finder\\/|^\\/holiday\\/shop-finder\\/|^\\/holiday\\/faqCategories\\/|^\\/f\\/faqCategories\\/|^\\/f\\/travel-information\\/|^\\/all-inclusive-calculator\\/|^\\/about-us\\/|^\\/destinations\\/info\\/|^\\/destinations\\/faqCategories|^\\/myapp\\//)) {\n            return 'Editorial';\n          } else if (path.match(/^\\/$|^\\/destinations\\/book\\/|^\\/holiday\\/book\\/|^\\/f\\/book\\/|^\\/cruise\\/book\\/|^\\/flight\\/book\\/|^\\/cruise\\/bookitineraries\\/|^\\/cruise\\/packages\\/hotels|^\\/cruise\\/bookHotelDetails|^\\/destinations\\/bookaccommodation|^\\/holiday\\/bookaccommodation|^\\/cps\\/pageRender|^\\/f\\/bookaccommodation/)) {\n            return 'Bookflow';\n          } else if (path.match(/^\\/$|^\\/destinations\\/packages|^\\/holiday\\/packages|^\\/f\\/packages|^\\/cruise\\/packages|^\\/flight\\/search/)) {\n            return 'Search';\n          } else if (path.match(/^\\/$|^\\/destinations\\/manage\\/|^\\/t\\//)) {\n            return 'Customer Account';\n          } else if (path.match(/^\\/$|^\\/cruise|^\\/flight/)) {\n            return 'Home Page/Landing Page';\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgRef) {\n          return tui.analytics.page.SrcBkgRef;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.bookingReference) {\n          return dataLayer[0].user.currentBookings.bookingReference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingSystem&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgSys) {\n          return tui.analytics.page.SrcBkgSys;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - CD - BOARD&quot;] = (function() {\n      return tui.analytics.page.Board;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Affiliation&quot;] = (function() {\n      return &quot;CruiseDeals.co.uk&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - BrandName&quot;] = (function() {\n      return &quot;Marella Cruises&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Category&quot;] = (function() {\n      return &quot;Cruise&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRType&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CruiseId&quot;] = (function() {\n      //Ship name, destination(s), depDate and Duration\n      return tui.analytics.page.CRShip + '-' + tui.analytics.page.CRWhereTo + '-' + tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear + '-' + tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRWhereTo&quot;] = (function() {\n      return tui.analytics.page.CRWhereTo;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - DepartureDate&quot;] = (function() {\n      return tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Discount&quot;] = (function() {\n      return tui.analytics.page.Disc;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration - New&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - ShipName&quot;] = (function() {\n      return tui.analytics.page.CRShip;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Sum&quot;] = (function() {\n      return tui.analytics.page.Sum;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Variant&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPAnc) {\n          return tui.analytics.page.TPAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPB) {\n          return tui.analytics.page.TPB;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBedsSupplier&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPBSupp) {\n          return tui.analytics.page.TPBSupp;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyFlightDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPFU) {\n          return tui.analytics.page.TPFU;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;top5SearchResults&quot;] = (function() {\n      try {\n        var FBdata;\n        var arr = [];\n        var sr = jsonData.searchResult.holidays;\n\n        sr.forEach(function(e) {\n          FBData = e.itinerary.outbounds[0].departureAirportCode + '|' + e.accommodation.code;\n          arr.push(FBData);\n        });\n\n        return arr.slice(0, 5).join();\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tradingCycle&quot;] = (function() {\n      // Function for returning Trading Cycle, based on Days To Departure. The UK trading team uses Early and Late classification, so any bookings \n      // made within 84 days (12 weeks) to departure are defined as late and greater than 84 days to dept are early .\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          if (dataLayer[0].transactions.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].transactions.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          if (dataLayer[0].basket.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].basket.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          if (dataLayer[0].product.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].product.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (typeof tui != &quot;undefined&quot; &amp;&amp; typeof tui.analytics != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page.DepDate != &quot;undefined&quot;) {\n          // todays date\n          var date1 = new Date();\n          // dep  date\n          var depdate = ((typeof window.tui.analytics.page.MonthYear !== 'undefined') ? ((window.tui.analytics.page.DepDate || '') + '/' + window.tui.analytics.page.MonthYear) : '');\n          var splitDate = depdate.split('/');\n\n          day = splitDate[0];\n          daystring = day.toString();\n          month = splitDate[1];\n          monthstring = month.toString();\n          year = splitDate[2];\n          yearstring = year.toString();\n\n          var slash = &quot;/&quot;;\n\n          daterage = monthstring + slash + daystring + slash + yearstring;\n          date3 = new Date(daterage);\n\n          var timeDiff = Math.abs(date3.getTime() - date1.getTime());\n          var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));\n          var tradingCycle = '';\n          if (diffDays &lt;= 84) {\n            tradingCycle = &quot;late&quot;;\n          }\n          if (diffDays &gt; 84) {\n            tradingCycle = &quot;early&quot;;\n          }\n\n          return tradingCycle;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorEventID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; taeventid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; typeof dataLayer[0].transactions.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].transactions.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; typeof dataLayer[0].basket.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].basket.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; typeof dataLayer[0].product.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].product.tripAdvisorProductRating);\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARating &amp;&amp; typeof tui.analytics.page.TARating != 'undefined') {\n          return tui.analytics.page.TARating;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripType&quot;] = (function() {\n      try {\n        var url = location.href;\n\n        if (url.indexOf(&quot;flight/book&quot;) &gt; -1) {\n          return tui.analytics.page.FltType;\n        } else if (url.indexOf(&quot;cruise/book&quot;) &gt; -1) {\n          if (typeof(tui.analytics.page.CRType) == &quot;undefined&quot;) {\n            return &quot;null&quot;;\n          } else {\n            return tui.analytics.page.CRType;\n          }\n        } else {\n          return '';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;trv_reference&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; trv_reference=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tuiProductRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TUIRating) {\n          return tui.analytics.page.TUIRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.tuiProductRating) {\n          return dataLayer[0].product.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.tuiProductRating) {\n          return dataLayer[0].basket.items.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.tuiProductRating) {\n          return dataLayer[0].transactions.items.tuiProductRating;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPrice&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          return tui.analytics.page.Sum;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          return dataLayer[0].transactions.total.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          return dataLayer[0].basket.price.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPromoCodeName&quot;] = (function() {\n    try {\n        var strArray = [];\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode.length &gt; 0 &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n            strArray.push(tui.analytics.page.bookingLevelCreditNoteCode.split(':')[0]);\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; typeof(tui.analytics.page.IncentivePromoCode) != &quot;undefined&quot;){\n                strArray.push(tui.analytics.page.IncentivePromoCode); \n            } \n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0){\n                strArray.push(tui.analytics.page.PromoCode);\n            } \n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode.length &gt; 0) {\n            if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n\t\t        for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t        strArray.push(promoCodeArray[i].bookingLevelPromoCode);\n\t\t\t    }\n\t        } else {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n            }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0) {\n            strArray.push(tui.analytics.page.PromoCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCode);\n        } else if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode);\n        } else {\n\t\t    return '';\n\t    }\n\t    return strArray.join(&quot;|&quot;);\n    } catch (err) {\n        return &quot;&quot;;\n    }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {}\n  }\n\n  try {\n    b[&quot;userAgent&quot;] = (function() {\n      try {\n        return navigator.userAgent\n      } catch (e) {\n        return 'error'\n      }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {\n      utag.DB(e)\n    } else {}\n  }\n\n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}"}},"draftSeq":"2","draftSnippets":{"2c146094b27fac381a79410cbc300e3b2db93d6ce0f177ec54c927dc16a89b89":{"code":"// enables console testing (but still works in Tealium iQ)\nvar b = b || (utag &amp;&amp; utag.data) || {}\n\nvar legacyPrefix = 'legacy_'\n\n// spoof some Ensighten functionality\nvar Bootstrapper = {}\nBootstrapper.ensightenOptions = {}\nBootstrapper.ensightenOptions.publishPath = b.tealium_environment === 'prod' ? 'hybrisprod' : 'hybrisdev';\n\nBootstrapper.getQueryParam = function (qp_name) {\n  var b = b || {}\n  return b['qp.' + qp_name] || &quot;&quot;\n}\n\n/*\n// there were only three instances of this being called and the timing was tricky, so I modified the below code a touch\nBootstrapper.data = {}\nBootstrapper.data.resolve = function (name) {\n  name = getCleanLegacyNameForLookup(name)\n  console.log('RESOLVING ' + name + ' to ' + b[name] )\n  return b[name]\n}\n*/\n\nfunction getCleanLegacyNameForLookup (longEnsightenName) {\n  var arr = longEnsightenName.split('.')\n  var lastString = arr[arr.length - 1]\n  var cleanWithLegacyPrefix = legacyPrefix + getSanitizedVariableName(lastString)\n  return cleanWithLegacyPrefix\n}\n\nBootstrapper.Cookies = {}\nBootstrapper.Cookies.get = function (cookieName) {\n  var b = b || {}\n  return b['cp.' + cookieName]\n}\n\n// make sure this object is defined to avoid errors\nwindow.tui = window.tui || {}\nwindow.tui.page = window.tui.page || {}\nwindow.tui.page.analytics = window.tui.page.analytics || {}\n\n// add the legacy ensighten variables\nb = addEnsightenVariables(b)\n\nfunction getSanitizedVariableName (oldName) {\n  // sanitation regex, only allow letters, numbers, underscores, dollar signs,\n  // array brackets, periods (same as TiQ Data Layer interface), remove others\n  var blacklist = /[^0-9A-Z_$\\[\\]\\.]/gi;\n  var spacesAndHyphens = /[\\s-]+/g;\n  // replace groups of spaces and hyphens with underscores\n  newName = oldName.replace(spacesAndHyphens, '_');\n  // sanitize name\n  newName = newName.replace(blacklist, '');\n  return newName\n}\n\nfunction sanitizeAllVariableNames (b) {\n  // Sanitize attribute names to remove any characters that \n  // Tealium doesn't allow (full list in comments):\n  //    - first replace any groups of spaces/hyphens with a single underscore\n  //    - then remove disallowed characters (no replacement character)\n\n\n  // fallback in case scope is changed and to allow console-based testing\n  b = b || {}\n\n  // get the list of attributes\n  var attributes = Object.keys(b);\n\n  // initialize loop vars\n  var i, len, oldName, newName;\n\n  // get the value for each of the keys and add it to b if non-empty\n  for (i = 0, len = attributes.length; i &lt; len; i++) {\n    oldName = attributes[i];\n    newName = getSanitizedVariableName(oldName)\n    if (oldName !== newName) {\n      // copy value\n      b[newName] = b[oldName];\n      // remove old key\n      delete b[oldName];\n    }\n  }\n  return b\n}\n\nfunction logError (e) {\n  console.log(&quot;UDO population function error: &quot; + e)\n}\n\nfunction addEnsightenVariables (b) {\n  b = b || {}\n  b = addUnconditionalEnsightenVariables(b)\n  b = addConditionalEnsightenVariables(b)\n  b = sanitizeAllVariableNames(b)\n  return b\n}\n\nfunction addConditionalEnsightenVariables (originalB) {\n  // a little confusing, but this is the 'new' b and the standard one is called originalB in this function\n  var b = {}\n  // a map of relevant Ensightten condition IDs to Load Rule UIDs\n  var conditionMap = {\n    &quot;205270&quot;: &quot;893&quot;,\n    &quot;205366&quot;: &quot;892&quot;,\n    &quot;205384&quot;: &quot;891&quot;,\n    &quot;205444&quot;: &quot;890&quot;,\n    &quot;231659&quot;: &quot;889&quot;,\n    &quot;275650&quot;: &quot;888&quot;,\n    &quot;292050&quot;: &quot;887&quot;,\n    &quot;306764&quot;: &quot;886&quot;,\n    &quot;317190&quot;: &quot;885&quot;,\n    &quot;318035&quot;: &quot;884&quot;,\n    &quot;319261&quot;: &quot;883&quot;,\n    &quot;321929&quot;: &quot;882&quot;,\n    &quot;321966&quot;: &quot;881&quot;,\n    &quot;322010&quot;: &quot;880&quot;,\n    &quot;323412&quot;: &quot;879&quot;,\n    &quot;326082&quot;: &quot;878&quot;,\n    &quot;330432&quot;: &quot;877&quot;,\n    &quot;334450&quot;: &quot;876&quot;,\n    &quot;338073&quot;: &quot;875&quot;,\n    &quot;338075&quot;: &quot;874&quot;,\n    &quot;342693&quot;: &quot;873&quot;,\n    &quot;356822&quot;: &quot;872&quot;,\n    &quot;381988&quot;: &quot;871&quot;,\n    &quot;381989&quot;: &quot;870&quot;,\n    &quot;381990&quot;: &quot;869&quot;,\n    &quot;381991&quot;: &quot;868&quot;,\n    &quot;386001&quot;: &quot;867&quot;,\n    &quot;386052&quot;: &quot;866&quot;,\n    &quot;386059&quot;: &quot;865&quot;,\n    &quot;386105&quot;: &quot;864&quot;,\n    &quot;386268&quot;: &quot;863&quot;,\n    &quot;386269&quot;: &quot;862&quot;,\n    &quot;386721&quot;: &quot;861&quot;,\n    &quot;392738&quot;: &quot;860&quot;,\n    &quot;392739&quot;: &quot;859&quot;,\n    &quot;392856&quot;: &quot;858&quot;,\n    &quot;393317&quot;: &quot;857&quot;,\n    &quot;398051&quot;: &quot;856&quot;,\n    &quot;413257&quot;: &quot;855&quot;,\n    &quot;413766&quot;: &quot;854&quot;,\n    &quot;415650&quot;: &quot;853&quot;,\n    &quot;416216&quot;: &quot;852&quot;,\n    &quot;420785&quot;: &quot;851&quot;,\n    &quot;420787&quot;: &quot;850&quot;,\n    &quot;421343&quot;: &quot;849&quot;,\n    &quot;423206&quot;: &quot;848&quot;,\n    &quot;441328&quot;: &quot;847&quot;,\n    &quot;455789&quot;: &quot;846&quot;,\n    &quot;461304&quot;: &quot;845&quot;,\n    &quot;461309&quot;: &quot;844&quot;,\n    &quot;463175&quot;: &quot;843&quot;,\n    &quot;470245&quot;: &quot;842&quot;,\n    &quot;470253&quot;: &quot;841&quot;,\n    &quot;470312&quot;: &quot;840&quot;,\n    &quot;470318&quot;: &quot;839&quot;,\n    &quot;473997&quot;: &quot;838&quot;,\n    &quot;476525&quot;: &quot;837&quot;,\n    &quot;476526&quot;: &quot;836&quot;,\n    &quot;476527&quot;: &quot;835&quot;,\n    &quot;476528&quot;: &quot;834&quot;,\n    &quot;480498&quot;: &quot;833&quot;,\n    &quot;480964&quot;: &quot;832&quot;,\n    &quot;481202&quot;: &quot;831&quot;,\n    &quot;483445&quot;: &quot;830&quot;,\n    &quot;491253&quot;: &quot;829&quot;,\n    &quot;493179&quot;: &quot;828&quot;,\n    &quot;493721&quot;: &quot;827&quot;,\n    &quot;496357&quot;: &quot;826&quot;,\n    &quot;501484&quot;: &quot;825&quot;,\n    &quot;501601&quot;: &quot;824&quot;,\n    &quot;510366&quot;: &quot;823&quot;,\n    &quot;513827&quot;: &quot;822&quot;,\n    &quot;635858&quot;: &quot;821&quot;,\n    &quot;635859&quot;: &quot;820&quot;,\n    &quot;635860&quot;: &quot;819&quot;,\n    &quot;635861&quot;: &quot;818&quot;,\n    &quot;635862&quot;: &quot;817&quot;,\n    &quot;635863&quot;: &quot;816&quot;,\n    &quot;636023&quot;: &quot;815&quot;,\n    &quot;636029&quot;: &quot;814&quot;,\n    &quot;636046&quot;: &quot;813&quot;,\n    &quot;648421&quot;: &quot;812&quot;,\n    &quot;649595&quot;: &quot;811&quot;,\n    &quot;649596&quot;: &quot;810&quot;,\n    &quot;649969&quot;: &quot;809&quot;,\n    &quot;650179&quot;: &quot;808&quot;,\n    &quot;650416&quot;: &quot;807&quot;,\n    &quot;650480&quot;: &quot;806&quot;,\n    &quot;650484&quot;: &quot;805&quot;,\n    &quot;650680&quot;: &quot;804&quot;,\n    &quot;650692&quot;: &quot;803&quot;,\n    &quot;650702&quot;: &quot;802&quot;,\n    &quot;650703&quot;: &quot;801&quot;,\n    &quot;650766&quot;: &quot;800&quot;,\n    &quot;650778&quot;: &quot;799&quot;,\n    &quot;650782&quot;: &quot;798&quot;,\n    &quot;650787&quot;: &quot;797&quot;,\n    &quot;650789&quot;: &quot;796&quot;,\n    &quot;650792&quot;: &quot;795&quot;,\n    &quot;651200&quot;: &quot;794&quot;,\n    &quot;653983&quot;: &quot;793&quot;,\n    &quot;664297&quot;: &quot;792&quot;,\n    &quot;664415&quot;: &quot;791&quot;,\n    &quot;664554&quot;: &quot;790&quot;,\n    &quot;664567&quot;: &quot;789&quot;,\n    &quot;664568&quot;: &quot;788&quot;,\n    &quot;664569&quot;: &quot;787&quot;,\n    &quot;664582&quot;: &quot;786&quot;,\n    &quot;664583&quot;: &quot;785&quot;,\n    &quot;664585&quot;: &quot;784&quot;,\n    &quot;664594&quot;: &quot;783&quot;,\n    &quot;664595&quot;: &quot;782&quot;,\n    &quot;664597&quot;: &quot;781&quot;,\n    &quot;664598&quot;: &quot;780&quot;,\n    &quot;664604&quot;: &quot;779&quot;,\n    &quot;664609&quot;: &quot;778&quot;,\n    &quot;664610&quot;: &quot;777&quot;,\n    &quot;664611&quot;: &quot;776&quot;,\n    &quot;664619&quot;: &quot;775&quot;,\n    &quot;664620&quot;: &quot;774&quot;,\n    &quot;664621&quot;: &quot;773&quot;,\n    &quot;664623&quot;: &quot;772&quot;,\n    &quot;664624&quot;: &quot;771&quot;,\n    &quot;664631&quot;: &quot;770&quot;,\n    &quot;671183&quot;: &quot;769&quot;,\n    &quot;671185&quot;: &quot;768&quot;,\n    &quot;671190&quot;: &quot;767&quot;,\n    &quot;671227&quot;: &quot;766&quot;,\n    &quot;671238&quot;: &quot;765&quot;,\n    &quot;671240&quot;: &quot;764&quot;,\n    &quot;671252&quot;: &quot;763&quot;,\n    &quot;671355&quot;: &quot;762&quot;,\n    &quot;682688&quot;: &quot;761&quot;,\n    &quot;686121&quot;: &quot;760&quot;,\n    &quot;686122&quot;: &quot;759&quot;,\n    &quot;686123&quot;: &quot;758&quot;,\n    &quot;686171&quot;: &quot;757&quot;,\n    &quot;686172&quot;: &quot;756&quot;,\n    &quot;686176&quot;: &quot;755&quot;,\n    &quot;686177&quot;: &quot;754&quot;,\n    &quot;686178&quot;: &quot;753&quot;,\n    &quot;686222&quot;: &quot;752&quot;,\n    &quot;686224&quot;: &quot;751&quot;,\n    &quot;686225&quot;: &quot;750&quot;,\n    &quot;686278&quot;: &quot;749&quot;,\n    &quot;696836&quot;: &quot;748&quot;,\n    &quot;696873&quot;: &quot;747&quot;,\n    &quot;696915&quot;: &quot;746&quot;,\n    &quot;698739&quot;: &quot;745&quot;,\n    &quot;698824&quot;: &quot;744&quot;,\n    &quot;701720&quot;: &quot;743&quot;,\n    &quot;701770&quot;: &quot;742&quot;,\n    &quot;701995&quot;: &quot;741&quot;,\n    &quot;702164&quot;: &quot;740&quot;,\n    &quot;717653&quot;: &quot;739&quot;,\n    &quot;717654&quot;: &quot;738&quot;,\n    &quot;717953&quot;: &quot;737&quot;,\n    &quot;717954&quot;: &quot;736&quot;,\n    &quot;718305&quot;: &quot;735&quot;,\n    &quot;718376&quot;: &quot;734&quot;,\n    &quot;758676&quot;: &quot;733&quot;,\n    &quot;763283&quot;: &quot;732&quot;,\n    &quot;767006&quot;: &quot;731&quot;,\n    &quot;794187&quot;: &quot;730&quot;,\n    &quot;821088&quot;: &quot;729&quot;,\n    &quot;835611&quot;: &quot;728&quot;,\n    &quot;836311&quot;: &quot;727&quot;,\n    &quot;840126&quot;: &quot;726&quot;,\n    &quot;840127&quot;: &quot;725&quot;,\n    &quot;840747&quot;: &quot;724&quot;,\n    &quot;840748&quot;: &quot;723&quot;,\n    &quot;840749&quot;: &quot;722&quot;,\n    &quot;853791&quot;: &quot;721&quot;,\n    &quot;853792&quot;: &quot;720&quot;,\n    &quot;882958&quot;: &quot;719&quot;,\n    &quot;887343&quot;: &quot;718&quot;,\n    &quot;899054&quot;: &quot;717&quot;,\n    &quot;899844&quot;: &quot;716&quot;,\n    &quot;901069&quot;: &quot;715&quot;,\n    &quot;901080&quot;: &quot;714&quot;,\n    &quot;901330&quot;: &quot;713&quot;,\n    &quot;901338&quot;: &quot;712&quot;,\n    &quot;901352&quot;: &quot;711&quot;,\n    &quot;962796&quot;: &quot;710&quot;,\n    &quot;1042978&quot;: &quot;709&quot;,\n    &quot;1043130&quot;: &quot;708&quot;,\n    &quot;1081657&quot;: &quot;707&quot;,\n    &quot;1081697&quot;: &quot;706&quot;,\n    &quot;1187972&quot;: &quot;705&quot;,\n    &quot;1187977&quot;: &quot;704&quot;,\n    &quot;1187985&quot;: &quot;703&quot;,\n    &quot;1187989&quot;: &quot;702&quot;,\n    &quot;1187995&quot;: &quot;701&quot;,\n    &quot;1188366&quot;: &quot;700&quot;,\n    &quot;1207206&quot;: &quot;699&quot;,\n    &quot;1207254&quot;: &quot;698&quot;,\n    &quot;1210674&quot;: &quot;697&quot;,\n    &quot;1211596&quot;: &quot;696&quot;,\n    &quot;1211720&quot;: &quot;695&quot;,\n    &quot;1211741&quot;: &quot;694&quot;,\n    &quot;1211742&quot;: &quot;693&quot;,\n    &quot;1211743&quot;: &quot;692&quot;,\n    &quot;1216621&quot;: &quot;691&quot;,\n    &quot;1217836&quot;: &quot;690&quot;,\n    &quot;1217852&quot;: &quot;689&quot;,\n    &quot;1218080&quot;: &quot;688&quot;,\n    &quot;1218101&quot;: &quot;687&quot;,\n    &quot;1219690&quot;: &quot;686&quot;,\n    &quot;1249258&quot;: &quot;685&quot;,\n    &quot;1417083&quot;: &quot;684&quot;,\n    &quot;1417130&quot;: &quot;683&quot;,\n    &quot;1495684&quot;: &quot;682&quot;,\n    &quot;1512996&quot;: &quot;681&quot;,\n    &quot;1512997&quot;: &quot;680&quot;,\n    &quot;1513092&quot;: &quot;679&quot;,\n    &quot;1513465&quot;: &quot;678&quot;,\n    &quot;1513466&quot;: &quot;677&quot;,\n    &quot;1514697&quot;: &quot;676&quot;,\n    &quot;1514864&quot;: &quot;675&quot;,\n    &quot;1514958&quot;: &quot;674&quot;,\n    &quot;1515424&quot;: &quot;673&quot;,\n    &quot;1531045&quot;: &quot;672&quot;,\n    &quot;1531096&quot;: &quot;671&quot;,\n    &quot;1531141&quot;: &quot;670&quot;,\n    &quot;1531422&quot;: &quot;669&quot;,\n    &quot;1532177&quot;: &quot;668&quot;,\n    &quot;1668141&quot;: &quot;667&quot;,\n    &quot;1769738&quot;: &quot;666&quot;,\n    &quot;1778256&quot;: &quot;665&quot;,\n    &quot;2081444&quot;: &quot;664&quot;,\n    &quot;2081446&quot;: &quot;663&quot;,\n    &quot;2082484&quot;: &quot;662&quot;,\n    &quot;2279242&quot;: &quot;661&quot;,\n    &quot;2279323&quot;: &quot;660&quot;,\n    &quot;2503734&quot;: &quot;659&quot;,\n    &quot;2503735&quot;: &quot;658&quot;,\n    &quot;2503818&quot;: &quot;657&quot;,\n    &quot;2518567&quot;: &quot;656&quot;,\n    &quot;2518982&quot;: &quot;655&quot;,\n    &quot;2662663&quot;: &quot;654&quot;,\n    &quot;2662758&quot;: &quot;653&quot;,\n    &quot;2664033&quot;: &quot;652&quot;,\n    &quot;2664082&quot;: &quot;651&quot;,\n    &quot;2665581&quot;: &quot;650&quot;,\n    &quot;2665582&quot;: &quot;649&quot;,\n    &quot;2708240&quot;: &quot;648&quot;,\n    &quot;2712769&quot;: &quot;647&quot;,\n    &quot;2712827&quot;: &quot;646&quot;,\n    &quot;2733381&quot;: &quot;645&quot;,\n    &quot;2733382&quot;: &quot;644&quot;,\n    &quot;2910769&quot;: &quot;643&quot;,\n    &quot;2917920&quot;: &quot;642&quot;,\n    &quot;3565541&quot;: &quot;641&quot;,\n    &quot;3584019&quot;: &quot;640&quot;,\n    &quot;3600994&quot;: &quot;639&quot;,\n    &quot;3834892&quot;: &quot;638&quot;,\n    &quot;4143702&quot;: &quot;637&quot;,\n    &quot;4151405&quot;: &quot;636&quot;,\n    &quot;4151407&quot;: &quot;635&quot;,\n    &quot;4151409&quot;: &quot;634&quot;,\n    &quot;4190389&quot;: &quot;633&quot;,\n    &quot;4821493&quot;: &quot;632&quot;,\n    &quot;4821495&quot;: &quot;631&quot;,\n    &quot;4821610&quot;: &quot;630&quot;,\n    &quot;4821659&quot;: &quot;629&quot;,\n    &quot;4821660&quot;: &quot;628&quot;,\n    &quot;4821661&quot;: &quot;627&quot;,\n    &quot;4821662&quot;: &quot;626&quot;,\n    &quot;4823353&quot;: &quot;625&quot;,\n    &quot;4823354&quot;: &quot;624&quot;,\n    &quot;4823597&quot;: &quot;623&quot;,\n    &quot;4823969&quot;: &quot;622&quot;,\n    &quot;4823970&quot;: &quot;621&quot;,\n    &quot;4824954&quot;: &quot;620&quot;,\n    &quot;4824955&quot;: &quot;619&quot;,\n    &quot;4825150&quot;: &quot;618&quot;,\n    &quot;4825427&quot;: &quot;617&quot;,\n    &quot;4825428&quot;: &quot;616&quot;,\n    &quot;4825462&quot;: &quot;615&quot;,\n    &quot;4825463&quot;: &quot;614&quot;,\n    &quot;4825556&quot;: &quot;613&quot;,\n    &quot;4825566&quot;: &quot;612&quot;,\n    &quot;4825579&quot;: &quot;611&quot;,\n    &quot;4825887&quot;: &quot;610&quot;,\n    &quot;4828711&quot;: &quot;609&quot;,\n    &quot;4828847&quot;: &quot;608&quot;,\n    &quot;4829563&quot;: &quot;607&quot;,\n    &quot;4834079&quot;: &quot;606&quot;,\n    &quot;4834101&quot;: &quot;605&quot;,\n    &quot;4834967&quot;: &quot;604&quot;,\n    &quot;4834971&quot;: &quot;603&quot;,\n    &quot;4835548&quot;: &quot;602&quot;,\n    &quot;4835555&quot;: &quot;601&quot;,\n    &quot;4836637&quot;: &quot;600&quot;,\n    &quot;4836638&quot;: &quot;599&quot;,\n    &quot;4836899&quot;: &quot;598&quot;,\n    &quot;4836986&quot;: &quot;597&quot;,\n    &quot;4836987&quot;: &quot;596&quot;,\n    &quot;4836995&quot;: &quot;595&quot;,\n    &quot;4837297&quot;: &quot;594&quot;,\n    &quot;4837976&quot;: &quot;593&quot;,\n    &quot;4837985&quot;: &quot;592&quot;,\n    &quot;4837986&quot;: &quot;591&quot;,\n    &quot;4837987&quot;: &quot;590&quot;,\n    &quot;4837989&quot;: &quot;589&quot;,\n    &quot;4838170&quot;: &quot;588&quot;,\n    &quot;4838540&quot;: &quot;587&quot;,\n    &quot;4838547&quot;: &quot;586&quot;,\n    &quot;4838593&quot;: &quot;585&quot;,\n    &quot;4840815&quot;: &quot;584&quot;,\n    &quot;4841313&quot;: &quot;583&quot;,\n    &quot;4841758&quot;: &quot;582&quot;,\n    &quot;4842201&quot;: &quot;581&quot;,\n    &quot;4843069&quot;: &quot;580&quot;,\n    &quot;4843070&quot;: &quot;579&quot;,\n    &quot;4843071&quot;: &quot;578&quot;,\n    &quot;4844445&quot;: &quot;577&quot;,\n    &quot;4844447&quot;: &quot;576&quot;,\n    &quot;4844577&quot;: &quot;575&quot;,\n    &quot;4844916&quot;: &quot;574&quot;,\n    &quot;4845253&quot;: &quot;573&quot;,\n    &quot;4845255&quot;: &quot;572&quot;,\n    &quot;4845258&quot;: &quot;571&quot;,\n    &quot;4845356&quot;: &quot;570&quot;,\n    &quot;4845366&quot;: &quot;569&quot;,\n    &quot;4845617&quot;: &quot;568&quot;,\n    &quot;4847129&quot;: &quot;567&quot;,\n    &quot;4847477&quot;: &quot;566&quot;,\n    &quot;4847478&quot;: &quot;565&quot;,\n    &quot;4848441&quot;: &quot;564&quot;,\n    &quot;4848815&quot;: &quot;563&quot;,\n    &quot;4851962&quot;: &quot;562&quot;,\n    &quot;4851964&quot;: &quot;561&quot;,\n    &quot;4852083&quot;: &quot;560&quot;,\n    &quot;4852084&quot;: &quot;559&quot;,\n    &quot;4852282&quot;: &quot;558&quot;,\n    &quot;4852283&quot;: &quot;557&quot;,\n    &quot;4852362&quot;: &quot;556&quot;,\n    &quot;4852363&quot;: &quot;555&quot;,\n    &quot;4852658&quot;: &quot;554&quot;,\n    &quot;4852659&quot;: &quot;553&quot;,\n    &quot;4852660&quot;: &quot;552&quot;,\n    &quot;4853590&quot;: &quot;551&quot;,\n    &quot;4854987&quot;: &quot;550&quot;,\n    &quot;4857995&quot;: &quot;549&quot;,\n    &quot;4858047&quot;: &quot;548&quot;,\n    &quot;4858048&quot;: &quot;547&quot;,\n    &quot;4858051&quot;: &quot;546&quot;,\n    &quot;4858052&quot;: &quot;545&quot;,\n    &quot;4859198&quot;: &quot;544&quot;,\n    &quot;4859386&quot;: &quot;543&quot;,\n    &quot;4860037&quot;: &quot;542&quot;,\n    &quot;4860043&quot;: &quot;541&quot;,\n    &quot;4860384&quot;: &quot;540&quot;,\n    &quot;4860389&quot;: &quot;539&quot;,\n    &quot;4860392&quot;: &quot;538&quot;,\n    &quot;4860393&quot;: &quot;537&quot;,\n    &quot;4860396&quot;: &quot;536&quot;,\n    &quot;4860489&quot;: &quot;535&quot;,\n    &quot;4860666&quot;: &quot;534&quot;,\n    &quot;4861558&quot;: &quot;533&quot;,\n    &quot;4861560&quot;: &quot;532&quot;,\n    &quot;4861724&quot;: &quot;531&quot;,\n    &quot;4861979&quot;: &quot;530&quot;,\n    &quot;4862577&quot;: &quot;529&quot;,\n    &quot;4862583&quot;: &quot;528&quot;,\n    &quot;4862586&quot;: &quot;527&quot;,\n    &quot;4862928&quot;: &quot;526&quot;,\n    &quot;4863228&quot;: &quot;525&quot;,\n    &quot;4863575&quot;: &quot;524&quot;,\n    &quot;4863765&quot;: &quot;523&quot;,\n    &quot;4863775&quot;: &quot;522&quot;,\n    &quot;4863805&quot;: &quot;521&quot;,\n    &quot;4863806&quot;: &quot;520&quot;,\n    &quot;4863807&quot;: &quot;519&quot;,\n    &quot;4863888&quot;: &quot;518&quot;,\n    &quot;4863889&quot;: &quot;517&quot;,\n    &quot;4864153&quot;: &quot;516&quot;,\n    &quot;4864565&quot;: &quot;515&quot;,\n    &quot;4865543&quot;: &quot;514&quot;,\n    &quot;4868062&quot;: &quot;513&quot;,\n    &quot;4868261&quot;: &quot;512&quot;,\n    &quot;4868262&quot;: &quot;511&quot;,\n    &quot;4868283&quot;: &quot;510&quot;,\n    &quot;4868358&quot;: &quot;509&quot;,\n    &quot;4868359&quot;: &quot;508&quot;,\n    &quot;4868360&quot;: &quot;507&quot;,\n    &quot;4868361&quot;: &quot;506&quot;,\n    &quot;4868362&quot;: &quot;505&quot;,\n    &quot;4868392&quot;: &quot;504&quot;,\n    &quot;4868449&quot;: &quot;503&quot;,\n    &quot;4868450&quot;: &quot;502&quot;,\n    &quot;4868451&quot;: &quot;501&quot;,\n    &quot;4868452&quot;: &quot;500&quot;,\n    &quot;4868453&quot;: &quot;499&quot;,\n    &quot;4868454&quot;: &quot;498&quot;,\n    &quot;4868455&quot;: &quot;497&quot;,\n    &quot;4868457&quot;: &quot;496&quot;,\n    &quot;4868458&quot;: &quot;495&quot;,\n    &quot;4869584&quot;: &quot;494&quot;,\n    &quot;4869945&quot;: &quot;493&quot;,\n    &quot;4869951&quot;: &quot;492&quot;,\n    &quot;4869954&quot;: &quot;491&quot;,\n    &quot;4870035&quot;: &quot;490&quot;,\n    &quot;4870036&quot;: &quot;489&quot;,\n    &quot;4870216&quot;: &quot;488&quot;,\n    &quot;4870973&quot;: &quot;487&quot;,\n    &quot;4871232&quot;: &quot;486&quot;,\n    &quot;4871233&quot;: &quot;485&quot;,\n    &quot;4871234&quot;: &quot;484&quot;,\n    &quot;4871236&quot;: &quot;483&quot;,\n    &quot;4871237&quot;: &quot;482&quot;,\n    &quot;4871243&quot;: &quot;481&quot;,\n    &quot;4871370&quot;: &quot;480&quot;,\n    &quot;4871371&quot;: &quot;479&quot;,\n    &quot;4871372&quot;: &quot;478&quot;,\n    &quot;4872478&quot;: &quot;477&quot;,\n    &quot;4872479&quot;: &quot;476&quot;,\n    &quot;4873112&quot;: &quot;475&quot;,\n    &quot;4873113&quot;: &quot;474&quot;,\n    &quot;4873115&quot;: &quot;473&quot;,\n    &quot;4873116&quot;: &quot;472&quot;,\n    &quot;4873541&quot;: &quot;471&quot;,\n    &quot;4873810&quot;: &quot;470&quot;,\n    &quot;4874021&quot;: &quot;469&quot;,\n    &quot;4874022&quot;: &quot;468&quot;,\n    &quot;4874023&quot;: &quot;467&quot;,\n    &quot;4874054&quot;: &quot;466&quot;,\n    &quot;4874525&quot;: &quot;465&quot;,\n    &quot;4874978&quot;: &quot;464&quot;,\n    &quot;4878074&quot;: &quot;463&quot;,\n    &quot;4878311&quot;: &quot;462&quot;,\n    &quot;4878451&quot;: &quot;461&quot;,\n    &quot;4878452&quot;: &quot;460&quot;,\n    &quot;4878453&quot;: &quot;459&quot;,\n    &quot;4878454&quot;: &quot;458&quot;,\n    &quot;4878457&quot;: &quot;457&quot;,\n    &quot;4878459&quot;: &quot;456&quot;,\n    &quot;4878460&quot;: &quot;455&quot;,\n    &quot;4878461&quot;: &quot;454&quot;,\n    &quot;4878462&quot;: &quot;453&quot;,\n    &quot;4878475&quot;: &quot;452&quot;,\n    &quot;4878884&quot;: &quot;451&quot;,\n    &quot;4879254&quot;: &quot;450&quot;,\n    &quot;4879515&quot;: &quot;449&quot;,\n    &quot;4879516&quot;: &quot;448&quot;,\n    &quot;4879518&quot;: &quot;447&quot;,\n    &quot;4879521&quot;: &quot;446&quot;,\n    &quot;4879526&quot;: &quot;445&quot;,\n    &quot;4879546&quot;: &quot;444&quot;,\n    &quot;4879565&quot;: &quot;443&quot;,\n    &quot;4879595&quot;: &quot;442&quot;,\n    &quot;4879598&quot;: &quot;441&quot;,\n    &quot;4879602&quot;: &quot;440&quot;,\n    &quot;4879676&quot;: &quot;439&quot;,\n    &quot;4879678&quot;: &quot;438&quot;,\n    &quot;4879679&quot;: &quot;437&quot;,\n    &quot;4879685&quot;: &quot;436&quot;,\n    &quot;4879704&quot;: &quot;435&quot;,\n    &quot;4879714&quot;: &quot;434&quot;,\n    &quot;4879716&quot;: &quot;433&quot;,\n    &quot;4879808&quot;: &quot;432&quot;,\n    &quot;4879809&quot;: &quot;431&quot;,\n    &quot;4879813&quot;: &quot;430&quot;,\n    &quot;4879814&quot;: &quot;429&quot;,\n    &quot;4879815&quot;: &quot;428&quot;,\n    &quot;4880004&quot;: &quot;427&quot;,\n    &quot;4880008&quot;: &quot;426&quot;,\n    &quot;4880055&quot;: &quot;425&quot;,\n    &quot;4880056&quot;: &quot;424&quot;,\n    &quot;4880058&quot;: &quot;423&quot;,\n    &quot;4880059&quot;: &quot;422&quot;,\n    &quot;4880060&quot;: &quot;421&quot;,\n    &quot;4880061&quot;: &quot;420&quot;,\n    &quot;4880062&quot;: &quot;419&quot;,\n    &quot;4880063&quot;: &quot;418&quot;,\n    &quot;4880064&quot;: &quot;417&quot;,\n    &quot;4880065&quot;: &quot;416&quot;,\n    &quot;4880066&quot;: &quot;415&quot;,\n    &quot;4880598&quot;: &quot;414&quot;,\n    &quot;4880599&quot;: &quot;413&quot;,\n    &quot;4880600&quot;: &quot;412&quot;,\n    &quot;4880601&quot;: &quot;411&quot;,\n    &quot;4880840&quot;: &quot;410&quot;,\n    &quot;4881012&quot;: &quot;409&quot;,\n    &quot;4882458&quot;: &quot;408&quot;,\n    &quot;4885030&quot;: &quot;407&quot;,\n    &quot;4885031&quot;: &quot;406&quot;,\n    &quot;4885035&quot;: &quot;405&quot;,\n    &quot;4885036&quot;: &quot;404&quot;,\n    &quot;4885040&quot;: &quot;403&quot;,\n    &quot;4885041&quot;: &quot;402&quot;,\n    &quot;4885054&quot;: &quot;401&quot;,\n    &quot;4885055&quot;: &quot;400&quot;,\n    &quot;4885056&quot;: &quot;399&quot;,\n    &quot;4885057&quot;: &quot;398&quot;,\n    &quot;4885058&quot;: &quot;397&quot;,\n    &quot;4885059&quot;: &quot;396&quot;,\n    &quot;4885060&quot;: &quot;395&quot;,\n    &quot;4885061&quot;: &quot;394&quot;,\n    &quot;4885406&quot;: &quot;393&quot;,\n    &quot;4885411&quot;: &quot;392&quot;,\n    &quot;4885412&quot;: &quot;391&quot;,\n    &quot;4885470&quot;: &quot;390&quot;,\n    &quot;4886176&quot;: &quot;389&quot;,\n    &quot;4890965&quot;: &quot;388&quot;,\n    &quot;4890966&quot;: &quot;387&quot;,\n    &quot;4890967&quot;: &quot;386&quot;\n  }\n  // expects a space-delimited string of Ensighten condition IDs, returns a boolean that says if ANY were true\n  function checkConditions (condString) {\n    try {\n      condString = condString || &quot;&quot;\n      var condList = condString.trim().split(/\\s+/)\n      var conditions = {}\n      var translatedId\n      condList.forEach((ensightenCondId) =&gt; {\n        // populate the object with 'false' to start\n        translatedId = conditionMap[ensightenCondId]\n        if (typeof translatedId === 'string') {\n          conditions[translatedId] = false\n        }\n      })\n      window.utag.loader.loadrules(originalB, conditions)\n      // console.log(conditions)\n      var conditionMet = false\n      var finalConditions = Object.keys(conditions)\n      finalConditions.forEach((id) =&gt; {\n        if (conditions[id]) {\n          conditionMet = true\n        }\n      })\n      return conditionMet\n    } catch (e) {\n      console.log('checkConditions error', e)\n      return false\n    }\n  }\n\n  if (checkConditions(&quot; 4874978 &quot;)) {\n    try {\n      b[&quot;content_id&quot;] = (function() {\n        return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n          .split(&quot;&amp;units[]=&quot;).pop()\n          .split(&quot;&amp;&quot;).shift();\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4825462  2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - Affiliate Order Detail&quot;] = (function() {\n        var boughtCat = dataLayer[0].ecommerce.purchase.products[0].category;\n        var partDetail = boughtCat.split('/');\n        var ref = dataLayer[0].ecommerce.purchase.actionField.id;\n        return ref + &quot;_&quot; + partDetail[1] + &quot;_&quot; + partDetail[2] + &quot;_&quot; + partDetail[3] + &quot;_&quot; + dataLayer[0].departureAirport + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].name + &quot;_&quot; + dataLayer[0].ecommerce.purchase.products[0].quantity + &quot;_&quot; + dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - BookingRef&quot;] = (function() {\n        if (dataLayer[0].eCommerce !== undefined) {\n          return dataLayer[0].eCommerce.purchase ? dataLayer[0].eCommerce.purchase.actionField.id : &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtAdults&quot;] = (function boughtAdults() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtChildren&quot;] = (function boughtChildren() {\n        if (dataLayer[0] !== undefined) {\n          var par = dataLayer[0].partyCombination;\n          var parts = par.split(':');\n          var firstlevel = parts[0];\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836899  4836987  4151406  4825427 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtCountry&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].category : &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : dataLayer[0].ecommerce.checkout.products[0].quantity;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPeriod&quot;] = (function anon() {\n        var boughtFrom = dataLayer[0].departureDate;\n        var boughtTo = dataLayer[0].returnDate;\n\n        if (boughtFrom !== undefined) {\n          return (boughtFrom + &quot; - &quot; + boughtTo);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.actionField.revenue;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4825427  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - boughtResort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151406  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal - departureDate&quot;] = (function() {\n        return dataLayer[0].departureDate;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4844447  4844445 &quot;)) {\n    try {\n      b[&quot;Crystal - productBrand&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].brand : dataLayer[0].ecommerce.detail.products[0].brand;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : dataLayer[0].ecommerce.checkout.products[0].category;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory1&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail ? dataLayer[0].ecommerce.detail.products[0].category : (dataLayer[0].ecommerce.checkout.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[0];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  2503818  4834971  4834967  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory2&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151409  4834971  2503818  4834967  4844577  4825428 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory3 - Resort&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : (dataLayer[0].ecommerce.detail.products[0].category || &quot;&quot;);\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151409  2503818 &quot;)) {\n    try {\n      b[&quot;Crystal - productCategory4&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].category : dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[3];\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4834971  4834967  4151407 &quot;)) {\n    try {\n      b[&quot;Crystal - productID&quot;] = (function anon() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productID - Facebook&quot;] = (function anon() {\n        var accomID = dataLayer[0].ecommerce &amp;&amp; dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].id : dataLayer[0].ecommerce.detail.products[0].id;\n        return accomID.substring(2);\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4151406 &quot;)) {\n    try {\n      b[&quot;Crystal - productPax&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].quantity : (dataLayer[0].ecommerce.purchase ? dataLayer[0].ecommerce.purchase.products[0].quantity : &quot;&quot;);\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2503818  4151409  4834971  4834967 &quot;)) {\n    try {\n      b[&quot;Crystal - productPrice&quot;] = (function() {\n        if (dataLayer[0].ecommerce !== undefined) {\n          return dataLayer[0].ecommerce.checkout ? dataLayer[0].ecommerce.checkout.products[0].price : dataLayer[0].ecommerce.detail.products[0].price;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4151407  4844577 &quot;)) {\n    try {\n      b[&quot;Crystal - Selected Flight Position&quot;] = (function() {\n        if (dataLayer[0].flightposition !== undefined) {\n          return parseInt(dataLayer[0].flightPosition) + 1;\n        } else return &quot;&quot;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4836987  2518567 &quot;)) {\n    try {\n      b[&quot;Crystal - TravelType&quot;] = (function() {\n        if (dataLayer[0].departureAirport === &quot;ASH&quot; || dataLayer[0].departureAirport === &quot;STP&quot;) {\n          return &quot;Train&quot;;\n        }\n        return &quot;Flight&quot;;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - Affiliate Cookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; AffiliateCJcookie=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 2518567  4836987 &quot;)) {\n    try {\n      b[&quot;Crystal Ski - cjCookie&quot;] = (function() {\n        var value = &quot;; &quot; + document.cookie;\n        var parts = value.split(&quot;; cjevent=&quot;);\n        if (parts.length == 2) {\n          return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 386105 &quot;)) {\n    try {\n      b[&quot;geoCountry&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n            return dataLayer[0].transactions.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n            return dataLayer[0].basket.items.geo.countryName;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n            return dataLayer[0].product.geo.countryName;\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n\n  // not sure why this is defined once conditional and once unconditional\n  try {\n    b[&quot;productType&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('flight/book') &gt; -1) {\n          return &quot;Flight&quot;;\n        } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n          return &quot;River Cruise&quot;;\n        } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n          return &quot;Cruise&quot;;\n        } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n          return &quot;Multi-Centre&quot;;\n        } else {\n          if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n            return &quot;Hotel Only&quot;;\n          } else {\n            return &quot;Package&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  /*\n  if (checkConditions(&quot; 696873  4845366  470318  4845258  4845255  4845356  4845253  4878884  4873541 &quot;)) {\n    try {\n      b[&quot;productType&quot;] = (function() {\n        try {\n          if (document.location.href.indexOf('flight/book') &gt; -1) {\n            return &quot;&quot;;\n          } else if (document.location.href.indexOf('river-cruises/book') &gt; -1) {\n            return &quot;River Cruise&quot;;\n          } else if (document.location.href.indexOf('cruise/book') &gt; -1) {\n            return &quot;Cruise&quot;;\n          } else if (document.location.href.indexOf('multi-centre/book') &gt; -1) {\n            return &quot;Multi-Centre&quot;;\n          } else {\n            if (tui.analytics.page.AOType == &quot;Yes&quot;) {\n              return &quot;Hotel Only&quot;;\n            } else {\n              return &quot;Package&quot;;\n            }\n          }\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  */\n\n  \n  // depends on &quot;legacy_productType&quot;\n  if (checkConditions(&quot; 4845255  4845356  4845253  4878884  696873  4845366  4873541  4859386  4845258 &quot;)) {\n    try {\n      b[&quot;productList&quot;] = (function() {\n\n        var productObj = {},\n          product = '',\n          dl = '',\n          returnVal = [];\n\n        function mapProductObj(id, name, brand, price, quantity, productType, numPax) {\n          var tempObj = {};\n          tempObj.id = id;\n          tempObj.name = name;\n          tempObj.brand = brand || '';\n          tempObj.price = price ? (String(parseFloat(price) / parseInt(quantity, 10))) : price;\n          tempObj.quantity = String(quantity);\n          tempObj.productType = productType || masterProductType;\n          tempObj.metric1 = String(numPax);\n          return tempObj;\n        };\n\n        try {\n          // var masterProductType = Bootstrapper.data.resolve('Manage.TUI UK - Google Analytics.productType');\n          var masterProductType = b.productType\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n            dl = dataLayer[0];\n            if (dl.product &amp;&amp; dl.product.productID) {\n              // Individual Product Impression\n              product = dl.product;\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, product.currentPrice, 1, '', product.noOfPax);\n              returnVal.push(productObj);\n            } else if (dl.page.search) {\n              // Search Term\n              product = dl.page.search;\n              var noOfPax = dl.page.search.noOfPax.toString();\n              if (product.destinationId || product.destinationName) {\n                // Splits the searched destinations up\n                var delimiter = '|',\n                  destinationIds = product.destinationId ? product.destinationId.split(delimiter) : [],\n                  destinationNames = product.destinationName ? product.destinationName.split(delimiter) : [],\n                  maxLength = destinationIds.length &gt;= destinationNames.length ? destinationIds.length : destinationNames.length;\n\n                for (var i = 0; i &lt; maxLength; i++) {\n                  var searchedObj = {\n                    'list': 'Search Term',\n                    'metric1': noOfPax\n                  };\n\n                  if (destinationIds[i]) {\n                    searchedObj.productID = destinationIds[i];\n                  }\n                  if (destinationNames[i]) {\n                    searchedObj.productName = destinationNames[i];\n                  }\n                  returnVal.push(searchedObj);\n                }\n              }\n\n              // Search Results\n              if (product &amp;&amp; product.resultsList) {\n                for (var j = 0; j &lt; product.resultsList.length; j++) {\n                  var currentResult = product.resultsList[j];\n                  currentResult.position = currentResult.position || (j + 1);\n                  currentResult.list = dl.page.pageSubCategory;\n                  currentResult.metric1 = noOfPax;\n                  returnVal.push(currentResult);\n                }\n              }\n            } else if (dl.basket || dl.transactions) {\n              // main item\n              product = dl.basket ? dl.basket.items : (dl.transactions ? dl.transactions.items : {});\n\n              var numPax = dl.basket ? dl.basket.price.paxDetails.total : dl.transactions.total.paxDetails.total,\n                promoDiscount = (function() {\n                  try {\n                    //Added for new array\n                    if (dl.transactions.total &amp;&amp; dl.transactions.total.bookingLevelPromoCodes &amp;&amp; dl.transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl.transactions.total.bookingLevelPromoCodes;\n                      var promoTotalValue = 0;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                      }\n                      return promoTotalValue;\n                    } else if (typeof dl.transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      return Math.abs(dl.transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                    } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                    }\n                    return 0;\n                  } catch (err) {\n                    return 0;\n                  }\n                })(),\n                price = product.price.currentPrice - promoDiscount;\n\n              productObj = mapProductObj(product.productID, product.productName, product.productCollectionCode, price, product.quantity.quantity, '', numPax.toString());\n              returnVal.push(productObj);\n\n              // ancillaries\n              var subItems = product.subItems || [];\n              for (var s = 0; s &lt; subItems.length; s++) {\n                var currentSubItem = subItems[s];\n                if (currentSubItem.productSubType.toLowerCase() == &quot;room upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;room downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Room Downgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board upgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Upgrade', currentSubItem.quantity.pax.toString());\n                } else if (currentSubItem.productSubType.toLowerCase() == &quot;board downgrade&quot;) {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Board Downgrade', currentSubItem.quantity.pax.toString());\n                } else {\n                  subItemObj = mapProductObj(currentSubItem.productID, currentSubItem.productName, currentSubItem.productCollectionCode, currentSubItem.price.currentPrice, currentSubItem.quantity.quantity, 'Ancillary', currentSubItem.quantity.pax.toString());\n                }\n\n                returnVal.push(subItemObj);\n              }\n            }\n          }\n          // For old data layer\n          else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n            product = tui.analytics.page;\n\n            var productSum = product.Sum || 0,\n              promoDiscount = (function() {\n                try {\n                  if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  return 0\n                } catch (err) {\n                  return 0;\n                }\n              })(),\n              price = product.bookingLevelCreditNoteDiscount &amp;&amp; (parseFloat(product.bookingLevelCreditNoteDiscount) &gt; 0) ? (parseFloat(product.bookingLevelCreditNoteDiscount) + parseFloat(productSum)) : productSum,\n              id = product.CRWhereTo || product.WhereTo;\n\n            price = price ? price : '';\n            productObj = mapProductObj(id, id, '', price, 1, masterProductType, product.Pax.toString()); // Credit note change - add credit note value if present\n            returnVal.push(productObj);\n          }\n          return returnVal;\n        } catch (err) {\n          return returnVal;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n \n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - CD - Cabin&quot;] = (function() {\n        return tui.analytics.page.CRCabin;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BoardFilter&quot;] = (function() {\n        return tui.analytics.page.BoardF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - BudgetFilter&quot;] = (function() {\n        return tui.analytics.page.BudgetF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - CabinFilter&quot;] = (function() {\n        return tui.analytics.page.CabinF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Confirmation - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('title tui-bold')[0].innerHTML;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211741  1207206 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Details - Itinerary Name&quot;] = (function() {\n        var itineraryName = document.getElementsByClassName('inline-title')[0].innerText.replace(/(\\r\\n|\\n|\\r)/gm, &quot; &quot;);\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1210674  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Cruise Options - Itinerary Name&quot;] = (function() {\n        var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n        if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n          itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n        }\n\n        if (itineraryName == null || itineraryName == '') {\n          itineraryName = tui.analytics.page.CRWhereTo;\n        }\n\n        return itineraryName;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211742  1211743  1211741  1207254  1207206  1210674  1211596  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DaysUntilDeparture&quot;] = (function() {\n        //Build raw date\n        var rawDate = tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n        //Change to american formatting\n        var depDate = new Date(rawDate.split(&quot;/&quot;)[1] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[0] + &quot;/&quot; + rawDate.split(&quot;/&quot;)[2]);\n        var today = new Date();\n        return parseInt((depDate - today) / (1000 * 60 * 60 * 24)) + 1;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211741  1211720  1211742  1211743 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirport&quot;] = (function() {\n        return tui.analytics.page.DepAir;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DepartureAirportFilter&quot;] = (function() {\n        return tui.analytics.page.DepAirF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - DestinationFilter&quot;] = (function() {\n        return tui.analytics.page.CRGeoF;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211743  1207254  1210674  1211596  1211720  1211742 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Hotel&quot;] = (function() {\n        return tui.analytics.page.CRHotel;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1207206  1210674  1211596  1211742  1211743  1211720  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - Party&quot;] = (function() {\n        return tui.analytics.page.Party;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1211596  1211743 &quot;)) {\n    try {\n      b[&quot;Stockton - DD - Passenger Details - Itinerary Name&quot;] = (function() {\n        try {\n          var itineraryName = jsonData.packageViewData.accomViewData[0].accomName;\n\n          if (itineraryName.indexOf(&quot;|&quot;) &gt; -1) {\n            itineraryName = itineraryName.replace(&quot;|&quot;, &quot;followed by&quot;)\n          }\n\n          if (itineraryName == null || itineraryName == '') {\n            itineraryName = tui.analytics.page.CRWhereTo;\n          }\n\n          return itineraryName;\n        } catch (err) {\n          return &quot;&quot;;\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PaymentType&quot;] = (function() {\n        return tui.analytics.page.PayType;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - PromoCode&quot;] = (function() {\n        return tui.analytics.page.PromoCode;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207206  1211741 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - ShipFilter&quot;] = (function() {\n        return tui.analytics.page.CRShip;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 1207254  1211720 &quot;)) {\n    try {\n      b[&quot;STOCKTON - DD - TransactionId&quot;] = (function() {\n        return tui.analytics.page.Tracsref;\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  if (checkConditions(&quot; 4879518  4880063  4880064  4880065  4880066 &quot;)) {\n    try {\n      b[&quot;uniqodoBookingReference&quot;] = (function() {\n        try {\n          if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n            return dataLayer[0].transactions.total.transactionId.toString().split('-')[0];\n          } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n            return tui.analytics.page.Tracsref.toString().split('-')[0];\n          }\n        } catch (err) {\n          return '';\n        }\n      })()\n    } catch (e) {\n      logError(e)\n    }\n  }\n  \n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}\n\nfunction addUnconditionalEnsightenVariables (originalB) {\n  var b = {}\n  try {\n    b[&quot;abtaNumber&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ShopID) {\n          return tui.analytics.page.ShopID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;abTest&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.abtestV2) {\n          return tui.analytics.page.abtestV2;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.abTestV2) {\n          return dataLayer[0].page.abTestV2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeCookieDomainPeriods&quot;] = (function() {\n      try {\n        if (document.location.host.indexOf(&quot;.co.uk&quot;) &gt; 0) {\n          return 3;\n        } else if (document.location.hostname.match(/(\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          return 3;\n        } else {\n          return 2;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeDownloadFileTypes&quot;] = (function() {\n      try {\n        return &quot;exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeLinkInternalFilters&quot;] = (function() {\n      try {\n        return &quot;javascript:,&quot; +\n          &quot;firstchoice.co.uk,&quot; +\n          &quot;firstchoiceprjuat.co.uk,&quot; +\n          &quot;thomson.co.uk,&quot; +\n          &quot;thomsonprjuat.co.uk,&quot; +\n          &quot;falconholidays.ie,&quot; +\n          &quot;falconholidaysprjuat.ie,&quot; +\n          &quot;tui.co.uk,&quot; +\n          &quot;tuiprjuat.co.uk,&quot; +\n          &quot;tuiholidays.ie,&quot; +\n          &quot;tuiholidaysprjuat.ie,&quot; +\n          &quot;i.4see.mobi,&quot; +\n          &quot;survey.foreseeresults.com,&quot; +\n          &quot;tuiretailagents.thomson.co.uk,&quot; +\n          &quot;retailagents.tui.co.uk,&quot; +\n          &quot;falconretailagents.falconholidays.ie,&quot; +\n          &quot;retailagents.tuiholidays.ie,&quot; +\n          &quot;retailagents.tuiholidaysprjuat.ie,&quot; +\n          &quot;tuiretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;tuiretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-live.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-st10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd1.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd2.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd3.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd4.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd5.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd6.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd7.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd8.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd9.thomsonuk.dnsroot.biz,&quot; +\n          &quot;falconretailhish-hybd10.thomsonuk.dnsroot.biz,&quot; +\n          &quot;money4travel.com,&quot; +\n          &quot;inbro.net,&quot; +\n          &quot;tuitickets.com,&quot; +\n          &quot;amazonaws.com&quot;;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeMarketingCloudVisitorID&quot;] = (function() {\n      try {\n        return visitor.getMarketingCloudVisitorID();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductString&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met')\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else if ((typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount === 'undefined') &amp;&amp; (typeof tui.analytics.page.PromoValue === 'undefined' || tui.analytics.page.PromoValue === 'null')) {\n                    return dataLayer[0].transactions.items.price.currentPrice\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code\n              function getPromoDiscount() {\n                try {\n                  if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return '|event154=' + Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                  } else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return '|event154=' + parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  } else {\n                    return ''\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeProductStringLYP&quot;] = (function anon() {\n      /////////////////////////////////////////////////\n      // ADOBE ANALYTICS - PRODUCT STRING DATA ELEMENT\n      /////////////////////////////////////////////////\n\n      // enables console logging if the environment is hybrisdev\n      debugLogging = function(msg) {\n        if (Bootstrapper.ensightenOptions.publishPath === 'hybrisdev' || Bootstrapper.ensightenOptions.publishPath === 'paymentpagedev' || Bootstrapper.ensightenOptions.publishPath === 'hybrisprod' || Bootstrapper.ensightenOptions.publishPath === 'paymentpage')\n          console.log('DEBUG - ' + msg)\n      }\n\n\n      // create inital product_string object\n      product_string = ''\n      product_string_old = ''\n\n      //////////////////////////////////////\n      // SEARCH PAGE - NEW DATA LAYER\n      //////////////////////////////////////\n\n      if (typeof dataLayer != 'undefined') {\n        if (typeof dataLayer[0] != 'undefined') {\n          if (dataLayer[0].page) {\n\n            if (dataLayer[0].page.pageSubCategory === 'Search Results') {\n\n              debugLogging('new datalayer: search page product string rule met')\n\n              // split destination ids into an arrays\n              var destinationIdArray = dataLayer[0].page.search.destinationId.split('|')\n\n              // loop through the array\n              var arrayLeng = destinationIdArray.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + destinationIdArray[i]\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  // Changed from searchType to siteSection\n                  ';' + 'eVar153=' + dataLayer[0].page.siteSection\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // UNIT DETAILS PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Unit Details') {\n\n              debugLogging('new datalayer: unit details page product string rule met')\n\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].product.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + dataLayer[0].product.productType\n\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // BOOKFLOW PAGES - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Room Options' ||\n              dataLayer[0].page.pageSubCategory === 'Flight Options' ||\n              dataLayer[0].page.pageSubCategory === 'Extra Options' ||\n              dataLayer[0].page.pageSubCategory === 'Summary' ||\n              dataLayer[0].page.pageSubCategory === 'Passenger Details' ||\n              dataLayer[0].page.pageSubCategory === 'Payment' ||\n              dataLayer[0].page.pageSubCategory === 'Payment Details' ||\n              dataLayer[0].page.pageSubCategory === 'Customise Holiday' ||\n              dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: bookflow product string rule met')\n\n              // add bookflow object as part of LYP\n              var bookflowPage = (dataLayer[0].page.pageID === 'lockYourPriceConfirmationpage_react' ? dataLayer[0].transactions : dataLayer[0].basket)\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + bookflowPage.items.productID\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                + //added check for productType\n                ((typeof bookflowPage.items.productType !== 'undefined') ? (';' + 'eVar153=' + bookflowPage.items.productType) : '')\n\n              // loop through the ancilliary items array\n              var arrayLeng = bookflowPage.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((bookflowPage.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + bookflowPage.items.subItems[i].isRecommendedItem) : '')\n\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + bookflowPage.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';'\n                  /*total price*/\n                  +\n                  ';'\n                  /*events*/\n                  +\n                  ';'\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + bookflowPage.items.productType +\n                  getRecommendedMerchEvars()\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n\n            //////////////////////////////////////\n            // CONFIRMATION PAGE - NEW DATA LAYER\n            //////////////////////////////////////\n\n            if (dataLayer[0].page.pageSubCategory === 'Confirmation' &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; typeof dataLayer[0].transactions.items !== 'undefined' &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') { //Added for LYP\n\n              debugLogging('new datalayer: confirmation page product string rule met');\n\n              // function to remove booking level discount (i.e. voucher code discounts) from the main product revenue, if applicable. Added backup reference to old data layer due to defect with bookingLevelPromoDiscount\n              function getMainProductRevenue() {\n                try {\n                  // New data layer, promo code array\n                  if (dataLayer[0].transactions.total.bookingLevelPromoCodes != 'undefined' &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                    var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n                    var promoTotalValue = 0;\n                    for (i = 0; i &lt; promoCodeArray.length; i++) {\n                      promoTotalValue = promoTotalValue + promoCodeArray[i].bookingLevelPromoDiscount;\n                    }\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(promoTotalValue);\n                  }\n                  // New data layer, pre-release location of promo code\n                  else if (typeof dataLayer[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                    return dataLayer[0].transactions.items.price.currentPrice - Math.abs(dataLayer[0].transactions.total.bookingLevelPromoDiscount);\n                  }\n                  // New data layer, old data layer for promo code\n                  else if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                    return dataLayer[0].transactions.items.price.currentPrice - parseFloat(tui.analytics.page.PromoValue); // Credit note change - changed parseInt to parseFloat\n                  }\n                  // New data layer, no promo code present\n                  else if (dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.price) {\n                    return dataLayer[0].transactions.items.price.currentPrice;\n                  } else {\n                    return '';\n                  }\n                } catch (err) {\n                  return '';\n                }\n              }\n\n              // function to get discount code - had to add checks for dataLayer presence due to FO defect\n              function getPromoDiscount() {\n                try {\n                  var dl = window.dataLayer;\n                  var discountString = '';\n                  if (dl &amp;&amp; dl[0] &amp;&amp; dl[0].transactions &amp;&amp; dl[0].transactions.total) {\n                    if (dl[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dl[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                      var promoCodeArray = dl[0].transactions.total.bookingLevelPromoCodes;\n                      for (i = 0; i &lt; promoCodeArray.length; i++) {\n                        if (/CVHRC/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event158=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                          discountString += '|event159=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        } else {\n                          discountString += '|event154=' + promoCodeArray[i].bookingLevelPromoDiscount;\n                        }\n                      }\n                    }\n                    // If old object is shown - can be removed at a later date\n                    else if (dl[0].transactions.total.bookingLevelPromoDiscount &amp;&amp; typeof dl[0].transactions.total.bookingLevelPromoDiscount !== 'undefined') {\n                      // Programme Change Incentive\n                      if (/CVRHC/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event158=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else if (/CVRI|CVRM|CVRV/i.test(dl[0].transactions.total.bookingLevelPromoCode)) {\n                        discountString += '|event159=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount);\n                      } else {\n                        return '|event154=' + Math.abs(dl[0].transactions.total.bookingLevelPromoDiscount); // convert it to positive if its ever negative\n                      }\n                    }\n                  }\n                  // For legacy data layer\n                  else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n                    if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                      if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                        discountString += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                      } else {\n                        discountString += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                      }\n                    }\n                  }\n                  return discountString;\n                } catch (err) {\n                  return '';\n                }\n              }\n              // add main product first\n              product_string +=\n                /*category*/\n                /*id*/\n                ';' + dataLayer[0].transactions.items.productID\n                /*quantity*/\n                +\n                ';' + dataLayer[0].transactions.items.quantity.quantity\n                /*total price*/\n                +\n                ';' + getMainProductRevenue()\n                /*events*/\n                +\n                ';' + 'event150=' + (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0 ? dataLayer[0].transactions.total.totalPrice + dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount : dataLayer[0].transactions.total.totalPrice) + '|' + // Credit note change - Adding credit note value back on if present\n                'event151=' + dataLayer[0].transactions.total.discount + '|' +\n                'event152=' + dataLayer[0].transactions.items.quantity.pax + '|' +\n                'event153=' + dataLayer[0].transactions.items.quantity.pax + getPromoDiscount()\n\n                /*evars*/\n                + //Added a check for product type\n                ((typeof dataLayer[0].transactions.items.productType !== 'undefined') ? (';' + 'eVar153=' + dataLayer[0].transactions.items.productType) : '')\n\n\n              // loop through the ancilliary items array\n              var arrayLeng = dataLayer[0].transactions.items.subItems.length;\n              for (var i = 0; i &lt; arrayLeng; i++) {\n\n                // add a comma to seperate each ancilliary product\n                if (product_string != '') {\n                  product_string += ','\n                }\n\n                // function to get recommended merch evars\n                function getRecommendedMerchEvars() {\n\n                  return ((dataLayer[0].transactions.items.subItems[i].isRecommendedItem) ? ('|' + 'eVar205=' + dataLayer[0].transactions.items.subItems[i].isRecommendedItem) : '')\n                }\n\n                // add the ancilliaries to the product string\n                product_string +=\n                  /*category*/\n                  /*id*/\n                  ';' + dataLayer[0].transactions.items.subItems[i].productID\n                  /*quantity*/\n                  +\n                  ';' + dataLayer[0].transactions.items.subItems[i].quantity.quantity\n                  /*total price*/\n                  +\n                  ';' + ((dataLayer[0].transactions.items.subItems[i] &amp;&amp; dataLayer[0].transactions.items.subItems[i].price &amp;&amp; dataLayer[0].transactions.items.subItems[i].price.currentPrice) ? (dataLayer[0].transactions.items.subItems[i].price.currentPrice) : 0)\n                  /*events*/\n                  +\n                  ';' + 'event152=' + dataLayer[0].transactions.items.subItems[i].quantity.pax\n                  /*evars*/\n                  +\n                  ';' + 'eVar153=' + dataLayer[0].transactions.items.productType +\n                  getRecommendedMerchEvars();\n\n              }\n              debugLogging('product_string: ' + product_string)\n            }\n\n          }\n        }\n      }\n\n      /////////////////////////////////////////////\n      // OLD DATA LAYER HANDLER FOR WHERETO VALUES\n      /////////////////////////////////////////////\n\n      if (window.tui &amp;&amp; tui.analytics) {\n\n        // functiom to get the right WhereTo values and type\n        function getWhereTo() {\n\n          // create some separators\n          var separators = ['-', '\\\\|'];\n\n          try {\n\n            // WhereTo for Beach holidays, which don't have a '-' and aren't on the multicentre or flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') === -1 &amp;&amp;\n              document.location.pathname.indexOf('/flight/') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Beach'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for Flight-only holidays, which are on flight page urls\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/flight/') != -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Flight-Only'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentre search page, which are on multicentre urls but don't have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp;\n              tui.analytics.page.WhereTo !== 'null' &amp;&amp;\n              document.location.pathname.indexOf('/multi-centre/') != -1 &amp;&amp;\n              tui.analytics.page.WhereTo.indexOf('-') === -1) {\n              var products_array = []\n              var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Multicentre'\n                });\n              }\n              return products_array;\n            }\n\n            // WhereTo for multicentres with ONE L-epic code, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 1) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i],\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for multicentres with TWO L-epic codes, which are on multicentre URLs or have a '-' in the WhereTo\n            if (typeof tui.analytics.page.WhereTo !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo !== 'null') {\n              if (document.location.pathname.indexOf('/multi-centre/') || tui.analytics.page.WhereTo.indexOf('-') != -1) {\n                if (tui.analytics.page.WhereTo.match(/L/g).length === 2) {\n                  var products_array = []\n                  var products = tui.analytics.page.WhereTo.replace('-', '?').split(new RegExp(separators.join('|'), 'g'))\n                  for (var i = 0; i &lt; products.length; i++) {\n                    products_array.push({\n                      product: products[i].replace('?', '-'),\n                      type: 'Multicentre'\n                    });\n                  }\n                  return products_array;\n                }\n              }\n            }\n\n            // WhereTo for cruises, which are in a separate 'CRWhereTo' variable\n            if (typeof tui.analytics.page.CRWhereTo !== 'undefined' &amp;&amp; tui.analytics.page.CRWhereTo !== 'null') {\n              var products_array = []\n              var products = tui.analytics.page.CRWhereTo.split(new RegExp(separators.join('|'), 'g'))\n              for (var i = 0; i &lt; products.length; i++) {\n                products_array.push({\n                  product: products[i],\n                  type: 'Cruise'\n                });\n              }\n              return products_array;\n            } else {\n              return ''\n            }\n\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get discount values\n        function getDiscount() {\n          try {\n            if (typeof tui.analytics.page.Disc !== 'undefined') {\n              return 'event151=' + tui.analytics.page.Disc\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get the promo discount value\n        function getLegacyPromoDiscount() {\n          try {\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n              var legacyPromoDiscount = '';\n              if (typeof tui.analytics.page.PromoValue !== 'undefined' &amp;&amp; tui.analytics.page.PromoValue !== 'null') {\n                if (/CVRHC/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event158=' + parseFloat(tui.analytics.page.PromoValue);\n                } else if (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n                  legacyPromoDiscount += '|event159=' + parseFloat(tui.analytics.page.PromoValue);\n                } else {\n                  legacyPromoDiscount += '|event154=' + parseFloat(tui.analytics.page.PromoValue);\n                }\n              }\n              return legacyPromoDiscount\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        // function to get cruise hotels\n        function getCruiseHotel() {\n          try {\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var products_array = []\n              products_array.push({\n                product: tui.analytics.page.CRHotel,\n                type: 'Cruise'\n              });\n              return products_array\n\n            } else {\n              return ''\n            }\n          } catch (err) {\n            return '';\n          }\n        }\n\n        /*\n          // function to get multicentre hotels\n          function getMulticentreHotel() {\n            try {\n              if (typeof typeof(tui.analytics.page.WhereTo) !== 'undefined' &amp;&amp; tui.analytics.page.WhereTo.indexOf('-') !== -1) {\n                return 'evarMulticentreHotel=' + tui.analytics.page.WhereTo.substr(tui.analytics.page.WhereTo.indexOf('H'), tui.analytics.page.WhereTo.length - tui.analytics.page.WhereTo.indexOf('H'))\n              } else {\n                return ''\n              }\n            } catch (err) {\n              return '';\n            }\n          }\n        */\n        // function to get legacy merch events and filter out any that are blank or empty strings\n        function getLegacyMerchEvents() {\n          legacyMerchEvents = ['event150=' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum), getDiscount(), 'event152=' + tui.analytics.page.Pax, 'event153=' + tui.analytics.page.Pax + getLegacyPromoDiscount()].filter(Boolean).join('|')\n          return legacyMerchEvents\n        }\n\n        /*\n          // function to get legacy merch evars and filter out any that are blank or empty strings\n          function getLegacyMerchEvars() {\n                legacyMerchEvars = [getCruiseHotel(), getMulticentreHotel()].filter(Boolean).join('|')\n                return legacyMerchEvars\n          }\n        */\n\n        // set up regex rules for pages\n        var searchRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|destinations(\\/multi-centre)?|cruise|river-cruises|flight|holiday|f)\\/(packages?|search)\\/?)$') // this currently fires on the search pages itself but returns no products\n        var bookflowRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre)\\/?)')\n        //var confirmationRegexCheck = new RegExp('^(\\/(holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre)\\/book\\/(mobile\\/confirmation|confirmation)\\/?)$') //changed for LYP (MMB confirmation)\n        var confirmationRegexCheck = new RegExp('^(\\/(retail\\/)?(retail|holiday|f|flight|cruise|river-cruises|destinations|destinations\\/multi-centre|holiday\\/multi-centre|destinations\\/your-account)\\/(book|managemybooking)\\/(mobile\\/confirmation|confirmation|bookingConfirmation|paymentconfirmation)\\/?)$')\n        var paymentRegexCheck = new RegExp('^(\\/cps\\/pageRender\\/?)')\n\n        //////////////////////////////////////\n        // SEARCH PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for search page\n        if (searchRegexCheck.test(document.location.pathname)) {\n\n          debugLogging('old datalayer: search page product string rule met')\n\n          // get all WhereTos and hotels\n          var destinationIdArray = getWhereTo()\n\n          // loop through the array\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 0; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n\n\n        //////////////////////////////////////\n        // UNIT DETAILS PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // not required, can be covered by bookflow rule as the data layer objects are the same\n\n\n        //////////////////////////////////////\n        // BOOKFLOW PAGES - OLD DATA LAYER\n        //////////////////////////////////////\n\n        // regex test for bookflow, excluding search and confirmation page\n        if (bookflowRegexCheck.test(document.location.pathname) === true ||\n          paymentRegexCheck.test(document.location.pathname) === true) {\n\n          if (searchRegexCheck.test(document.location.pathname) === false &amp;&amp;\n            confirmationRegexCheck.test(document.location.pathname) === false) {\n\n            debugLogging('old datalayer: bookflow product string rule met')\n\n            // get the WhereTo array\n            if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n              var destinationIdArray = getWhereTo()\n            }\n            // get the WhereTo array, if it has a cruise hotel\n            if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n              var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n            }\n\n            // loop through the array\n            var arrayLeng = destinationIdArray.length;\n            for (var i = 0; i &lt; arrayLeng; i++) {\n\n              // add a comma to seperate each product\n              if (product_string_old != '') {\n                product_string_old += ','\n              }\n\n              product_string_old +=\n                /*category*/\n                /*id*/\n                ';' + destinationIdArray[i].product\n                /*quantity*/\n                +\n                ';'\n                /*total price*/\n                +\n                ';'\n                /*events*/\n                +\n                ';'\n                /*evars*/\n                +\n                ';' + 'eVar153=' + destinationIdArray[i].type\n\n            }\n            debugLogging('product_string_old: ' + product_string_old)\n          }\n        }\n\n\n        //////////////////////////////////////\n        // CONFIRMATION PAGE - OLD DATA LAYER\n        //////////////////////////////////////\n\n        if (confirmationRegexCheck.test(document.location.pathname) &amp;&amp;\n          typeof tui.analytics.page.Tracsref != 'undefined' &amp;&amp;\n          tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react' //added as per LYP\n        ) {\n\n          debugLogging('old datalayer: confirmation product string rule met')\n\n          // get the WhereTo array\n          if (typeof tui.analytics.page.CRHotel === 'undefined' || tui.analytics.page.CRHotel === 'null') {\n            var destinationIdArray = getWhereTo()\n          }\n          // get the WhereTo array, if it has a cruise hotel\n          if (typeof tui.analytics.page.CRHotel !== 'undefined' &amp;&amp; tui.analytics.page.CRHotel !== 'null') {\n            var destinationIdArray = getWhereTo().concat(getCruiseHotel())\n          }\n\n          // add main product\n          product_string_old +=\n            /*category*/\n            /*id*/\n            ';' + destinationIdArray[0].product\n            /*quantity*/\n            +\n            ';' + '1'\n            /*total price*/\n            +\n            ';' + (tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null' ? parseFloat(tui.analytics.page.Sum) + parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) : tui.analytics.page.Sum) // Credit note change - added credit note value back on\n            /*events*/\n            +\n            ';' + getLegacyMerchEvents()\n            /*evars*/\n            +\n            ';' + 'eVar153=' + destinationIdArray[0].type\n\n          // loop through the array to add the remaining products\n          var arrayLeng = destinationIdArray.length;\n          for (var i = 1; i &lt; arrayLeng; i++) {\n\n            // add a comma to seperate each product\n            if (product_string_old != '') {\n              product_string_old += ','\n            }\n\n            product_string_old +=\n              /*category*/\n              /*id*/\n              ';' + destinationIdArray[i].product\n              /*quantity*/\n              +\n              ';' + '1'\n              /*total price*/\n              +\n              ';'\n              /*events*/\n              +\n              ';'\n              /*evars*/\n              +\n              ';' + 'eVar153=' + destinationIdArray[i].type\n          }\n          debugLogging('product_string_old: ' + product_string_old)\n        }\n      }\n\n\n      // return correct product string to Ensighten\n\n\n      if (product_string) {\n        return product_string\n      } else if (product_string_old) {\n        return product_string_old\n      }\n\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;adobeReportSuite&quot;] = (function() {\n      try {\n        if (/^(hybrisdev|paymentpagedev)$/i.test(Bootstrapper.ensightenOptions.publishPath) || /^(prjuat|staging|st[0-9]|hybd[0-9]|admin|prdsupport|localhost|webcache|cloud|rategain|absolutesurveyors|anite|cms|qa|ceros)$/i.test(window.location.host)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukdev&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukapppdev,tuiukdev&quot;;\n          } else {\n            return &quot;tuiukdev&quot;;\n          }\n        } else if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n\n          if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*CriOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*FxiOS).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Mercury).*/) ||\n            navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukprod&quot;;\n          } else if (navigator.userAgent.match(/.*(iPhone|iPod|iPad).*AppleWebKit.*/) ||\n            navigator.userAgent.match(/.*(Android).*AppleWebKit(.*Version).*/)\n          ) {\n            return &quot;tuiukappprod,tuiukprod&quot;;\n          } else {\n            return &quot;tuiukprod&quot;;\n          }\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;agentID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AgentID) {\n          return tui.analytics.page.AgentID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;airportExtras&quot;] = (function() {\n      try {\n        return window.tui.analytics.page.HXAnc;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;alternativeFlightOptions&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AltFlt) {\n          return tui.analytics.page.AltFlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;appVisitor&quot;] = (function() {\n      try {\n        var paramArray = [];\n        if (s.Util.getQueryParam('utm_medium') === &quot;TDA&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;ios-myfirstchoice_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-tui_uk&quot; || s.Util.getQueryParam('utm_medium') === &quot;android-myfirstchoice_uk&quot;) {\n          paramArray.push(s.Util.getQueryParam('utm_source'));\n          paramArray.push(s.Util.getQueryParam('utm_campaign'));\n\n          if (s.Util.getQueryParam('utm_content')) {\n            paramArray.push(s.Util.getQueryParam('utm_content'));\n          } else if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push('No content set');\n          }\n\n          if (s.Util.getQueryParam('utm_term')) {\n            paramArray.push(s.Util.getQueryParam(&quot;utm_term&quot;));\n          }\n\n          return 'Native App Visitor' + '|' + paramArray.join('|');\n\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportCode) {\n          return dataLayer[0].transactions.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportCode) {\n          return dataLayer[0].basket.items.arrivalAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportCode) {\n          return dataLayer[0].product.arrivalAirportCode;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData != null &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors != null &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.code;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;arrivalAirportName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.arrivalAirportName) {\n          return dataLayer[0].transactions.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.arrivalAirportName) {\n          return dataLayer[0].basket.items.arrivalAirportName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.arrivalAirportName) {\n          return dataLayer[0].product.arrivalAirportName;\n        } else if (window.jsonData &amp;&amp; jsonData.package &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.flightViewData[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0] &amp;&amp; jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name) {\n          return jsonData.packageViewData.flightViewData[0].outboundSectors[0].arrivalAirport.name;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Board) {\n          return tui.analytics.page.Board.trim();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisCode) {\n          return dataLayer[0].transactions.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisCode) {\n          return dataLayer[0].basket.items.boardBasisCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisCode) {\n          return dataLayer[0].product.boardBasisCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;boardBasisName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.boardBasisName) {\n          return dataLayer[0].transactions.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.boardBasisName) {\n          return dataLayer[0].basket.items.boardBasisName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.boardBasisName) {\n          return dataLayer[0].product.boardBasisName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingDate YYYY-MM-DD&quot;] = (function() {\n      try {\n        var today = new Date();\n        var dd = today.getDate();\n        var mm = today.getMonth() + 1; //January is 0\n        var yyyy = today.getFullYear();\n\n        if (dd &lt; 10) {\n          dd = '0' + dd;\n        }\n\n        if (mm &lt; 10) {\n          mm = '0' + mm;\n        }\n\n        today = yyyy + '-' + mm + '-' + dd;\n        return today;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n   try {\n\tb[&quot;bookingOrMmbIncentiveCode&quot;] = (function() {\n\t  try {\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; (dataLayer[0].basket || dataLayer[0].transactions)) {\n\n\t\t  if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t\tvar promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t\tfor (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t  if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\treturn promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t  }\n\t\t\t}\n\t\t  } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t  return dataLayer[0].transactions.total.bookingLevelPromoCode;\n\t\t\t}\n\t\t  } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t\tvar promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t\tfor (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t  if (/CVRI|CVRM|CVRV/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\treturn promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t  }\n\t\t\t}\n\t\t  } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t  return dataLayer[0].basket.price.bookingLevelPromoCode;\n\t\t\t}\n\t\t  }\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n\t\t  if (typeof tui.analytics.page.IncentivePromoCode !== 'undefined' &amp;&amp; tui.analytics.page.IncentivePromoCode !== 'null') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.IncentivePromoCode)) {\n\t\t\t  return tui.analytics.page.IncentivePromoCode;\n\t\t\t}\n\t\t  } else if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n\t\t\tif (/CVRI|CVRM|CVRV/i.test(tui.analytics.page.PromoCode)) {\n\t\t\t  return tui.analytics.page.PromoCode;\n\t\t\t}\n\t\t  }\n\t\t} else {\n\t\t  return undefined;\n\t\t}\n\t  } catch (err) {\n\t\treturn undefined;\n\t  }\n\t})()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref) {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId) {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;bookingReferenceMoney4Travel&quot;] = (function() {\n      try {\n        var element = document.querySelector(&quot;.overall-summary p:nth-child(4)&quot;);\n        return element ? element.textContent : &quot;&quot;;\n      } catch (e) {\n        return ''\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;brand&quot;] = (function() {\n      try {\n        if ((document.location.host.indexOf('tuiretailagents.thomson.co.uk') != -1) || (document.location.host.indexOf('tuiretailagents.thomsonprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tui.co.uk') != -1) || (document.location.host.indexOf('retailagents.tuiprjuat.co.uk') != -1)) {\n          return &quot;tui retail third party&quot;;\n        } else if ((document.location.host.indexOf('falconretailagents.falconholidays.ie') != -1) || (document.location.host.indexOf('falconretailagents.falconholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('retailagents.tuiholidays.ie') != -1) || (document.location.host.indexOf('retailagents.tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie retail third party&quot;;\n        } else if ((document.location.host.indexOf('thomson.co.uk') != -1) || (document.location.host.indexOf('thomsonprjuat.co.uk') != -1)) {\n          return &quot;thomson&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.co.uk') != -1) || (document.location.host.indexOf('firstchoiceprjuat.co.uk') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('firstchoice.inbro.net') != -1) || (document.location.host.indexOf('firstchoiceprjuat.inbro.net') != -1)) {\n          return &quot;firstchoice&quot;;\n        } else if ((document.location.host.indexOf('falconholidays.ie') != -1) || (document.location.host.indexOf('falconholidaysprjuat.ie') != -1)) {\n          return &quot;falconholidays&quot;;\n        } else if ((document.location.host.indexOf('tui.co.uk') != -1) || (document.location.host.indexOf('tuiprjuat.co.uk') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tui.inbro.net') != -1) || (document.location.host.indexOf('tuiprjuat.inbro.net') != -1)) {\n          return &quot;tui&quot;;\n        } else if ((document.location.host.indexOf('tuiholidays.ie') != -1) || (document.location.host.indexOf('tuiholidaysprjuat.ie') != -1)) {\n          return &quot;tui ie&quot;;\n        } else if ((document.location.host.indexOf('tuiretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(tuiretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui retail&quot;;\n        } else if ((document.location.host.indexOf('falconretailhish-live.thomsonuk.dnsroot.biz') != -1) || (document.location.hostname.match(/(falconretailhish\\-(st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g))) {\n          return &quot;tui ie retail&quot;;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaign&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          var im_id = Bootstrapper.getQueryParam('im_id');\n          if (im_id) {\n            im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // return undefined for PPC and paid social and let autotagging handle setting of campaign\n            return im_id;\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return 'email';\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;campaignSource&quot;] = (function() {\n      try {\n        if (/tuiholidays/.test(document.location.host)) {\n          return undefined;\n        } else {\n          if (Bootstrapper.getQueryParam('im_id')) {\n            if (Bootstrapper.getQueryParam('im_id') === 'affiliate') {\n              if (~location.href.toLowerCase().indexOf('ia_id=')) {\n                return Bootstrapper.getQueryParam('ia_id');\n              } else {\n                return Bootstrapper.getQueryParam('im_id');\n              }\n            } else if (~location.href.toLowerCase().indexOf('if_id=')) {\n              return Bootstrapper.getQueryParam('if_id');\n            } else if (Bootstrapper.getQueryParam('im_id') &amp;&amp; Bootstrapper.getQueryParam('im_id') != 'affiliate') {\n              var im_id = Bootstrapper.getQueryParam('im_id');\n              im_id = (im_id.toLowerCase() === 'ppc' || im_id.toLowerCase() === 'paidsocial') ? undefined : im_id; // Let autotagging or utms handle ppc and paid social so returning undefined\n              return im_id;\n            } else if (document.referrer) {\n              var parts = document.referrer.split('://')[1].split('/'),\n                host = parts[0];\n              if (~host.indexOf('.google.')) {\n                return 'google';\n              }\n              return host;\n            }\n          } else if (~location.href.toLowerCase().indexOf('cmid=')) {\n            return Bootstrapper.getQueryParam('ito');\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cancelReason&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.cancelReason) {\n          return dataLayer[0].transactions.total.cancelReason;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierInbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[1];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;carrierOutbound&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.carrier) {\n          return tui.analytics.page.carrier.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.carrierCode) {\n          return dataLayer[0].transactions.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.carrierCode) {\n          return dataLayer[0].basket.items.carrierCode.split(&quot;|&quot;)[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.carrierCode) {\n          return dataLayer[0].product.carrierCode.split(&quot;|&quot;)[0];\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Channel&quot;] = (function() {\n      if (dataLayer[0].pageName === 'Booking Confirmation') {\n        return 'Sale Ski';\n      } else {\n        return dataLayer[0].sectionName || &quot;&quot;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;childAges&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ChildAges) {\n          return tui.analytics.page.ChildAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.childAges) {\n          return dataLayer[0].product.childAges;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.childAges) {\n          return dataLayer[0].search.childAges;\n        } else if (window.jsonData &amp;&amp; jsonData.searchRequest &amp;&amp; jsonData.searchRequest.childrenAge) {\n          return jsonData.searchRequest.childrenAge.toString().replace(/,/g, &quot;|&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialSortPriority&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CSPScore) {\n          return tui.analytics.page.CSPScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScore&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScore) {\n          return tui.analytics.page.CVScore;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;commercialValueScoreType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CVScoreType) {\n          return tui.analytics.page.CVScoreType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;componentClicked&quot;] = (function() {\n      try {\n        return s.Util.cookieRead('s_comp_click');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentCode) {\n          return dataLayer[0].transactions.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentCode) {\n          return dataLayer[0].basket.items.geo.continentCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentCode) {\n          return dataLayer[0].product.geo.continentCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;continentName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.continentName) {\n          return dataLayer[0].transactions.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.continentName) {\n          return dataLayer[0].basket.items.geo.continentName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.continentName) {\n          return dataLayer[0].product.geo.continentName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cookieLength&quot;] = (function() {\n      try {\n        var cookieSize = document.cookie.length;\n        var cLength = 'unknown';\n        if (!isNaN(cookieSize)) {\n          if (cookieSize &lt; 500)\n            cLength = '&lt; 500';\n          else if (cookieSize &lt; 1024)\n            cLength = '500b-1k';\n          else if (cookieSize &lt; 2048)\n            cLength = '1k-2k';\n          else if (cookieSize &lt; 4096)\n            cLength = '2k-4k';\n          else if (cookieSize &lt; 8192)\n            cLength = '4k-8k';\n          else\n            cLength = 'more than 8k';\n        }\n        return cLength;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryCode) {\n          return dataLayer[0].transactions.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryCode) {\n          return dataLayer[0].basket.items.geo.countryCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryCode) {\n          return dataLayer[0].product.geo.countryCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;countryName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.countryName) {\n          return dataLayer[0].transactions.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.countryName) {\n          return dataLayer[0].basket.items.geo.countryName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.countryName) {\n          return dataLayer[0].product.geo.countryName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].countryName) {\n          return jsonData.packageViewData.accomViewData[0].countryName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;coupon&quot;] = (function() {\n      var returnVal = 'none';\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total) {\n          if (dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode;\n          } else if (dataLayer[0].transactions.total.bookingLevelPromoCode) {\n            return dataLayer[0].transactions.total.bookingLevelPromoCode;\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.toLowerCase() != 'null') {\n          return tui.analytics.page.PromoCode;\n        } else {\n          return returnVal;\n        }\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking.toLowerCase() == &quot;yes&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n          return tui.analytics.page.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteCode) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteCode;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; tui.analytics.page.bookingLevelCreditNoteDiscount != 'null') {\n          return parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount) {\n          return dataLayer[0].basket.price.bookingLevelCreditNoteDiscount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteOriginalBookingID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.originalTransactionId &amp;&amp; tui.analytics.page.originalTransactionId != 'null') {\n          return tui.analytics.page.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.orignalTransactionId) {\n          return dataLayer[0].transactions.total.originalTransactionId;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.originalTransactionId) {\n          return dataLayer[0].basket.price.totalPrice.originalTransactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteRefundValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteRefundValue &amp;&amp; tui.analytics.page.creditNoteRefundValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteRefundValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteRefundValue) {\n          return dataLayer[0].transactions.total.creditNoteRefundValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;creditNoteTotalValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.creditNoteTotalValue &amp;&amp; tui.analytics.page.creditNoteTotalValue != 'null') {\n          return parseFloat(tui.analytics.page.creditNoteTotalValue);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.creditNoteTotalValue) {\n          return dataLayer[0].transactions.total.creditNoteTotalValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.creditNoteTotalValue) {\n          return dataLayer[0].basket.price.creditNoteTotalValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRCabin) {\n          return tui.analytics.page.CRCabin;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CrCabin) {\n          return tui.analytics.page.CrCabin;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseEpicCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRWhereTo) {\n          return tui.analytics.page.CRWhereTo;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseHotel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRHotel) {\n          return tui.analytics.page.CRHotel;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShip) {\n          return tui.analytics.page.CRShip;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStay&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStay) {\n          return tui.analytics.page.CRStay;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayDuration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur) {\n          return tui.analytics.page.STDur;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseStayRoomType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STRmSlt) {\n          return tui.analytics.page.STRmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;cruiseType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRType) {\n          return tui.analytics.page.CRType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - BkngStep&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.checkout !== undefined) {\n        return dataLayer[0].ecommerce.checkout.actionField.step;\n      } else if (dataLayer[0].ecommerce !== undefined &amp;&amp; dataLayer[0].ecommerce.purchase !== undefined) {\n        return dataLayer[0].ecommerce.purchase.actionField.step;\n      } else return &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - bookingPace&quot;] = (function() {\n      return dataLayer[0].bookingPace || dataLayer[0].searchPace || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - cjevent&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cjevent=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentArrivalAirport&quot;] = (function arrivalAirport() {\n      // returns the arrival airport taken from the route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        var defaultRoute = dataLayer[0].defaultRoute;\n        var defaultRouteArray = defaultRoute.split(&quot;-&quot;);\n        return defaultRouteArray[1];\n      } else if (dataLayer[0].selectedRoute !== undefined) {\n        var selectedRoute = dataLayer[0].defaultRoute;\n        var selectedRouteArray = defaultRoute.split(&quot;-&quot;);\n        return selectedRouteArray[1];\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentCountry&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[1];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureAirportArray&quot;] = (function depAirport() {\n      // returns the departure airport\n      if (dataLayer[0].d_airport !== undefined) {\n        return dataLayer[0].d_airport.join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDepartureDate&quot;] = (function currentDepDate() {\n      // returns the current departure date\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout;\n      }\n      if (dataLayer[0].departureDate !== undefined) {\n        return dataLayer[0].departureDate;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentDuration&quot;] = (function currentDestination() {\n      // returns the current holiday duration\n      if (dataLayer[0].duration !== undefined) {\n        return dataLayer[0].duration;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentHotelId&quot;] = (function accomId() {\n      // returns the accom id, without the initial letters, where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].id.substring(2);\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].id.substring(2);\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPartyType&quot;] = (function currentDepDate() {\n      // returns the current party type\n      if (dataLayer[0].partyType !== undefined) {\n        return dataLayer[0].partyType;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax&quot;] = (function anyPax() {\n      // returns the sum of adults and children from the partyCombination (i.e. excluding infants)\n      if (dataLayer[0].partyCombination !== undefined) {\n        var party = dataLayer[0].partyCombination;\n        var partyArray = party.split(&quot;:&quot;);\n        return parseInt(partyArray[0], 10) + parseInt(partyArray[1], 10);\n      } else if (dataLayer[0].ecommerce !== undefined) {\n        // uses quantity as a fallback if partyCombination is undefined, but will include infants in pax\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentPax inc infants&quot;] = (function anyPax() {\n      // returns the pax where ever it is located\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].quantity;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].quantity;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentResort&quot;] = (function productCat() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          var cat = dataLayer[0].ecommerce.purchase.products[0].category;\n          var parts = cat.split('/');\n          return parts[2]\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          var cat = dataLayer[0].ecommerce.checkout.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          var cat = dataLayer[0].ecommerce.detail.products[0].category;\n          var parts = cat.split('/');\n          return parts[2];\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - currentRoute&quot;] = (function route() {\n      // returns the current route\n      if (dataLayer[0].defaultRoute !== undefined) {\n        return dataLayer[0].defaultRoute;\n      }\n      if (dataLayer[0].selectedRoute !== undefined) {\n        return dataLayer[0].selectedRoute;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Hit Timestamp&quot;] = (function() {\n      //Get local time as ISO string with offset at the end\n      var now = new Date();\n      var tzo = -now.getTimezoneOffset();\n      var dif = tzo &gt;= 0 ? '+' : '-';\n      var pad = function(num) {\n        var norm = Math.abs(Math.floor(num));\n        return (norm &lt; 10 ? '0' : '') + norm;\n      };\n      return now.getFullYear() +\n        '-' + pad(now.getMonth() + 1) +\n        '-' + pad(now.getDate()) +\n        'T' + pad(now.getHours()) +\n        ':' + pad(now.getMinutes());\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Internal Campaign&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;icid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - NumberOfRooms&quot;] = (function() {\n      return dataLayer[0].numberOfRooms;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - pageName&quot;] = (function() {\n      return dataLayer[0].pageName || &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - productName&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products[0].name;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products[0].name;\n        } else if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products[0].name;\n        }\n      } else return &quot;&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - sectionName&quot;] = (function() {\n      return dataLayer[0].sectionName;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - Server&quot;] = (function() {\n      return dataLayer[0].server;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal - transactionID&quot;] = (function() {\n      return dataLayer[0].transactionID;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Flashtalking Departure Date&quot;] = (function() {\n      if (dataLayer[0].dout !== undefined) {\n        return dataLayer[0].dout.split(&quot;/&quot;).reverse().join(&quot;-&quot;);\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array&quot;] = (function() {\n      if (dataLayer[0].ecommerce !== undefined) {\n        if (dataLayer[0].ecommerce.purchase !== undefined) {\n          return dataLayer[0].ecommerce.purchase.products;\n        } else if (dataLayer[0].ecommerce.checkout !== undefined) {\n          return dataLayer[0].ecommerce.checkout.products;\n        } else if (dataLayer[0].ecommerce.detail !== undefined) {\n          return dataLayer[0].ecommerce.detail.products;\n        }\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Crystal Ski - Products Array Search&quot;] = (function() {\n      if (dataLayer[0].sectionName === &quot;Search Results&quot; || dataLayer[0].sectionName === &quot;Deals&quot;) {\n\n        const ids = dataLayer[0].destinationCode || [];\n        const names = dataLayer[0].destinationName || [];\n\n        return ids.map(function(val, i) {\n          return {\n            id: val,\n            name: names[i],\n            list: dataLayer[0].pageName\n          }\n        });\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Currency&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.www.crystalski.co.uk.crystaldev.io', 'qa1.www.crystalski.co.uk.crystaldev.io', 'dev2.www.crystalski.co.uk.crystaldev.io', 'dev1.www.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'GBP';\n      } else if (document.location.host.indexOf('stage.agent.crystalski.co.uk.crystaldev.io', 'qa1.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io', 'dev2.agent.crystalski.co.uk.crystaldev.io') != -1) {\n        return 'GBP';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'EUR';\n      } else if (document.location.host.indexOf('stage.www.crystalski.ie.crystaldev.io', 'qa1.www.crystalski.ie.crystaldev.io', 'dev2.www.crystalski.ie.crystaldev.io', 'dev1.www.crystalski.ie.crystaldev.io') != -1) {\n        return 'EUR';\n      }\n      return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;currencyCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.total &amp;&amp; dl.transactions.total.currency) {\n            return dl.transactions.total.currency;\n          } else if (dl.basket &amp;&amp; dl.basket.price &amp;&amp; dl.basket.price.currency) {\n            return dl.basket.price.currency;\n          } else if (dl.product &amp;&amp; dl.product.currency) {\n            return dl.product.currency;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerAccountNumberOfBookings&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CABookings) {\n          return tui.analytics.page.CABookings;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;customerID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CustID) {\n          return tui.analytics.page.CustID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.customerID) {\n          return dataLayer[0].user.customerID;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;date&quot;] = (function() {\n      try {\n        var ddd = new Date();\n        var fyfyfy = ddd.getFullYear();\n        var mmm = ddd.getMonth() + 1;\n        var zero = &quot;0&quot;\n        if (mmm &lt; 10) {\n          mmm = zero + mmm;\n        } else {\n          mmm = mmm;\n        }\n        var daydayday = ddd.getDate();\n        var zero = &quot;0&quot;\n        if (daydayday &lt; 10) {\n          daydayday = zero + daydayday;\n        } else {\n          daydayday = daydayday;\n        }\n        var slash = &quot;/&quot;\n        var date = daydayday + slash + mmm + slash + fyfyfy\n        return date;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;daysToDeparture&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate) {\n          var depMonthYear = tui.analytics.page.MonthYear.split('/')\n          var departureDate = new Date(depMonthYear[1], depMonthYear[0] - 1, tui.analytics.page.DepDate);\n          var today = new Date();\n\n          Days = departureDate - today;\n\n          var daysToDep = Math.ceil(Days / (1000 * 60 * 60 * 24));\n\n          return daysToDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          return String(dataLayer[0].transactions.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          return String(dataLayer[0].basket.items.daysToDeparture);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          return String(dataLayer[0].product.daysToDeparture);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;decibelID&quot;] = (function() {\n      try {\n        var host = location.hostname,\n          returnVal = '';\n\n        if (~host.indexOf('tuiprjuat.co.uk')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('firstchoiceprjuat.co.uk')) {\n          returnVal = '116869';\n        } else if (~host.indexOf('tuiholidaysprjuat.ie')) {\n          returnVal = '116782';\n        } else if (~host.indexOf('tui.co.uk')) {\n          returnVal = '93210';\n        } else if (~host.indexOf('firstchoice.co.uk')) {\n          returnVal = '95707';\n        } else if (~host.indexOf('tuiholidays.ie')) {\n          returnVal = '95715';\n        }\n        return returnVal;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureAirportCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAir) {\n          return tui.analytics.page.DepAir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureAirportCode) {\n          return dataLayer[0].transactions.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureAirportCode) {\n          return dataLayer[0].basket.items.departureAirportCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureAirportCode) {\n          return dataLayer[0].product.departureAirportCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;departureDate&quot;] = (function() {\n      //date format dd/mm/yyyy\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; (tui.analytics.page.DepDate || (tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.indexOf('Dates') === -1))) {\n          var day = tui.analytics.page.DepDate;\n          var month = tui.analytics.page.MonthYear.substring(0, 2);\n          var year = tui.analytics.page.MonthYear.substring(3, 7);\n          return (day == undefined ? &quot;&quot; : day == &quot;&quot; ? &quot;&quot; : day) + '/' + month + '/' + year;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDate) {\n          return dataLayer[0].transactions.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDate) {\n          return dataLayer[0].basket.items.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDate) {\n          return dataLayer[0].product.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search.departureDate) {\n          return dataLayer[0].page.search.departureDate.split(&quot;-&quot;).reverse().join(&quot;/&quot;);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n    try {\n      var returnVal = 'none';\n      // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n      if (typeof b.departureDate === 'string') {\n        var splitDate = b.departureDate.split('/')\n        var year = splitDate[2] &amp;&amp; splitDate[2].length === 4 &amp;&amp; splitDate[2]\n        var month = splitDate[1] &amp;&amp; splitDate[1].length === 2 &amp;&amp; splitDate[1]\n        var day = splitDate[0] &amp;&amp; splitDate[0].length === 2 &amp;&amp; splitDate[0]\n        if (year &amp;&amp; month &amp;&amp; day) {\n          return year + month + day\n        }\n        // sometimes the day isn't selected (like cruises)\n        if (year &amp;&amp; month) {\n          return year + month\n        }\n      }\n      return returnVal\n    } catch (err) {\n      return returnVal;\n    }\n  })()\n\n  /*\n  Doesn't seem to work correctly on https://www.tui.co.uk/cruise/bookitineraries/Mediterranean-Medley-101129?itineraryCodeOne=101129&amp;itineraryCodeTwo=&amp;shipCode=150012&amp;mc=false&amp;isMCTracs=false&amp;isStayBefore=false&amp;stayDuration=0&amp;cruiseDuration=7&amp;duration=1-7&amp;noOfAdults=2&amp;noOfChildren=0&amp;childrenAge=&amp;from[]=BOH:Airport&amp;to[]=101129:Itinerary&amp;flexibility=false&amp;noOfSeniors=0&amp;when=12-10-2021&amp;sailingDate=12Oct21&amp;to[]=&amp;packageId=16340190000001634030400000TOM620416346388000001634643300000TOM62051181672602/3/650/7ZI01&amp;index=3&amp;brandType=null&amp;addAStay=0&amp;cabin[]=1,2&amp;dp=BOH&amp;bb=AI&amp;cabinOnly=false&amp;mcId=101129|T&amp;searchVariant=FLY_CRUISE_ATCOM\n\n  Attempting to replace it\n\n  try {\n    b[&quot;departureDate YYYYMMDD&quot;] = (function() {\n      try {\n        var returnVal = 'none';\n        // function for returning Departure Date, used in Adobe Departure Date (evar14). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/09/17\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n          var dl = dataLayer[0];\n\n          if (dl.page &amp;&amp; dl.page.search &amp;&amp; dl.page.search.departureDate) {\n            returnVal = dl.page.search.departureDate;\n          } else if (dl.product &amp;&amp; dl.product.departureDate) {\n            returnVal = dl.product.departureDate;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.departureDate) {\n            returnVal = dl.basket.items.departureDate;\n          } else if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.departureDate) {\n            returnVal = dl.transactions.items.departureDate;\n          }\n          return returnVal.replace(/-/g, '');\n        } else if (tui.analytics.page.MonthYear) {\n          var year = tui.analytics.page.MonthYear &amp;&amp; tui.analytics.page.MonthYear.split('/').length &gt; 0 ? tui.analytics.page.MonthYear.split('/')[1] : '';\n          month = tui.analytics.page.MonthYear ? tui.analytics.page.MonthYear.split('/')[0] : '';\n          day = tui.analytics.page.DepDate;\n\n          return [year, month, day].join('');\n        }\n        return returnVal;\n      } catch (err) {\n        return returnVal;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  */\n\n  try {\n    b[&quot;departureDateDifference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDateDiff) {\n          return tui.analytics.page.DepDateDiff;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureDateDifference) {\n          return dataLayer[0].product.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureDateDifference) {\n          return dataLayer[0].basket.items.departureDateDifference;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureDateDifference) {\n          return dataLayer[0].transactions.items.departureDateDifference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionsAvailable&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOpt) {\n          return tui.analytics.page.DepOpt;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.availableDepositOptions) {\n          return dataLayer[0].basket.price.availableDepositOptions;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositOptionSelected&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepOptSel) {\n          return tui.analytics.page.DepOptSel;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.depositValue) {\n          return dataLayer[0].transactions.total.depositValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;depositValueBookflow&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') == -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationBrowse&quot;] = (function() {\n      //to be updated later\n      try {\n        var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n        var destination = (function() {\n          switch (pageType) {\n            case 'COUNTRY':\n            case 'Destination_Country':\n            case 'Destination_Country_TTD':\n            case 'REGION':\n            case 'Destination_Region':\n              return document.getElementsByClassName('pg-heading')[0].innerText.split(&quot; Holidays&quot;)[0];\n            case 'DESTINATION':\n            case 'Destination_Destination':\n            case 'RESORT':\n            case 'Destination_Resort':\n              return document.getElementsByClassName('page-title')[0].innerHTML.split(&quot; Holidays&quot;)[0];\n            case 'ACCOMMODATION':\n            case 'Destination_Accommodation':\n              return document.querySelector(&quot;.bread-viewport&quot;).childNodes[1].childNodes[3].innerText.slice(0, -1);\n            default:\n              return '';\n          }\n        })()\n        return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationCode) {\n          return dataLayer[0].transactions.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationCode) {\n          return dataLayer[0].basket.items.geo.destinationCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationCode) {\n          return dataLayer[0].product.geo.destinationCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationFC&quot;] = (function() {\n      try {\n        function titleCase(str) {\n          str = str ? str.toLowerCase().split(' ') : [];\n          for (var i = 0; i &lt; str.length; i++) {\n            str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n          }\n          return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n        }\n\n        if (tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n          return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/PPPPP/g, &quot;&quot;));\n        } else {\n          return titleCase(document.getElementsByClassName('uppercase tui-dark-blue destinations-name')[0].outerText.replace(&quot;DESTINATIONS IN &quot;, &quot;&quot;));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationIMG&quot;] = (function() {\n      try {\n        var url = document.getElementsByClassName('hero-img')[0].children[0].currentSrc;\n        var widthreplace = url.replace(/width:1080/g, &quot;width:364&quot;);\n        var heightreplace = widthreplace.replace(/height:608/g, &quot;height:180&quot;);\n        return heightreplace;\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.destinationName) {\n          return dataLayer[0].transactions.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.destinationName) {\n          return dataLayer[0].basket.items.geo.destinationName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.destinationName) {\n          return dataLayer[0].product.geo.destinationName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPrice&quot;] = (function() {\n      try {\n\t\tif(tui.analytics.page.contextType == &quot;ACCOMMODATION&quot;) {\n\t\t\treturn document.getElementsByClassName('actual-price')[0].outerText;\n\t\t}\n\t\telse {\n\t\t\treturn document.getElementsByClassName('amount')[0].outerText;\n\t\t}\n\t}\n\tcatch (err){\n\t\treturn &quot;500&quot;;\n\t}\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;destinationPush&quot;] = (function() {\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var destination = (function() {\n        switch (pageType) {\n          case 'CONTINENT':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'COUNTRY':\n          case 'Destination_Country':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'Destination_Country_TTD':\n          case 'REGION':\n          case 'Destination_Region':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'DESTINATION':\n          case 'Destination_Destination':\n          case 'RESORT':\n          case 'Destination_Resort':\n            return document.getElementsByClassName('page-title')[0].innerHTML.replace(&quot; Holidays&quot;, &quot;&quot;).trim();\n          case 'ACCOMMODATION':\n          case 'Destination_Accommodation':\n            function titleCase(str) {\n              str = str ? str.toLowerCase().split(' ') : [];\n              for (var i = 0; i &lt; str.length; i++) {\n                str[i] = str[i].charAt(0).toUpperCase() + str[i].slice(1);\n              }\n              return str.join(' ').replace(/Tui/g, &quot;TUI&quot;);\n            }\n            return titleCase(document.getElementsByClassName('pg-heading')[0].childNodes[1].outerText.replace(/OOOOO/g, &quot;&quot;));\n          default:\n            return 'a holiday';\n        }\n      })()\n      return destination.replace(/^\\s+|\\s+$/g, &quot;&quot;);\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;device&quot;] = (function() {\n      try {\n        var deviceDetector = (function() {\n          var ua = navigator.userAgent.toLowerCase();\n          var detect = (function(s) {\n            if (s === undefined) s = ua;\n            else ua = s.toLowerCase();\n            if (/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(ua))\n              return 'Tablet';\n            else\n            if (/(mobi|ipod|phone|blackberry|opera mini|fennec|minimo|symbian|psp|nintendo ds|archos|skyfire|puffin|blazer|bolt|gobrowser|iris|maemo|semc|teashark|uzard)/.test(ua))\n              return 'Mobile';\n            else return 'Desktop';\n          });\n          return {\n            device: detect(),\n            detect: detect,\n            isMobile: ((detect() != 'desktop') ? true : false),\n            userAgent: ua\n          };\n        }());\n\n        return deviceDetector.device;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directDebit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DirectDebit) {\n          return tui.analytics.page.DirectDebit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;directOrIndirectFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InDir) {\n          return tui.analytics.page.InDir;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.directOrIndirectFlight) {\n          return dataLayer[0].transactions.items.directOrIndirectFlight;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.directOrIndirectFlight) {\n          return dataLayer[0].basket.items.directOrIndirectFlight;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;dreamlinerFlight&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DreamFl) {\n          return tui.analytics.page.DreamFl;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;duration&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          return tui.analytics.page.Dur;\n        } else if (tui.analytics.page.STDur &amp;&amp; tui.analytics.page.STDur.toLowerCase() == &quot;null&quot;) {\n          return tui.analytics.page.CRDur;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.STDur &amp;&amp; tui.analytics.page.CRDur) {\n          return parseInt(tui.analytics.page.CRDur) + parseInt(tui.analytics.page.STDur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          return dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          return dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          return dataLayer[0].product.duration;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationCode&quot;] = (function() {\n      try {\n        var dur = &quot;&quot;;\n        var durCode;\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Dur) {\n          dur = parseInt(tui.analytics.page.Dur);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.duration) {\n          dur = dataLayer[0].transactions.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.duration) {\n          dur = dataLayer[0].basket.items.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.duration) {\n          dur = dataLayer[0].product.duration;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.duration) {\n          dur = dataLayer[0].page.search.duration;\n        }\n\n\n        switch (dur) {\n          case 1:\n            durCode = '1245';\n            break;\n          case 2:\n          case 3:\n          case 4:\n            durCode = '4321';\n            break;\n          case 5:\n          case 6:\n          case 7:\n          case 8:\n          case 9:\n            durCode = '7114';\n            break;\n          case 10:\n            durCode = '1014';\n            break;\n          case 11:\n            durCode = '1114';\n            break;\n          case 12, 13, 14, 15, 16:\n            durCode = '1413';\n            break;\n          default:\n            durCode = '2118';\n        }\n\n        return durCode;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;durationSearched&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DurationSearched) {\n          return tui.analytics.page.DurationSearched;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.durationSearched) {\n          return dataLayer[0].page.search.durationSearched;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;emailHash&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Eml) {\n          return tui.analytics.page.Eml;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.hashedEmail) {\n          return dataLayer[0].user.hashedEmail;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;epicCode&quot;] = (function() {\n      try {\n        if (document.location.href.indexOf('cruise') == -1) {\n          if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.WhereTo) {\n            return tui.analytics.page.WhereTo;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productID) {\n            return dataLayer[0].transactions.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productID) {\n            return dataLayer[0].basket.items.productID;\n          } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productID) {\n            return dataLayer[0].product.productID;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;facebookPixelFire&quot;] = (function() {\n      try {\n        //let days = Bootstrapper.data.resolve('Manage.TUI UK - Generic.daysToDeparture');\n        let days = b.daysToDeparture\n        //let carrier = Bootstrapper.data.resolve('Manage.TUI UK - Generic.carrierCode');\n        let carrier = b.carrierCode\n        //Fire FB Pixel Logic\n        if (days &lt; 180 &amp;&amp; carrier === &quot;TOM|TOM&quot;) {\n          return 'YES';\n        } else {\n          return 'NO';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterAccommodationType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AccomTypeF) {\n          return tui.analytics.page.AccomTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;accommodationType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBackTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BackTimeF) {\n          return tui.analytics.page.BackTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;inslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBestFor&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BestForF) {\n          return tui.analytics.page.BestForF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;bestfor&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBoard&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BoardF) {\n          return tui.analytics.page.BoardF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;boardBasis&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterBudget&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BudgetF) {\n          return tui.analytics.page.BudgetF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;budgettotal&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseCabin&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CabinF) {\n          return tui.analytics.page.CabinF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRGeoF) {\n          return tui.analytics.page.CRGeoF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseShip&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRShipF) {\n          return tui.analytics.page.CRShipF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterCruiseStayDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CRStayF) {\n          return tui.analytics.page.CRStayF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDepartureAirport&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepAirF) {\n          return tui.analytics.page.DepAirF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;departurePoints&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterDestination&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.GeoF) {\n          return tui.analytics.page.GeoF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;destinations&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFeatures&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FeaturesF) {\n          return tui.analytics.page.FeaturesF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;features&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterFreeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FreeKidsF) {\n          return tui.analytics.page.FreeKidsF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;isFCP&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterHolidayType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.HolTypeF) {\n          return tui.analytics.page.HolTypeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayType&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterOutTime&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OutTimeF) {\n          return tui.analytics.page.OutTimeF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;outslots&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterSingleAccommodationEndState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.filters) {\n          return window.tui.analytics.page.filters.reduce(function(a, c, i) {\n            i === 0 ? c.filterValue : a + ',' + c.filterValue;\n          }, '')\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n\n  try {\n    b[&quot;filterSortBy&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SortByF) {\n          return tui.analytics.page.SortByF;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTourOperator&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TourOperatorF) {\n          return tui.analytics.page.TourOperatorF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters;\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;holidayOperator&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARatingF) {\n          return tui.analytics.page.TARatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;taRatingF&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;filterTuiRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RatingF) {\n          return tui.analytics.page.RatingF;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.filters) {\n          var filters = dataLayer[0].product.filters\n          var i;\n          for (i = 0; i &lt; filters.length; i++) {\n            if (dataLayer[0].product.filters[i].filterName == &quot;fcRating&quot;) {\n              return (dataLayer[0].product.filters[i].filterValue);\n            }\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;firstPartyAncillaries&quot;] = (function() {\n      try {\n\n        var arrayItems = &quot;&quot;;\n        var itemValue = &quot;&quot;;\n\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TuiAnc) {\n          return tui.analytics.page.TuiAnc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.subItems) {\n          arrayItems = dataLayer[0].transactions.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.subItems) {\n          arrayItems = dataLayer[0].basket.items.subItems;\n          for (i = 0; i &lt; arrayItems.length; i++) {\n            itemValue += arrayItems[i].productID + &quot;|&quot; + arrayItems[i].quantity.pax + &quot;|&quot; + arrayItems[i].price.currentPrice +\n              (i == arrayItems.length - 1 ? &quot;&quot; : &quot;-&quot;)\n          }\n          return itemValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flexibleDates&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FlexDate) {\n          return tui.analytics.page.FlexDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flexibleDates) {\n          return dataLayer[0].page.search.flexibleDates;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.ACSSRef) {\n          return tui.analytics.page.ACSSRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasCheckedInState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CheckIn) {\n          return tui.analytics.page.CheckIn;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightExtrasInboundDays&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.InboundDays) {\n          return tui.analytics.page.InboundDays;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightInventory&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltInv) {\n          return tui.analytics.page.FltInv;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.flightInventory) {\n          return dataLayer[0].transactions.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.flightInventory) {\n          return dataLayer[0].basket.items.flightInventory;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.flightInventory) {\n          return dataLayer[0].product.flightInventory;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightOnlyDeparturePeriod&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepPeriod) {\n          return tui.analytics.page.DepPeriod;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;flightType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FltType) {\n          return tui.analytics.page.FltType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productSubType &amp;&amp; (dataLayer[0].transactions.items.productSubType == &quot;Inbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Outbound&quot; || dataLayer[0].transactions.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].transactions.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productSubType &amp;&amp; (dataLayer[0].basket.items.productSubType == &quot;Inbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Outbound&quot; || dataLayer[0].basket.items.productSubType == &quot;Return&quot;)) {\n          return dataLayer[0].basket.items.productSubType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.flightType) {\n          dataLayer[0].page.search.flightType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlacePartySize&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PartySize) {\n          return tui.analytics.page.PartySize;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;freeChildPlaces&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SelectScope) {\n          return tui.analytics.page.SelectScope;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.freeKidsAvailable) {\n          return dataLayer[0].product.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.freeKidsAvailable) {\n          return dataLayer[0].basket.items.freeKidsAvailable;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.freeKidsAvailable) {\n          return dataLayer[0].transactions.items.freeKidsAvailable;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;geoLevel&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) {\n          return tui.analytics.page.contextType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;gmpCustomerID&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('qcmk') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;qcmk=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics Property ID&quot;] = (function() {\n      if (document.location.host === 'www.crystalski.co.uk' || document.location.host === 'crystalski.co.uk') {\n        return 'UA-64722569-1';\n      } else if ([&quot;dev1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.www.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.www.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.www.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64722569-8';\n      } else if (document.location.host === 'agent.crystalski.co.uk') {\n        return 'UA-64996454-1';\n      } else if ([&quot;dev1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;dev2.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;qa1.agent.crystalski.co.uk.crystaldev.io&quot;, &quot;stage.agent.crystalski.co.uk.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-64996454-2';\n      } else if (document.location.host === 'www.crystalski.ie') {\n        return 'UA-65009155-1';\n      } else if ([&quot;dev1.www.crystalski.ie.crystaldev.io&quot;, &quot;dev2.www.crystalski.ie.crystaldev.io&quot;, &quot;qa1.www.crystalski.ie.crystaldev.io&quot;, &quot;stage.www.crystalski.ie.crystaldev.io&quot;\n        ].indexOf(document.location.host) != -1) {\n        return 'UA-65009155-2';\n      } else return '';\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Google Analytics - New Property ID&quot;] = (function() {\n\n      var tui_new_prod = 'UA-107596466-5';\n      var tui_new_dev = 'UA-107596466-6';\n      var fc_new_prod = 'UA-107596466-7';\n      var fc_new_dev = 'UA-107596466-8';\n      var tui_ie_new_prod = 'UA-39088453-1';\n      var tui_ie_new_dev = 'UA-39088453-3';\n\n      try {\n        // Check if it is prod bootstrap\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Production\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK - New:' + fc_new_prod);\n            return fc_new_prod;\n          }\n          // TUI IE Production\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE:' + tui_ie_new_prod);\n            return tui_ie_new_prod;\n          }\n          // TUI UK Production\n          else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - New:' + tui_new_prod);\n            return tui_new_prod;\n          } else {\n            return tui_new_dev;\n          }\n        }\n        // Check if it is dev bootstrap\n        else if (/^(hybrisdev|paymentpagedev|dev)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          // FC Development\n          if (document.location.hostname.indexOf('firstchoice') !== -1) {\n            console.log('GA Property:FC UK Dev - New:' + fc_new_dev);\n            return fc_new_dev;\n          }\n          // TUI IE Development\n          else if (document.location.hostname.indexOf('tuiholidays') !== -1) {\n            console.log('GA Property:TUI IE - Dev:' + tui_ie_new_dev);\n            return tui_ie_new_dev;\n          } else if (document.location.hostname.indexOf('tui') !== -1) {\n            console.log('GA Property:TUI UK - Dev New:' + tui_new_dev);\n            return tui_new_dev;\n          }\n        }\n        // Fallback to dev\n        else {\n          console.log('GA Property:TUI UK - Dev New FALLBACK:' + tui_new_dev);\n          return tui_new_dev;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsClientID&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('_ga2')) {\n          return Bootstrapper.Cookies.get('_ga2').slice(6);\n        } else if (Bootstrapper.Cookies.get('_ga')) {\n          return Bootstrapper.Cookies.get('_ga').slice(6);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;googleAnalyticsPropertyID&quot;] = (function() {\n      try {\n        if (/^(hybrisprod|paymentpage|prod)$/i.test(Bootstrapper.ensightenOptions.publishPath)) {\n          return 'UA-107596466-1';\n        }\n        return 'UA-107596466-3';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;handLuggageOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Hlo) {\n          return tui.analytics.page.Hlo;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.handLuggageOnly) {\n          return dataLayer[0].transactions.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.handLuggageOnly) {\n          return dataLayer[0].basket.items.handLuggageOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.handLuggageOnly) {\n          return dataLayer[0].product.handLuggageOnly;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;haulTypeSearch&quot;] = (function() {\n\n      //Iterates through search results list and counts SH/LH destinations. Returns haul type with higher count.\n      //Used for audience building/retargeting purposes.\n\n      //Beach Search Results\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList) {\n          var results = dataLayer[0].page.search.resultsList;\n          var haulList = [],\n            countSH = 0,\n            countLH = 0;\n\n          results.forEach(function(item) {\n            if (item.haulCode === 'SH') {\n              countSH++;\n            } else if (item.haulCode === 'LH') {\n              countLH++;\n            }\n          });\n\n          if (countLH &gt; countSH) {\n            return 'LH';\n          } else {\n            return 'SH';\n          }\n        }\n      } catch (e) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hostname&quot;] = (function() {\n      try {\n        return document.location.host;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;hotelName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productName &amp;&amp; dataLayer[0].transactions.items.productType &amp;&amp; (dataLayer[0].transactions.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].transactions.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productName &amp;&amp; dataLayer[0].basket.items.productType &amp;&amp; (dataLayer[0].basket.items.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].basket.items.productName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productName &amp;&amp; dataLayer[0].product.productType &amp;&amp; (dataLayer[0].product.productType == &quot;Beach&quot;)) {\n          return dataLayer[0].product.productName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].accomName) {\n          return jsonData.packageViewData.accomViewData[0].accomName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;irClickID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; irclickid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isAccommodationOnly&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AOType) {\n          return tui.analytics.page.AOType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.isAccommodationOnly) {\n          return dataLayer[0].transactions.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.isAccommodationOnly) {\n          return dataLayer[0].basket.items.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.isAccommodationOnly) {\n          return dataLayer[0].product.isAccommodationOnly;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].search &amp;&amp; dataLayer[0].search.isAccommodationOnly) {\n          return dataLayer[0].search.isAccommodationOnly;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isChoiceSearch&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.IsChoiceSearch &amp;&amp; tui.analytics.page.IsChoiceSearch != 'null') {\n          return tui.analytics.page.IsChoiceSearch;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isChoiceSearch) {\n          return dataLayer[0].page.search.isChoiceSearch;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteBooking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteBooking &amp;&amp; tui.analytics.page.isCreditNoteBooking != 'null') {\n          return tui.analytics.page.isCreditNoteBooking;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteBooking) {\n          return dataLayer[0].transactions.total.isCreditNoteBooking;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCreditNoteIncentiveEligible&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible &amp;&amp; tui.analytics.page.isCreditNoteIncentiveEligible != 'null') {\n          return tui.analytics.page.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].transactions.total.isCreditNoteIncentiveEligible.toLowerCase();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isCreditNoteIncentiveEligible) {\n          return dataLayer[0].basket.price.isCreditNoteIncentiveEligible.toLowerCase();\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isCRM&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;cmid&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isLowDeposit&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LowDep) {\n          return tui.analytics.page.LowDep;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.price.isLowDeposit;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.total.isLowDeposit;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isPush&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf(&quot;im_id=Push&quot;) &gt; -1) {\n          return &quot;YES&quot;;\n        } else {\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSearch&quot;] = (function() {\n\n      try {\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          return &quot;YES&quot;;\n        } else {\n\n          return &quot;NO&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;isSEO&quot;] = (function() {\n      try {\n        var isSearch;\n        var isSEO;\n\n        if (document.referrer.indexOf(&quot;aol.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;ask.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yahoo.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;bing.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;google.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;msn.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;yandex.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else if (document.referrer.indexOf(&quot;live.&quot;) &gt; -1) {\n\n          isSearch = &quot;YES&quot;;\n        } else {\n\n          isSearch = &quot;NO&quot;;\n        }\n\n        if (isSearch === &quot;YES&quot;) {\n\n          if (window.location.search.indexOf(&quot;im_id&quot;) &gt; -1) {\n\n            isSEO = &quot;NO&quot;;\n          } else {\n\n            isSEO = &quot;YES&quot;;\n          }\n        } else {\n          isSEO = &quot;NO&quot;;\n        }\n        return isSEO;\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvB) {\n          return tui.analytics.page.LimAvB;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilityBeds) {\n          return dataLayer[0].product.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilityBeds) {\n          return dataLayer[0].basket.items.limitedAvailabilityBeds;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilityBeds) {\n          return dataLayer[0].transactions.items.limitedAvailabilityBeds;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilityCabins&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvC) {\n          return tui.analytics.page.LimAvC;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;limitedAvailabilitySeats&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.LimAvS) {\n          return tui.analytics.page.LimAvS;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.limitedAvailabilitySeats) {\n          return dataLayer[0].product.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.limitedAvailabilitySeats) {\n          return dataLayer[0].basket.items.limitedAvailabilitySeats;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.limitedAvailabilitySeats) {\n          return dataLayer[0].transactions.items.limitedAvailabilitySeats;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price - Booking Check&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid &amp;&amp; tui.analytics.page.pageUid == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return &quot;LYPUnconfirmed&quot;;\n        } else {\n          return &quot;FireBooking&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Available&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.isLockYourPriceAvailable &amp;&amp; (dataLayer[0].basket.price.lockYourPriceCost &gt;= 0)) {\n          return (dataLayer[0].basket.price.isLockYourPriceAvailable + &quot;|&quot; + (dataLayer[0].basket.price.lockYourPriceCost == 0 ? 'zero' : dataLayer[0].basket.price.lockYourPriceCost));\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Confirmed Booking&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return 1;\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Revenue&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/confirmation') !== -1) {\n          if (window.dataLayer[0].transactions.total.isLockYourPrice == &quot;Yes&quot; || window.dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n            return window.dataLayer[0].transactions.total.lockYourPriceValue;\n          }\n        } else if (document.URL.indexOf('/managemybooking/paymentconfirmation') !== -1) {\n          return (window.dataLayer[0].transactions.total.lockYourPriceValue * -1);\n        }\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return 1;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Lock Your Price Unconfirmed Booking Revenue&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID == &quot;lockYourPriceConfirmationpage_react&quot;) {\n          return dataLayer[0].transactions.total.totalPrice;\n        } else {\n          return &quot;&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;loginDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.CLogin) {\n          return tui.analytics.page.CLogin;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.loggedInStatus) {\n          return dataLayer[0].user.loggedInStatus;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;minimumPaymentAmount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MinPay) {\n          return tui.analytics.page.MinPay;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.minPaymentAmount) {\n          return dataLayer[0].transactions.items.minPaymentAmount;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.minPaymentAmount) {\n          return dataLayer[0].basket.items.minPaymentAmount;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RPRef) {\n          return tui.analytics.page.RPRef;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MMBPayments) {\n          return tui.analytics.page.MMBPayments;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmendmentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AandCType) {\n          return tui.analytics.page.AandCType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAmountOutstanding&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AmountOutstanding) {\n          return tui.analytics.page.AmountOutstanding;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.amountOustanding) {\n          return dataLayer[0].user.currentBookings.amountOustanding;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.AcAnc) {\n          return tui.analytics.page.AcAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingAmount&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('your-account') != -1) {\n          return (window.tui.analytics.page.Amount || '');\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbBookingType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.BookingType) {\n          return tui.analytics.page.BookingType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbExistingBookingDepartureDate&quot;] = (function() {\n      try {\n        // returns in yyyymmdd format\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.items &amp;&amp; dataLayer[0].user.currentBookings.items.departureDate) {\n          return dataLayer[0].user.currentBookings.items.departureDate.replace(/-/gi, '');\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbPaymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;mmbTransactionValue&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TransactionValue) {\n          return tui.analytics.page.TransactionValue;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;month&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear.substring(0, 2);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;monthYear&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          return tui.analytics.page.MonthYear;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureMonth &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].transactions.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].transactions.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].transactions.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureMonth &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].basket.items.departureMonth.split('-')[1]) {\n          return dataLayer[0].basket.items.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].basket.items.departureMonth.split('-')[0];\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureMonth &amp;&amp; dataLayer[0].product.departureMonth.split('-')[0] &amp;&amp; dataLayer[0].product.departureMonth.split('-')[1]) {\n          return dataLayer[0].product.departureMonth.split('-')[1] + &quot;/&quot; + dataLayer[0].product.departureMonth.split('-')[0]\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;navigationTracking&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.navigation) {\n          return tui.analytics.page.navigation;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newDataLayer&quot;] = (function() {\n      try {\n        return dataLayer[0].page ? 'true' : 'false';\n      } catch (err) {\n        return 'false';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;newSEOdata&quot;] = (function() {\n      //Variable Declarations\n      var refOrigin = document.createElement('a');\n      refOrigin.href = document.referrer;\n      var lpurl = window.location.href;\n      var urlLength = lpurl.length;\n      var siteSection;\n      var destination;\n      var pageName = (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) ? dataLayer[0].page.pageID : (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) ? tui.analytics.page.pageUid : '';\n      var pageType = (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.contextType) ? tui.analytics.page.contextType : '';\n      var pageHead = (function() {\n        try {\n          var a = document.getElementsByClassName('pg-heading')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n      var pageTitle = (function() {\n        try {\n          var a = document.getElementsByClassName('page-title')[0].innerText;\n          return a\n        } catch (err) {\n          var a = &quot;null&quot;;\n          return a\n        }\n      })()\n\n      if (document.domain === 'www.tui.co.uk') {\n        //TUI SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;cruise&quot;) &gt; -1):\n            siteSection = 'Cruise';\n            break;\n          case (lpurl.indexOf(&quot;flight&quot;) &gt; -1):\n            siteSection = 'Flight';\n            break;\n          case (lpurl.indexOf(&quot;city-breaks&quot;) &gt; -1):\n            siteSection = 'Cities';\n            break;\n          case (lpurl.indexOf(&quot;multi-centre&quot;) &gt; -1):\n            siteSection = 'Multi-Centre';\n            break;\n          case (lpurl.indexOf(&quot;lakes-and-mountains&quot;) &gt; -1):\n            siteSection = 'Lakes-and-Mountains';\n            break;\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account';\n            break;\n          case (lpurl.indexOf(&quot;my-thomson-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/hotels/&quot;) &gt; -1):\n            siteSection = 'Hotels'\n            break;\n            //Discover\n          case (lpurl.indexOf(&quot;discover&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;articles&quot;) &gt; -1):\n            siteSection = 'Discover';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;europe&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;asia&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;africa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;caribbean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;the-americas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;indian-ocean&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;holiday-destinations&quot;) &gt; -1):\n            siteSection = 'Destinations';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensimar&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;small-and-friendly&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family-life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;robinson&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;villas&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;gold&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;platinum&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;scene&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;a-la-carte&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;3t-favourites&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;skytours&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;simply&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;local-flavour&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;riu&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;tui-blue&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;magic-life&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;couples&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;weddings&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;nightlife&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;collection&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;spa&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;sensatori&quot;) &gt; -1):\n            siteSection = 'Best-For';\n            break;\n            //Homepage\n          case (window.location.pathname.length == 1):\n          case (lpurl.substring(urlLength - 13, urlLength) == 'destinations/'):\n            siteSection = 'Homepage'\n            break;\n            //Other\n          case (pageName === &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n            break;\n        }\n        //TUI Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            destination = document.querySelector(&quot;#breadcrumbs&quot;).childNodes[3].text;\n            break;\n          case (siteSection == 'Destinations'):\n            if (pageType === &quot;COUNTRY&quot; || pageType === &quot;REGION&quot;) {\n              destination = pageHead.substring(0, pageHead.length - 10);\n            } else if (pageType === &quot;RESORT&quot; || pageType === &quot;DESTINATION&quot;) {\n              destination = pageTitle;\n            }\n            break;\n          default:\n            destination = 'null';\n        }\n      } else if (document.domain === 'www.firstchoice.co.uk') {\n        //FirstChoice SiteSection\n        switch (true) {\n          //Sections\n          case (lpurl.indexOf(&quot;holiday-extras&quot;) &gt; -1):\n            siteSection = 'Extras';\n            break;\n          case (lpurl.indexOf(&quot;your-account&quot;) &gt; -1):\n            siteSection = 'Customer-Account'\n            break;\n          case (lpurl.indexOf(&quot;my-first-choice-app&quot;) &gt; -1):\n            siteSection = 'App';\n            break;\n          case (lpurl.indexOf(&quot;travel-information&quot;) &gt; -1):\n            siteSection = 'Travel-Information';\n            break;\n          case (lpurl.indexOf(&quot;/info/&quot;) &gt; -1):\n            siteSection = 'Info';\n            break;\n          case (lpurl.indexOf(&quot;blog&quot;) &gt; -1):\n            siteSection = 'Blog';\n            break;\n          case (lpurl.indexOf(&quot;/accommodation&quot;) &gt; -1):\n            siteSection = 'Hotels';\n            break;\n            //Destinations\n          case (lpurl.indexOf(&quot;location&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 12, urlLength) == 'destinations'):\n            siteSection = 'Destinations';\n            break;\n            //Collections\n          case (lpurl.indexOf(&quot;Holiday-Village&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SplashWorld&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;Magic-Life&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;SuneoClub&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;premier-holidays&quot;) &gt; -1):\n            siteSection = 'Collections';\n            break;\n            //Best For\n          case (lpurl.indexOf(&quot;luxury&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;family&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;adult&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;beach&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;long-haul&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;award-winners&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;all-inclusive&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;activity&quot;) &gt; -1):\n          case (lpurl.substring(urlLength - 3, urlLength) == 'spa'):\n          case (lpurl.substring(urlLength - 9, urlLength) == 'holidays/'):\n            siteSection = 'Best-For';\n            break;\n            //Deals\n          case (lpurl.indexOf(&quot;deals&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;last-minute&quot;) &gt; -1):\n          case (lpurl.indexOf(&quot;free-child-places&quot;) &gt; -1):\n            siteSection = 'Deals';\n            break;\n            //Homepage\n          case (lpurl.substring(urlLength - 10, urlLength) == 'holiday/'):\n          case (window.location.pathname.length == 1):\n            siteSection = 'Homepage';\n            break;\n          case (pageName == &quot;technicaldifficultiespage&quot; || pageName === &quot;pagenotfounderrorpage&quot; || pageName === &quot;sessiontimeoutpage&quot;):\n            siteSection = 'Error-Page';\n            break;\n          default:\n            siteSection = 'Other';\n        }\n        //FirstChoice Destination\n        switch (true) {\n          case (siteSection == 'Hotels'):\n            var cutone = lpurl.substring(61, lpurl.length);\n            destination = cutone.substring(0, cutone.indexOf(&quot;/&quot;));\n            break;\n          case (siteSection == 'Destinations'):\n            destination = pageTitle;\n            break;\n          default:\n            destination = 'null';\n        }\n      }\n      //Output\n\n      //return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + encodeURIComponent(lpurl);\n\n      if (lpurl.indexOf(&quot;utm_medium=TDA&quot;) &gt; -1) {\n        return &quot;&quot;;\n      } else {\n        return refOrigin.host + '|' + siteSection + '.' + pageName + '.' + destination + '.' + lpurl;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;noOfRooms&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.numberOfRooms) {\n          return dataLayer[0].transactions.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.numberOfRooms) {\n          return dataLayer[0].basket.items.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.noOfRooms) {\n          return dataLayer[0].basket.items.noOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.numberOfRooms) {\n          return dataLayer[0].product.numberOfRooms;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfRooms) {\n          return dataLayer[0].product.noOfRooms;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfAdults&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; jsonData.packageViewData.paxViewData.noOfAdults) {\n          return jsonData.packageViewData.paxViewData.noOfAdults;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults) {\n          return parseInt(tui.analytics.page.Adults);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.adults) {\n          return dataLayer[0].transactions.total.paxDetails.adults\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.adults) {\n          return dataLayer[0].basket.price.paxDetails.adults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfAdults) {\n          return dataLayer[0].product.noOfAdults;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfAdults) {\n          return dataLayer[0].page.search.noOfAdults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfChildren&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfChildren) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfChildren &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfChildren;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Children) {\n          return parseInt(tui.analytics.page.Children);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.children\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.children) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.children &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.children;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfChildren &gt;= 0)) {\n          return dataLayer[0].product.noOfChildren;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfChildren) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfChildren &gt;= 0)) {\n          return dataLayer[0].page.search.noOfChildren;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfInfants&quot;] = (function() {\n      try {\n        if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.paxViewData &amp;&amp; (typeof(jsonData.packageViewData.paxViewData.noOfInfants) != &quot;undefined&quot; &amp;&amp; jsonData.packageViewData.paxViewData.noOfInfants &gt;= 0)) {\n          return jsonData.packageViewData.paxViewData.noOfInfants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Infants) {\n          return parseInt(tui.analytics.page.Infants);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; (typeof(dataLayer[0].transactions.total.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].transactions.total.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].transactions.total.paxDetails.infants\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; (typeof(dataLayer[0].basket.price.paxDetails.infants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].basket.price.paxDetails.infants &gt;= 0)) {\n          return dataLayer[0].basket.price.paxDetails.infants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; (typeof(dataLayer[0].product.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].product.noOfInfants &gt;= 0)) {\n          return dataLayer[0].product.noOfInfants;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; (typeof(dataLayer[0].page.search.noOfInfants) != &quot;undefined&quot; &amp;&amp; dataLayer[0].page.search.noOfInfants &gt;= 0)) {\n          return dataLayer[0].page.search.noOfInfants;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfPax&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Pax) {\n          return tui.analytics.page.Pax;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paxDetails &amp;&amp; dataLayer[0].transactions.total.paxDetails.total) {\n          return dataLayer[0].transactions.total.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.paxDetails &amp;&amp; dataLayer[0].basket.price.paxDetails.total) {\n          return dataLayer[0].basket.price.paxDetails.total.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.noOfPax) {\n          return dataLayer[0].product.noOfPax.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfPax) {\n          return dataLayer[0].page.search.noOfPax.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;numberOfResults&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Results) {\n          return tui.analytics.page.Results;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.noOfResults) {\n          return dataLayer[0].page.search.noOfResults;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;onlineDiscount&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Disc) {\n          return tui.analytics.page.Disc;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.discount) {\n          return Math.round(dataLayer[0].transactions.total.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.discount) {\n          return Math.round(dataLayer[0].basket.price.discount).toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.discount) {\n          return Math.round(dataLayer[0].product.discount).toString();\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.onlineDiscount) {\n          return Math.round(jsonData.packageViewData.onlineDiscount).toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.pageUid) {\n          return tui.analytics.page.pageUid;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID) {\n          return dataLayer[0].page.pageID;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeCount&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          return '1';\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeFullyLoaded&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.loadEventEnd - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageLoadTimeInteractive&quot;] = (function() {\n      try {\n        if (window.performance &amp;&amp; performance.timing) {\n          var returnVal = performance.timing.domInteractive - performance.timing.navigationStart;\n          return parseInt(returnVal, 10) &gt; 0 ? (parseFloat(returnVal) / 1000).toString() : undefined;\n        }\n        return undefined;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageNameTemporary&quot;] = (function() {\n\n      try {\n\n        var path = document.location.href;\n        var pathArray = path.split('/');\n\n\n        if (document.location.hostname.indexOf('thomson.co.uk') != -1 || document.location.hostname.indexOf('thomsonprjuat.co.uk') != -1 || document.location.hostname.indexOf('tui.co.uk') != -1 || document.location.hostname.indexOf('tuiprjuat.co.uk') != -1) {\n          // TUI Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;tui:homepage&quot;;\n          }\n          // TUI Cruise\n          if (document.location.pathname.match(/^\\/$|^\\/cruise/) !== null) {\n            return &quot;tui:cruises&quot;;\n          }\n          // TUI Flights\n          if (document.location.pathname.match(/^\\/$|^\\/flight/) !== null) {\n            return &quot;tui:flights&quot;;\n          }\n          // TUI Deals\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals/) !== null) {\n            return &quot;tui:deals:&quot; + (pathArray[5]);\n          }\n          // CR Deals - this needs updating\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/info\\/summer-2016-cruises/) !== null) {\n            return &quot;tui:cruises:deals:&quot; + (pathArray[5]);\n          }\n          // Flight Deals\n          if (document.location.pathname.match(/^\\/$|^\\/flight\\/deals/) !== null) {\n            return &quot;tui:flights:deals&quot;;\n          }\n          // Deals Landing Page\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/holiday-destinations/) !== null) {\n            return &quot;tui:hol:destinations&quot;;\n          }\n          // TUI Country Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\/|^\\/destinations\\/africa\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]);\n          }\n          // TUI Region/Destination Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/|^\\/destinations\\/asia\\/|^\\/destinations\\/indian-ocean\\/|^\\/destinations\\/middle-east\\/|^\\/destinations\\/caribbean\\/|^\\/destinations\\/europe\\/|^\\/destinations\\/the-americas\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[6]);\n          }\n          // TUI Resort Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\//) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n          // TUI Hotel Browse\n          if (document.location.pathname.match(/^\\/$|^\\/destinations\\/africa\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/asia\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/indian-ocean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/middle-east\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/caribbean\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/europe\\/.*\\/.*\\/.*\\/.*\\/.*|^\\/destinations\\/the-americas\\/.*\\/.*\\/.*\\/.*\\/.*/) !== null) {\n            return &quot;tui:hol:destinations:&quot; + (pathArray[5]) + &quot;:&quot; + (pathArray[7]);\n          }\n        } else if (document.location.hostname.indexOf('firstchoice.co.uk') != -1 || document.location.hostname.indexOf('firstchoiceprjuat.co.uk') != -1) {\n          // FC Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fc:homepage&quot;;\n          }\n          // FC Deals\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/deals\\/|^\\/holiday\\/deals/) !== null) {\n            return &quot;fc:deals:&quot; + (pathArray[5]);\n          }\n          // FC Deals Landing\n          if (document.location.pathname.match(/^\\/$|^\\/holiday\\/destinations/) !== null) {\n            return &quot;fc:hol:destinations&quot;;\n          }\n        } else if (document.location.hostname.indexOf('falconholidays.ie') != -1 || document.location.hostname.indexOf('falconholidaysprjuat.ie') != -1 || document.location.hostname.indexOf('tuiholidays.ie') != -1 || document.location.hostname.indexOf('tuiholidaysprjuat.ie') != -1) {\n          // TUI IE Homepage\n          if (document.location.pathname === &quot;/&quot;) {\n            return &quot;fal:homepage&quot;;\n          }\n          // TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/deals\\/|^\\/f\\/deals/) !== null) {\n            return &quot;fal:deals:&quot; + (pathArray[5]);\n          }\n          //TUI IE Deals\n          if (document.location.pathname.match(/^\\/$|^\\/f\\/holiday-destinations/) !== null) {\n            return &quot;fal:hol:destinations&quot;;\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pagePath&quot;] = (function() {\n      try {\n        if (window.location.pathname) {\n          var pagePath = window.location.pathname + window.location.search;\n          return pagePath;\n        } else {\n          return &quot;error&quot;;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageSubCategory&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.pageID &amp;&amp; dataLayer[0].page.pageID == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.pageUid &amp;&amp; tui.analytics.pageUid == 'lockYourPriceConfirmationpage_react') {\n          return 'Lock Your Price ' + dataLayer[0].page.pageSubCategory;\n        } else {\n          return dataLayer[0].page.pageSubCategory;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pageURL&quot;] = (function() {\n      try {\n        var url = [location.protocol, '//', location.host, location.pathname].join('');\n        return url;\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;paymentType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PayType) {\n          return tui.analytics.page.PayType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.paymentType) {\n          return dataLayer[0].transactions.total.paymentType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;ppcVariant&quot;] = (function() {\n      try {\n        if (window.location.search.indexOf('ppcvariant') != -1) {\n          return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n            .split(&quot;&amp;ppcvariant=&quot;).pop()\n            .split(&quot;&amp;&quot;).shift();\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;preferredSearchAvailable&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.isPreferredSearchAvailable) {\n          return dataLayer[0].page.search.isPreferredSearchAvailable;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;price&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          if (tui.analytics.page.bookingLevelCreditNoteDiscount &amp;&amp; parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) &gt; 0) {\n            return (parseFloat(tui.analytics.page.bookingLevelCreditNoteDiscount) + parseFloat(tui.analytics.page.Sum)).toString();\n          } else {\n            return tui.analytics.page.Sum;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          if (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].transactions.total.bookingLevelCreditNoteDiscount + dataLayer[0].transactions.total.totalPrice).toString();\n          } else {\n            return dataLayer[0].transactions.total.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          if (dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &amp;&amp; dataLayer[0].basket.price.bookingLevelCreditNoteDiscount &gt; 0) {\n            return (dataLayer[0].basket.items.bookingLevelCreditNoteDiscount + dataLayer[0].basket.price.totalPrice).toString();\n          } else {\n            return dataLayer[0].basket.price.totalPrice.toString();\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;priceVariationAlert&quot;] = (function() {\n      try {\n        if (document.URL.indexOf('/book/flow/summary') !== -1 || document.URL.indexOf('/book/passengerdetails') !== -1 || document.URL.indexOf('/cps/pageRender') !== -1) {\n          var priceStatus = document.querySelectorAll('.PriceVariationAlert__infoTextHeading');\n          var price = document.querySelectorAll('.alertprice');\n\n          if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;INCREASED&quot;)) {\n            return &quot;Price Increased|&quot; + price[0].innerText.replace(/[£€]/g, '');\n          } else if (priceStatus.length &gt; 0 &amp;&amp; priceStatus[0].innerText.includes(&quot;DECREASED&quot;)) {\n            return &quot;Price Decreased|&quot; + -price[0].innerText.replace(/[£€]/g, '');\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Analytics Experience&quot;] = (function() {\n      try {\n        var experience = Bootstrapper.gateway &amp;&amp; Bootstrapper.gateway.getCookie ? Bootstrapper.gateway.getCookie('Experience') : Bootstrapper.Cookies.get ? Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') : '';\n        switch (experience) {\n          case 'A':\n            return 'cookie consent - modal experience A';\n          case 'B':\n            return 'cookie consent - banner experience B';\n          case 'C':\n            return 'cookie consent - control experience C';\n          case 'Av2':\n            return 'cookie consent - modal experience A v2';\n          case 'Bv2':\n            return 'cookie consent - modal experience B v2';\n          case 'Cv2':\n            return 'cookie consent - modal experience C v2 - control';\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Experience&quot;] = (function() {\n      try {\n        return Bootstrapper.gateway ? Bootstrapper.gateway.getCookie('Experience') : undefined;\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories&quot;] = (function() {\n      try {\n        var types = Bootstrapper.gateway.getCookieTypes(),\n          cookiesNotSet = [],\n          returnVal = [];\n\n        for (var i = 0; i &lt; types.length; i++) {\n          var currentType = types[i];\n          if (Bootstrapper.gateway.getCookie(currentType) === '0') {\n            returnVal.push(currentType);\n          } else if (!Bootstrapper.gateway.getCookie(currentType)) {\n            cookiesNotSet.push(currentType);\n          }\n        }\n\n        if (cookiesNotSet.length === types.length) {\n          // cookies have not been set\n          return undefined;\n        } else if (returnVal.length === 0) {\n          return 'all categories accepted';\n        }\n        return returnVal.join(',').toLowerCase();\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;Privacy - Opted-out Categories Page Load&quot;] = (function() {\n      try {\n        if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Experience') == 'C') {\n          return 'not applicable';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'personalisation,targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'all categories accepted';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '1' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '0') {\n          return 'targeting and advertising';\n        } else if (Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Personalisation') == '0' &amp;&amp; Bootstrapper.Cookies.get('TUI_ENSIGHTEN_PRIVACY_Targeting_and_Advertising') == '1') {\n          return 'personalisation';\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionCode&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SubProd) {\n          return tui.analytics.page.SubProd;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionCode) {\n          return dataLayer[0].transactions.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionCode) {\n          return dataLayer[0].basket.items.productCollectionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionCode) {\n          return dataLayer[0].product.productCollectionCode;\n        }\n\n\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productCollectionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.productCollectionName) {\n          return dataLayer[0].transactions.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.productCollectionName) {\n          return dataLayer[0].basket.items.productCollectionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.productCollectionName) {\n          return dataLayer[0].product.productCollectionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productID&quot;] = (function() {\n      try {\n        // WhereTo for both regular holidays and cruises\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          var dl = dataLayer[0];\n          if (dl.transactions &amp;&amp; dl.transactions.items &amp;&amp; dl.transactions.items.productID) {\n            return dl.transactions.items.productID;\n          } else if (dl.basket &amp;&amp; dl.basket.items &amp;&amp; dl.basket.items.productID) {\n            return dl.basket.items.productID;\n          } else if (dl.product &amp;&amp; dl.product.productID) {\n            return dl.product.productID;\n          } else if (dl.page.search &amp;&amp; dl.page.search.destinationId) {\n            return dataLayer[0].page.search.destinationId;\n          }\n\n\n\n\n        } else {\n          if (String(typeof tui.analytics.page.CRWhereTo) !== 'undefined') {\n            return tui.analytics.page.CRWhereTo;\n          } else if (String(typeof tui.analytics.page.WhereTo) !== 'undefined') {\n            return tui.analytics.page.WhereTo;\n          }\n        }\n        return 'none';\n      } catch (err) {\n        return 'none';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;productTypeMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;#content &gt; div &gt; div.summary.review &gt; div.basket.payment-summary &gt; div &gt; div:nth-child(1) &gt; h3:nth-child(1) &gt; span&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeFreeAmends&quot;] = (function() {\n      try {\n        var freeDaysOriginal = '',\n          freeDaysLeft = '';\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysOriginal != undefined &amp;&amp; dataLayer[0].user.currentBookings.freeAmendDaysLeft != undefined) {\n          if (dataLayer[0].user.currentBookings.freeAmendDaysOriginal == 0) {\n            freeDaysOriginal = 'Zero';\n          } else {\n            freeDaysOriginal = dataLayer[0].user.currentBookings.freeAmendDaysOriginal.toString();\n          }\n          if (dataLayer[0].user.currentBookings.freeAmendDaysLeft == 0) {\n            freeDaysLeft = 'Zero';\n          } else {\n            freeDaysLeft = dataLayer[0].user.currentBookings.freeAmendDaysLeft.toString();\n          }\n          return freeDaysOriginal + '|' + freeDaysLeft;\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeIncentiveCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0]) {\n\n          if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].transactions.total.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n              return dataLayer[0].transactions.total.bookingLevelPromoCode;\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n            var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n            for (i = 0; i &lt; promoCodeArray.length; i++) {\n              if (/CVRHC|CVRW20|CVRS21/i.test(promoCodeArray[i].bookingLevelPromoCode)) {\n                return promoCodeArray[i].bookingLevelPromoCode;\n              }\n            }\n          } else if (dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode &amp;&amp; typeof dataLayer[0].basket.price.bookingLevelPromoCode !== 'undefined') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n              return dataLayer[0].basket.price.bookingLevelPromoCode;\n            }\n          }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          if (typeof tui.analytics.page.PromoCode !== 'undefined' &amp;&amp; tui.analytics.page.PromoCode !== 'null') {\n            if (/CVRHC|CVRW20|CVRS21/i.test(tui.analytics.page.PromoCode)) {\n              return tui.analytics.page.PromoCode;\n            }\n          }\n        } else {\n          return undefined;\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;programmeChangeMemoNotes&quot;] = (function() {\n      // Returns a comma separated list of memo notes from the memoNotes array\n      try {\n        if (window.dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.memoNotes) {\n          var results = [];\n          var memoArray = dataLayer[0].user.currentBookings.memoNotes;\n\n          for (i = 0; i &lt; memoArray.length; i++) {\n            results.push(memoArray[i].memoNoteCode);\n          }\n\n          if (results.length &gt; 0) {\n            return results.join(&quot;,&quot;)\n          } else {\n            return undefined;\n          }\n        }\n      } catch (err) {\n        return undefined;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\ntry {\t\n\tb[&quot;promoCodeName&quot;] = (function() {\n\t  try {\n\t\tvar rgx = new RegExp('^((?!(CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV)).)*$', 'i');\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult = promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult = promoCodeArray[i].bookingLevelPromoCode;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.PromoCode)) {\n\t\t\t\treturn tui.analytics.page.PromoCode;\n\t\t\t} \n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.bookingLevelPromoCode)) {\n\t\t\t\treturn tui.analytics.page.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].transactions.total.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].basket.price.bookingLevelPromoCode;\n\t\t\t} \n\t\t} else {\n\t\t\treturn 'null';\n\t\t}\n\t  } catch (err) {\n\t\treturn &quot;&quot;;\n\t  }\n\t})()\n  } catch (e) {\n    logError(e)\n  }\t\n  \n\n  try {\t\n\tb[&quot;promoCodeValue&quot;] = (function() {\n\t  try {\n\t\tvar rgx = new RegExp('^((?!(CVRHC|CVRW20|CVRS21|CVRI|CVRM|CVRV)).)*$', 'i');\n\t\tif (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult =  promoCodeArray[i].bookingLevelPromoDiscount;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCodes.length &gt; 0) {\n\t\t  var promoCodeArray = dataLayer[0].basket.price.bookingLevelPromoCodes;\n\t\t  var result = 'null';\n\t\t  for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\tif (rgx.test(promoCodeArray[i].bookingLevelPromoCode)) {\n\t\t\t\tresult =  promoCodeArray[i].bookingLevelPromoDiscount;\n\t\t\t} \n\t\t  }\n\t\t  return result;\n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.PromoCode)) {\n\t\t\t\treturn tui.analytics.page.PromoValue;\n\t\t\t} \n\t\t} else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelPromoCode) {\n\t\t  if (rgx.test(tui.analytics.page.bookingLevelPromoCode)) {\n\t\t\t\treturn tui.analytics.page.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].transactions.total.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].transactions.total.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.bookingLevelPromoCode) {\n\t\t  if (rgx.test(dataLayer[0].basket.price.bookingLevelPromoCode)) {\n\t\t\t\treturn dataLayer[0].basket.price.bookingLevelPromoDiscount;\n\t\t\t} \n\t\t} else {\n\t\t\treturn 'null';\n\t\t}\n\t  } catch (err) {\n\t\treturn &quot;&quot;;\n\t  }\n\t})()\n  } catch (e){\n\t  logError(e)\n  }\n\n  try {\n    b[&quot;protocol&quot;] = (function() {\n      try {\n        if (window.location &amp;&amp; window.location.protocol) {\n          return window.location.protocol;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;purchaseID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Tracsref &amp;&amp; tui.analytics.page.pageUid != 'lockYourPriceConfirmationpage_react') {\n          return tui.analytics.page.Tracsref;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.transactionId &amp;&amp; dataLayer[0].page.pageID != 'lockYourPriceConfirmationpage_react') {\n          return dataLayer[0].transactions.total.transactionId;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;pushData&quot;] = (function() {\n\n      function getParameterByName(name, url) {\n        if (!url) url = window.location.href;\n        name = name.replace(/[\\[\\]]/g, '\\\\$&amp;');\n        var regex = new RegExp('[?&amp;]' + name + '(=([^&amp;#]*)|&amp;|#|$)'),\n          results = regex.exec(url);\n        if (!results) return null;\n        if (!results[2]) return '';\n        return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n      }\n\n      try {\n        var host = window.location.host,\n          imid = getParameterByName('im_id'),\n          ipid = getParameterByName('ip_id');\n\n        if (host &amp;&amp; ipid &amp;&amp; imid === 'Push') {\n          return host + '|' + 'PushNotification' + '.' + ipid + '.' + ipid + '.' + ipid\n        } else {\n          return ''\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryString&quot;] = (function() {\n      try {\n        return document.URL.split('?')[1];\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamCmid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;cmid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n  try {\n    b[&quot;queryStringParamGaid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ga_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n  \n\n  try {\n    b[&quot;queryStringParamGclid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;gclid=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIkid&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ik_id=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamIto&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;ito=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamQ&quot;] = (function() {\n      return window.location.search.replace(&quot;?&quot;, &quot;&amp;&quot;)\n        .split(&quot;&amp;q=&quot;).pop()\n        .split(&quot;&amp;&quot;).shift();\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;queryStringParamVlid&quot;] = (function() {\n      try {\n        return Bootstrapper.getQueryParam('vlid') || Bootstrapper.getQueryParam('vlids') || Bootstrapper.getQueryParam('VLID');\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionCode) {\n          return dataLayer[0].transactions.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionCode) {\n          return dataLayer[0].basket.items.geo.regionCode;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionCode) {\n          return dataLayer[0].product.geo.regionCode;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;regionName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.regionName) {\n          return dataLayer[0].transactions.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.regionName) {\n          return dataLayer[0].basket.items.geo.regionName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.regionName) {\n          return dataLayer[0].product.geo.regionName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortID) {\n          return dataLayer[0].transactions.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortID) {\n          return dataLayer[0].basket.items.geo.resortID;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortID) {\n          return dataLayer[0].product.geo.resortID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;resortName&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.geo &amp;&amp; dataLayer[0].transactions.items.geo.resortName) {\n          return dataLayer[0].transactions.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.geo &amp;&amp; dataLayer[0].basket.items.geo.resortName) {\n          return dataLayer[0].basket.items.geo.resortName;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.geo &amp;&amp; dataLayer[0].product.geo.resortName) {\n          return dataLayer[0].product.geo.resortName;\n        } else if (window.jsonData &amp;&amp; jsonData.packageViewData &amp;&amp; jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName) {\n          return jsonData.packageViewData.accomViewData[0] &amp;&amp; jsonData.packageViewData.accomViewData[0].resortName;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;retailVisitorIDValueChange&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RetVisID) {\n          return tui.analytics.page.RetVisID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;returnDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.DepDate &amp;&amp; tui.analytics.page.MonthYear) {\n          var date1 = tui.analytics.page.DepDate;\n          var month1 = tui.analytics.page.MonthYear.substring(0, 2);\n          var year1 = tui.analytics.page.MonthYear.substring(3, 7);\n          var duration = (window.location.href.indexOf('/cruise/book/') &gt; -1) ? tui.analytics.page.CRDur : tui.analytics.page.Dur;\n          var addition = parseInt(date1, 10) + parseInt(duration, 10);\n          var depDate = new Date(year1, month1, date1);\n          var outDate = new Date(depDate);\n          outDate.setDate(addition);\n          var date2 = String(outDate.getDate());\n          var date3;\n          var d = date2.length;\n          if (d == 2) {\n            date3 = date2;\n          }\n          if (d == 1) {\n            date3 = '0' + date2;\n          }\n          var month2 = String(outDate.getMonth());\n          var month3;\n          var m = month2.length;\n          if (m == 2) {\n            month3 = month2;\n          }\n          if (m == 1) {\n            month3 = '0' + month2;\n          }\n\n          var year2 = outDate.getFullYear();\n          var lastDate = year2 + '-' + month3 + '-' + date3;\n          return lastDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.returnDate) {\n          return dataLayer[0].transactions.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.returnDate) {\n          return dataLayer[0].basket.items.returnDate;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.returnDate) {\n          return dataLayer[0].product.returnDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;revenueMoney4Travel&quot;] = (function() {\n      var element = document.querySelector(&quot;.grand-total.align-right&quot;);\n      return element ? element.textContent : &quot;&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomAllocation&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmAlloc) {\n          return tui.analytics.page.RmAlloc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomComposition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Adults &amp;&amp; tui.analytics.page.Children &amp;&amp; tui.analytics.page.Infants) {\n          return tui.analytics.page.Adults + '/' + window.tui.analytics.page.Children + '/' + window.tui.analytics.page.Infants;\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Party) {\n          return tui.analytics.page.Party;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.roomComposition) {\n          return dataLayer[0].transactions.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.roomComposition) {\n          return dataLayer[0].basket.items.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.roomComposition) {\n          return dataLayer[0].product.roomComposition;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].roomComposition) {\n          return dataLayer[0].page.search.resultsList[0].roomComposition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;roomOrCabinType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.RmSlt) {\n          return tui.analytics.page.RmSlt;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;screenSizeIncludingIPhones&quot;] = (function() {\n      try {\n        if (typeof screen.width === &quot;number&quot; &amp;&amp; typeof screen.height === &quot;number&quot;) {\n          return (screen.width + &quot;x&quot; + screen.height);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDepartureDate&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.OrigDepDate) {\n          return tui.analytics.page.OrigDepDate;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationIDs&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationId) {\n          return dataLayer[0].page.search.searchedDestinationId;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchedDestinationNames&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchedDestinationName) {\n          return dataLayer[0].page.search.searchedDestinationName;\n        }\n\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchResultsFinalPosition&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.FinPos) {\n          return tui.analytics.page.FinPos;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.finalPosition) {\n          return dataLayer[0].product.finalPosition;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;searchType&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SearchType &amp;&amp; tui.analytics.page.SearchType != 'null') {\n          return tui.analytics.page.SearchType;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.searchType) {\n          return dataLayer[0].page.search.searchType;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;season&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.MonthYear) {\n          var season = '';\n          var d = tui.analytics.page.MonthYear.split('/');\n          var m = d[0];\n          var y = d[1].slice(-2);\n\n          if (m &gt;= 1 &amp;&amp; m &lt;= 4) {\n            season = 'W' + (y - 1);\n          } else if (m &gt;= 5 &amp;&amp; m &lt;= 10) {\n            season = 'S' + y;\n          } else if (m &gt;= 11) {\n            season = 'W' + y;\n          }\n          return season;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.departureSeason) {\n          return dataLayer[0].transactions.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.departureSeason) {\n          return dataLayer[0].basket.items.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.departureSeason) {\n          return dataLayer[0].product.departureSeason;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.search &amp;&amp; dataLayer[0].page.search.resultsList[0] &amp;&amp; dataLayer[0].page.search.resultsList[0].departureSeason) {\n          return dataLayer[0].page.search.resultsList[0].departureSeason;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sellingCode&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.sellingCode) {\n          return String(dataLayer[0].transactions.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.sellingCode) {\n          return String(dataLayer[0].basket.items.sellingCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.sellingCode) {\n          return String(dataLayer[0].product.sellingCode);\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionID&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.sessionID) {\n          return tui.analytics.sessionID;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sessionState&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.sessionState) {\n          return tui.analytics.page.sessionState;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page &amp;&amp; dataLayer[0].page.sessionState) {\n          return dataLayer[0].page.sessionState;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;shortlist&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Shortlist) {\n          return tui.analytics.page.Shortlist;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSection&quot;] = (function() {\n      try {\n        // function for returning Site Section, used in Adobe Site Section (s.channel). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 28/04/19\n        var b = Bootstrapper.getQueryParam('b'),\n          host = location.host,\n          path = location.pathname;\n\n        if (~host.indexOf('thomson.co.uk') || ~host.indexOf('thomsonprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || (location.pathname.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) !== null) &amp;&amp; (location.pathname.match(/cruise(s?)/) === null)) {\n            return 'TH Beach';\n          } else if (~host.indexOf('flights.thomson.co.uk') || ~host.indexOf('flights.thomsonprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TH Flight-Only';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TH Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TH Accomm Only';\n          }\n        } else if (~host.indexOf('firstchoice.co.uk') || ~host.indexOf('firstchoiceprjuat.co.uk')) {\n          if (~b.indexOf('31000') || ~b.indexOf('10000') || ~b.indexOf('52000') || ~b.indexOf('20000') || ~b.indexOf('42000') || path.match(/^\\/$|^\\/holiday\\/?|^\\/holidays\\/?|^\\/sun-holidays\\/?|^\\/last-minute-holidays\\/?|^\\/destinations\\/?|^\\/departure-airports\\/?|^\\/last-minute-deals\\/?|^\\/2wentys|^\\/myholidayalerts/)) {\n            return 'FC Beach';\n          } else if (~b.indexOf('12000') || path.match(/^\\/$|^\\/hotels\\/|^\\/accom\\//)) {\n            return 'FC Accomm Only';\n          } else if (path === '/') {\n            return 'FC Beach';\n          }\n        } else if (~host.indexOf('falconholidays.ie') || ~host.indexOf('falconholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'Falcon';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'Falcon FO';\n          }\n        } else if (~host.indexOf('retailagents.tui.co.uk') || ~host.indexOf('retailagents.tuiprjuat.co.uk')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (~host.indexOf('retailagents.tuiholidays.ie') || ~host.indexOf('retailagents.tuiholidaysprjuat.ie')) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        } else if (~host.indexOf('tui.co.uk') || ~host.indexOf('tuiprjuat.co.uk')) {\n          if (~b.indexOf('25000') || ~b.indexOf('32000') || ~b.indexOf('19000') || ~b.indexOf('41000') || ~b.indexOf('50000') || ~b.indexOf('51000') || path.match(/^\\/$|^\\/destinations\\/?|^\\/holidays\\/?|^\\/editorial\\/?|^\\/late-deals\\/?|^\\/brochures\\/?|^\\/blog\\/?|^\\/deals\\/?|^\\/villas\\/?|^\\/thomson\\/page\\/byo/) &amp;&amp; !path.match(/cruise(s?)/)) {\n            return 'TUI UK Beach';\n          } else if (~host.indexOf('flights.tui.co.uk') || ~host.indexOf('flights.tuiprjuat.co.uk') || ~b.indexOf('15000') || ~b.indexOf('39000') || ~b.indexOf('40000') || ~b.indexOf('59000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI UK Flight-Only';\n          } else if (~b.indexOf('58000') || path.match(/^\\/$|^\\/river-cruise(s?)\\/|^\\/river-cruise-deals\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise';\n          } else if (~b.indexOf('18000') || ~b.indexOf('37000') || ~b.indexOf('49000') || ~b.indexOf('54000') || path.match(/^\\/$|^\\/cruise\\/|^\\/cruise-deals\\/|cruise(s?)/)) {\n            return 'TUI UK Cruise';\n          } else if (~b.indexOf('6000') || path.match(/^\\/$|^\\/accom\\/page\\/|^\\/hotels\\//)) {\n            return 'TUI UK Accomm Only';\n          }\n        }\n        if (~host.indexOf('tuiholidays.ie') || ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (~b.indexOf('38000') || ~b.indexOf('53000') || path.match(/^\\/$|^\\/f\\//)) {\n            return 'TUI IE Beach';\n          } else if (~b.indexOf('47000') || ~b.indexOf('48000') || ~b.indexOf('60000') || path.match(/^\\/$|^\\/flight\\/|^\\/flights\\//)) {\n            return 'TUI IE Flight-Only';\n          }\n        } else if (host.match(/(tuiretailhish\\-(live|st.*|hybd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\/|^\\/retail\\/flights\\//)) {\n            return 'TUI UK Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI UK River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI UK Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/|^\\/holidays\\//)) {\n            return 'TUI UK Beach (Retail)';\n          }\n        } else if (host.match(/(falconretailhish\\-(live|st.*|hyd.*)\\.thomsonuk\\.dnsroot\\.biz)/g)) {\n          if (path.match(/^\\/$|^\\/retail\\/flight\\//)) {\n            return 'TUI IE Flight-Only (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/river-cruise(s?)\\/|river-cruise(s?)/)) {\n            return 'TUI IE River Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/cruise\\//)) {\n            return 'TUI IE Cruise (Retail)';\n          } else if (path.match(/^\\/$|^\\/retail\\/f\\//)) {\n            return 'TUI IE Beach (Retail)';\n          }\n        }\n        return '';\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;siteSubSection&quot;] = (function() {\n      try {\n        // function for returning Site SubSection (evar1). Copied from Tag &quot;WA - SiteCat Page Code&quot; on 24/10/17\n        var pageUid = '',\n          geoLevel = '',\n          host = location.host,\n          path = location.pathname;\n\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page) {\n          pageUid = tui.analytics.page.pageUid || '';\n          geoLevel = tui.analytics.page.contextType || '';\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].page) {\n          pageUid = dataLayer[0].page.pageID || '';\n          geoLevel = dataLayer[0].page.pageCategory || '';\n        }\n\n        if (~host.indexOf('thomson.co.uk') ||\n          ~host.indexOf('thomsonprjuat.co.uk') ||\n          ~host.indexOf('flights.thomson.co.uk') ||\n          ~host.indexOf('flights.thomsonprjuat.co.uk') ||\n          ~host.indexOf('firstchoice.co.uk') ||\n          ~host.indexOf('firstchoiceprjuat.co.uk') ||\n          ~host.indexOf('falconholidays.ie') ||\n          ~host.indexOf('falconholidaysprjuat.ie') ||\n          ~host.indexOf('tui.co.uk') ||\n          ~host.indexOf('tuiprjuat.co.uk') ||\n          ~host.indexOf('flights.tui.co.uk') ||\n          ~host.indexOf('flights.tuiprjuat.co.uk') ||\n          ~host.indexOf('tuiholidays.ie') ||\n          ~host.indexOf('tuiholidaysprjuat.ie')) {\n          if (path === '/') {\n            return 'Home Page/Landing Page';\n          } else if (path.match(/^\\/$|^\\/blog|^\\/blog\\//)) {\n            return 'Blog';\n          } else if (path.match(/^\\/$|^\\/holidays\\/lakes-and-mountains|^\\/destinations\\/info\\/why-lakes-and-mountains|^\\/destinations\\/deals\\/italian-lakes-deals|^\\/destinations\\/deals\\/lakes-mountains-platinum|^\\/destinations\\/deals\\/austria-deals|^\\/destinations\\/deals\\/lake-garda-deals|^\\/destinations\\/deals\\/lakes-mountains-summer-holidays/)) {\n            return 'Lakes &amp; Mountains';\n          } else if ((pageUid === 'lastMinuteHolidayFinderPage') || (pageUid == 'page_00000IIZ') || path.match(/^\\/$|^\\/destinations\\/deals\\/|^\\/destinations\\/deals|^\\/deals\\/summer-2016-cruises|^\\/holiday\\/deals\\/|^\\/holiday\\/deals|^\\/f\\/deals\\/|^\\/f\\/deals|^\\/flight\\/deals|^\\/flight\\/deals\\//)) {\n            return 'Deals';\n          } else if (path.match(/^\\/$|^\\/destinations\\/multi-centre\\/|^\\/holidays\\/multi-centre/)) {\n            return 'MultiCentres';\n          } else if (/^(ACCOMMODATION|RESORT|DESTINATION|REGION|COUNTRY|destinationlanding|ATTRACTION|ITINERARY|PORTS OF CALL|CRUISE REGION LANDING|CRUISE DESTINATION LANDING|SHIPS LANDING|SHIP|CRUISE &amp; STAY LANDING|cruise-calender|ONBOARD-EXPERIENCE|PORTS OF CALL LANDING)$/.test(geoLevel) || path.match(/^\\/$|^\\/thomson\\/en-GB\\/timetable\\/default|^\\/flight\\/arrivals-and-departures|^\\/destinations\\/product\\/|^\\/holidays\\/|^\\/holiday\\/product\\/|^\\/holiday\\/inventory\\/|^\\/holiday\\/collections\\/|^\\/f\\/products\\/|^\\/f\\/holidays\\/|^\\/sun-holidays\\/|^\\/destinations\\/viewAnonymousShortlist\\/|^\\/holiday\\/viewAnonymousShortlist\\/|^\\/en\\/destination\\/|^\\/flights\\//)) {\n            return 'Browse';\n          } else if ((pageUid === 'travel-information') || path.match(/^\\/$|^\\/holiday-extras.html|^\\/editorial\\/|^\\/gsa\\/|^\\/affiliates.html|^\\/information\\/|^\\/our-policies\\/|^\\/contact-us\\/|^\\/myapp\\/|^\\/destinations\\/shop-finder\\/|^\\/holiday\\/shop-finder\\/|^\\/holiday\\/faqCategories\\/|^\\/f\\/faqCategories\\/|^\\/f\\/travel-information\\/|^\\/all-inclusive-calculator\\/|^\\/about-us\\/|^\\/destinations\\/info\\/|^\\/destinations\\/faqCategories|^\\/myapp\\//)) {\n            return 'Editorial';\n          } else if (path.match(/^\\/$|^\\/destinations\\/book\\/|^\\/holiday\\/book\\/|^\\/f\\/book\\/|^\\/cruise\\/book\\/|^\\/flight\\/book\\/|^\\/cruise\\/bookitineraries\\/|^\\/cruise\\/packages\\/hotels|^\\/cruise\\/bookHotelDetails|^\\/destinations\\/bookaccommodation|^\\/holiday\\/bookaccommodation|^\\/cps\\/pageRender|^\\/f\\/bookaccommodation/)) {\n            return 'Bookflow';\n          } else if (path.match(/^\\/$|^\\/destinations\\/packages|^\\/holiday\\/packages|^\\/f\\/packages|^\\/cruise\\/packages|^\\/flight\\/search/)) {\n            return 'Search';\n          } else if (path.match(/^\\/$|^\\/destinations\\/manage\\/|^\\/t\\//)) {\n            return 'Customer Account';\n          } else if (path.match(/^\\/$|^\\/cruise|^\\/flight/)) {\n            return 'Home Page/Landing Page';\n          }\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingReference&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgRef) {\n          return tui.analytics.page.SrcBkgRef;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].user &amp;&amp; dataLayer[0].user.currentBookings &amp;&amp; dataLayer[0].user.currentBookings.bookingReference) {\n          return dataLayer[0].user.currentBookings.bookingReference;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;sourceBookingSystem&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.SrcBkgSys) {\n          return tui.analytics.page.SrcBkgSys;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - CD - BOARD&quot;] = (function() {\n      return tui.analytics.page.Board;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Affiliation&quot;] = (function() {\n      return &quot;CruiseDeals.co.uk&quot;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - BrandName&quot;] = (function() {\n      return &quot;Marella Cruises&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Category&quot;] = (function() {\n      return &quot;Cruise&quot;;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRType&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CruiseId&quot;] = (function() {\n      //Ship name, destination(s), depDate and Duration\n      return tui.analytics.page.CRShip + '-' + tui.analytics.page.CRWhereTo + '-' + tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear + '-' + tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - CRWhereTo&quot;] = (function() {\n      return tui.analytics.page.CRWhereTo;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - DepartureDate&quot;] = (function() {\n      return tui.analytics.page.DepDate + '/' + tui.analytics.page.MonthYear;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Discount&quot;] = (function() {\n      return tui.analytics.page.Disc;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Duration - New&quot;] = (function() {\n      return tui.analytics.page.CRDur;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - ShipName&quot;] = (function() {\n      return tui.analytics.page.CRShip;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Sum&quot;] = (function() {\n      return tui.analytics.page.Sum;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;STOCKTON - DD - Variant&quot;] = (function() {\n      return tui.analytics.page.CRType;\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyAncillaries&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPAnc) {\n          return tui.analytics.page.TPAnc;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBeds&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPB) {\n          return tui.analytics.page.TPB;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyBedsSupplier&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPBSupp) {\n          return tui.analytics.page.TPBSupp;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;thirdPartyFlightDetail&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TPFU) {\n          return tui.analytics.page.TPFU;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;top5SearchResults&quot;] = (function() {\n      try {\n        var FBdata;\n        var arr = [];\n        var sr = jsonData.searchResult.holidays;\n\n        sr.forEach(function(e) {\n          FBData = e.itinerary.outbounds[0].departureAirportCode + '|' + e.accommodation.code;\n          arr.push(FBData);\n        });\n\n        return arr.slice(0, 5).join();\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tradingCycle&quot;] = (function() {\n      // Function for returning Trading Cycle, based on Days To Departure. The UK trading team uses Early and Late classification, so any bookings \n      // made within 84 days (12 weeks) to departure are defined as late and greater than 84 days to dept are early .\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items.daysToDeparture) {\n          if (dataLayer[0].transactions.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].transactions.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items.daysToDeparture) {\n          if (dataLayer[0].basket.items.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].basket.items.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.daysToDeparture) {\n          if (dataLayer[0].product.daysToDeparture &lt;= 84) {\n            return &quot;late&quot;;\n          }\n          if (dataLayer[0].product.daysToDeparture &gt; 84) {\n            return &quot;early&quot;;\n          }\n        } else if (typeof tui != &quot;undefined&quot; &amp;&amp; typeof tui.analytics != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page != &quot;undefined&quot; &amp;&amp; typeof tui.analytics.page.DepDate != &quot;undefined&quot;) {\n          // todays date\n          var date1 = new Date();\n          // dep  date\n          var depdate = ((typeof window.tui.analytics.page.MonthYear !== 'undefined') ? ((window.tui.analytics.page.DepDate || '') + '/' + window.tui.analytics.page.MonthYear) : '');\n          var splitDate = depdate.split('/');\n\n          day = splitDate[0];\n          daystring = day.toString();\n          month = splitDate[1];\n          monthstring = month.toString();\n          year = splitDate[2];\n          yearstring = year.toString();\n\n          var slash = &quot;/&quot;;\n\n          daterage = monthstring + slash + daystring + slash + yearstring;\n          date3 = new Date(daterage);\n\n          var timeDiff = Math.abs(date3.getTime() - date1.getTime());\n          var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));\n          var tradingCycle = '';\n          if (diffDays &lt;= 84) {\n            tradingCycle = &quot;late&quot;;\n          }\n          if (diffDays &gt; 84) {\n            tradingCycle = &quot;early&quot;;\n          }\n\n          return tradingCycle;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorEventID&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; taeventid=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripAdvisorRating&quot;] = (function() {\n      try {\n        if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; typeof dataLayer[0].transactions.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].transactions.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; typeof dataLayer[0].basket.items.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].basket.items.tripAdvisorProductRating);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; typeof dataLayer[0].product.tripAdvisorProductRating != 'undefined') {\n          return String(dataLayer[0].product.tripAdvisorProductRating);\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TARating &amp;&amp; typeof tui.analytics.page.TARating != 'undefined') {\n          return tui.analytics.page.TARating;\n        }\n      } catch (err) {\n        return '';\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tripType&quot;] = (function() {\n      try {\n        var url = location.href;\n\n        if (url.indexOf(&quot;flight/book&quot;) &gt; -1) {\n          return tui.analytics.page.FltType;\n        } else if (url.indexOf(&quot;cruise/book&quot;) &gt; -1) {\n          if (typeof(tui.analytics.page.CRType) == &quot;undefined&quot;) {\n            return &quot;null&quot;;\n          } else {\n            return tui.analytics.page.CRType;\n          }\n        } else {\n          return '';\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;trv_reference&quot;] = (function() {\n      var value = &quot;; &quot; + document.cookie;\n      var parts = value.split(&quot;; trv_reference=&quot;);\n      if (parts.length == 2) {\n        return decodeURIComponent(parts.pop().split(&quot;;&quot;).shift());\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;tuiProductRating&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.TUIRating) {\n          return tui.analytics.page.TUIRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.tuiProductRating) {\n          return dataLayer[0].product.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.items &amp;&amp; dataLayer[0].basket.items.tuiProductRating) {\n          return dataLayer[0].basket.items.tuiProductRating;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.items &amp;&amp; dataLayer[0].transactions.items.tuiProductRating) {\n          return dataLayer[0].transactions.items.tuiProductRating;\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPrice&quot;] = (function() {\n      try {\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.Sum) {\n          return tui.analytics.page.Sum;\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.totalPrice) {\n          return dataLayer[0].transactions.total.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].basket &amp;&amp; dataLayer[0].basket.price &amp;&amp; dataLayer[0].basket.price.totalPrice) {\n          return dataLayer[0].basket.price.totalPrice.toString();\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].product &amp;&amp; dataLayer[0].product.currentPrice) {\n          return dataLayer[0].product.currentPrice.toString();\n        }\n      } catch (err) {\n        return &quot;&quot;;\n      }\n    })()\n  } catch (e) {\n    logError(e)\n  }\n\n  try {\n    b[&quot;uniqodoPromoCodeName&quot;] = (function() {\n    try {\n        var strArray = [];\n        if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode.length &gt; 0 &amp;&amp; tui.analytics.page.bookingLevelCreditNoteCode != 'null') {\n            strArray.push(tui.analytics.page.bookingLevelCreditNoteCode.split(':')[0]);\n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; typeof(tui.analytics.page.IncentivePromoCode) != &quot;undefined&quot;){\n                strArray.push(tui.analytics.page.IncentivePromoCode); \n            } \n            if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0){\n                strArray.push(tui.analytics.page.PromoCode);\n            } \n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelCreditNoteCode.length &gt; 0) {\n            if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n                var promoCodeArray = dataLayer[0].transactions.total.bookingLevelPromoCodes;\n\t            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n\t\t        for (i = 0; i &lt; promoCodeArray.length; i++) {\n\t\t\t        strArray.push(promoCodeArray[i].bookingLevelPromoCode);\n\t\t\t    }\n\t        } else {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelCreditNoteCode.split(':')[0]);\n            }\n        } else if (window.tui &amp;&amp; tui.analytics &amp;&amp; tui.analytics.page &amp;&amp; tui.analytics.page.PromoCode &amp;&amp; tui.analytics.page.PromoCode.length &gt; 0) {\n            strArray.push(tui.analytics.page.PromoCode);\n        } else if (window.dataLayer &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCode &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCode);\n        } else if (window.dataLayer[0] &amp;&amp; dataLayer[0] &amp;&amp; dataLayer[0].transactions &amp;&amp; dataLayer[0].transactions.total &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes &amp;&amp; dataLayer[0].transactions.total.bookingLevelPromoCodes.length &gt; 0) {\n            strArray.push(dataLayer[0].transactions.total.bookingLevelPromoCodes[0].bookingLevelPromoCode);\n        } else {\n\t\t    return '';\n\t    }\n\t    return strArray.join(&quot;|&quot;);\n    } catch (err) {\n        return &quot;&quot;;\n    }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {}\n  }\n\n  try {\n    b[&quot;userAgent&quot;] = (function() {\n      try {\n        return navigator.userAgent\n      } catch (e) {\n        return 'error'\n      }\n    })()\n  } catch (e) {\n    if (utag &amp;&amp; utag.DB) {\n      utag.DB(e)\n    } else {}\n  }\n\n  // add a prefix to mark these variables as legacy\n  var legacyVariables = Object.keys(b)\n  legacyVariables.forEach(function(key) {\n    originalB[legacyPrefix + key] = b[key]\n  })\n\n  return originalB;\n}","name":"legacy prefixes","creationDate":"202011241029","updateDate":"202101181719","updatedBy":"gabriele.giucca@tui.co.uk"}},"queueSeq":"38"},"labels":"23","advExecOption":"blr","status":"active","scope":"global","constructor":"","id":"100040","title":"UDO Population - 'legacy_' data definitions (copied directly from Ensighten as a stopgap)"},"28":{"selectedTargets":{"dev":"true","prod":"true","qa":"true"},"notes":"","sort":"3","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"_id":"28","extType":"Javascript Code","type":"new","publishedTargets":"dev","blockPubTargetsLogic":"true","codeDevData":{"draftSeq":"1","promotedSnippets":{"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202012091349","promotedDraftName":"Draft 1","name":"dev","code":"\n// ported from the Ensighten GA tag\nb.legacy_customerIDClean = (b.legacy_customerID &amp;&amp; b.legacy_customerID.toLowerCase() !== 'anonymous' &amp;&amp; b.legacy_customerID.toLowerCase() !== 'null' &amp;&amp; b.legacy_customerID !== '') ? b.legacy_customerID : undefined;\n\nb.legacy_bookingReferenceSplit = b.legacy_bookingReference ? b.legacy_bookingReference.split('-')[0] : undefined;\n\n// TiQ's GA tag can fire to multiple properties if you provide a comma-delimited string of multiple Tracking IDs\nb.legacy_Google_Analytics_All_Property_IDs = (function (older, newer) {\n    var ids = [];\n    if (older) ids.push(older);\n    if (newer) ids.push(newer);\n    return ids;\n})(b.legacy_googleAnalyticsPropertyID, b.legacy_Google_Analytics_New_Property_ID).join(',');"},"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"name":"qa","code":"\n// ported from the Ensighten GA tag\nb.legacy_customerIDClean = (b.legacy_customerID &amp;&amp; b.legacy_customerID.toLowerCase() !== 'anonymous' &amp;&amp; b.legacy_customerID.toLowerCase() !== 'null' &amp;&amp; b.legacy_customerID !== '') ? b.legacy_customerID : undefined;\n\nb.legacy_bookingReferenceSplit = b.legacy_bookingReference ? b.legacy_bookingReference.split('-')[0] : undefined;\n\n// TiQ's GA tag can fire to multiple properties if you provide a comma-delimited string of multiple Tracking IDs\nb.legacy_Google_Analytics_All_Property_IDs = (function (older, newer) {\n    var ids = [];\n    if (older) ids.push(older);\n    if (newer) ids.push(newer);\n    return ids;\n})(b.legacy_googleAnalyticsPropertyID, b.legacy_Google_Analytics_New_Property_ID).join(',');","promotedBy":"caleb.jaquith@tealium.com","promotedTimestamp":"202012091349","promotedDraftName":"Draft 1"}},"queueSeq":"6","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"code":"\n// ported from the Ensighten GA tag\nb.legacy_customerIDClean = (b.legacy_customerID &amp;&amp; b.legacy_customerID.toLowerCase() !== 'anonymous' &amp;&amp; b.legacy_customerID.toLowerCase() !== 'null' &amp;&amp; b.legacy_customerID !== '') ? b.legacy_customerID : undefined;\n\nb.legacy_bookingReferenceSplit = b.legacy_bookingReference ? b.legacy_bookingReference.split('-')[0] : undefined;\n\n// TiQ's GA tag can fire to multiple properties if you provide a comma-delimited string of multiple Tracking IDs\nb.legacy_Google_Analytics_All_Property_IDs = (function (older, newer) {\n    var ids = [];\n    if (older) ids.push(older);\n    if (newer) ids.push(newer);\n    return ids;\n})(b.legacy_googleAnalyticsPropertyID, b.legacy_Google_Analytics_New_Property_ID).join(',');","name":"Draft 1","updateDate":"202011201345","creationDate":"202011181151","updatedBy":"caleb.jaquith@tealium.com"}}},"initialize":"","labels":"20","advExecOption":"blr","status":"active","constructor":"","scope":"global","id":"100040","title":"Google Analytics - Additional Variables"},"29":{"160579006382500600_filter":"timing","160579766569300728_set":"js.gaEventCategory","type":"new","160579004074700599_settovar":"","publishedTargets":"dev","160579766569300728_settovar":"","sort":"15","notes":"","160579769351500729_settotext":"Timings","160579769351500729_settovar":"","160579006382500600_filtertype":"equals_ignore_case","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160579766569300728_setoption":"code","extType":"Set Data Values","_id":"29","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"Set tealium_event (and related) on TIMING events","160579004074700599_set":"js.tealium_event","160579769351500729_setoption":"text","160579769351500729_set":"js.gaEventAction","id":"100003","160579006382500600_source":"js.ut.event","160579766569300728_settotext":"'Page Speed'","160579004074700599_setoption":"text","160579004074700599_settotext":"page_timing","labels":"","initialize":"","scope":"global","constructor":"","status":"active","advExecOption":"blr"},"30":{"listtype":"array","cship":"","cstore":"","cstate":"","separator":"|","ccat2":"","ccurrency":"js.legacy_currencyCode","cprod":"js.legacy_productList.id","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"cpdisc":"js.legacy_coupon","extType":"E-commerce","ccity":"","ctax":"","_id":"30","totalcalculate":"no","sort":"5","czip":"","cpromo":"js.legacy_coupon","output":"_cprod,_cprodname,_cbrand,_ccat,_ccat2,_corder,_ccurrency,_cquan,_cprice,_ctype,_ctotal,_csubtotal,_csku,_cship,_cstore,_ctax,_cpdisc,_ccustid,_ccity,_cstate,_czip,_ccountry,_cpromo","ctotal":"js.legacy_price","corder":"js.legacy_bookingReference","id":"100005","constructor":"","cprice":"js.legacy_productList.price","initialize":"","pricetype":"unit","labels":"","ctype":"","csubtotal":"js.legacy_price","publishedTargets":"dev","ccat":"","ccountry":"","cquan":"js.legacy_productList.quantity","cprodname":"js.legacy_productList.name","type":"new","cbrand":"js.legacy_productList.brand","ccustid":"","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"notes":"Added via Tealium Data Layer Wizard by: caleb.jaquith@tealium.com","title":"E-commerce","advExecOption":"blr","scope":"global","status":"active","csku":""},"31":{"160579004074700599_settovar":"","type":"new","160579006382500600_filter":"","publishedTargets":"dev","notes":"","160579006382500600_160743887969902467_filtertype":"equals_ignore_case","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160579006382500600_160579278133200601_filter":"386","160613836749803725_setoption":"text","title":"Set  tealium_event (and related) on DETAIL pages","160579006382500600_source":"js.loadRulesTriggered","160613836881403726_setoption":"text","160613836881403726_settotext":"Product View","160613836881403726_set":"js.gaEventAction","160579004074700599_settotext":"detail","160579006382500600_160743887969902467_filter":"view","status":"active","scope":"global","160613836881403726_settovar":"","advExecOption":"blr","160613836749803725_set":"js.gaEventCategory","160579006382500600_160743887969902467_source":"js.ut.event","160613836749803725_settovar":"","sort":"10","160579006382500600_160579278133200601_filtertype":"contains","160579006382500600_filtertype":"defined","160613836749803725_settotext":"Enhanced Ecommerce","_id":"31","extType":"Set Data Values","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"160579004074700599_set":"js.tealium_event","id":"100003","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","labels":"","initialize":"","160579004074700599_setoption":"text","constructor":""},"32":{"notes":"","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"160579006382500600_160579278133200601_filter":"583","160613836749803725_setoption":"text","160579006382500600_filter":"","type":"new","160579004074700599_settovar":"","publishedTargets":"dev","160579004074700599_settotext":"search","160613836881403726_set":"js.gaEventAction","scope":"global","160613836881403726_settovar":"","status":"active","160613836749803725_set":"js.gaEventCategory","advExecOption":"blr","title":"Set tealium_event (and related) on SEARCH pages","160613836881403726_setoption":"text","160579006382500600_160743885851102466_source":"js.ut.event","160579006382500600_source":"js.loadRulesTriggered","160613836881403726_settotext":"Impression","sort":"6","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_filtertype":"contains","extType":"Set Data Values","_id":"32","160579006382500600_160743885851102466_filter":"view","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"160613836749803725_settovar":"","160579004074700599_setoption":"text","labels":"","initialize":"","constructor":"","160579004074700599_set":"js.tealium_event","id":"100003","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","160579006382500600_160743885851102466_filtertype":"equals_ignore_case"},"33":{"title":"Convert 'legacy_productList' into arrays of the component parts","id":"100040","codeDevData":{"queueSeq":"5","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"name":"Draft 1","code":"if (typeof b.legacy_productList === &quot;object&quot; &amp;&amp; b.legacy_productList.length) {\n  for (var i = 0, flat, keys; i &lt; b.legacy_productList.length; i++) {\n    flat = teal.flattenObject(b.legacy_productList[i])\n    keys = Object.keys(flat)\n    for (var j = 0; j &lt; keys.length; j++) {\n      b['legacy_productList.' + keys[j]] = b['legacy_productList.' + keys[j]] || []\n      b['legacy_productList.' + keys[j]][i] = flat[keys[j]]\n    }\n  }\n}","updatedBy":"caleb.jaquith@tealium.com","updateDate":"202011242007","creationDate":"202011241156"}},"promotedSnippets":{"3f3ef786b34d6dd716e1812c8b74a7a0e1f05aa5f3230588f6f5bcd00c6c8392":{"promotedDraftName":"Draft 1","promotedTimestamp":"202012091349","promotedBy":"caleb.jaquith@tealium.com","code":"if (typeof b.legacy_productList === &quot;object&quot; &amp;&amp; b.legacy_productList.length) {\n  for (var i = 0, flat, keys; i &lt; b.legacy_productList.length; i++) {\n    flat = teal.flattenObject(b.legacy_productList[i])\n    keys = Object.keys(flat)\n    for (var j = 0; j &lt; keys.length; j++) {\n      b['legacy_productList.' + keys[j]] = b['legacy_productList.' + keys[j]] || []\n      b['legacy_productList.' + keys[j]][i] = flat[keys[j]]\n    }\n  }\n}","name":"qa"},"ef260e9aa3c673af240d17a2660480361a8e081d1ffeca2a5ed0e3219fc18567":{"code":"if (typeof b.legacy_productList === &quot;object&quot; &amp;&amp; b.legacy_productList.length) {\n  for (var i = 0, flat, keys; i &lt; b.legacy_productList.length; i++) {\n    flat = teal.flattenObject(b.legacy_productList[i])\n    keys = Object.keys(flat)\n    for (var j = 0; j &lt; keys.length; j++) {\n      b['legacy_productList.' + keys[j]] = b['legacy_productList.' + keys[j]] || []\n      b['legacy_productList.' + keys[j]][i] = flat[keys[j]]\n    }\n  }\n}","name":"dev","promotedTimestamp":"202012091349","promotedDraftName":"Draft 1","promotedBy":"caleb.jaquith@tealium.com"}},"draftSeq":"1"},"initialize":"","labels":"","constructor":"","scope":"global","status":"active","advExecOption":"blr","type":"new","blockPubTargetsLogic":"true","publishedTargets":"dev","sort":"4","notes":"","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"extType":"Javascript Code","_id":"33","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}}},"34":{"sort":"14","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_160579278133200601_filtertype":"contains","160579006382500600_filtertype":"defined","extType":"Set Data Values","_id":"34","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"160622807629201575_set":"js.gaEventLabel","160613836749803725_settovar":"","160622807629201575_settotext":"Extra Options","160622807629201575_setoption":"text","160579006382500600_160743895080002471_filter":"view","160579004074700599_setoption":"text","initialize":"","160579006382500600_160743895080002471_source":"js.ut.event","labels":"","constructor":"","160622807629201575_settovar":"","160579004074700599_set":"js.tealium_event","id":"100003","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","notes":"","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160613836749803725_setoption":"text","160579006382500600_160579278133200601_filter":"571","160579006382500600_160743895080002471_filtertype":"equals_ignore_case","160579006382500600_filter":"","type":"new","160579004074700599_settovar":"","publishedTargets":"dev","160613836881403726_set":"js.gaEventAction","160579004074700599_settotext":"checkout_extra_options","scope":"global","160613836881403726_settovar":"","status":"active","160613836749803725_set":"js.gaEventCategory","advExecOption":"blr","title":"Set tealium_event (and related) on CHECKOUT - EXTRA OPTIONS pages","160613836881403726_setoption":"text","160579006382500600_source":"js.loadRulesTriggered","160613836881403726_settotext":"Checkout"},"35":{"publishedTargets":"dev","160579006382500600_filter":"","type":"new","160579004074700599_settovar":"","160579006382500600_160579278133200601_filter":"543","160613836749803725_setoption":"text","notes":"","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160613836881403726_settotext":"Checkout","title":"Set tealium_event (and related) on CHECKOUT - CUSTOMISE HOLIDAY pages","160613836881403726_setoption":"text","160579006382500600_source":"js.loadRulesTriggered","scope":"global","160613836881403726_settovar":"","status":"active","160579006382500600_160743893816502470_filtertype":"equals_ignore_case","160613836749803725_set":"js.gaEventCategory","advExecOption":"blr","160613836881403726_set":"js.gaEventAction","160579004074700599_settotext":"checkout_customise_holiday","160613836749803725_settovar":"","160622807629201575_set":"js.gaEventLabel","extType":"Set Data Values","_id":"35","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"160579006382500600_160743893816502470_filter":"view","sort":"13","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_160579278133200601_filtertype":"contains","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","160579004074700599_set":"js.tealium_event","160579006382500600_160743893816502470_source":"js.ut.event","id":"100003","constructor":"","160622807629201575_settovar":"","160622807629201575_settotext":"Customise Holiday","160622807629201575_setoption":"text","160579004074700599_setoption":"text","labels":"","initialize":""},"36":{"160622807629201575_set":"js.gaEventLabel","160613836749803725_settovar":"","sort":"7","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_filtertype":"contains","extType":"Set Data Values","_id":"36","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"160579004074700599_set":"js.tealium_event","id":"100003","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","160579006382500600_160743889609102468_filter":"view","160622807629201575_settotext":"Flight Options","160579006382500600_160743889609102468_filtertype":"equals_ignore_case","160622807629201575_setoption":"text","160579004074700599_setoption":"text","labels":"","initialize":"","constructor":"","160622807629201575_settovar":"","160579006382500600_filter":"","160579004074700599_settovar":"","type":"new","publishedTargets":"dev","notes":"","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160613836749803725_setoption":"text","160579006382500600_160579278133200601_filter":"572","title":"Set tealium_event (and related) on CHECKOUT - FLIGHT OPTIONS pages","160613836881403726_setoption":"text","160579006382500600_source":"js.loadRulesTriggered","160613836881403726_settotext":"Checkout","160613836881403726_set":"js.gaEventAction","160579004074700599_settotext":"checkout_flight_options","160613836881403726_settovar":"","scope":"global","status":"active","160579006382500600_160743889609102468_source":"js.ut.event","160613836749803725_set":"js.gaEventCategory","advExecOption":"blr"},"37":{"notes":"","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160613836749803725_setoption":"text","160579006382500600_160579278133200601_filter":"573","160579006382500600_160743892537602469_filter":"view","160579006382500600_filter":"","type":"new","160579004074700599_settovar":"","publishedTargets":"dev","160579006382500600_160743892537602469_source":"js.ut.event","160613836881403726_set":"js.gaEventAction","160579004074700599_settotext":"checkout_room_options","160613836881403726_settovar":"","scope":"global","status":"active","advExecOption":"blr","160613836749803725_set":"js.gaEventCategory","title":"Set  tealium_event (and related) on CHECKOUT - ROOM OPTIONS pages","160613836881403726_setoption":"text","160579006382500600_source":"js.loadRulesTriggered","160613836881403726_settotext":"Checkout","sort":"8","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_filtertype":"contains","extType":"Set Data Values","_id":"37","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"160622807629201575_set":"js.gaEventLabel","160613836749803725_settovar":"","160622807629201575_settotext":"Room Options","160622807629201575_setoption":"text","160579004074700599_setoption":"text","initialize":"","labels":"","constructor":"","160622807629201575_settovar":"","160579004074700599_set":"js.tealium_event","160579006382500600_160743892537602469_filtertype":"equals","id":"100003","160579006382500600_160579278133200601_source":"js.loadRulesTriggered"},"38":{"160579004074700599_settotext":"checkout_summary_to_payment","160623032511401994_settotext":"","160613836749803725_set":"js.gaEventCategory","advExecOption":"blr","status":"active","scope":"global","160622951956901838_160743897232102473_filtertype":"equals_ignore_case","160579006382500600_source":"js.loadRulesTriggered","160622951956901838_160622952445301841_filter":"569","160622952153801839_160622952359701840_filtertype":"contains","title":"Set tealium_event (and related) on CHECKOUT - SUMMARY TO PAYMENT pages","160622951956901838_160743897232102473_filter":"view","160622951956901838_filter":"","160622952153801839_160743898045502474_filter":"view","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160622951956901838_filtertype":"populated","160622951956901838_160622952445301841_source":"js.loadRulesTriggered","notes":"","160579006382500600_160579278133200601_filter":"570","160613836749803725_setoption":"text","160579004074700599_settovar":"","type":"new","160579006382500600_filter":"","publishedTargets":"dev","160622951956901838_160622952445301841_filtertype":"contains","labels":"","initialize":"","160579004074700599_setoption":"text","160622807629201575_setoption":"text","160622807629201575_settotext":"Checkout","160622952153801839_160622952359701840_source":"js.loadRulesTriggered","160623032511401994_settovar":"js.legacy_pageSubCategory","160579006382500600_160743896477102472_filter":"view","160622807629201575_settovar":"","constructor":"","id":"100003","160622952153801839_filter":"","160579004074700599_set":"js.tealium_event","160623032511401994_set":"js.gaEventLabel","160622952153801839_160743898045502474_filtertype":"equals_ignore_case","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","160622952153801839_source":"js.loadRulesTriggered","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_filtertype":"contains","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_160743896477102472_source":"js.ut.event","sort":"11","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"_id":"38","160622952153801839_160743898045502474_source":"js.ut.event","extType":"Set Data Values","160622951956901838_160743897232102473_source":"js.ut.event","160622807629201575_set":"js.gaEventAction","160623032511401994_setoption":"var","160622951956901838_source":"js.loadRulesTriggered","160622952153801839_160622952359701840_filter":"451","160579006382500600_160743896477102472_filtertype":"equals_ignore_case","160622952153801839_filtertype":"contains","160613836749803725_settovar":""},"39":{"publishedTargets":"dev","160579006382500600_filter":"","type":"new","160579004074700599_settovar":"","160613836749803725_setoption":"text","160579006382500600_160579278133200601_filter":"471","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"notes":"","160613836881403726_settotext":"Order Confirmation","160613836881403726_setoption":"text","160579006382500600_source":"js.loadRulesTriggered","title":"Set tealium_event (and related) on PURCHASE pages","advExecOption":"blr","160613836749803725_set":"js.gaEventCategory","160613836881403726_settovar":"","scope":"global","status":"active","160579004074700599_settotext":"purchase","160613836881403726_set":"js.gaEventAction","160613836749803725_settovar":"","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"extType":"Set Data Values","_id":"39","160613836749803725_settotext":"Enhanced Ecommerce","160579006382500600_filtertype":"defined","160579006382500600_160579278133200601_filtertype":"contains","sort":"12","160579006382500600_160743899453102475_filter":"view","160579006382500600_160579278133200601_source":"js.loadRulesTriggered","id":"100003","160579004074700599_set":"js.tealium_event","constructor":"","160579004074700599_setoption":"text","labels":"","initialize":"","160579006382500600_160743899453102475_source":"js.ut.event","160579006382500600_160743899453102475_filtertype":"equals_ignore_case"},"40":{"advExecOption":"alr","constructor":"","scope":"10","status":"active","initialize":"","labels":"18,20","code":"return false;","160745763632401937_160745765050401938_source":"js.event","_ignoreError":"false","160745763632401937_160745765050401938_filtertype":"equals_ignore_case","id":"100036","title":"Google Analytics - Prevent tag from firing on cm_events (Manage Preferences Relaunch)","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"160745763632401937_160745765050401938_filter":"tiq.cm_manage_preferences_relaunched","extType":"Javascript Code","_id":"40","160745763632401937_source":"js.event","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"160745763632401937_filtertype":"populated","sort":"34","scopevars":"","notes":"These events aren't currently tracked in GA, and we want to migrate 1:1 (but make it easy to add them later)","publishedTargets":"dev","160745763632401937_filter":"","type":"new"},"41":{"160630329510600825_setoption":"code","extType":"Set Data Values","160630291104700822_setoption":"code","_id":"41","160630323561400824_set":"_cprice","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"160630280335300821_setoption":"code","sort":"35","160630329510600825_set":"_cquan","160579006382500600_160579278133200601_filtertype":"equals","160579006382500600_filtertype":"defined","160630329510600825_settotext":"[ &quot;1&quot; ]","160579006382500600_160579278133200601_source":"js.tealium_event","160630280335300821_set":"_cprod","160630323561400824_settovar":"","160630280335300821_settotext":"[ b.legacy_productID || &quot;&quot; ]","id":"100003","160630292686800823_settotext":"[ b.legacy_productCollectionCode || &quot;&quot; ]","constructor":"","160630291104700822_settotext":"[ b.legacy_productID || &quot;&quot; ]","160630329510600825_settovar":"","labels":"20","initialize":"","publishedTargets":"dev","160630292686800823_setoption":"code","160579006382500600_filter":"","type":"new","160579006382500600_160579278133200601_filter":"detail","160630323561400824_settotext":"[ b.legacy_price || &quot;&quot; ]","notes":"Tweak the ecommerce variables, just for this kind of page","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160630291104700822_settovar":"","160630280335300821_settovar":"","title":"Google Analytics - Edit Ecommerce Vars for GA on 'detail'","160579006382500600_source":"js.tealium_event","scope":"10","status":"active","160630292686800823_set":"_cbrand","160630292686800823_settovar":"","160630323561400824_setoption":"code","advExecOption":"alr","160630291104700822_set":"_cprodname"},"42":{"initialize":"","labels":"21,19","160813300697501682_value":"DC-6038309,DC-10291465","varlookup":"js.legacy_brand","disable_default_logic":"no","var":"js.dcAdvertiserId","160813300697501682_name":"tui","advExecOption":"alr","status":"active","constructor":"","scope":"global","160822715968800533_value":"DC-6038309","id":"100020","title":"Google Campaign Manager: Set Advertiser ID [1]","160822715968800533_comment":"TUI IE Advertiser ID (Same advertiser as UK)","settotext":"","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160822715968800533_name":"tui ie","160813377959901683_value":"DC-10190463","160813377959901683_comment":"_FC_Master Floodlight Configuration","notes":"","vartype":"string","sort":"17","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"160813377959901683_name":"firstchoice","_id":"42","extType":"Lookup Table","type":"new","filtertype":"equals","publishedTargets":"dev","160813300697501682_comment":"_TUI_Master Floodlight Configuration, _TUI_Brand Master Floodlight Configuration"},"43":{"publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"160813637411703556_setoption":"text","extType":"Set Data Values","_id":"43","160813808282303737_160855589222400758_filtertype":"populated","160813808282303737_filtertype":"populated","160813808282303737_filter":"1","160813637411703556_settotext":"2","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"sort":"36","notes":"","publishedTargets":"dev","160813637411703556_set":"js.dcFloodlightFire","type":"new","160813637411703556_settovar":"","160813808282303737_160855589222400758_source":"js.legacy_bookingReference","advExecOption":"alr","constructor":"","scope":"11,12","status":"active","labels":"21,19","initialize":"","160813808282303737_160855589222400758_filter":"","160813808282303737_source":"js.dcSettings","id":"100003","title":"Google Campaign Manager: Purchase Floodlight Trigger [5]"},"44":{"160821787713801307_value":"hp|tui_u002|Standard","vartype":"string","160821787713901314_name":"^(\\/holidays\\/robinson-club\\/?)$","160821787713901315_value":"land|tours|Standard","sort":"18","160821787713601291_comment":"TUI_UK_PAC_BOOK","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"160821787713701305_value":"hp|tui_u0|Standard","160821787713701303_value":"hp|tui_u000|Standard","160821787713501281_comment":"TUI_UK_CRU_SALE_NEW,TUI_UK_Brand_CRU_SALE","160821787713901314_value":"land|tui_u0|Unique","initialize":"","160821787713601294_value":"book|tui_u000|Standard","160821787713801306_value":"hp|tui_u00|Standard","160821787713501284_comment":"TUI_UK_MULTI_SALE,TUI_UK_Brand_MULTI_SALE","160821787713601295_name":"^(\\/destinations\\/multi-centre\\/centre-details\\/?)$","varlookup":"dom.pathname","160821787713901317_comment":"TUI_UK_HOMEPAGE","160821787713601295_comment":"TUI_UK_MULTI_PRODUCT","160821787713701298_value":"sp|tui_u00|Standard","160821787713601292_name":"^(\\/river-cruises\\/book\\/(?!(confirmation)|(mobile\\/confirmation)))","id":"100020","160821787713701302_name":"^(\\/river-cruises\\/packages\\/?)$","160821787713901316_comment":"TUI_UK_LOGGED-IN","160821787713601290_value":"book|multbook|Standard","160821787713501284_name":"^(\\/destinations\\/multi-centre\\/book\\/(mobile\\/)?confirmation\\/?)$","160821787713501286_comment":"TUI_UK_RIV_SALE,TUI_UK_Brand_RIV_SALE","160821787713601296_value":"pp|tui_u0|Standard","160821787713501285_value":"booki0,booking|thoms0,pacbrand|Transactions,Transactions","160821787713501288_comment":"TUI_UK_CRU_BOOK","160821787713601293_comment":"TUI_UK_CRU_PRODUCT","type":"new","160821787713701303_comment":"TUI_UK_CRU_LAND","160821787713601296_comment":"TUI_UK_PAC_PRODUCT","160821787713701301_name":"^(\\/destinations\\/packages\\/?)$","160821787713801312_value":"land|tui_u000|Unique","160821787713701305_comment":"TUI_UK_PAC_DEST_LAND","publishedTargets":"dev","160821787713901315_name":"^(\\/holidays\\/escorted-tours\\/?)$","160821787713801307_name":"^(\\/river-cruises\\/?)$","160821787713801307_comment":"TUI_UK_RIV_LAND","160821787713701297_comment":"TUI_UK_RIV_PRODUCT","160821787713801313_name":"^(\\/holidays\\/multi-centre\\/?)$","160821787713801313_value":"land|multi|Standard","160821787713701303_name":"^(\\/cruise\\/?)$","160821787713801306_comment":"TUI_UK_PAC_HOL_LAND","160821787713701297_name":"^(\\/river-cruises\\/bookitineraries\\/?)","160821787713801311_name":"^(\\/holidays\\/lakes-and-mountains\\/?)$","160821787713801311_comment":"TUI_UK_LAKE_LAND","160821787713901317_value":"misc|tui_u0|Standard","title":"Google Campaign Manager: TUI UK Floodlight Configs [2]","160821787713501285_name":"^(\\/destinations\\/book\\/(mobile\\/)?confirmation\\/?)$","160821787713701298_name":"^(\\/cruise\\/packages\\/?)$","160821787713801309_name":"^(\\/holidays\\/beach\\/?)$","160821787713501281_name":"^(\\/cruise\\/book\\/confirmation\\/?)$","160821787713701304_value":"hp|tui_u001|Standard","160821787713801310_value":"land|tui_u00|Unique","160821787713601291_value":"book|tui_u0|Standard","160821787713601294_name":"^(\\/flight\\/book\\/(?!(confirmation)|(mobile\\/confirmation)))","160821787713601293_name":"^(\\/cruise\\/bookitineraries\\/?)","160821787713601289_comment":"TUI_UK_FLI_PRODUCT","_id":"44","extType":"Lookup Table","160821787713601292_value":"book|tui_u001|Standard","160821787713801310_name":"^(\\/holidays\\/tui-blue\\/?)$","160821787713601291_name":"^(\\/destinations\\/book\\/(?!(confirmation)|(mobile\\/confirmation)))","160821787713901317_name":"^(\\/?)$","160821787713701300_comment":"TUI_UK_MULTI_SEARCH","160821787713901316_value":"misc|tui_u00|Standard","160821787713501286_value":"booki0,booking|https0,tui_u002|Transactions","160821787713701299_value":"sp|tui_u000|Standard","160821787713601292_comment":"TUI_UK_RIV_BOOK","160821787713801313_comment":"TUI_UK_MULTI_LAND","160821787713801311_value":"land|lakes|Standard","160821787713701304_name":"^(\\/flight\\/?)$","160821787713701300_value":"sp|multse|Standard","labels":"21,19","disable_default_logic":"no","160821787713801306_name":"^(\\/holidays\\/?)$","160821787713801312_comment":"TUI_UK_MAGICLIFE_LAND","160821787713501282_name":"^(\\/flight\\/book\\/confirmation\\/?)$","160821787713801309_value":"land|beach|Standard","160821787713701299_name":"^(\\/flight\\/search?)$","160821787713801310_comment":"TUI_UK_BLUE_LAND","160821787713501288_name":"^(\\/cruise\\/book\\/(?!(confirmation)|(mobile\\/confirmation)))","160813885423503782_source":"js.legacy_brand","constructor":"","160821787713601296_name":"^(\\/destinations\\/bookaccommodation\\/?)","160821787713601293_value":"pp|tui_u00|Standard","160821787713701297_value":"pp|tui_u001|Standard","160813885423503782_filtertype":"equals","160821787713601295_value":"pp|multpro|Standard","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"160821787713701300_name":"^(\\/destinations\\/multi-centre\\/package\\/?)$","160821787713701298_comment":"TUI_UK_CRU_SEARCH","160821787713801312_name":"^(\\/holidays\\/magic-life\\/?)$","notes":"Returns ACTIVITY GROUP|ACTIVITY STRING|COUNTERTYPE\n\n* AO/Tours/Lakes floodlight ID logic applied in following extensions","160821787713601289_name":"^(\\/flight\\/book\\/(mobile\\/)?flightoptions\\/?)$","160821787713501286_name":"^(\\/river-cruises\\/book\\/confirmation\\/?)$","160821787713901315_comment":"TUI_UK_TOU_LAND","160821787713701301_comment":"TUI_UK_PAC_SEARCH","160821787713701302_comment":"TUI_UK_RIV_SEARCH","160821787713501285_comment":"*TUI_UK_PAC_SALE_NEW,TUI_UK_Brand_PAC_SALE","160821787713901314_comment":"TUI_UK_ROBINSON_LAND","160821787713901316_name":"^(\\/destinations\\/your-account\\/my-account\\/?)$","160821787713501282_comment":"TUI_UK_FLI_SALE_NEW,TUI_UK_Brand_FLI_SALE","filtertype":"regular_expression","160821787713501284_value":"booki0,booking|tui_u0,tui_u001|Transactions,Transactions","160821787713501288_value":"book|tui_u00|Standard","160821787713501281_value":"booki0,booking|thoms00,crubrand|Transactions,Transactions","160821787713701301_value":"sp|tui_u0|Standard","160821787713701299_comment":"TUI_UK_FLI_SEARCH","160821787713601289_value":"pp|tui_u000|Standard","160821787713601294_comment":"TUI_UK_FLI_BOOK","var":"js.dcSettings","160821787713501282_value":"booki0,booking|thoms000,flibrand|Transactions,Transactions","advExecOption":"alr","160821787713601290_comment":"TUI_UK_MULTI_BOOK","160821787713701302_value":"sp|tui_u001|Standard","status":"active","160813885423503782_filter":"tui","scope":"global","160821787713801309_comment":"TUI_UK_BEA_LAND","160821787713601290_name":"^(\\/destinations\\/multi-centre\\/book\\/(?!(confirmation)|(mobile\\/confirmation)))","160821787713701304_comment":"TUI_UK_FLI_LAND","160821787713701305_name":"^(\\/destinations\\/holiday-destinations\\/?)$","settotext":""},"45":{"160813917834003785_setoption":"code","160813912806203783_set":"js.dcActivityGroup","type":"new","160813912806203783_settotext":"b['dcSettings'].split(&quot;|&quot;)[0]","160813912806203783_settovar":"","publishedTargets":"dev","sort":"19","notes":"","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"extType":"Set Data Values","160813917742103784_setoption":"code","_id":"45","160813917742103784_settotext":"b['dcSettings'].split(&quot;|&quot;)[1]","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"title":"Google Campaign Manager: Set Floodlight Variables [3]","160813917834003785_set":"js.dcCounterType","id":"100003","160813917834003785_settovar":"","160813917742103784_settovar":"","160813912806203783_setoption":"code","labels":"21,19","initialize":"","160813917742103784_set":"js.dcActivityString","constructor":"","160813917834003785_settotext":"b['dcSettings'].split(&quot;|&quot;)[2]","scope":"global","status":"active","advExecOption":"alr"},"46":{"status":"active","160813885423503782_filter":"firstchoice","160821787713501287_name":"^(/discount-codes/?)$","scope":"global","160821787713601290_comment":"FC_UK_INS_LAND","advExecOption":"alr","160821787713501282_value":"book|fc_uk0|Standard","var":"js.dcSettings","160821787713601294_comment":"FC_UK_HOMEPAGE","160821787713601289_value":"hp|fc_uk003|Standard","settotext":"","160821787713501283_value":"pp|fc_uk0|Standard","160821787713601290_name":"^(/inspire/?)","160821787713501283_comment":"FC_UK_PAC_PRODUCT","160821787713501286_name":"^(/holiday/deals/?)$","160821787713601289_name":"^(/hotels/?)","notes":"Returns ACTIVITY GROUP|ACTIVITY STRING|COUNTERTYPE\n\n*** Beach/AO custom floodlight logic applied in following extensions","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160821787713501288_value":"land|fc_uk00|Unique","160821787713501284_value":"sp|fc_uk0|Standard","filtertype":"regular_expression","160821787713501282_comment":"FC_UK_PAC_BOOK","160821787713501285_comment":"FC_UK_CALC_LAND","160821787713501288_name":"^(\\/holiday\\/your-account\\/login\\/?)$","constructor":"","160821787713401280_comment":"*FC_UK_PAC_SALE","160813885423503782_source":"js.legacy_brand","160821787713501282_name":"^(\\/holiday\\/book\\/(?!(mobile\\/)?confirmation))","labels":"21,19","disable_default_logic":"no","160813885423503782_filtertype":"equals","160821787713601293_value":"hp|fc_uk001|Standard","_id":"46","160821787713601289_comment":"FC_UK_HOT_LAND","extType":"Lookup Table","160821787713401280_name":"^(\\/holiday\\/book\\/(mobile\\/)?confirmation\\/?)$","160821787713601293_name":"^(/holiday/?)","160821787713601294_name":"^(\\/)$","160821787713601291_value":"hp|fc_uk005|Standard","160821787713501287_value":"hp|fc_uk000|Standard","160821787713601292_comment":"FC_UK_SHOPFINDER_LAND","160821787713601291_name":"^(/holidays/?)","160821787713601292_value":"hp|fc_uk006|Standard","160821787713501286_value":"hp|fc_uk00|Standard","160821787713501285_name":"^(\\/all-inclusive-calculator\\/?)$","title":"Google Campaign Manager: First Choice Floodlight Configs [2]","160821787713601293_comment":"FC_UK_HOL_LAND","160821787713501287_comment":"FC_UK_DISC_LAND","160821787713501288_comment":"FC_UK_LOG-IN","160821787713501286_comment":"FC_UK_DEAL_LAND","160821787713501285_value":"hp|fc_uk0|Standard","160821787713601290_value":"hp|fc_uk004|Standard","160821787713501284_name":"^(/holiday/packages)$","publishedTargets":"dev","type":"new","160821787713501284_comment":"FC_UK_PAC_SEARCH","initialize":"","160821787713601294_value":"hp|fc_uk002|Standard","varlookup":"dom.pathname","id":"100020","160821787713601292_name":"^(\\/shop-finder\\/?)","160821787713501283_name":"^(\\/holiday\\/bookaccommodation/?)","160821787713601291_comment":"FC_UK_PAC_LAND","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"vartype":"string","160821787713401280_value":"booki0|fc_u0|Transactions","sort":"20"},"47":{"notes":"Returns ACTIVITY GROUP|ACTIVITY STRING|COUNTERTYPE","vartype":"string","sort":"21","160821787713401280_value":"booki0|falco00|Transactions","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"_id":"47","extType":"Lookup Table","160821787713401280_name":"^(\\/flight\\/book\\/(mobile\\/)?confirmation\\/?)$","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"filtertype":"regular_expression","type":"new","160821787713501281_comment":"FALCON_IE_PAC_SALE","160821787713501281_value":"booki0|falco0|Transactions","publishedTargets":"dev","var":"js.dcSettings","labels":"21,19","initialize":"","disable_default_logic":"no","varlookup":"dom.pathname","status":"active","160813885423503782_filter":"tui ie","160813885423503782_source":"js.legacy_brand","160821787713401280_comment":"FALCON_IE_FLI_SALE","constructor":"","scope":"global","advExecOption":"alr","160813885423503782_filtertype":"equals","title":"Google Campaign Manager: TUI IE Floodlight Configs [2]","id":"100020","settotext":"","160821787713501281_name":"^(\\/f\\/book\\/(mobile\\/)?confirmation\\/?)$"},"48":{"extType":"Set Data Values","160813917742103784_setoption":"text","160813917742103784_settotext":"tui_u001,landp","_id":"48","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"sort":"37","notes":"TUI_UK_ALL_UNIQUE-LAND,TUI_UK_ALL_Brand_UNIQUE-LAND floodlights","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160813912806203783_settotext":"land,lanbrand","160813912806203783_settovar":"","publishedTargets":"dev","160813917834003785_setoption":"text","160813912806203783_set":"js.dcActivityGroup","type":"new","160813917742103784_set":"js.dcActivityString","scope":"12","constructor":"","160813917834003785_settotext":"Unique,Unique","status":"active","160855893313501575_filter":"tui","160855893313501575_filtertype":"equals","advExecOption":"alr","160855893313501575_source":"js.legacy_brand","160813912806203783_setoption":"text","labels":"21,19","initialize":"","160813917742103784_settovar":"","160813917834003785_settovar":"","title":"Google Campaign Manager: TUI UK Unique Lands Floodlight Variables Override [4]","160813917834003785_set":"js.dcCounterType","id":"100003"},"49":{"extType":"Set Data Values","_id":"49","160813917742103784_settotext":"fc_uk0","160813917742103784_setoption":"text","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"sort":"38","notes":"FC_UK_ALL_UNIQUE-LAND","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160813912806203783_settotext":"land","160813912806203783_settovar":"","publishedTargets":"dev","160813917834003785_setoption":"text","type":"new","160813912806203783_set":"js.dcActivityGroup","constructor":"","scope":"12","160813917834003785_settotext":"Unique","160813917742103784_set":"js.dcActivityString","status":"active","160855893313501575_filter":"firstchoice","160855893313501575_filtertype":"equals","advExecOption":"alr","160855893313501575_source":"js.legacy_brand","initialize":"","160813912806203783_setoption":"text","labels":"21,19","160813917742103784_settovar":"","160813917834003785_settovar":"","title":"Google Campaign Manager: Set First Choice Unique Lands Floodlight Variables Override [4]","160813917834003785_set":"js.dcCounterType","id":"100003"},"50":{"id":"100003","title":"Google Campaign Manager: TUI AO Purchase Floodlight Config [4]","160856641988901403_settovar":"","labels":"21,19","initialize":"","160856632920901401_160856873797201405_filter":"tui","160856632920901401_160856633062501402_filtertype":"equals","advExecOption":"alr","scope":"11","constructor":"","160856632920901401_filter":"Yes","status":"active","type":"new","publishedTargets":"dev","160856641988901403_setoption":"text","160856641988901403_set":"js.dcActivityString","160856641988901403_settotext":"tui_u00,tui_u0","160856632920901401_160856873797201405_source":"js.legacy_brand","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"sort":"39","160856632920901401_160856873797201405_filtertype":"equals","notes":"TUI_UK_AO_SALE,TUI_UK_Brand_AO_SALE floodlights","160856632920901401_filtertype":"equals","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"160856632920901401_160856633062501402_filter":"/destinations/book/confirmation","160856632920901401_source":"js.legacy_isAccommodationOnly","160856632920901401_160856633062501402_source":"dom.pathname","extType":"Set Data Values","_id":"50"},"51":{"160856632920901401_160856633062501402_source":"dom.pathname","160856632920901401_source":"js.legacy_productCollectionName","160856632920901401_160856633062501402_filter":"/destinations/book/confirmation","160856632920901401_filtertype":"equals","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"_id":"51","extType":"Set Data Values","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"notes":"TUI_UK_LAKES_SALE,TUI_UK_Brand_LAKES_SALE floodlights","sort":"40","160856641988901403_setoption":"text","160856641988901403_set":"js.dcActivityString","publishedTargets":"dev","160856641988901403_settotext":"tui_u001,tui_u00","type":"new","160856632920901401_160856877477701406_filtertype":"equals","advExecOption":"alr","status":"active","160856632920901401_filter":"Lakes &amp; Mountains","scope":"11","constructor":"","initialize":"","labels":"21,19","160856641988901403_settovar":"","160856632920901401_160856633062501402_filtertype":"equals","id":"100003","160856632920901401_160856877477701406_source":"js.legacy_brand","160856632920901401_160856877477701406_filter":"tui","title":"Google Campaign Manager: TUI Lakes Purchase Floodlight Config [4]"},"52":{"type":"new","160856632920901401_160856878427001407_filtertype":"equals","160856632920901401_160856878427001407_source":"js.legacy_brand","160856641988901403_setoption":"text","160856641988901403_set":"js.dcActivityString","publishedTargets":"dev","160856641988901403_settotext":"tui_u000,tui_u000","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"notes":"TUI_UK_TOURS_SALE, TUI_UK_Brand_TOURS_SALE floodlights","sort":"41","160856632920901401_160856633062501402_source":"dom.pathname","160856632920901401_filtertype":"equals","160856632920901401_source":"js.legacy_productCollectionName","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"160856632920901401_160856633062501402_filter":"/destinations/book/confirmation","_id":"52","extType":"Set Data Values","id":"100003","title":"Google Campaign Manager: TUI Tours Purchase Floodlight Config [4]","labels":"21,19","initialize":"","160856641988901403_settovar":"","160856632920901401_160856633062501402_filtertype":"equals","160856632920901401_160856878427001407_filter":"tui","advExecOption":"alr","status":"active","160856632920901401_filter":"TUI Tours","constructor":"","scope":"11"},"53":{"160856632920901401_160856873797201405_filtertype":"equals","notes":"FC_UK_AO_SALE floodlight","sort":"42","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"_id":"53","extType":"Set Data Values","160856632920901401_160856633062501402_source":"dom.pathname","160856632920901401_160856633062501402_filter":"/holiday/book/confirmation","160856632920901401_filtertype":"equals","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"160856632920901401_source":"js.legacy_isAccommodationOnly","type":"new","160856632920901401_160856873797201405_source":"js.legacy_brand","160856641988901403_settotext":"fc_uk00","publishedTargets":"dev","160856641988901403_set":"js.dcActivityString","160856641988901403_setoption":"text","160856632920901401_160856633062501402_filtertype":"equals","160856632920901401_160856873797201405_filter":"firstchoice","labels":"21,19","initialize":"","160856641988901403_settovar":"","160856632920901401_filter":"Yes","status":"active","constructor":"","scope":"11","advExecOption":"alr","title":"Google Campaign Manager: First Choice AO Purchase Floodlight Config [4]","id":"100003"},"54":{"title":"Google Ads: Lakes &amp; Mountains Event Snippet [3]","id":"100003","160864883133000543_filter":"Lakes &amp; Mountains","160864883133000543_160865339977600642_filter":"","160864883133000543_source":"js.legacy_productCollectionName","labels":"22,19","initialize":"","constructor":"","scope":"13","160864876761300542_settovar":"","160864876761300542_setoption":"text","status":"active","160864876761300542_set":"js.googleAdsConversionLabel","advExecOption":"alr","160864883133000543_filtertype":"equals","type":"new","160864876761300542_settotext":"rSi4CLfqtawBEOHq1OED","publishedTargets":"dev","160864883133000543_160865339977600642_source":"js.legacy_bookingReference","sort":"43","notes":"","160864883133000543_160865339977600642_filtertype":"populated","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"extType":"Set Data Values","_id":"54","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}}},"55":{"_id":"55","extType":"Javascript Code","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"notes":"","sort":"29","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"blockPubTargetsLogic":"true","type":"new","status":"inactive","constructor":"","scope":"10,13,14,11,12,15","advExecOption":"alr","initialize":"","labels":"","codeDevData":{"queueSeq":"3","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"code":"// Scope to ALL gtag tags to override the current Tealium logic, which\n// assumes that multiple gtags on the page is always a user error and should\n// be avoided.  We check the page for script elements with gtag in the current\n// version, which means we can't use a separate gtag namespace for GA4 without\n// modifications.\n\n\nu.hasgtagjs = function (){\n  // window.gtagRename = window.gtagRename || &quot;##UTVARconfig_gtag_rename##&quot; || &quot;gtag&quot;;\n  if (u.scriptrequested) {\n    return true;\n  }\n  return false;\n};\n\nu.scriptrequested = u.hasgtagjs();\n\nu.o = window[window.gtagRename];","name":"Draft 1","creationDate":"202101221206","updateDate":"202101221236","updatedBy":"caleb.jaquith@tealium.com"}},"draftSeq":"1"},"title":"Allow multiple gtags on a page (for GA4 to have a separate one)","id":"100040"},"56":{"initialize":"","codeDevData":{"draftSeq":"1","draftSnippets":{"156e808776455eb7fb3231a67b22d1d38ab0ed941db5b8d157735eea6c9da88b":{"name":"Draft 1","code":"// Type your JavaScript code here...\n\n/*\nIs this not supported?\n#\n*/\n\n\n","updatedBy":"caleb.jaquith@tealium.com","creationDate":"202101221230","updateDate":"202101221231"}},"queueSeq":"0"},"labels":"","constructor":"","scope":"global","status":"inactive","advExecOption":"alr","title":"No Title","id":"100040","sort":"22","notes":"","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"extType":"Javascript Code","_id":"56","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"type":"new","blockPubTargetsLogic":"true"},"59":{"all":"yes","type":"new","lower_case_arrays":"true","publishedTargets":"dev","sort":"23","notes":"Added concurrently","selectedTargets":{"prod":"false","dev":"true","qa":"true"},"extType":"Lower-Casing","_id":"59","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"},"last_modified":"202102150938"},"title":"TEST Lowercase","id":"100001","initialize":"","labels":"","constructor":"","scope":"global","status":"active","advExecOption":"alr"},"62":{"advExecOption":"alr","161234263891700032_set":"dom.hash","scope":"global","constructor":"","status":"active","initialize":"","labels":"","161234263891700032_setoption":"text","id":"100003","title":"TEST caleb.jaquith","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","qa":"202102101257"}},"extType":"Set Data Values","_id":"62","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"sort":"24","notes":"concurrency test with library","publishedTargets":"dev","161234263891700032_settotext":"hashhhh","161234263891700032_settovar":"","type":"new"},"63":{"initialize":"","labels":"26,19","160637793339800522_160637795763800523_filter":"878","status":"inactive","constructor":"","scope":"20","advExecOption":"alr","160637956649700539_set":"js.fbEventType","160637793339800522_filter":"","title":"Facebook Event: Purchase M4T","id":"100003","160637793339800522_160637795763800523_source":"js.loadRulesTriggered","notes":"Facebook Custom Event, Money 4 Travel, currently paused","sort":"44","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"_id":"63","160637793339800522_source":"js.loadRulesTriggered","extType":"Set Data Values","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306"}},"160638611680800980_settotext":"","160638611680800980_settovar":"js.legacy_revenueMoney4Travel","type":"new","160638611680800980_setoption":"var","160637956649700539_settotext":"PurchaseM4T","160637793339800522_160637795763800523_filtertype":"contains","160637956649700539_setoption":"text","160637793339800522_filtertype":"populated","160638611680800980_set":"js.fbValue","160637956649700539_settovar":""},"64":{"160924728773700551_source":"dom.pathname","160638687284601045_setoption":"var","status":"active","scope":"20","advExecOption":"alr","160638717804801049_set":"js.fbCheckoutDate","160638717804801049_settotext":"","160637956649700539_settotext":"AddToCart","notes":"Add to Cart Event for TUI and FC\nEvent fires on:\nBeach - Customise Holiday\nCruise - Cabin and Board\nRiver Cruise - Cruise Options","160638703168601048_set":"js.fbCheckinDate","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160638676025501044_settovar":"js.fbContentName","160637793339800522_filter":"/destinations/book/flow/summary","160638687284601045_settovar":"js.fbContentIDs","160637956649700539_set":"js.fbEventType","161003938775400637_setoption":"var","constructor":"","160638687284601045_set":"js.fbContentIDs","labels":"26,19","160637956649700539_setoption":"text","160638701212001047_settovar":"js.legacy_departureAirportCode","160638717804801049_setoption":"var","160637956649700539_settovar":"","160638611680800980_set":"js.fbValue","_id":"64","160638687284601045_settotext":"","160924728773700551_filtertype":"contains_ignore_case","extType":"Set Data Values","160803274961100529_filtertype":"contains_ignore_case","160638701212001047_settotext":"","160638747313101050_settovar":"js.legacy_durationCode","title":"Facebook Pixel Event: AddToCart [3]","160638747313101050_set":"js.fbNumChildren","160638717804801049_settovar":"js.legacy_returnDate","161003938775400637_set":"js.fbCurrency","160638676025501044_set":"js.fbContentName","160638747313101050_setoption":"var","publishedTargets":"dev","160638611680800980_settotext":"","160638611680800980_settovar":"js.legacy_price","type":"new","160637793339800522_source":"dom.pathname","160638676025501044_setoption":"var","160638701212001047_set":"js.fbOriginAirport","161003938775400637_settovar":"js.fbCurrency","160638703168601048_settotext":"","160924728773700551_filter":"/river-cruises/book/flow/cruiseoptions","160803274961100529_source":"dom.pathname","160638699824101046_settotext":"","160638699824101046_setoption":"var","160638747313101050_settotext":"","id":"100003","160803274961100529_filter":"/cruise/book/flow/cruiseoptions","161003938775400637_settotext":"","160803298834500530_source":"dom.pathname","160803298834500530_filter":"/holiday/book/flow/summary","160638703168601048_setoption":"var","160638676025501044_settotext":"","initialize":"","160803298834500530_filtertype":"contains_ignore_case","160638703168601048_settovar":"js.legacy_departureDate_YYYYMMDD","160637793339800522_filtertype":"contains_ignore_case","160638699824101046_set":"js.fbContentType","160638611680800980_setoption":"var","160638699824101046_settovar":"js.fbContentType","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"}},"sort":"45","160638701212001047_setoption":"var"},"65":{"160638676025501044_setoption":"var","160924699367200550_filtertype":"contains_ignore_case","160637793339800522_source":"dom.pathname","160924292223600548_source":"dom.pathname","160638703168601048_settotext":"","160638701212001047_set":"js.fbOriginAirport","publishedTargets":"dev","160638747313101050_setoption":"var","type":"new","160924699367200550_source":"dom.pathname","160638611680800980_settovar":"js.legacy_price","160638611680800980_settotext":"","160638747313101050_set":"js.fbNumChildren","160638676025501044_set":"js.fbContentName","160638717804801049_settovar":"js.legacy_returnDate","160638747313101050_settovar":"js.legacy_durationCode","title":"Facebook Pixel Event: InitiateCheckout [3]","160638701212001047_settotext":"","160638699824101046_settovar":"js.fbContentType","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"},"last_modified":"202102150938"},"160924292223600548_filter":"/holiday/book/passengerdetails","160638701212001047_setoption":"var","sort":"46","160637793339800522_filtertype":"contains_ignore_case","161003940661200638_settovar":"js.fbCurrency","160638611680800980_setoption":"var","160924292223600548_filtertype":"contains_ignore_case","160638699824101046_set":"js.fbContentType","160638703168601048_settovar":"js.legacy_departureDate_YYYYMMDD","160924785247800553_filter":"/flight/book/extraoptions","initialize":"","160638676025501044_settotext":"","160638703168601048_setoption":"var","160638747313101050_settotext":"","160638699824101046_settotext":"","160638699824101046_setoption":"var","160924737710600552_source":"dom.pathname","161003940661200638_settotext":"","id":"100003","160924737710600552_filter":"/river-cruises/book/flow/flightoptions","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"160924785247800553_filtertype":"contains_ignore_case","160638703168601048_set":"js.fbCheckinDate","161003940661200638_set":"js.fbCurrency","notes":"Facebook Initiate checkout event, \nTUI UK Beach: Passenger details\nFC Beach: Passenger Details\nCruise: Flights\nRiver Cruise: Flights &amp; Extras\nFlight Only: Extras","160637956649700539_settotext":"InitiateCheckout","160924737710600552_filtertype":"contains_ignore_case","160924699367200550_filter":"/cruise/book/flow/flightoptions","advExecOption":"alr","scope":"20","status":"active","160638717804801049_set":"js.fbCheckoutDate","160638717804801049_settotext":"","160638687284601045_setoption":"var","160638687284601045_settotext":"","extType":"Set Data Values","_id":"65","160924785247800553_source":"dom.pathname","161003940661200638_setoption":"var","160637956649700539_settovar":"","160638717804801049_setoption":"var","160638611680800980_set":"js.fbValue","160638701212001047_settovar":"js.legacy_departureAirportCode","160637956649700539_setoption":"text","160638687284601045_set":"js.fbContentIDs","constructor":"","labels":"26,19","160638676025501044_settovar":"js.fbContentName","160638687284601045_settovar":"js.fbContentIDs","160637956649700539_set":"js.fbEventType","160637793339800522_filter":"/destinations/book/passengerdetails"},"66":{"160986137943500682_set":"js.fbCreditNoteDiscount","160638687284601045_setoption":"var","scope":"20","160638859921101123_set":"js.fbPromoCodeValue","status":"active","161004296259904625_set":"js.fbOrderID","advExecOption":"alr","160638717804801049_set":"js.fbContentType","160638717804801049_settotext":"","160986135411500681_settotext":"","160977132667900546_160977135530800547_filter":"","160638859921101123_settotext":"","160637956649700539_settotext":"Purchase","160638859921101123_setoption":"var","160986135411500681_settovar":"js.legacy_isCreditNoteBooking","160638872278501124_settovar":"js.legacy_numberOfPax","160977132667900546_160977135530800547_filtertype":"populated","160924035778800546_160941036351000690_filter":"","161003450894401098_161003453380901099_filtertype":"populated","160924035778800546_160941036351000690_source":"js.legacy_bookingReference","160638703168601048_set":"js.fbDeparting","161003943028800639_setoption":"var","161003450894401098_161003453380901099_filter":"","notes":"Facebook Pixel Event, Purchase, fires on confirmation page\nTUI UK - \nBeach / Accommodation Only\nCruise / River Cruise\nFlight Only\n\nFirst Choice:\nBeach / Accommodation Only\n\nTUI IE -\nPackage Confirmation\nFlight Confirmation","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"161003943028800639_set":"js.fbCurrency","160638854293801121_settotext":"","160638676025501044_settovar":"js.fbContentName","160637793339800522_filter":"/destinations/book/confirmation","160638687284601045_settovar":"js.fbContentIDs","160637956649700539_set":"js.fbEventType","160986135411500681_set":"js.fbCreditNoteBooking","160924035778800546_filtertype":"contains_ignore_case","160638872278501124_set":"js.fbNumTravelers","161003718160402952_settovar":"js.legacy_destinationName","constructor":"","160986137943500682_settotext":"","160638687284601045_set":"js.fbContentIDs","160638859921101123_settovar":"js.legacy_promoCodeValue","160977132667900546_filtertype":"regular_expression","160977149664200548_160977164302300549_source":"js.legacy_bookingReference","160638859777301122_setoption":"var","labels":"26,19","160637793339800522_160941034130000689_filtertype":"populated","160924035778800546_160941036351000690_filtertype":"populated","160637956649700539_setoption":"text","161003718160402952_set":"js.fbDestination","160638717804801049_setoption":"var","160924035778800546_source":"dom.pathname","160638611680800980_set":"js.fbValue","160637956649700539_settovar":"","160638701212001047_settovar":"js.legacy_departureAirportCode","160977132667900546_160977135530800547_source":"js.legacy_bookingReference","161003450894401098_source":"dom.pathname","160637793339800522_160941034130000689_source":"js.legacy_bookingReference","160638687284601045_settotext":"","extType":"Set Data Values","_id":"66","160638872278501124_setoption":"var","160638854293801121_set":"js.fbCheckoutDate","160977149664200548_160977164302300549_filtertype":"populated","160977149664200548_160977164302300549_filter":"","160924035778800546_filter":"/holiday/book/confirmation","161004296259904625_settovar":"js.legacy_bookingReference","title":"Facebook Pixel Event: Purchase [3]","160638701212001047_settotext":"","161004296259904625_setoption":"var","160638717804801049_settovar":"js.fbContentType","160638676025501044_set":"js.fbContentName","publishedTargets":"dev","160638852378001120_setoption":"var","160638872278501124_settotext":"","160638611680800980_settovar":"js.legacy_price","160638611680800980_settotext":"","160986137943500682_settovar":"js.legacy_creditNoteDiscount","160638854293801121_settovar":"js.legacy_returnDate","160977149664200548_source":"dom.pathname","160977132667900546_source":"dom.pathname","type":"new","160637793339800522_source":"dom.pathname","160638676025501044_setoption":"var","161004296259904625_settotext":"","160986135411500681_setoption":"var","160638701212001047_set":"js.fbOrigin","160638859777301122_set":"js.fbPromoCodeName","160638703168601048_settotext":"","160638859777301122_settovar":"js.legacy_promoCodeName","160638852378001120_settotext":"","161003450894401098_filtertype":"regular_expression","160638852378001120_set":"js.fbCheckinDate","160977149664200548_filter":"^(\\/f\\/book\\/(mobile\\/)?confirmation\\/?)$","id":"100003","160637793339800522_160941034130000689_filter":"","160638676025501044_settotext":"","160638703168601048_setoption":"var","161003943028800639_settotext":"","161003450894401098_filter":"/^(\\/(river-)?cruise(s)?\\/book\\/(mobile\\/)?confirmation\\/?)$/i","161003718160402952_settotext":"","160977132667900546_filter":"^(\\/flight\\/book\\/(mobile\\/)?confirmation\\/?)$","160638703168601048_settovar":"js.legacy_season","160638859777301122_settotext":"","initialize":"","160986137943500682_setoption":"var","160637793339800522_filtertype":"contains_ignore_case","161003943028800639_settovar":"js.fbCurrency","160977149664200548_filtertype":"regular_expression","160638611680800980_setoption":"var","160638854293801121_setoption":"var","160638852378001120_settovar":"js.legacy_departureDate_YYYYMMDD","161003450894401098_161003453380901099_source":"js.legacy_bookingReference","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306","prod":"202102101104"}},"sort":"47","161003718160402952_setoption":"var","160638701212001047_setoption":"var"},"67":{"160804318409201062_filtertype":"contains_ignore_case","id":"100003","160638852378001120_set":"js.fbCheckinDate","160638852378001120_settotext":"","160923326579200674_filter":"/river-cruises/packages","160638927467301198_set":"js.fbHaulType","initialize":"","160638676025501044_settotext":"","160638907004801125_setoption":"var","160804345498301063_filtertype":"contains_ignore_case","161295048715500724_settovar":"js.fbDestinationAirport","160804345498301063_source":"dom.pathname","160638854293801121_setoption":"var","161295048715500724_set":"js.fbDestinationAirport","160638928995701199_setoption":"var","160637793339800522_filtertype":"contains_ignore_case","160804345498301063_filter":"/holiday/packages","sort":"48","160638701212001047_setoption":"var","publish_revisions":{"svr_save_timestamps":{"prod":"202102101104","dev":"202102101306","qa":"202102101257"},"last_modified":"202102150938"},"160638907004801125_settovar":"js.legacy_durationCode","160638852378001120_settovar":"js.legacy_departureDate_YYYYMMDD","161295048715500724_settotext":"","160638927467301198_setoption":"var","title":"Facebook Pixel Event: Search [3]","160638701212001047_settotext":"","160638912673701127_settovar":"","160638676025501044_set":"js.fbContentCategory","160638912673701127_settotext":"b.legacy_epicCode.substring(1)","160638717804801049_settovar":"js.fbContentType","160638854293801121_settovar":"js.legacy_returnDate","type":"new","160638872278501124_settotext":"","160638928995701199_set":"js.fbContentName","160638928995701199_settovar":"js.fbContentName","publishedTargets":"dev","160638852378001120_setoption":"var","160638701212001047_set":"js.fbOriginAirport","160638676025501044_setoption":"var","160638912673701127_set":"js.fbDestinationIDs","160638810497801116_filter":"/cruise/packages","160637793339800522_source":"dom.pathname","160638872278501124_set":"js.fbNumAdults","160804318409201062_source":"dom.pathname","160637956649700539_set":"js.fbEventType","160638687284601045_settovar":"js.legacy_top5SearchResults","160637793339800522_filter":"/destinations/packages","160638676025501044_settovar":"js.fbContentCategory","160638854293801121_settotext":"","labels":"26,19","160638907004801125_set":"js.fbNumChildren","160638687284601045_set":"js.fbContentIDs","161295048715500724_setoption":"var","constructor":"","160923326579200674_filtertype":"contains_ignore_case","160638717804801049_setoption":"var","160637956649700539_settovar":"","160638701212001047_settovar":"js.legacy_departureAirportCode","160637956649700539_setoption":"text","160638927467301198_settovar":"js.legacy_haulTypeSearch","160638928995701199_settotext":"","160638872278501124_setoption":"var","160638854293801121_set":"js.fbCheckoutDate","extType":"Set Data Values","160638687284601045_settotext":"","_id":"67","160638687284601045_setoption":"var","160804318409201062_filter":"/flight/search","160923326579200674_source":"dom.pathname","160638717804801049_set":"js.fbContentType","160638717804801049_settotext":"","advExecOption":"alr","scope":"20","status":"active","160638907004801125_settotext":"","160638872278501124_settovar":"js.legacy_numberOfAdults","160638927467301198_settotext":"","160638912673701127_setoption":"code","160637956649700539_settotext":"Search","160638810497801116_source":"dom.pathname","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"notes":"Facebook Search Event for TUI and FC","160638810497801116_filtertype":"contains_ignore_case"},"68":{"160923664510500540_filter":"/holiday/bookaccommodation","160638701212001047_setoption":"var","sort":"49","160638907004801125_settovar":"js.legacy_durationCode","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"}},"160638852378001120_settovar":"js.legacy_departureDate_YYYYMMDD","160638854293801121_setoption":"var","160923677519000541_filter":"/flight/book/flightoptions","160637793339800522_filtertype":"contains_ignore_case","160638928995701199_setoption":"var","160923691836100542_source":"dom.pathname","initialize":"","160923691836100542_filter":"/cruise/bookitineraries","160638907004801125_setoption":"var","160638676025501044_settotext":"","id":"100003","160638852378001120_set":"js.fbCheckinDate","160638852378001120_settotext":"","160638701212001047_set":"js.fbOriginAirport","160638676025501044_setoption":"var","160637793339800522_source":"dom.pathname","type":"new","160638854293801121_settovar":"js.legacy_returnDate","160638928995701199_settovar":"js.fbContentIDs","160638928995701199_set":"js.fbContentIDs","160638852378001120_setoption":"var","publishedTargets":"dev","160638676025501044_set":"js.fbValue","160638717804801049_settovar":"js.fbContentType","160923677519000541_filtertype":"contains_ignore_case","160638701212001047_settotext":"","title":"Facebook Pixel Event: ViewContent [3]","160923677519000541_source":"dom.pathname","160638928995701199_settotext":"","160638854293801121_set":"js.fbCheckoutDate","_id":"68","extType":"Set Data Values","160638687284601045_settotext":"","160638701212001047_settovar":"js.legacy_departureAirportCode","160638717804801049_setoption":"var","160637956649700539_settovar":"","160637956649700539_setoption":"text","labels":"26,19","160638907004801125_set":"js.fbNumChildren","160638687284601045_set":"js.fbContentName","constructor":"","160637793339800522_filter":"/destinations/bookaccommodation","160923741029000543_filtertype":"contains_ignore_case","160638687284601045_settovar":"js.fbContentName","160637956649700539_set":"js.fbEventType","161003936735100636_set":"js.fbCurrency","160638676025501044_settovar":"js.legacy_price","160638854293801121_settotext":"","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"notes":"Facebook Pixel Event for ViewContent\nTUI UK Package: Hotel Details\nFC Package: Hotel Details\nTUI Cruise: Itinerary and Ship\nTUI River Cruise: Itinerary\nFlight Only: Seats and Luggage","161003936735100636_settotext":"","160923691836100542_filtertype":"contains_ignore_case","161003936735100636_settovar":"js.fbCurrency","161003936735100636_setoption":"var","160637956649700539_settotext":"ViewContent","160638717804801049_set":"js.fbContentType","160638717804801049_settotext":"","160923741029000543_filter":"/river-cruises/bookitineraries","advExecOption":"alr","status":"active","160638907004801125_settotext":"","scope":"20","160923664510500540_filtertype":"contains_ignore_case","160638687284601045_setoption":"var","160923664510500540_source":"dom.pathname","160923741029000543_source":"dom.pathname"},"69":{"type":"new","160637956649700539_settotext":"Accommodation Only","160637793339800522_160637795763800523_filtertype":"equals_ignore_case","160637956649700539_setoption":"text","160637793339800522_filtertype":"populated","160637956649700539_settovar":"","publishedTargets":"dev","notes":"Changes content_name to Accommodation Only, must be set to load after content_name within [2] group","sort":"50","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160637793339800522_source":"js.legacy_isAccommodationOnly","_id":"69","extType":"Set Data Values","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"prod":"202102101104","dev":"202102101306","qa":"202102101257"}},"title":"Facebook Pixel: Accomodation Only content_name [2]","160637793339800522_filter":"","160637956649700539_set":"js.fbContentName","id":"100003","160637793339800522_160637795763800523_source":"js.legacy_isAccommodationOnly","labels":"26,19","160637793339800522_160637795763800523_filter":"Yes","initialize":"","status":"active","scope":"20","constructor":"","advExecOption":"alr"},"70":{"title":"Facebook Pixel Event: ViewContent Destinations [3]","160941502439000705_filtertype":"equals_ignore_case","160941502439000705_160941512647900706_filtertype":"contains_ignore_case","scope":"20","status":"active","advExecOption":"alr","type":"new","160637793339800522_160637795763800523_filtertype":"contains_ignore_case","160639011589501272_setoption":"text","160637956649700539_settotext":"ViewContent","publishedTargets":"dev","notes":"Facebook ViewContent Event for Destination Page on TUI UK and Firstchoice","selectedTargets":{"prod":"true","dev":"true","qa":"true"},"160637793339800522_source":"js.legacy_brand","160637793339800522_filter":"tui","160637956649700539_set":"js.fbEventType","160941502439000705_filter":"firstchoice","160941502439000705_160941512647900706_filter":"/holiday/destinations","id":"100003","160637793339800522_160637795763800523_source":"dom.pathname","160941502439000705_160941512647900706_source":"dom.pathname","160637793339800522_160637795763800523_filter":"/destinations/holiday-destinations","initialize":"","labels":"26,19","constructor":"","160637956649700539_setoption":"text","160639011589501272_settovar":"","160637956649700539_settovar":"","160637793339800522_filtertype":"equals_ignore_case","sort":"51","160639011589501272_settotext":"Destination","160941502439000705_source":"js.legacy_brand","extType":"Set Data Values","_id":"70","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","prod":"202102101104","qa":"202102101257"}},"160639011589501272_set":"js.fbContentType"},"71":{"type":"new","publishedTargets":"dev","160637956649700539_settotext":"AddToWishlist","160637793339800522_160637795763800523_filtertype":"contains_ignore_case","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"notes":"AddtoWishlist event for TUI and FC, variables are currently in development","160976481167901090_source":"js.legacy_brand","160637793339800522_source":"js.legacy_brand","160976481167901090_filtertype":"equals_ignore_case","title":"Facebook Pixel Event: AddToWishlist [3]","160976481167901090_160976482344801091_source":"dom.pathname","advExecOption":"alr","160976481167901090_160976482344801091_filtertype":"contains_ignore_case","scope":"20","status":"active","160637956649700539_settovar":"","160637793339800522_filtertype":"equals_ignore_case","160976481167901090_filter":"firstchoice","160637956649700539_setoption":"text","sort":"52","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"prod":"202102101104","dev":"202102101306","qa":"202102101257"}},"extType":"Set Data Values","_id":"71","id":"100003","160637956649700539_set":"js.fbEventType","160637793339800522_filter":"tui","160637793339800522_160637795763800523_source":"dom.pathname","initialize":"","labels":"26,19","160637793339800522_160637795763800523_filter":"/destinations/myshortlist","160976481167901090_160976482344801091_filter":"/holiday/myshortlist","constructor":""},"72":{"160639659294601581_settovar":"","160639668428101586_settovar":"","160639666866701585_settotext":"[]","160639666866701585_set":"_cprod","labels":"26,19","initialize":"","constructor":"","160639669654601587_settotext":"[]","161001307033801371_setoption":"text","id":"100003","160639659294601581_set":"_cbrand","160639669654601587_setoption":"code","160639654477001580_settotext":"[]","160639669654601587_set":"_cquan","160639659294601581_setoption":"code","sort":"53","extType":"Set Data Values","160639660739901582_settotext":"[]","_id":"72","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","prod":"202102101104","qa":"202102101257"},"last_modified":"202102150938"},"160639660739901582_settovar":"","160639661744501583_settovar":"","160639660739901582_setoption":"code","161001307033801371_settotext":"1","160639668428101586_setoption":"code","scope":"20","status":"active","160639654477001580_set":"_ccurrency","160639666866701585_setoption":"code","160639668428101586_settotext":"[]","advExecOption":"alr","title":"Facebook - Disable most Ecommerce fields [2]","160639661744501583_setoption":"code","161001307033801371_set":"js.fbNumItems","160639661744501583_set":"_ccat2","160639669654601587_settovar":"","160639671932401588_settotext":"[]","160639671932401588_settovar":"","160639654477001580_setoption":"code","notes":"The FB pixel is trying to be helpful, but it's sending extra information and we want to migrate 1:1 for now.","160639666866701585_settovar":"","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160639654477001580_settovar":"","160639671932401588_set":"_cprice","160639660739901582_set":"_ccat","160639661744501583_settotext":"[]","161001307033801371_settovar":"","type":"new","160639659294601581_settotext":"[]","160639671932401588_setoption":"code","160639668428101586_set":"_cprodname","publishedTargets":"dev"},"73":{"constructor":"","varlookup":"js.legacy_siteSection","disable_default_logic":"no","labels":"26,19","initialize":"","160803922617300531_source":"js.fbPixelID","160803933057100532_name":"TUI UK Cruise","160803938375200534_comment":"TUI UK Flight Only","160803933057100532_value":"Cruise","id":"100020","160803921853900530_comment":"FC Package","160803938375200534_name":"TUI UK Flight-Only","160803921853900530_name":"FC Beach","160803933057100532_comment":"TUI UK Cruise","160803922617300531_filter":"","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306","prod":"202102101104"}},"extType":"Lookup Table","160803909925900529_comment":"TUI UK Package","_id":"73","160803935821200533_comment":"TUI UK River Cruise","sort":"54","vartype":"string","160803935821200533_name":"TUI UK River Cruise","advExecOption":"alr","scope":"20","160803921853900530_value":"Package","status":"active","160803938375200534_value":"Flight Only","160803922617300531_filtertype":"populated","160803909925900529_name":"TUI UK Beach","var":"js.fbContentName","settotext":"&quot;&quot;","160803909925900529_value":"Package","title":"Facebook Pixel: content_name [2]","160803935821200533_value":"River Cruise","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"notes":"Facebook Pixel component","publishedTargets":"dev","type":"new","filtertype":"equals"},"74":{"160803921853900530_comment":"FC Package","160803938375200534_name":"TUI UK Flight-Only","160803921853900530_name":"FC Beach","id":"100020","160803938375200534_comment":"TUI UK Flight Only","disable_default_logic":"no","varlookup":"js.legacy_siteSection","160803922617300531_source":"js.fbPixelID","initialize":"","labels":"26,19","constructor":"","sort":"55","vartype":"string","extType":"Lookup Table","160803909925900529_comment":"TUI UK Package","_id":"74","160803922617300531_filter":"","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","prod":"202102101104","qa":"202102101257"},"last_modified":"202102150938"},"title":"Facebook Pixel: content_type [2]","160803909925900529_value":"hotel","settotext":"&quot;&quot;","var":"js.fbContentType","160803909925900529_name":"TUI UK Beach","scope":"20","160803938375200534_value":"flight","160803921853900530_value":"hotel","status":"active","160803922617300531_filtertype":"populated","advExecOption":"alr","filtertype":"equals","type":"new","publishedTargets":"dev","notes":"Component of Facebook Pixel, required for Catalogue Feed","selectedTargets":{"qa":"true","prod":"true","dev":"true"}},"75":{"scope":"20","status":"active","160804573644701066_160975887836200546_filter":"FC Beach","advExecOption":"alr","160804541456801064_set":"js.fbContentCategory","160804573644701066_filtertype":"populated","160804556505601065_filtertype":"populated","title":"Facebook Pixel: content_category [2]","160804556505601065_160975881535900545_filtertype":"contains_ignore_case","160804556505601065_source":"js.fbPixelID","notes":"Facebook Pixel components,  sets ContentCategory to fire on TUI and FC package\nreturns: couple, family or group","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"160804541456801064_setoption":"code","publishedTargets":"dev","160804573644701066_source":"js.fbPixelID","type":"new","constructor":"","160804573644701066_160975887836200546_source":"js.legacy_siteSection","labels":"26,19","initialize":"","id":"100003","160804573644701066_160975887836200546_filtertype":"contains_ignore_case","extType":"Set Data Values","160804556505601065_filter":"TUI UK Beach","_id":"75","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","dev":"202102101306","prod":"202102101104"},"last_modified":"202102150938"},"160804573644701066_filter":"FC Beach","sort":"56","160804556505601065_160975881535900545_source":"js.legacy_siteSection","160804541456801064_settovar":"","160804541456801064_settotext":"(function() {   var partyType = (function() {     if ( b.legacy_numberOfAdults == 2 &amp;&amp; b.legacy_numberOfChildren + b.legacy_numberOfInfants == 0) {       return 'couple'     } else if ( b.legacy_numberOfChildren + b.legacy_numberOfInfants &gt; 0) {       return 'family'     } else if ( b.legacy_numberOfAdults &gt; 2 &amp;&amp; b.legacy_numberOfChildren + b.legacy_numberOfInfants == 0) {       return 'group'     } else {       return ''     }   })();   return b.legacy_season +'|' + partyType; })()","160804556505601065_160975881535900545_filter":"TUI UK Beach"},"76":{"sort":"57","publish_revisions":{"svr_save_timestamps":{"dev":"202102101306","prod":"202102101104","qa":"202102101257"},"last_modified":"202102150938"},"160804573644701066_filter":"FC Beach","extType":"Set Data Values","_id":"76","160804556505601065_filter":"TUI UK Beach","160804556505601065_160923866230200544_source":"js.legacy_siteSection","160804573644701066_160923870000300545_filter":"FC Beach","160804541456801064_settotext":"b.legacy_epicCode.substring(1) + ',' + b.legacy_departureAirportCode + '|' + b.legacy_epicCode.substring(1)","160804541456801064_settovar":"","labels":"26,19","initialize":"","constructor":"","id":"100003","selectedTargets":{"dev":"true","prod":"true","qa":"true"},"notes":"Facebook Pixel components,  sets ContentIDs to fire on TUI and FC package","type":"new","160804573644701066_source":"js.fbPixelID","publishedTargets":"dev","160804573644701066_160923870000300545_source":"js.legacy_siteSection","160804541456801064_setoption":"code","160804573644701066_filtertype":"populated","160804541456801064_set":"js.fbContentIDs","160804556505601065_160923866230200544_filtertype":"equals_ignore_case","advExecOption":"alr","scope":"20","status":"active","160804556505601065_source":"js.fbPixelID","title":"Facebook Pixel: contentIDs [2]","160804556505601065_160923866230200544_filter":"TUI UK Beach","160804573644701066_160923870000300545_filtertype":"equals_ignore_case","160804556505601065_filtertype":"populated"},"77":{"160803909925900529_name":"tui ie","var":"js.fbCurrency","varlookup":"js.legacy_brand","disable_default_logic":"no","160803922617300531_source":"js.fbPixelID","labels":"26,19","initialize":"","constructor":"","scope":"20","160803922617300531_filtertype":"populated","status":"active","advExecOption":"alr","title":"Facebook Pixel: fbCurrency [2]","160803909925900529_value":"EUR","id":"100020","settotext":"GBP","sort":"58","vartype":"string","notes":"Facebook Pixel component","selectedTargets":{"qa":"true","dev":"true","prod":"true"},"160803909925900529_comment":"EUR for Ireland","extType":"Lookup Table","_id":"77","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"qa":"202102101257","dev":"202102101306","prod":"202102101104"}},"160803922617300531_filter":"","filtertype":"equals","type":"new","publishedTargets":"dev"},"78":{"161235454526300572_161235455857500573_filter":"TUI UK River Cruise","publishedTargets":"dev","type":"new","161235454526300572_filtertype":"populated","notes":"Changes format for promo code to come back empty if it equals &quot;null&quot;","161235448111200570_filtertype":"populated","160923160011600672_set":"js.legacy_returnDate","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"161235448111200570_source":"js.legacy_siteSection","title":"Format: returnDate of null to &quot;&quot; for Cruise","scope":"20","status":"active","161235448111200570_161235451751400571_filter":"TUI UK Cruise","advExecOption":"alr","161235448111200570_161235451751400571_filtertype":"contains","161235454526300572_161235455857500573_source":"js.legacy_siteSection","161235448111200570_filter":"","extType":"Set Data Values","_id":"78","publish_revisions":{"last_modified":"202102150938","svr_save_timestamps":{"dev":"202102101306","prod":"202102101104","qa":"202102101257"}},"161235454526300572_161235455857500573_filtertype":"contains","160923160011600672_settovar":"","sort":"59","160923160011600672_setoption":"text","161235454526300572_source":"js.legacy_siteSection","161235454526300572_filter":"","161235448111200570_161235451751400571_source":"js.legacy_siteSection","id":"100003","constructor":"","160923160011600672_settotext":"&quot;&quot;","initialize":"","labels":"19"},"79":{"161294817695000578_settotext":"[]","161294816492300577_setoption":"code","161294480529004188_set":"js.fbReturningDepartureDate","161294613613600578_filter":"TUI UK Flight-Only","constructor":"","161294613613600578_161294614917400579_source":"js.fbEventType","161295441280100577_settotext":"[]","labels":"26,19","initialize":"","161295227397200726_set":"js.fbDestinationAirport","161294617115000580_filtertype":"equals_ignore_case","161294816492300577_set":"js.fbCheckinDate","161295227397200726_settotext":"","id":"100003","160637793339800522_filter":"TUI UK Flight-Only","160637956649700539_set":"js.fbDepartingDepartureDate","publish_revisions":{"svr_save_timestamps":{"qa":"202102101257","prod":"202102101104","dev":"202102101306"},"last_modified":"202102150938"},"161294617115000580_161294618483600581_filtertype":"equals_ignore_case","161294617115000580_source":"js.legacy_siteSection","_id":"79","extType":"Set Data Values","161294617115000580_161294618483600581_filter":"InitiateCheckout","160637793339800522_161294608791000577_filtertype":"equals_ignore_case","sort":"60","160637793339800522_filtertype":"equals_ignore_case","160637956649700539_settovar":"js.legacy_departureDate_YYYYMMDD","161294480529004188_settotext":"","160637956649700539_setoption":"var","161294816492300577_settotext":"[]","161294816492300577_settovar":"","161294613613600578_161294614917400579_filtertype":"equals_ignore_case","advExecOption":"alr","status":"active","scope":"20","161294480529004188_settovar":"js.legacy_returnDate","161295227397200726_setoption":"var","161294817695000578_setoption":"code","161294617115000580_filter":"TUI UK Flight-Only","160637793339800522_161294608791000577_filter":"Search","161294617115000580_161294618483600581_source":"js.fbEventType","161294613613600578_161294614917400579_filter":"ViewContent","161295441280100577_setoption":"code","161294613613600578_source":"js.legacy_siteSection","title":"Facebook Pixel: Flight Only specific parameters [4]","160637793339800522_source":"js.legacy_siteSection","161295441280100577_set":"js.fbDestinationIDs","selectedTargets":{"qa":"true","prod":"true","dev":"true"},"161294817695000578_set":"js.fbCheckoutDate","161294480529004188_setoption":"var","notes":"Parameters required for FO dynamic search ads, replaces check in and chekout dates","161294817695000578_settovar":"","publishedTargets":"dev","160637956649700539_settotext":"","161295441280100577_settovar":"","type":"new","160637793339800522_161294608791000577_source":"js.fbEventType","161295227397200726_settovar":"js.legacy_epicCode","161294613613600578_filtertype":"equals_ignore_case"}},"publish":{"readywait":"","lock_profile":"","disable_custom_version_name":"","distro_zip":"","forcetimeout":"","publish_notify":"","alert_notify":"","basevariable":"","bundle_all":"","enable_purge_sub":"","revision":"202101131238","s2id_autogen1776":"","s2id_autogen1776_search":"","sessiontimeout":"","domain":"","smartFTP":{"qa":"preMCDN","prod":"preMCDN","dev":"preMCDN"},"enable_sync_loader":"","publish_prod":"","publish_qa":"","enable_workflow":"","enable_custom_targets":"","noload":"","data_object":"","minify":"","audienceStream_profile":"","webcompanion":"","disable_save_on_old_version":"","enable_utf8_encoding":"yes","publish_dev":""},"lastmanageid":"22","test":{},"revision":"202102150938","importable_library":"NONE","account":"services-caleb","lastcustomizeid":"0","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"22\" , \"tag_name\" : \"Adform\" , \"library\" : \"\" , \"name\" : \"Adform\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161338193102300050\" , \"tab_name\" : \"manage\"}}]","profile_action_type":"SaveAs","linkedProfiles":"{ }","label_relationships":null,"profile":"tui-uk-staging","publish_history":{"202101191648":{"status":"Not Published","202101191648":{"operator":"caleb.jaquith@tealium.com","lastmanageid":"8","action":"Save profile","notes":"Update for template","versionorigin":"202101191645","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"8\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"library\" : \"\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161107486797900074\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Fixed\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107282396700007\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"2\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107282396600006\" , \"tab_name\" : \"manage\"}}]"},"title":"Version 2021.01.19.1648"},"202101221307":{"status":"Not Published","size":"1,373","202101221307":{"publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"17","action":"Published to dev","publishedConsent":"[ ]","notes":"Names to default","versionorigin":"202101221305","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"10\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GUA - TUI UK\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161131576255800022\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GA4 - Google Analytics (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161132021345800034\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","title":"Version 2021.01.22.1307"},"title":"Version 2021.01.22.1307"},"202101211542":{"202101211542":{"action":"Save profile","notes":"Save for template","versionorigin":"202101201149","operator":"caleb.jaquith@tealium.com","lastmanageid":"9","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"9\" , \"tag_name\" : \"Tealium Custom Container\" , \"library\" : \"\" , \"name\" : \"Tealium Custom Container\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161124370765701145\" , \"tab_name\" : \"manage\"}}]","linkedProfiles":"{ }"},"status":"Not Published","title":"Version 2021.01.21.1541"},"202101191417":{"202101191417":{"datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161106436139300098\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1417","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","action":"Published to dev","publishedConsent":"[ ]","versionorigin":"202101191406","notes":"Doublecheck fix","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\"]","status":"qa,dev","lastmanageid":"6"},"size":"455","status":"Not Published","title":"Version 2021.01.19.1417"},"202101191550":{"title":"Version 2021.01.19.1549","size":"455","status":"Not Published","202101191550":{"action":"Published to dev","publishedConsent":"[ ]","versionorigin":"202101191521","notes":"Remove cookieDomainPeriods","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\"]","lastmanageid":"6","status":"qa,dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.19.1549","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161107071333600183\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"}},"202102030858":{"title":"Version 2021.02.03.0857","202102030858":{"datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","history":"[ { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"62\" , \"name\" : \"No Title\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_62\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.02.03.0857","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"57\" , \"58\" , \"59\" , \"62\"]","linkedProfiles":"{ \"lib-test2\" : { \"rev\" : \"202102030842\" , \"env\" : \"QA\"}}","action":"Published to dev","publishedConsent":"[ ]","notes":"Update concurrently with a library\n","versionorigin":"202102030850","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"19\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"19","status":"dev"},"size":"1,393","status":"Not Published"},"202101191259":{"title":"Version 2021.01.19.1258","size":"333","status":"Not Published","202101191259":{"publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"6","status":"qa,dev","action":"Published to dev","publishedConsent":"[ ]","versionorigin":"202101191248","notes":"Update","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161106026601600007\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"removed_tag\" , \"data\" : { \"id\" : \"6\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Fixed\" , \"library\" : \"\" , \"kind\" : \"Tag\" , \"operation\" : \"removed\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"toggled_extension\" , \"data\" : { \"id\" : \"18\" , \"name\" : \"Add some test events\" , \"type\" : \"100040\" , \"status\" : \"inactive\" , \"kind\" : \"Extension\" , \"operation\" : \"toggled\" , \"container\" : \"customizations_18\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"status\" : \"active\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"17\" , \"name\" : \"Fire u.addEvent as needed for specific events\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_17\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.19.1258","lastcustomizeid":"0"}},"202102030850":{"status":"Not Published","202102030850":{"linkedProfiles":"{ \"lib-test2\" : { \"rev\" : \"202102030842\" , \"env\" : \"QA\"}}","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"57\" , \"58\" , \"59\"]","history":"[ { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"59\" , \"name\" : \"No Title\" , \"type\" : \"100001\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_59\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.02.03.0849","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","status":"dev","lastmanageid":"19","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"19\"]","versionorigin":"202102030846","publishedConsent":"[ ]","notes":"Add lowercasing extension","action":"Published to dev"},"size":"1,392","title":"Version 2021.02.03.0849"},"202101201107":{"title":"Version 2021.01.20.1107","status":"Not Published","size":"587","202101201107":{"status":"dev","lastmanageid":"8","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","notes":"Save progress\n","versionorigin":"202101200916","publishedConsent":"[ ]","action":"Published to dev","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"Adobe Analytics - s.events JS logic\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.20.1107","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"}},"202102150939":{"title":"Version 2021.02.15.0938","202102150939":{"lastmanageid":"22","operator":"caleb.jaquith@tealium.com","versionorigin":"202102150938","notes":"Save for adform template","action":"Save profile","linkedProfiles":"{ }","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"22\" , \"tag_name\" : \"Adform\" , \"library\" : \"\" , \"name\" : \"Adform\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161338193102300050\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"status":"Not Published"},"202101191645":{"title":"Version 2021.01.19.1644","202101191645":{"status":"qa,dev","lastmanageid":"7","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\"]","operator":"caleb.jaquith@tealium.com","publishedConsent":"[ ]","versionorigin":"202101191632","notes":"Add latest marketplace tag","action":"Published to dev","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"7\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"library\" : \"\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161107437639200014\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : 4 , \"name\" : \"Adobe Marketplace Tag - Copy\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161107453328400047\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"17\" , \"name\" : \"Fire u.addEvent as needed for specific events\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_17\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.19.1644","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"size":"577","status":"Not Published"},"202101191248":{"size":"333","status":"Not Published","title":"Version 2021.01.19.1248","202101191248":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161106026601600007\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1248","publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"6","status":"dev","action":"Published to dev","versionorigin":"202101191237","notes":"Update template ","publishedConsent":"[ ]"}},"202101201110":{"title":"Version 2021.01.20.1110","status":"Not Published","size":"587","202101201110":{"notes":"Update","publishedConsent":"[ ]","versionorigin":"202101201107","action":"Published to dev","lastmanageid":"8","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"Adobe Analytics - s.events JS logic\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.01.20.1110","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","linkedProfiles":"{ }"}},"202101191312":{"status":"Not Published","size":"333","202101191312":{"linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"2\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161106026601500006\" , \"tab_name\" : \"Template\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"2\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161106026601500006\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161106026601600007\" , \"tab_name\" : \"Template\"}}]","title":"Version 2021.01.19.1312","publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"6","status":"dev","action":"Published to dev","versionorigin":"202101191259","publishedConsent":"[ ]","notes":"Remove cookieDomainPeriods as experiment"},"title":"Version 2021.01.19.1312"},"202101221305":{"title":"Version 2021.01.22.1304","size":"1,373","status":"Not Published","202101221305":{"linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GA4 - Google Analytics (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161132021345800034\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","title":"Version 2021.01.22.1304","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\"]","lastmanageid":"17","status":"dev","action":"Published to dev","versionorigin":"202101221302","notes":"Update names","publishedConsent":"[ ]"}},"202101211605":{"title":"Version 2021.01.21.1605","202101211605":{"lastmanageid":"9","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"9\"]","publishedConsent":"[ ]","notes":"Update template","versionorigin":"202101211558","action":"Published to dev","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","title":"Version 2021.01.21.1605","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"9\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"GA4\" , \"tag_name\" : \"Tealium Custom Container\" , \"container\" : \"manage_content_161124370765701145\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"size":"596","status":"Not Published"},"202101200916":{"title":"Version 2021.01.20.0916","202101200916":{"history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"No Title\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.01.20.0916","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","versionorigin":"202101191702","notes":"Update s.events quickly","publishedConsent":"[ ]","action":"Published to dev","lastmanageid":"8","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]"},"size":"604","status":"Not Published"},"202102030846":{"status":"Not Published","size":"1,392","title":"Version 2021.02.03.0846","202102030846":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"57\" , \"58\"]","linkedProfiles":"{ \"lib-test2\" : { \"rev\" : \"202102030842\" , \"env\" : \"QA\"}}","lastcustomizeid":"0","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"19\" , \"tag_name\" : \"Google Analytics 4 (gtag.js) (BETA)\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"name\" : \"Google Analytics 4 (gtag.js) (BETA)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161234187075900059\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"57\" , \"name\" : \"OPT OUT lib2\" , \"type\" : \"100022\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_57\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"58\" , \"name\" : \"DNT lib2\" , \"type\" : \"100034\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_58\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.02.03.0846","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","status":"qa,dev","lastmanageid":"17","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"19\"]","operator":"caleb.jaquith@tealium.com","notes":"Update from library","publishedConsent":"[ ]","versionorigin":"202101221355","action":"Published to dev"}},"202101191111":{"title":"Initial publish","status":"Not Published","202101191111":{"history":"","lastcustomizeid":"","title":"Initial publish","datacloudLinkedProfiles":"{}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"18\" , \"21\" , \"23\"]","notes":"Initial publish on profile creation","publishedConsent":"","versionorigin":"","action":"Published to dev","status":"prod,qa,dev","lastmanageid":"","publishedTags":"[ \"3\" , \"5\" , \"6\"]","operator":"caleb.jaquith@tealium.com"},"size":"468"},"202102101257":{"202102101257":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"59\" , \"62\" , \"64\" , \"65\" , \"66\" , \"67\" , \"68\" , \"69\" , \"70\" , \"71\" , \"72\" , \"73\" , \"74\" , \"75\" , \"76\" , \"77\" , \"78\" , \"79\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","title":"Version 2021.02.10.1257","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"20\" , \"tag_name\" : \"Facebook Pixel\" , \"name\" : \"Facebook Pixel\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161296140131601183\" , \"tab_name\" : \"manage\"}}]","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"20\"]","operator":"caleb.jaquith@tealium.com","status":"qa,dev","lastmanageid":"20","action":"Published to dev","notes":"Update pixel id","versionorigin":"202102101237","publishedConsent":"[ ]"},"status":"qa,dev","size":"1,419","title":"Version 2021.02.10.1257"},"202101191118":{"size":"339","202101191118":{"operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"3\" , \"5\"]","lastmanageid":"6","status":"dev","action":"Published to dev","notes":"Update","publishedConsent":"[ ]","versionorigin":"202101191115","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"toggled_extension\" , \"data\" : { \"id\" : \"21\" , \"name\" : \"Intermediate mappings to test \" , \"type\" : \"100003\" , \"status\" : \"inactive\" , \"kind\" : \"Extension\" , \"operation\" : \"toggled\" , \"container\" : \"customizations_21\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"6\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Fixed\" , \"status\" : \"inactive\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161105476128700590\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.01.19.1118","lastcustomizeid":"0"},"status":"Not Published","title":"Version 2021.01.19.1118"},"202101191113":{"title":"Version 2021.01.19.1113","status":"Not Published","size":"468","202101191113":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"21\" , \"23\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"toggled_extension\" , \"data\" : { \"id\" : \"18\" , \"name\" : \"Add some test events\" , \"type\" : \"100040\" , \"status\" : \"inactive\" , \"kind\" : \"Extension\" , \"operation\" : \"toggled\" , \"container\" : \"customizations_18\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1113","publishedTags":"[ \"3\" , \"5\" , \"6\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"6","action":"Published to dev","versionorigin":"202101191111","publishedConsent":"[ ]","notes":"Update"}},"202101191210":{"status":"Not Published","size":"333","202101191210":{"operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"3\" , \"5\"]","status":"dev","lastmanageid":"6","action":"Published to dev","versionorigin":"202101191147","publishedConsent":"[ ]","notes":"Update to make cleaner","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1209"},"title":"Version 2021.01.19.1209"},"202101220955":{"title":"Version 2021.01.22.0954","status":"Not Published","202101220955":{"lastmanageid":"9","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"9\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\"]","publishedConsent":"[ ]","notes":"Copy gtag related from tui-uk to work on GA4","versionorigin":"202101211605","action":"Published to dev","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]","lastcustomizeid":"0","title":"Version 2021.01.22.0954","history":"[ { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"311\" , \"name\" : \"legacy_abtaNumber\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"312\" , \"name\" : \"legacy_abTest\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"313\" , \"name\" : \"legacy_adobeCookieDomainPeriods\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"314\" , \"name\" : \"legacy_adobeDownloadFileTypes\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"315\" , \"name\" : \"legacy_adobeLinkInternalFilters\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"316\" , \"name\" : \"legacy_adobeMarketingCloudVisitorID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"317\" , \"name\" : \"legacy_adobeProductString\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"318\" , \"name\" : \"legacy_adobeProductStringLYP\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"319\" , \"name\" : \"legacy_adobeReportSuite\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"320\" , \"name\" : \"legacy_agentID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"321\" , \"name\" : \"legacy_airportExtras\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"322\" , \"name\" : \"legacy_alternativeFlightOptions\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"323\" , \"name\" : \"legacy_appVisitor\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"324\" , \"name\" : \"legacy_arrivalAirportCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"325\" , \"name\" : \"legacy_arrivalAirportName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"326\" , \"name\" : \"legacy_boardBasisCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"327\" , \"name\" : \"legacy_boardBasisName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"328\" , \"name\" : \"legacy_bookingDate_YYYY_MM_DD\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"329\" , \"name\" : \"legacy_bookingOrMmbIncentiveCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"330\" , \"name\" : \"legacy_bookingReference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"331\" , \"name\" : \"legacy_bookingReferenceMoney4Travel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"332\" , \"name\" : \"legacy_brand\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"333\" , \"name\" : \"legacy_campaign\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"334\" , \"name\" : \"legacy_campaignSource\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"335\" , \"name\" : \"legacy_cancelReason\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"336\" , \"name\" : \"legacy_carrierCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"337\" , \"name\" : \"legacy_carrierInbound\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"338\" , \"name\" : \"legacy_carrierOutbound\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"339\" , \"name\" : \"legacy_Channel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"340\" , \"name\" : \"legacy_childAges\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"341\" , \"name\" : \"legacy_commercialSortPriority\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"342\" , \"name\" : \"legacy_commercialValueScore\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"343\" , \"name\" : \"legacy_commercialValueScoreType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"344\" , \"name\" : \"legacy_componentClicked\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"345\" , \"name\" : \"legacy_content_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"346\" , \"name\" : \"legacy_continentCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"347\" , \"name\" : \"legacy_continentName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"348\" , \"name\" : \"legacy_cookieLength\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"349\" , \"name\" : \"legacy_countryCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"350\" , \"name\" : \"legacy_countryName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"351\" , \"name\" : \"legacy_coupon\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"352\" , \"name\" : \"legacy_creditNoteBooking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"353\" , \"name\" : \"legacy_creditNoteCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"354\" , \"name\" : \"legacy_creditNoteDiscount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"355\" , \"name\" : \"legacy_creditNoteOriginalBookingID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"356\" , \"name\" : \"legacy_creditNoteRefundValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"357\" , \"name\" : \"legacy_creditNoteTotalValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"358\" , \"name\" : \"legacy_cruiseCabinType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"359\" , \"name\" : \"legacy_cruiseEpicCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"360\" , \"name\" : \"legacy_cruiseHotel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"361\" , \"name\" : \"legacy_cruiseShip\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"362\" , \"name\" : \"legacy_cruiseStay\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"363\" , \"name\" : \"legacy_cruiseStayDuration\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"364\" , \"name\" : \"legacy_cruiseStayRoomType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"365\" , \"name\" : \"legacy_cruiseType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"366\" , \"name\" : \"legacy_Crystal_Affiliate_Order_Detail\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"367\" , \"name\" : \"legacy_Crystal_BkngStep\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"368\" , \"name\" : \"legacy_Crystal_bookingDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"369\" , \"name\" : \"legacy_Crystal_bookingPace\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"370\" , \"name\" : \"legacy_Crystal_BookingRef\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"371\" , \"name\" : \"legacy_Crystal_boughtAdults\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"372\" , \"name\" : \"legacy_Crystal_boughtCategory4\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"373\" , \"name\" : \"legacy_Crystal_boughtChildren\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"374\" , \"name\" : \"legacy_Crystal_boughtCountry\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"375\" , \"name\" : \"legacy_Crystal_boughtPax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"376\" , \"name\" : \"legacy_Crystal_boughtPeriod\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"377\" , \"name\" : \"legacy_Crystal_boughtPrice\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"378\" , \"name\" : \"legacy_Crystal_boughtResort\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"379\" , \"name\" : \"legacy_Crystal_cjevent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"380\" , \"name\" : \"legacy_Crystal_currentArrivalAirport\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"381\" , \"name\" : \"legacy_Crystal_currentCountry\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"382\" , \"name\" : \"legacy_Crystal_currentDepartureAirportArray\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"383\" , \"name\" : \"legacy_Crystal_currentDepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"384\" , \"name\" : \"legacy_Crystal_currentDuration\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"385\" , \"name\" : \"legacy_Crystal_currentHotelId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"386\" , \"name\" : \"legacy_Crystal_currentPartyType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"387\" , \"name\" : \"legacy_Crystal_currentPax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"388\" , \"name\" : \"legacy_Crystal_currentPax_inc_infants\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"389\" , \"name\" : \"legacy_Crystal_currentResort\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"390\" , \"name\" : \"legacy_Crystal_currentRoute\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"391\" , \"name\" : \"legacy_Crystal_departureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"392\" , \"name\" : \"legacy_Crystal_DL_Ready\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"393\" , \"name\" : \"legacy_Crystal_Hit_Timestamp\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"394\" , \"name\" : \"legacy_Crystal_Internal_Campaign\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"395\" , \"name\" : \"legacy_Crystal_NumberOfRooms\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"396\" , \"name\" : \"legacy_Crystal_pageName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"397\" , \"name\" : \"legacy_Crystal_productBrand\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"398\" , \"name\" : \"legacy_Crystal_productCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"399\" , \"name\" : \"legacy_Crystal_productCategory1\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"400\" , \"name\" : \"legacy_Crystal_productCategory2\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"401\" , \"name\" : \"legacy_Crystal_productCategory3_Resort\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"402\" , \"name\" : \"legacy_Crystal_productCategory4\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"403\" , \"name\" : \"legacy_Crystal_productID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"404\" , \"name\" : \"legacy_Crystal_productID_Facebook\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"405\" , \"name\" : \"legacy_Crystal_productName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"406\" , \"name\" : \"legacy_Crystal_productPax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"407\" , \"name\" : \"legacy_Crystal_productPrice\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"408\" , \"name\" : \"legacy_Crystal_sectionName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"409\" , \"name\" : \"legacy_Crystal_Selected_Flight_Position\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"410\" , \"name\" : \"legacy_Crystal_Server\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"411\" , \"name\" : \"legacy_Crystal_transactionID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"412\" , \"name\" : \"legacy_Crystal_TravelType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"413\" , \"name\" : \"legacy_Crystal_Ski_Affiliate_Cookie\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"414\" , \"name\" : \"legacy_Crystal_Ski_cjCookie\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"415\" , \"name\" : \"legacy_Crystal_Ski_Flashtalking_Departure_Date\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"416\" , \"name\" : \"legacy_Crystal_Ski_Products_Array\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"417\" , \"name\" : \"legacy_Crystal_Ski_Products_Array_Search\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"418\" , \"name\" : \"legacy_Currency\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"419\" , \"name\" : \"legacy_currencyCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"420\" , \"name\" : \"legacy_customerAccountNumberOfBookings\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"421\" , \"name\" : \"legacy_customerID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"422\" , \"name\" : \"legacy_date\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"423\" , \"name\" : \"legacy_daysToDeparture\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"424\" , \"name\" : \"legacy_decibelID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"425\" , \"name\" : \"legacy_departureAirportCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"426\" , \"name\" : \"legacy_departureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"427\" , \"name\" : \"legacy_departureDate_YYYYMMDD\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"428\" , \"name\" : \"legacy_departureDateDifference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"429\" , \"name\" : \"legacy_depositOptionsAvailable\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"430\" , \"name\" : \"legacy_depositOptionSelected\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"431\" , \"name\" : \"legacy_depositValueBookflow\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"432\" , \"name\" : \"legacy_destinationBrowse\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"433\" , \"name\" : \"legacy_destinationCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"434\" , \"name\" : \"legacy_destinationFC\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"435\" , \"name\" : \"legacy_destinationIMG\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"436\" , \"name\" : \"legacy_destinationName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"437\" , \"name\" : \"legacy_destinationPrice\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"438\" , \"name\" : \"legacy_destinationPush\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"439\" , \"name\" : \"legacy_device\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"440\" , \"name\" : \"legacy_directDebit\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"441\" , \"name\" : \"legacy_directOrIndirectFlight\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"442\" , \"name\" : \"legacy_dreamlinerFlight\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"443\" , \"name\" : \"legacy_duration\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"444\" , \"name\" : \"legacy_durationCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"445\" , \"name\" : \"legacy_durationSearched\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"446\" , \"name\" : \"legacy_emailHash\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"447\" , \"name\" : \"legacy_epicCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"448\" , \"name\" : \"legacy_facebookPixelFire\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"449\" , \"name\" : \"legacy_filterAccommodationType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"450\" , \"name\" : \"legacy_filterBackTime\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"451\" , \"name\" : \"legacy_filterBestFor\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"452\" , \"name\" : \"legacy_filterBoard\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"453\" , \"name\" : \"legacy_filterBudget\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"454\" , \"name\" : \"legacy_filterCruiseCabin\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"455\" , \"name\" : \"legacy_filterCruiseDestination\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"456\" , \"name\" : \"legacy_filterCruiseShip\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"457\" , \"name\" : \"legacy_filterCruiseStayDestination\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"458\" , \"name\" : \"legacy_filterDepartureAirport\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"459\" , \"name\" : \"legacy_filterDestination\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"460\" , \"name\" : \"legacy_filterFeatures\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"461\" , \"name\" : \"legacy_filterFreeChildPlaces\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"462\" , \"name\" : \"legacy_filterHolidayType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"463\" , \"name\" : \"legacy_filterOutTime\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"464\" , \"name\" : \"legacy_filterSingleAccommodationEndState\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"465\" , \"name\" : \"legacy_filterSortBy\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"466\" , \"name\" : \"legacy_filterTourOperator\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"467\" , \"name\" : \"legacy_filterTripAdvisorRating\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"468\" , \"name\" : \"legacy_filterTuiRating\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"469\" , \"name\" : \"legacy_firstPartyAncillaries\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"470\" , \"name\" : \"legacy_flexibleDates\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"471\" , \"name\" : \"legacy_flightExtrasBookingReference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"472\" , \"name\" : \"legacy_flightExtrasCheckedInState\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"473\" , \"name\" : \"legacy_flightExtrasInboundDays\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"474\" , \"name\" : \"legacy_flightInventory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"475\" , \"name\" : \"legacy_flightOnlyDeparturePeriod\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"476\" , \"name\" : \"legacy_flightType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"477\" , \"name\" : \"legacy_freeChildPlacePartySize\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"478\" , \"name\" : \"legacy_freeChildPlaces\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"479\" , \"name\" : \"legacy_geoCountry\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"480\" , \"name\" : \"legacy_geoLevel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"481\" , \"name\" : \"legacy_gmpCustomerID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"482\" , \"name\" : \"legacy_Google_Analytics_New_Property_ID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"483\" , \"name\" : \"legacy_Google_Analytics_Property_ID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"484\" , \"name\" : \"legacy_googleAnalyticsClientID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"485\" , \"name\" : \"legacy_googleAnalyticsPropertyID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"486\" , \"name\" : \"legacy_handLuggageOnly\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"487\" , \"name\" : \"legacy_haulTypeSearch\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"488\" , \"name\" : \"legacy_hostname\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"489\" , \"name\" : \"legacy_hotelName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"490\" , \"name\" : \"legacy_irClickID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"491\" , \"name\" : \"legacy_isAccommodationOnly\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"492\" , \"name\" : \"legacy_isChoiceSearch\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"493\" , \"name\" : \"legacy_isCreditNoteBooking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"494\" , \"name\" : \"legacy_isCreditNoteIncentiveEligible\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"495\" , \"name\" : \"legacy_isCRM\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"496\" , \"name\" : \"legacy_isLowDeposit\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"497\" , \"name\" : \"legacy_isPush\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"498\" , \"name\" : \"legacy_isSearch\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"499\" , \"name\" : \"legacy_isSEO\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"500\" , \"name\" : \"legacy_limitedAvailabilityBeds\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"501\" , \"name\" : \"legacy_limitedAvailabilityCabins\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"502\" , \"name\" : \"legacy_limitedAvailabilitySeats\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"503\" , \"name\" : \"legacy_Lock_Your_Price_Booking_Check\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"504\" , \"name\" : \"legacy_Lock_Your_Price_Available\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"505\" , \"name\" : \"legacy_Lock_Your_Price_Confirmed_Booking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"506\" , \"name\" : \"legacy_Lock_Your_Price_Revenue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"507\" , \"name\" : \"legacy_Lock_Your_Price_Unconfirmed_Booking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"508\" , \"name\" : \"legacy_Lock_Your_Price_Unconfirmed_Booking_Revenue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"509\" , \"name\" : \"legacy_loginDetail\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"510\" , \"name\" : \"legacy_minimumPaymentAmount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"511\" , \"name\" : \"legacy_mmbAmendmentDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"512\" , \"name\" : \"legacy_mmbAmendmentDetail\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"513\" , \"name\" : \"legacy_mmbAmendmentType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"514\" , \"name\" : \"legacy_mmbAmountOutstanding\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"515\" , \"name\" : \"legacy_mmbAncillaries\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"516\" , \"name\" : \"legacy_mmbBookingAmount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"517\" , \"name\" : \"legacy_mmbBookingType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"518\" , \"name\" : \"legacy_mmbExistingBookingDepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"519\" , \"name\" : \"legacy_mmbPaymentType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"520\" , \"name\" : \"legacy_mmbTransactionValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"521\" , \"name\" : \"legacy_month\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"522\" , \"name\" : \"legacy_monthYear\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"523\" , \"name\" : \"legacy_navigationTracking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"524\" , \"name\" : \"legacy_newDataLayer\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"525\" , \"name\" : \"legacy_newSEOdata\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"526\" , \"name\" : \"legacy_noOfRooms\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"527\" , \"name\" : \"legacy_numberOfAdults\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"528\" , \"name\" : \"legacy_numberOfChildren\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"529\" , \"name\" : \"legacy_numberOfInfants\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"530\" , \"name\" : \"legacy_numberOfPax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"531\" , \"name\" : \"legacy_numberOfResults\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"532\" , \"name\" : \"legacy_onlineDiscount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"533\" , \"name\" : \"legacy_pageID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"534\" , \"name\" : \"legacy_pageLoadTimeCount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"535\" , \"name\" : \"legacy_pageLoadTimeFullyLoaded\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"536\" , \"name\" : \"legacy_pageLoadTimeInteractive\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"537\" , \"name\" : \"legacy_pageNameTemporary\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"538\" , \"name\" : \"legacy_pagePath\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"539\" , \"name\" : \"legacy_pageSubCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"540\" , \"name\" : \"legacy_pageURL\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"541\" , \"name\" : \"legacy_paymentType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"542\" , \"name\" : \"legacy_ppcVariant\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"543\" , \"name\" : \"legacy_preferredSearchAvailable\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"544\" , \"name\" : \"legacy_price\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"545\" , \"name\" : \"legacy_priceVariationAlert\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"546\" , \"name\" : \"legacy_Privacy_Analytics_Experience\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"547\" , \"name\" : \"legacy_Privacy_Experience\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"548\" , \"name\" : \"legacy_Privacy_Opted_out_Categories\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"549\" , \"name\" : \"legacy_Privacy_Opted_out_Categories_Page_Load\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"550\" , \"name\" : \"legacy_productCollectionCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"551\" , \"name\" : \"legacy_productCollectionName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"552\" , \"name\" : \"legacy_productID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"553\" , \"name\" : \"legacy_productList\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"554\" , \"name\" : \"legacy_productType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"555\" , \"name\" : \"legacy_productTypeMoney4Travel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"556\" , \"name\" : \"legacy_programmeChangeFreeAmends\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"557\" , \"name\" : \"legacy_programmeChangeIncentiveCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"558\" , \"name\" : \"legacy_programmeChangeMemoNotes\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"559\" , \"name\" : \"legacy_promoCodeName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"560\" , \"name\" : \"legacy_promoCodeValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"561\" , \"name\" : \"legacy_protocol\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"562\" , \"name\" : \"legacy_purchaseID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"563\" , \"name\" : \"legacy_pushData\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"564\" , \"name\" : \"legacy_queryString\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"565\" , \"name\" : \"legacy_queryStringParamCmid\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"566\" , \"name\" : \"legacy_queryStringParamGclid\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"567\" , \"name\" : \"legacy_queryStringParamIkid\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"568\" , \"name\" : \"legacy_queryStringParamIto\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"569\" , \"name\" : \"legacy_queryStringParamQ\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"570\" , \"name\" : \"legacy_queryStringParamVlid\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"571\" , \"name\" : \"legacy_regionCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"572\" , \"name\" : \"legacy_regionName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"573\" , \"name\" : \"legacy_resortCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"574\" , \"name\" : \"legacy_resortName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"575\" , \"name\" : \"legacy_retailVisitorIDValueChange\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"576\" , \"name\" : \"legacy_returnDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"577\" , \"name\" : \"legacy_revenueMoney4Travel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"578\" , \"name\" : \"legacy_roomAllocation\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"579\" , \"name\" : \"legacy_roomComposition\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"580\" , \"name\" : \"legacy_roomOrCabinType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"581\" , \"name\" : \"legacy_screenSizeIncludingIPhones\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"582\" , \"name\" : \"legacy_searchedDepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"583\" , \"name\" : \"legacy_searchedDestinationIDs\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"584\" , \"name\" : \"legacy_searchedDestinationNames\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"585\" , \"name\" : \"legacy_searchResultsFinalPosition\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"586\" , \"name\" : \"legacy_searchType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"587\" , \"name\" : \"legacy_season\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"588\" , \"name\" : \"legacy_sellingCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"589\" , \"name\" : \"legacy_sessionID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"590\" , \"name\" : \"legacy_sessionState\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"591\" , \"name\" : \"legacy_shortlist\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"592\" , \"name\" : \"legacy_siteSection\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"593\" , \"name\" : \"legacy_siteSubSection\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"594\" , \"name\" : \"legacy_sourceBookingReference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"595\" , \"name\" : \"legacy_sourceBookingSystem\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"596\" , \"name\" : \"legacy_STOCKTON_CD_BOARD\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"597\" , \"name\" : \"legacy_STOCKTON_CD_Cabin\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"598\" , \"name\" : \"legacy_STOCKTON_DD_Affiliation\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"599\" , \"name\" : \"legacy_STOCKTON_DD_BoardFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"600\" , \"name\" : \"legacy_STOCKTON_DD_BrandName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"601\" , \"name\" : \"legacy_STOCKTON_DD_BudgetFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"602\" , \"name\" : \"legacy_STOCKTON_DD_CabinFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"603\" , \"name\" : \"legacy_STOCKTON_DD_Category\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"604\" , \"name\" : \"legacy_STOCKTON_DD_Confirmation_Itinerary_Name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"605\" , \"name\" : \"legacy_STOCKTON_DD_CRType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"606\" , \"name\" : \"legacy_STOCKTON_DD_Cruise_Details_Itinerary_Name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"607\" , \"name\" : \"legacy_STOCKTON_DD_Cruise_Options_Itinerary_Name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"608\" , \"name\" : \"legacy_STOCKTON_DD_CruiseId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"609\" , \"name\" : \"legacy_STOCKTON_DD_CRWhereTo\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"610\" , \"name\" : \"legacy_STOCKTON_DD_DaysUntilDeparture\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"611\" , \"name\" : \"legacy_STOCKTON_DD_DepartureAirport\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"612\" , \"name\" : \"legacy_STOCKTON_DD_DepartureAirportFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"613\" , \"name\" : \"legacy_STOCKTON_DD_DepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"614\" , \"name\" : \"legacy_STOCKTON_DD_DestinationFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"615\" , \"name\" : \"legacy_STOCKTON_DD_Discount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"616\" , \"name\" : \"legacy_STOCKTON_DD_Duration\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"617\" , \"name\" : \"legacy_STOCKTON_DD_Duration_New\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"618\" , \"name\" : \"legacy_STOCKTON_DD_Hotel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"619\" , \"name\" : \"legacy_STOCKTON_DD_Party\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"620\" , \"name\" : \"legacy_Stockton_DD_Passenger_Details_Itinerary_Name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"621\" , \"name\" : \"legacy_STOCKTON_DD_PaymentType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"622\" , \"name\" : \"legacy_STOCKTON_DD_PromoCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"623\" , \"name\" : \"legacy_STOCKTON_DD_ShipFilter\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"624\" , \"name\" : \"legacy_STOCKTON_DD_ShipName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"625\" , \"name\" : \"legacy_STOCKTON_DD_Sum\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"626\" , \"name\" : \"legacy_STOCKTON_DD_TransactionId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"627\" , \"name\" : \"legacy_STOCKTON_DD_Variant\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"628\" , \"name\" : \"legacy_thirdPartyAncillaries\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"629\" , \"name\" : \"legacy_thirdPartyBeds\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"630\" , \"name\" : \"legacy_thirdPartyBedsSupplier\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"631\" , \"name\" : \"legacy_thirdPartyFlightDetail\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"632\" , \"name\" : \"legacy_top5SearchResults\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"633\" , \"name\" : \"legacy_tradingCycle\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"634\" , \"name\" : \"legacy_tripAdvisorEventID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"635\" , \"name\" : \"legacy_tripAdvisorRating\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"636\" , \"name\" : \"legacy_tripType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"637\" , \"name\" : \"legacy_trv_reference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"638\" , \"name\" : \"legacy_tuiProductRating\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"639\" , \"name\" : \"legacy_uniqodoBookingReference\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"640\" , \"name\" : \"legacy_uniqodoPrice\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"641\" , \"name\" : \"legacy_uniqodoPromoCodeName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"642\" , \"name\" : \"legacy_userAgent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"643\" , \"name\" : \"auth\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"644\" , \"name\" : \"cmid\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"645\" , \"name\" : \"b\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"646\" , \"name\" : \"cjevent\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"647\" , \"name\" : \"irclickid\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"648\" , \"name\" : \"legacy_customerIDClean\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"649\" , \"name\" : \"legacy_bookingReferenceSplit\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"650\" , \"name\" : \"gaid\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"651\" , \"name\" : \"legacy_Google_Analytics_All_Property_IDs\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"652\" , \"name\" : \"loadRulesTriggered\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"653\" , \"name\" : \"gaEventCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"654\" , \"name\" : \"gaEventAction\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"655\" , \"name\" : \"product_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"656\" , \"name\" : \"product_sku\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"657\" , \"name\" : \"product_name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"658\" , \"name\" : \"product_brand\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"659\" , \"name\" : \"product_category\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"660\" , \"name\" : \"product_subcategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"661\" , \"name\" : \"product_unit_price\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"662\" , \"name\" : \"product_list_price\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"663\" , \"name\" : \"product_quantity\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"664\" , \"name\" : \"product_discount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"665\" , \"name\" : \"order_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"666\" , \"name\" : \"order_total\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"667\" , \"name\" : \"order_subtotal\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"668\" , \"name\" : \"order_payment_type\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"669\" , \"name\" : \"order_discount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"670\" , \"name\" : \"order_shipping\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"671\" , \"name\" : \"order_tax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"672\" , \"name\" : \"order_currency\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"673\" , \"name\" : \"order_coupon_code\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"674\" , \"name\" : \"order_coupon_discount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"675\" , \"name\" : \"order_store\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"676\" , \"name\" : \"order_type\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"677\" , \"name\" : \"customer_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"678\" , \"name\" : \"customer_city\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"679\" , \"name\" : \"customer_state\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"680\" , \"name\" : \"customer_zip\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"681\" , \"name\" : \"customer_country\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"682\" , \"name\" : \"customer_email\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"683\" , \"name\" : \"customer_type\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"684\" , \"name\" : \"legacy_productList.productID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"685\" , \"name\" : \"legacy_productList.productName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"686\" , \"name\" : \"legacy_productList.list\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"687\" , \"name\" : \"legacy_productList.productCollectionName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"688\" , \"name\" : \"legacy_productList.position\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"689\" , \"name\" : \"gaEventLabel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"690\" , \"name\" : \"legacy_productList.brand\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"691\" , \"name\" : \"legacy_productList.price\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"692\" , \"name\" : \"legacy_productList.quantity\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"693\" , \"name\" : \"legacy_productList.name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"694\" , \"name\" : \"legacy_productList.productType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"695\" , \"name\" : \"legacy_productList.id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"696\" , \"name\" : \"legacy_productList.metric1\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"697\" , \"name\" : \"siteName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"698\" , \"name\" : \"fbPixelID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"699\" , \"name\" : \"fbEvent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"700\" , \"name\" : \"fbContentType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"701\" , \"name\" : \"fbEventType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"702\" , \"name\" : \"fbContentName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"703\" , \"name\" : \"fbCheckinDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"704\" , \"name\" : \"fbValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"705\" , \"name\" : \"fbNumTravelers\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"706\" , \"name\" : \"fbPromoCodeName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"707\" , \"name\" : \"fbPromoCodeValue\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"708\" , \"name\" : \"fbDestination\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"709\" , \"name\" : \"fbOrigin\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"710\" , \"name\" : \"fbDeparting\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"711\" , \"name\" : \"fbContentIDs\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"712\" , \"name\" : \"fbDepartingDepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"713\" , \"name\" : \"fbOriginAirport\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"714\" , \"name\" : \"fbReturningDepartureDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"715\" , \"name\" : \"fbDestinationAirport\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"716\" , \"name\" : \"fbNumAdults\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"717\" , \"name\" : \"fbContentCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"718\" , \"name\" : \"fbNumItems\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"719\" , \"name\" : \"fbCheckoutDate\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"720\" , \"name\" : \"fbNumChildren\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"721\" , \"name\" : \"fbDestinationIDs\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"722\" , \"name\" : \"fbHaulType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"723\" , \"name\" : \"currencyCode\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"724\" , \"name\" : \"utag_main__ss\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"725\" , \"name\" : \"utag_main__pn\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"726\" , \"name\" : \"utag_main__sn\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"727\" , \"name\" : \"utag_main_v_id\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"728\" , \"name\" : \"utag_main__st\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"729\" , \"name\" : \"utag_main_ses_id\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"730\" , \"name\" : \"ut.account\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"731\" , \"name\" : \"ut.profile\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"732\" , \"name\" : \"ut.env\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"733\" , \"name\" : \"ut.version\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"734\" , \"name\" : \"ut.domain\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"735\" , \"name\" : \"brand_and_environment\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"736\" , \"name\" : \"uniqodo_script_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"737\" , \"name\" : \"uniqodo_account_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"738\" , \"name\" : \"uniqodo_brand\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"739\" , \"name\" : \"legacy_flightOnlyDepositPeriod\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"740\" , \"name\" : \"legacy_commerceValueScore\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"741\" , \"name\" : \"legacy_filterCruiseStayDuration\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"742\" , \"name\" : \"adobeChannel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"743\" , \"name\" : \"adobeCampaign\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"744\" , \"name\" : \"quantcastLabel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"745\" , \"name\" : \"quantcastAccountId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"746\" , \"name\" : \"numberOfPax\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"747\" , \"name\" : \"cm_event_name\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"748\" , \"name\" : \"cm_event_category\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"749\" , \"name\" : \"cm_event_action\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"750\" , \"name\" : \"cm_method\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"751\" , \"name\" : \"cm_banner_version\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"752\" , \"name\" : \"cm_optout_categories\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"753\" , \"name\" : \"event\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"754\" , \"name\" : \"productType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"755\" , \"name\" : \"cm_banner_was_shown\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"756\" , \"name\" : \"tealium_event\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"757\" , \"name\" : \"legacy_queryStringParamGaid\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"758\" , \"name\" : \"quantcastCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"759\" , \"name\" : \"tuiblue\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"760\" , \"name\" : \"dcAdvertiserId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"761\" , \"name\" : \"dcActivityGroup\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"762\" , \"name\" : \"dcActivityString\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"763\" , \"name\" : \"dcFloodlightFire\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"764\" , \"name\" : \"cloud_iq_id\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"765\" , \"name\" : \"placeholder_pageCategory\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"766\" , \"name\" : \"dcCounterType\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"767\" , \"name\" : \"dcSettings\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"768\" , \"name\" : \"baynote_code\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"769\" , \"name\" : \"baynote_server\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"770\" , \"name\" : \"googleAdsConversionId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"771\" , \"name\" : \"googleAdsConversionLabel\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"772\" , \"name\" : \"braze_api_key\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"773\" , \"name\" : \"bingUETTag\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"774\" , \"name\" : \"bingEvent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"775\" , \"name\" : \"turnID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"776\" , \"name\" : \"uniqodo_booking_type\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"777\" , \"name\" : \"turnCID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"778\" , \"name\" : \"turnbprice\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"779\" , \"name\" : \"fbOrderID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"780\" , \"name\" : \"fbCreditNoteBooking\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"781\" , \"name\" : \"fbCreditNoteDiscount\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"782\" , \"name\" : \"pageID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"783\" , \"name\" : \"fbCurrency\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"784\" , \"name\" : \"pinterestEvent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"785\" , \"name\" : \"adobeEvents\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"786\" , \"name\" : \"sc_events\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"787\" , \"name\" : \"linkTrackVars\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"788\" , \"name\" : \"linkTrackEvents\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"789\" , \"name\" : \"impactActionId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"790\" , \"name\" : \"impactSku\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"791\" , \"name\" : \"impactResortName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"792\" , \"name\" : \"movableInkSubDomain\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"793\" , \"name\" : \"movableInkSku\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"794\" , \"name\" : \"impactConversionTrigger\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"795\" , \"name\" : \"tsmID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"796\" , \"name\" : \"tsmRID\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"797\" , \"name\" : \"rid\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"798\" , \"name\" : \"tsm_rid\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"799\" , \"name\" : \"tsmBoard\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"800\" , \"name\" : \"pushengageBaseUrl\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"801\" , \"name\" : \"pushengageEvent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"802\" , \"name\" : \"pushengageCampaignName\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"803\" , \"name\" : \"tripadvisorPixelId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"804\" , \"name\" : \"tripadvisorPartner\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"805\" , \"name\" : \"taeventid\" , \"type\" : \"cp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"806\" , \"name\" : \"tripadvisorEvent\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"807\" , \"name\" : \"googleHotelAdsOrderId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"808\" , \"name\" : \"distributeTravelId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"809\" , \"name\" : \"ozoneTagId\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"810\" , \"name\" : \"ozoneSegmentKey\" , \"type\" : \"js\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_variable\" , \"data\" : { \"id\" : \"811\" , \"name\" : \"trv_reference\" , \"type\" : \"qp\" , \"library\" : \"\" , \"kind\" : \"Variable\" , \"operation\" : \"added\" , \"container\" : \"defineObjectsList\" , \"tab_name\" : \"define\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"6\" , \"name\" : \"All Brands - Web - Global - All Pages (Excluding PrdSupport, Retail, Inspire &amp; Nordics) [4885406]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920163300589\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"7\" , \"name\" : \"TUI IE - Web - Dev - All Test Sites - Flights - Confirmation (With Data Definition) [4868458]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920222100590\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"8\" , \"name\" : \"TUI IE - Web - Dev - All Test Sites - Beach - Confirmation (With Data Definition) [4868457]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920315600591\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"9\" , \"name\" : \"TUI IE - Web - Prod - Flights - Confirmation (With Data Definition) [4868452]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920367000592\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"10\" , \"name\" : \"TUI IE - Web - Prod - Beach - Confirmation (With Data Definition) [4868451]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920417900593\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"11\" , \"name\" : \"FC - Web - Dev - All Test Sites - All Pages (Including Payment) [962796]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920469600594\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"12\" , \"name\" : \"TUI UK - Web - Prod - All Pages (Excluding Payment Page) [686176]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920518800595\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"13\" , \"name\" : \"TUI UK - Web - Dev - All Test Sites - All Pages (Including Payment) [664598]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920577000596\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"14\" , \"name\" : \"FC - Web - Prod - All Pages (Excluding Payment) [650480]\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161130920628800597\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 10 , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Google Analytics (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130920690100598\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 11 , \"tag_name\" : \"Floodlight (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Floodlight (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130920760800650\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 12 , \"tag_name\" : \"Floodlight (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Floodlight (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130920888600695\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 13 , \"tag_name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130920956000701\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 14 , \"tag_name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130921021000704\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 15 , \"tag_name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Google Ads Conversion Tracking &amp; Remarketing (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130921089400705\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 16 , \"tag_name\" : \"Tealium Custom Container\" , \"library\" : \"\" , \"name\" : \"Tealium Custom Container\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161130921443200712\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"26\" , \"name\" : \"UDO Cleanup - Remove null/empty/undefined values\" , \"type\" : \"100036\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_26\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"27\" , \"name\" : \"UDO Population - 'legacy_' data definitions (copied directly from Ensighten as a stopgap)\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_27\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"28\" , \"name\" : \"Google Analytics - Additional Variables\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_28\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"29\" , \"name\" : \"Set tealium_event (and related) on TIMING events\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_29\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"30\" , \"name\" : \"E-commerce\" , \"type\" : \"100005\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_30\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"31\" , \"name\" : \"Set  tealium_event (and related) on DETAIL pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_31\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"32\" , \"name\" : \"Set tealium_event (and related) on SEARCH pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_32\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"33\" , \"name\" : \"Convert 'legacy_productList' into arrays of the component parts\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_33\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"34\" , \"name\" : \"Set tealium_event (and related) on CHECKOUT - EXTRA OPTIONS pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_34\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"35\" , \"name\" : \"Set tealium_event (and related) on CHECKOUT - CUSTOMISE HOLIDAY pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_35\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"36\" , \"name\" : \"Set tealium_event (and related) on CHECKOUT - FLIGHT OPTIONS pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_36\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"37\" , \"name\" : \"Set  tealium_event (and related) on CHECKOUT - ROOM OPTIONS pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_37\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"38\" , \"name\" : \"Set tealium_event (and related) on CHECKOUT - SUMMARY TO PAYMENT pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_38\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"39\" , \"name\" : \"Set tealium_event (and related) on PURCHASE pages\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_39\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"40\" , \"name\" : \"Google Analytics - Prevent tag from firing on cm_events (Manage Preferences Relaunch)\" , \"type\" : \"100036\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_40\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"41\" , \"name\" : \"Google Analytics - Edit Ecommerce Vars for GA on 'detail'\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_41\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"42\" , \"name\" : \"Google Campaign Manager: Set Advertiser ID [1]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_42\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"43\" , \"name\" : \"Google Campaign Manager: Purchase Floodlight Trigger [5]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_43\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"44\" , \"name\" : \"Google Campaign Manager: TUI UK Floodlight Configs [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_44\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"45\" , \"name\" : \"Google Campaign Manager: Set Floodlight Variables [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_45\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"46\" , \"name\" : \"Google Campaign Manager: First Choice Floodlight Configs [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_46\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"47\" , \"name\" : \"Google Campaign Manager: TUI IE Floodlight Configs [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_47\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"48\" , \"name\" : \"Google Campaign Manager: TUI UK Unique Lands Floodlight Variables Override [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_48\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"49\" , \"name\" : \"Google Campaign Manager: Set First Choice Unique Lands Floodlight Variables Override [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_49\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"50\" , \"name\" : \"Google Campaign Manager: TUI AO Purchase Floodlight Config [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_50\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"51\" , \"name\" : \"Google Campaign Manager: TUI Lakes Purchase Floodlight Config [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_51\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"52\" , \"name\" : \"Google Campaign Manager: TUI Tours Purchase Floodlight Config [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_52\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"53\" , \"name\" : \"Google Campaign Manager: First Choice AO Purchase Floodlight Config [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_53\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"54\" , \"name\" : \"Google Ads: Lakes &amp; Mountains Event Snippet [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_54\" , \"tab_name\" : \"customizations\"}}]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"size":"1,360"},"202101221157":{"title":"Version 2021.01.22.1157","status":"Not Published","size":"1,360","202101221157":{"action":"Published to dev","notes":"Show issue","publishedConsent":"[ ]","versionorigin":"202101220955","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"16\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"16","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.22.1157","history":"[ { \"action\" : \"removed_tag\" , \"data\" : { \"id\" : \"9\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4\" , \"library\" : \"\" , \"kind\" : \"Tag\" , \"operation\" : \"removed\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"16\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4 - Custom\" , \"status\" : \"active\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161131576256400028\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]"}},"202102150938":{"202102150938":{"linkedProfiles":"{ }","history":"[ ]","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastmanageid":"21","operator":"caleb.jaquith@tealium.com","notes":"Save for adform template to check","versionorigin":"202102101306","action":"Save profile"},"status":"Not Published","title":"Version 2021.02.15.0937"},"202101221341":{"title":"Version 2021.01.22.1341","202101221341":{"history":"[ { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GA4 - Google Analytics (gtag.js)\" , \"status\" : \"inactive\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161132021345800034\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"16\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4 - Custom\" , \"status\" : \"active\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161131576256400028\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","notes":"Save","versionorigin":"202101221307","action":"Save profile","lastmanageid":"17","operator":"caleb.jaquith@tealium.com"},"status":"Not Published"},"202101201145":{"202101201145":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"Adobe Analytics - s.events JS logic\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.20.1144","lastcustomizeid":"0","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"8","status":"dev","action":"Published to dev","versionorigin":"202101201120","publishedConsent":"[ ]","notes":"Update reworked"},"title":"Version 2021.01.20.1144","status":"Not Published","size":"591"},"202101201149":{"size":"591","status":"Not Published","202101201149":{"action":"Published to dev","versionorigin":"202101201145","publishedConsent":"[ ]","notes":"Update","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"8","status":"dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.20.1149","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"Adobe Analytics - s.events JS logic\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","linkedProfiles":"{ }"},"title":"Version 2021.01.20.1149"},"202101211558":{"title":"Version 2021.01.21.1558","202101211558":{"action":"Published to dev","versionorigin":"202101211542","notes":"Stand up","publishedConsent":"[ ]","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"9\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"9","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.21.1558","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"9\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161124370765701145\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"9\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"GA4\" , \"tag_name\" : \"Tealium Custom Container\" , \"container\" : \"manage_content_161124370765701145\" , \"tab_name\" : \"Template\"}}]","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]"},"status":"Not Published","size":"596"},"202102101229":{"title":"Version 2021.02.10.1229","202102101229":{"lastmanageid":"19","operator":"caleb.jaquith@tealium.com","versionorigin":"202102030858","notes":"Library sync","action":"Save profile","linkedProfiles":"{ }","history":"[ { \"action\" : \"removed_extension\" , \"data\" : { \"id\" : \"57\" , \"name\" : \"OPT OUT lib2\" , \"type\" : \"100022\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"kind\" : \"Extension\" , \"operation\" : \"removed\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"removed_extension\" , \"data\" : { \"id\" : \"58\" , \"name\" : \"DNT lib2\" , \"type\" : \"100034\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"kind\" : \"Extension\" , \"operation\" : \"removed\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"removed_tag\" , \"data\" : { \"id\" : \"19\" , \"tag_name\" : \"Google Analytics 4 (gtag.js) (BETA)\" , \"name\" : \"Google Analytics 4 (gtag.js) (BETA)\" , \"imported\" : \"qa\" , \"library\" : \"lib-test2\" , \"kind\" : \"Tag\" , \"operation\" : \"removed\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"status":"Not Published"},"202101221228":{"202101221228":{"publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"55\"]","linkedProfiles":"{ }","title":"Version 2021.01.22.1228","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : 55 , \"name\" : \"Allow multiple gtags on a page (for GA4 to have a separate one)\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_55\" , \"tab_name\" : \"customizations\"}}]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastmanageid":"16","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"16\"]","versionorigin":"202101221224","notes":"Update","publishedConsent":"[ ]","action":"Published to dev"},"size":"1,372","status":"Not Published","title":"Version 2021.01.22.1228"},"202101191120":{"status":"Not Published","size":"339","202101191120":{"publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"6","action":"Published to dev","publishedConsent":"[ ]","notes":"Remove hardcoded events","versionorigin":"202101191118","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.19.1120","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0"},"title":"Version 2021.01.19.1120"},"202101191521":{"title":"Version 2021.01.19.1521","202101191521":{"datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.19.1521","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161106961714100007\" , \"tab_name\" : \"Template\"}}]","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","action":"Published to dev","notes":"Update template","versionorigin":"202101191417","publishedConsent":"[ ]","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\"]","status":"qa,dev","lastmanageid":"6"},"status":"Not Published","size":"455"},"202102101300":{"status":"Not Published","size":"1,419","202102101300":{"status":"dev","lastmanageid":"20","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"20\"]","versionorigin":"202102101257","publishedConsent":"[ ]","notes":"Update FB pixel id","action":"Published to dev","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"59\" , \"62\" , \"64\" , \"65\" , \"66\" , \"67\" , \"68\" , \"69\" , \"70\" , \"71\" , \"72\" , \"73\" , \"74\" , \"75\" , \"76\" , \"77\" , \"78\" , \"79\"]","linkedProfiles":"{ }","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"20\" , \"tag_name\" : \"Facebook Pixel\" , \"name\" : \"Facebook Pixel\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161296140131601183\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.02.10.1300","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"title":"Version 2021.02.10.1300"},"202101221237":{"202101221237":{"linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"55\" , \"56\"]","lastcustomizeid":"0","history":"[ { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"56\" , \"name\" : \"No Title\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_56\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : 55 , \"name\" : \"Allow multiple gtags on a page (for GA4 to have a separate one)\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_55\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.22.1236","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastmanageid":"16","status":"dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"16\"]","publishedConsent":"[ ]","versionorigin":"202101221228","notes":"Update","action":"Published to dev"},"title":"Version 2021.01.22.1236","size":"1,364","status":"Not Published"},"202101191632":{"title":"Version 2021.01.19.1632","status":"Not Published","size":"455","202101191632":{"notes":"Update","publishedConsent":"[ ]","versionorigin":"202101191615","action":"Published to dev","lastmanageid":"6","status":"qa,dev","publishedTags":"[ \"2\" , \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","title":"Version 2021.01.19.1632","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161107282396700007\" , \"tab_name\" : \"Template\"}}]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }"}},"202102101237":{"title":"Version 2021.02.10.1236","status":"qa","size":"1,419","202102101237":{"publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"20\"]","operator":"caleb.jaquith@tealium.com","status":"dev","lastmanageid":"19","action":"Published to dev","versionorigin":"202102101229","notes":"Copy some FB things from tui-uk","publishedConsent":"[ ]","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"59\" , \"62\" , \"64\" , \"65\" , \"66\" , \"67\" , \"68\" , \"69\" , \"70\" , \"71\" , \"72\" , \"73\" , \"74\" , \"75\" , \"76\" , \"77\" , \"78\" , \"79\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.02.10.1236","history":"[ { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"15\" , \"name\" : \"fbPixelID is populated\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161296053203605912\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : \"16\" , \"name\" : \"All Brands - Web - Global - All Pages (Excluding Payment)\" , \"library\" : \"\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161296053238805913\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"added_tag\" , \"data\" : { \"id\" : 20 , \"tag_name\" : \"Facebook Pixel\" , \"library\" : \"\" , \"name\" : \"Facebook Pixel\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161296053291805914\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"63\" , \"name\" : \"Facebook Event: Purchase M4T\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_63\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"64\" , \"name\" : \"Facebook Pixel Event: AddToCart [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_64\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"65\" , \"name\" : \"Facebook Pixel Event: InitiateCheckout [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_65\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"66\" , \"name\" : \"Facebook Pixel Event: Purchase [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_66\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"67\" , \"name\" : \"Facebook Pixel Event: Search [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_67\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"68\" , \"name\" : \"Facebook Pixel Event: ViewContent [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_68\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"69\" , \"name\" : \"Facebook Pixel: Accomodation Only content_name [2]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_69\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"70\" , \"name\" : \"Facebook Pixel Event: ViewContent Destinations [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_70\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"71\" , \"name\" : \"Facebook Pixel Event: AddToWishlist [3]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_71\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"72\" , \"name\" : \"Facebook - Disable most Ecommerce fields [2]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_72\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"73\" , \"name\" : \"Facebook Pixel: content_name [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_73\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"74\" , \"name\" : \"Facebook Pixel: content_type [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_74\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"75\" , \"name\" : \"Facebook Pixel: content_category [2]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_75\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"76\" , \"name\" : \"Facebook Pixel: contentIDs [2]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_76\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"77\" , \"name\" : \"Facebook Pixel: fbCurrency [2]\" , \"type\" : \"100020\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_77\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"78\" , \"name\" : \"Format: returnDate of null to &quot;&quot; for Cruise\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_78\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"79\" , \"name\" : \"Facebook Pixel: Flight Only specific parameters [4]\" , \"type\" : \"100003\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_79\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0"}},"202101221355":{"202101221355":{"action":"Published to dev","notes":"Update","versionorigin":"202101221341","publishedConsent":"[ ]","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\"]","status":"dev","lastmanageid":"17","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","title":"Version 2021.01.22.1354","lastcustomizeid":"0","history":"[ { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"16\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4 - Custom\" , \"status\" : \"inactive\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161132357840601218\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GA4 - Google Analytics (gtag.js)\" , \"status\" : \"active\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161132357840701219\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GA4 - Google Analytics (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161132357840701219\" , \"tab_name\" : \"manage\"}}]","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]"},"title":"Version 2021.01.22.1354","status":"Not Published","size":"1,373"},"202101221302":{"title":"Version 2021.01.22.1302","size":"1,373","202101221302":{"linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","title":"Version 2021.01.22.1302","history":"[ { \"action\" : \"toggled_extension\" , \"data\" : { \"id\" : 56 , \"name\" : \"No Title\" , \"type\" : \"100040\" , \"status\" : \"inactive\" , \"kind\" : \"Extension\" , \"operation\" : \"toggled\" , \"container\" : \"customizations_56\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"toggled_extension\" , \"data\" : { \"id\" : 55 , \"name\" : \"Allow multiple gtags on a page (for GA4 to have a separate one)\" , \"type\" : \"100040\" , \"status\" : \"inactive\" , \"kind\" : \"Extension\" , \"operation\" : \"toggled\" , \"container\" : \"customizations_55\" , \"tab_name\" : \"customizations\"}}]","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\"]","lastmanageid":"17","status":"dev","action":"Published to dev","versionorigin":"202101221259","notes":"Remove change","publishedConsent":"[ ]"},"status":"Not Published"},"202101191127":{"status":"Not Published","size":"333","202101191127":{"operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"3\" , \"5\"]","lastmanageid":"6","status":"dev","action":"Published to dev","notes":"UPdate","publishedConsent":"[ ]","versionorigin":"202101191120","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1127"},"title":"Version 2021.01.19.1127"},"202101191115":{"status":"Not Published","size":"468","202101191115":{"action":"Published to dev","notes":"No more clearVars","publishedConsent":"[ ]","versionorigin":"202101191113","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"3\" , \"5\" , \"6\"]","lastmanageid":"6","status":"dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"6\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Fixed\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161105476128700590\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"manage\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1115","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"21\" , \"23\"]","linkedProfiles":"{ }"},"title":"Version 2021.01.19.1115"},"202101191651":{"title":"Version 2021.01.19.1651","202101191651":{"versionorigin":"202101191648","notes":"Add latest fixed","publishedConsent":"[ ]","action":"Published to dev","lastmanageid":"8","status":"qa,dev","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","operator":"caleb.jaquith@tealium.com","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"8\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Latest FIxed\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161107486797900074\" , \"tab_name\" : \"Template\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"17\" , \"name\" : \"Fire u.addEvent as needed for specific events\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_17\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}} , { \"action\" : \"added_loadrule\" , \"data\" : { \"id\" : 5 , \"name\" : \"Adobe Marketplace Latest Tag - Copy\" , \"kind\" : \"Loadrule\" , \"operation\" : \"added\" , \"container\" : \"loadrules_content_161107507186800135\" , \"tab_name\" : \"loadrules\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"8\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Latest FIxed\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107486797900074\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.01.19.1651","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"},"size":"699","status":"prod,dev"},"202101191615":{"status":"Not Published","size":"455","202101191615":{"notes":"Update to include cookieDomainPeriods","versionorigin":"202101191550","publishedConsent":"[ ]","action":"Published to dev","status":"qa,dev","lastmanageid":"6","publishedTags":"[ \"2\" , \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","title":"Version 2021.01.19.1615","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161107282396700007\" , \"tab_name\" : \"Template\"}}]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"},"title":"Version 2021.01.19.1615"},"202101191403":{"title":"Version 2021.01.19.1403","202101191403":{"action":"Published to dev","versionorigin":"202101191312","publishedConsent":"[ ]","notes":"Update and add load rules","publishedTags":"[ \"2\" , \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"6","status":"qa,dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastcustomizeid":"0","history":"[ { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"2\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"status\" : \"active\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161106436139200097\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"2\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161106436139200097\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Customized\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161106436139300098\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.01.19.1403","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"},"status":"Not Published","size":"395"},"202101191237":{"title":"Version 2021.01.19.1236","202101191237":{"action":"Published to dev","publishedConsent":"[ ]","notes":"Updateeee","versionorigin":"202101191210","publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","lastmanageid":"6","status":"dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1236","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"},"size":"333","status":"Not Published"},"202101201120":{"status":"Not Published","202101201120":{"publishedConsent":"[ ]","notes":"Update","versionorigin":"202101201110","action":"Published to dev","status":"dev","lastmanageid":"8","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","operator":"caleb.jaquith@tealium.com","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"25\" , \"name\" : \"Adobe Analytics - s.events JS logic\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_25\" , \"tab_name\" : \"customizations\"}}]","title":"Version 2021.01.20.1120","lastcustomizeid":"0","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\"]","linkedProfiles":"{ }"},"size":"587","title":"Version 2021.01.20.1120"},"202101191702":{"status":"qa,prod","size":"699","202101191702":{"linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"8\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Latest FIxed\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107486797900074\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"7\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Latest Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107437639200014\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"5\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Fixed\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107282396700007\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"2\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161107282396600006\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1702","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","lastmanageid":"8","status":"prod,qa,dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\"]","notes":"Update to prod for ticket","versionorigin":"202101191651","publishedConsent":"[ ]","action":"Published to dev"},"title":"Version 2021.01.19.1702"},"202101191406":{"202101191406":{"publishedConsent":"[ ]","versionorigin":"202101191403","notes":"Add plugins","action":"Published to dev","lastmanageid":"6","status":"qa,dev","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\"]","title":"Version 2021.01.19.1406","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_extension\" , \"data\" : { \"id\" : \"23\" , \"name\" : \"TUI UK Plugin staging\" , \"type\" : \"100040\" , \"kind\" : \"Extension\" , \"operation\" : \"updated\" , \"container\" : \"customizations_23\" , \"tab_name\" : \"customizations\"}}]","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]"},"size":"455","status":"Not Published","title":"Version 2021.01.19.1406"},"202101221224":{"size":"1,372","status":"Not Published","202101221224":{"status":"dev","lastmanageid":"16","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"16\"]","operator":"caleb.jaquith@tealium.com","versionorigin":"202101221157","publishedConsent":"[ ]","notes":"Add second gtag logic","action":"Published to dev","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"55\"]","history":"[ { \"action\" : \"added_extension\" , \"data\" : { \"id\" : \"55\" , \"name\" : \"No Title\" , \"type\" : \"100040\" , \"library\" : \"\" , \"kind\" : \"Extension\" , \"operation\" : \"added\" , \"container\" : \"customizations_55\" , \"tab_name\" : \"customizations\"}}]","lastcustomizeid":"0","title":"Version 2021.01.22.1224","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}"},"title":"Version 2021.01.22.1224"},"202101191147":{"title":"Version 2021.01.19.1146","202101191147":{"publishedConsent":"[ ]","versionorigin":"202101191127","notes":"Update u.o.Ha in the Adobe Template","action":"Published to dev","status":"dev","lastmanageid":"6","publishedTags":"[ \"3\" , \"5\"]","operator":"caleb.jaquith@tealium.com","history":"[ { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"5\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Adobe Analytics AppMeasurement for JS - Marketplace\" , \"tag_name\" : \"Adobe Analytics AppMeasurement for JS\" , \"container\" : \"manage_content_161105476128600589\" , \"tab_name\" : \"Template\"}}]","lastcustomizeid":"0","title":"Version 2021.01.19.1146","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\"]","linkedProfiles":"{ }"},"status":"Not Published","size":"333"},"202101221259":{"size":"1,377","status":"Not Published","title":"Version 2021.01.22.1259","202101221259":{"action":"Published to dev","notes":"Update","publishedConsent":"[ ]","versionorigin":"202101221237","operator":"caleb.jaquith@tealium.com","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\"]","lastmanageid":"17","status":"dev","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","history":"[ { \"action\" : \"added_tag\" , \"data\" : { \"id\" : \"17\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"library\" : \"\" , \"name\" : \"Google Analytics (gtag.js)\" , \"kind\" : \"Tag\" , \"operation\" : \"added\" , \"container\" : \"manage_content_161132021345800034\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"10\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"name\" : \"GUA - TUI UK\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161131576255800022\" , \"tab_name\" : \"manage\"}} , { \"action\" : \"updated_template\" , \"data\" : { \"id\" : \"17\" , \"kind\" : \"Template\" , \"operation\" : \"updated\" , \"name\" : \"Google Analytics (gtag.js)\" , \"tag_name\" : \"Google Analytics (gtag.js)\" , \"container\" : \"manage_content_161132021345800034\" , \"tab_name\" : \"Template\"}} , { \"action\" : \"toggled_tag\" , \"data\" : { \"id\" : \"16\" , \"tag_name\" : \"Tealium Custom Container\" , \"name\" : \"GA4 - Custom\" , \"status\" : \"inactive\" , \"kind\" : \"Tag\" , \"operation\" : \"toggled\" , \"container\" : \"manage_content_161131576256400028\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.01.22.1259","lastcustomizeid":"0","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"55\" , \"56\"]"}},"202102101306":{"status":"dev","size":"1,419","202102101306":{"versionorigin":"202102101300","publishedConsent":"[ ]","notes":"Add num_children to the search","action":"Published to dev","lastmanageid":"20","status":"dev","publishedTags":"[ \"2\" , \"3\" , \"5\" , \"7\" , \"8\" , \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"15\" , \"17\" , \"20\"]","operator":"caleb.jaquith@tealium.com","lastcustomizeid":"0","history":"[ { \"action\" : \"updated_tag\" , \"data\" : { \"id\" : \"20\" , \"tag_name\" : \"Facebook Pixel\" , \"name\" : \"Facebook Pixel\" , \"kind\" : \"Tag\" , \"operation\" : \"updated\" , \"container\" : \"manage_content_161296140131601183\" , \"tab_name\" : \"manage\"}}]","title":"Version 2021.02.10.1305","datacloudLinkedProfiles":"{&quot;main&quot;:{&quot;rev&quot;:&quot;1605528129252&quot;,&quot;env&quot;:&quot;AudienceStream&quot;}}","linkedProfiles":"{ }","publishedExtensions":"[ \"10\" , \"11\" , \"12\" , \"13\" , \"14\" , \"17\" , \"23\" , \"25\" , \"26\" , \"27\" , \"28\" , \"29\" , \"30\" , \"31\" , \"32\" , \"33\" , \"34\" , \"35\" , \"36\" , \"37\" , \"38\" , \"39\" , \"40\" , \"41\" , \"42\" , \"43\" , \"44\" , \"45\" , \"46\" , \"47\" , \"48\" , \"49\" , \"50\" , \"51\" , \"52\" , \"53\" , \"54\" , \"59\" , \"62\" , \"64\" , \"65\" , \"66\" , \"67\" , \"68\" , \"69\" , \"70\" , \"71\" , \"72\" , \"73\" , \"74\" , \"75\" , \"76\" , \"77\" , \"78\" , \"79\"]"},"title":"Version 2021.02.10.1305"}},"datacloud_merge":"true","datacloud_profile_name":"main","datacloud_revision":"1625226277606","experiments":[]}
